{"version":3,"sources":["webpack:///./node_modules/ol-ext/interaction/Split.js","webpack:///./node_modules/ol/MapBrowserEventType.js","webpack:///./node_modules/ol/CollectionEventType.js","webpack:///./node_modules/ol/Kinetic.js","webpack:///./node_modules/ol/Observable.js","webpack:///./node_modules/ol/ViewHint.js","webpack:///./node_modules/ol/Feature.js","webpack:///./node_modules/ol/MapBrowserEvent.js","webpack:///./node_modules/ol/MapEventType.js","webpack:///./node_modules/ol/LayerType.js","webpack:///./node_modules/ol/Tile.js","webpack:///./node_modules/ol/MapBrowserEventHandler.js","webpack:///./node_modules/ol/MapProperty.js","webpack:///./node_modules/ol/TileQueue.js","webpack:///./node_modules/ol/PluggableMap.js","webpack:///./node_modules/ol/Map.js","webpack:///./node_modules/ol-ext/interaction/DrawHole.js","webpack:///./node_modules/ol-ext/style/defaultStyle.js","webpack:///./node_modules/ol-ext/interaction/Offset.js","webpack:///./node_modules/ol-ext/util/element.js","webpack:///./node_modules/ol/MapEvent.js","webpack:///./node_modules/ol/ObjectEventType.js","webpack:///./node_modules/ol/ImageTile.js","webpack:///./node_modules/ol/AssertionError.js","webpack:///./node_modules/ol/ImageState.js","webpack:///./node_modules/ol/TileCache.js","webpack:///./node_modules/ol-ext/interaction/Delete.js","webpack:///./node_modules/ol-ext/geom/GeomUtils.js","webpack:///./node_modules/ol/ViewProperty.js","webpack:///./node_modules/ol/View.js","webpack:///./node_modules/ol/TileState.js","webpack:///./node_modules/ol-ext/util/ext.js","webpack:///./node_modules/ol-ext/geom/LineStringSplitAt.js","webpack:///./node_modules/ol-ext/source/Vector.js","webpack:///./node_modules/ol-ext/interaction/UndoRedo.js","webpack:///./node_modules/ol-ext/interaction/DrawRegular.js","webpack:///./node_modules/ol/Disposable.js","webpack:///./node_modules/ol/TileRange.js","webpack:///./node_modules/ol/MapBrowserPointerEvent.js","webpack:///./node_modules/ol/Object.js","webpack:///./node_modules/ol/Collection.js","webpack:///./node_modules/ol-ext/interaction/ModifyFeature.js","webpack:///./node_modules/ol-ext/interaction/Transform.js","webpack:///./node_modules/ol/ImageBase.js","webpack:///./node_modules/ol/ImageCanvas.js"],"names":["ol_interaction_Split","options","call","this","handleEvent","e","type","handleDownEvent","handleMoveEvent","snapDistance_","snapDistance","tolerance_","tolerance","cursor_","cursor","sources_","sources","Array","features","push","filterSplit_","filter","white","blue","width","fill","color","stroke","sketchStyle","image","radius","featureStyle","overlayLayer_","source","useSpatialIndex","name","displayInLayerSwitcher","style","f","_sketch_","prototype","setMap","map","getMap","removeLayer","getClosestFeature","c","g","d","forEach","si","fi","getClosestFeatureToCoordinate","coordinate","getGeometry","splitAt","ci","getClosestPoint","gi","di","getLength","frameState","viewState","resolution","coord","getNearestCoord","getCoordinates","p","getPixelFromCoordinate","pixel","feature","link","pt","coords","p0","dm","Number","MAX_VALUE","i","length","evt","current","self","getSource","clear","split","tosplit","clone","setGeometry","dispatchEvent","original","removeFeature","addFeature","l","originalEvent","linkGeometry","element","getTargetElement","previousCursor_","undefined","SINGLECLICK","CLICK","DBLCLICK","POINTERDRAG","POINTERMOVE","POINTERDOWN","POINTERUP","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","ADD","REMOVE","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","points_","angle_","initialVelocity_","begin","update","x","y","Date","now","end","lastIndex","firstIndex","duration","dx","dy","Math","atan2","sqrt","getDistance","getAngle","Observable","EventTarget","revision_","__proto__","Object","create","constructor","changed","CHANGE","getRevision","on","listener","isArray","len","keys","once","un","ii","unByKey","key","ANIMATING","INTERACTING","Feature","BaseObject","opt_geometryOrProperties","id_","geometryName_","style_","styleFunction_","geometryChangeKey_","handleGeometryChanged_","getSimplifiedGeometry","geometry","properties","setProperties","getProperties","setGeometryName","getGeometryName","getStyle","setStyle","get","getId","getStyleFunction","handleGeometryChange_","set","createStyleFunction","setId","id","obj","styles","getZIndex","MapBrowserEvent","MapEvent","browserEvent","opt_dragging","opt_frameState","getEventPixel","getCoordinateFromPixel","dragging","preventDefault","stopPropagation","POSTRENDER","MOVESTART","MOVEEND","IMAGE","TILE","VECTOR_TILE","VECTOR","Tile","tileCoord","state","opt_options","interimTile","transition_","transition","transitionStarts_","getKey","getInterimTile","tile","getState","LOADED","refreshInterimChain","prev","LOADING","IDLE","getTileCoord","setState","load","getAlpha","time","start","delta","inTransition","endTransition","MapBrowserEventHandler","moveTolerance","map_","clickTimeoutId_","dragging_","dragListenerKeys_","moveTolerance_","down_","getViewport","activePointers_","trackedTouches_","pointerEventHandler_","PointerEventHandler","documentPointerEventHandler_","pointerdownListenerKey_","handlePointerDown_","relayedListenerKey_","relayEvent_","emulateClick_","pointerEvent","newEvent","MapBrowserPointerEvent","MapBrowserEventType","clearTimeout","setTimeout","bind","updateActivePointers_","event","pointerId","handlePointerUp_","propagationStopped","isMouseActionButton_","dispose","button","document","handlePointerMove_","isMoving_","abs","clientX","clientY","disposeInternal","LAYERGROUP","SIZE","TARGET","VIEW","PriorityQueue","TileQueue","tilePriorityFunction","tileChangeCallback","apply","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","enqueue","added","handleTileChange","getTilesLoading","TileState","ERROR","EMPTY","ABORT","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","abortedTiles","getCount","dequeue","PluggableMap","optionsInternal","createOptionsInternal","maxTilesLoading_","maxTilesLoading","loadTilesWhileAnimating_","loadTilesWhileAnimating","loadTilesWhileInteracting_","loadTilesWhileInteracting","pixelRatio_","pixelRatio","animationDelayKey_","animationDelay_","renderFrame_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","createElement","className","position","overflow","height","msTouchAction","touchAction","overlayContainer_","appendChild","overlayContainerStopEvent_","overlayEvents","MOUSEDOWN","TOUCHSTART","MSPOINTERDOWN","MOUSEWHEEL","WHEEL","mapBrowserEventHandler_","handleMapBrowserEvent","keyboardEventTarget_","keyboardEventTarget","keyHandlerKeys_","CONTEXTMENU","handleBrowserEvent","controls","Collection","interactions","overlays_","overlays","overlayIdIndex_","renderer_","createRenderer","handleResize_","focus_","postRenderFunctions_","tileQueue_","getTilePriority","handleTileChange_","skippedFeatureUids_","MapProperty","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","values","control","CollectionEventType","interaction","addOverlayInternal_","overlay","toString","Error","addControl","getControls","addInteraction","getInteractions","addLayer","layer","layers","getLayerGroup","getLayers","addOverlay","getOverlays","removeEventListener","RESIZE","cancelAnimationFrame","setTarget","forEachFeatureAtPixel","callback","hitTolerance","layerFilter","forEachFeatureAtCoordinate","getFeaturesAtPixel","forEachLayerAtPixel","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","viewportPosition","getBoundingClientRect","eventPosition","changedTouches","left","top","getTarget","target","getElementById","pixelToCoordinateTransform","slice","getOverlayById","coordinateToPixelTransform","getRenderer","getSize","getView","getOverlayContainer","getOverlayContainerStopEvent","tileSourceKey","tileCenter","tileResolution","wantedTiles","deltaX","focus","deltaY","log","opt_type","mapBrowserEvent","interactionsArray","getArray","getActive","cont","handlePostRender","tileQueue","isEmpty","hints","viewHints","ViewHint","reprioritize","hasListener","RENDERCOMPLETE","animate","getLoading","dispatchRenderEvent","postRenderFunctions","render","targetElement","KEYDOWN","KEYPRESS","updateSize","window","addEventListener","removeLayerRenderers","handleViewPropertyChanged_","view","setAttribute","ObjectEventType","PROPERTYCHANGE","layerGroup","isRendered","renderSync","requestAnimationFrame","removeControl","remove","removeInteraction","removeOverlay","size","extent","previousFrameState","isDef","getHints","layerStatesArray","getLayerStatesArray","layerStates","center","index","skippedFeatureUids","usedTiles","rotation","renderFrame","moveStart","MapEventType","idle","setLayerGroup","setSize","setView","skipFeature","computedStyle","getComputedStyle","offsetWidth","parseFloat","offsetHeight","unskipFeature","View","loading","Map","renderer","registerLayerRenderers","ol_interaction_DrawHole","_select","setActive","geometryFn","geomFn","geometryFunction","_geometryFn","layers_","indexOf","_features","item","_startDrawing","_finishDrawing","b","getFeatures","removeLastPoint","_feature","getPolygon","_polygon","_current","poly","getType","intersectsCoordinate","_polygonIndex","hole","pi","geom","newGeom","appendLinearRing","appendPolygon","coordinates","pop","lastOKCoord","setCoordinates","concat","ol_style_Style_defaultStyle","defaultEditStyle","edit","fillColor","ol_interaction_Offset","handleDownEvent_","handleDragEvent","handleDragEvent_","handleMoveEvent_","handleUpEvent","handleUpEvent_","features_","duplicate","source_","_style","getFeatureAtPixel_","typeGeom","test","hit","geomType","current_","currentStyle_","ctrlKey","offset","seg","v1","v2","segment","ol_ext_element","tagName","elt","createTextNode","html","parent","attr","trim","Element","innerHTML","addListener","checked","text","eventType","fn","display","el","st","s","styleProp","value","defaultView","ownerDocument","replace","toLowerCase","getPropertyValue","currentStyle","str","letter","toUpperCase","oldLeft","oldRsLeft","runtimeStyle","pixelLeft","parseInt","rect","pageYOffset","documentElement","scrollTop","body","pageXOffset","scrollLeft","bottom","widtth","right","pos","speed","dt","onmove","page","vertical","scroll","moving","querySelectorAll","ondragstart","classList","add","mousewheel","contains","max","min","wheelDelta","detail","eventName","CustomEvent","createEvent","initCustomEvent","Event","ImageTile","src","crossOrigin","tileLoadFunction","crossOrigin_","src_","image_","Image","imageListenerKeys_","tileLoadFunction_","unlistenImage_","getBlankImage","getImage","handleImageError_","handleImageLoad_","naturalWidth","naturalHeight","LOAD","ctx","fillStyle","fillRect","canvas","AssertionError","code","path","message","TileCache","LRUCache","opt_highWaterMark","expireCache","canExpireCache","peekLast","zKey","pruneExceptNewestZ","peekFirstKey","z","ol_interaction_Delete","delete","selected","_getSources","delFeatures","ol_coordinate_dist2d","p1","p2","ol_coordinate_equal","ol_coordinate_offsetCoords","mi","mi1","li","li1","ri","ri1","si1","Xi1","Yi1","N","isClosed","ol_coordinate_findSegment","d0","v0","d1","CENTER","RESOLUTION","ROTATION","DEFAULT_MIN_ZOOM","hints_","animations_","updateAnimationKey_","updateAnimations_","projection_","projection","applyOptions_","ViewProperty","resolutionConstraintInfo","createResolutionConstraint","maxResolution_","maxResolution","minResolution_","minResolution","zoomFactor_","zoomFactor","resolutions_","resolutions","minZoom_","minZoom","centerConstraint","createCenterConstraint","resolutionConstraint","constraint","rotationConstraint","createRotationConstraint","constraints_","zoom","constrainResolution","getResolution","options_","getUpdatedOptions_","newOptions","getZoom","getCenter","getRotation","var_args","arguments$1","arguments","animationCount","setCenter","setZoom","setRotation","animationCallback","series","animation","complete","anchor","easing","sourceCenter","targetCenter","sourceResolution","targetResolution","sourceRotation","PI","targetRotation","isNoopAnimation","setHint","getAnimating","getInteracting","cancelAnimations","more","seriesComplete","j","jj","elapsed","fraction","progress","x0","y0","x1","y1","calculateCenterZoom","calculateCenterRotate","Boolean","currentCenter","currentResolution","getSizeFromViewport_","selector","querySelector","metrics","constrainCenter","opt_delta","opt_direction","direction","constrainRotation","getConstraints","opt_hints","calculateExtent","opt_size","getMaxResolution","getMinResolution","getMaxZoom","getZoomForResolution","setMaxZoom","maxZoom","getMinZoom","setMinZoom","getProjection","getResolutions","getResolutionForExtent","xResolution","yResolution","getResolutionForValueFunction","opt_power","power","pow","getValueForResolutionFunction","pixelResolution","round","nearest","getResolutionForZoom","fit","geometryOrExtent","GeometryType","CIRCLE","getExtent","rotate","padding","getFlatCoordinates","cosAngle","cos","sinAngle","sin","minRotX","Infinity","minRotY","maxRotX","maxRotY","stride","getStride","rotX","rotY","isNaN","constrainedResolution","centerRotX","centerRotY","centerX","centerY","setResolution","centerOn","opt_anchor","hint","returnValue","defaultMaxZoom","defaultZoomFactor","Units","DEGREES","getMetersPerUnit","defaultMaxResolution","defaultMinResolution","floor","enableRotation","ol","ext","ol_ext_inherits","child","inherits","NodeList","parentNode","removeChild","tol","result","r","k","getFirstCoordinate","getLastCoordinate","c0","d2","opt_fast","ol_interaction_UndoRedo","_undoStack","_redoStack","_block","_record","_defs","define","action","undoFn","redoFn","undo","redo","prop","active","_mapListener","blockStart","blockEnd","_watchSources","_watchInteractions","getVectorLayers","init","_sourceListener","vectors","_onAddRemove","_interactionListener","_onInteraction","setattributestart","newp","assign","oldp","newProperties","oldProperties","rotatestart","translatestart","scalestart","modifystart","m","oldFeature","beforesplit","deletestart","aftersplit","deleteend","_handleDo","unset","console","warn","substr","hasUndo","hasRedo","ol_interaction_DrawRegular","squaredClickTolerance_","clickTolerance","maxCircleCoordinates_","maxCircleCoordinates","squareFn_","squareCondition","centeredFn_","centerCondition","canRotate_","canRotate","geometryName","setSides","sides","defaultStyle","sketch_","handleEvent_","reset","started_","nb","sides_","getSides","startAngle","3","4","getGeom_","center_","coord_","dmax","circle","centerPx","square_","centered_","coordPx_","hasrotation","a","scx","scy","sc","sign","t","applyTransform","g1","g2","dim","drawSketch_","shiftKey","metaKey","feature_","drawPoint_","noclear","_eventTime","downPx_","start_","_longTouch","lastEvent","end_","upPx_","finishDrawing","startCoordinate","square","centered","Disposable","disposed_","TileRange","minX","maxX","minY","maxY","createOrUpdate","tileRange","containsXY","containsTileRange","equals","extend","getHeight","getWidth","intersects","ObjectEvent","oldValue","opt_values","values_","hasOwnProperty","getKeys","notify","getChangeEventType","opt_silent","changeEventTypeCache","Property","LENGTH","CollectionEvent","opt_element","opt_array","unique_","unique","array_","assertUnique_","updateLength_","arr","array","insertAt","elem","splice","removeAt","n","setAt","opt_except","ol_interaction_ModifyFeature","modifying","_deleteCondition","pixelTolerance","_condition","condition","deleteCondition","_insertVertexCondition","insertVertexCondition","wrapX","currentFeature","deselected","dist","lstring","getLineStrings","ring","lring","getLinearRings","getPolygons","getGeometries","getArcs","arcs","coord1","coord2","node","shift","c1","nbpt","closed","typeg","error","getFeaturesInExtent","_modifiedFeatures","_removePoint","getModifiedFeatures","removePoint","_getModification","geoms","found","setGeometries","setArcCoordinates","getCurrentFeature","ol_interaction_Transform","selection_","handles_","_filter","_handleEvent","addFn_","addCondition","translateFeature","translate","translateBBox","stretch","scale","keepAspectRatio","modifyCenter","noFlip","selection","enableRotatedTransform","setDefaultStyle","Cursors","oldMap","select","isTouch","setVisible","strokedash","lineDash","fill0","points","getAnchor","bigpt","angle","smallpt","createStyle","img","olstyle","im","setScale","tx","getText","setOffsetX","bbox_","handle","option","some","getGeometryRotateToZero_","origGeom","viewRotation","rotGeom","extendExt","ispt_","iscircle_","addFeatures","watchFeatures_","setSelection","_featureListeners","isUpdating_","sel","mode_","opt_","constraint_","coordinate_","pixel_","geoms_","rotatedGeoms_","rotExtent","extent_","rotatedExtent_","rotate0","pt0","ispt","setCenterAndRadius","getRadius","extentCoordinates","downCoordinate","dragCoordinate","downPoint","dragPoint","centerPoint","default","oldgeom","oldgeoms","ImageBase","EventType","getPixelRatio","ImageCanvas","opt_loader","ImageState","loader_","canvas_","error_","getError","handleLoad_","err"],"mappings":"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","file":"js/chunk-8c4a16ce.b48f41de.js","sourcesContent":["/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\n\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\r\nimport ol_style_Style from 'ol/style/Style'\r\nimport ol_style_Stroke from 'ol/style/Stroke'\r\nimport ol_source_Vector from 'ol/source/Vector'\r\nimport ol_style_Fill from 'ol/style/Fill'\r\nimport ol_style_Circle from 'ol/style/Circle'\r\nimport ol_layer_Vector from 'ol/layer/Vector'\r\nimport ol_geom_Point from 'ol/geom/Point'\r\nimport ol_Feature from 'ol/Feature'\r\nimport ol_geom_LineString from 'ol/geom/LineString'\r\nimport {ol_coordinate_dist2d} from \"../geom/GeomUtils\";\r\nimport '../geom/LineStringSplitAt'\r\n\r\n/** Interaction split interaction for splitting feature geometry\r\n * @constructor\r\n * @extends {ol_interaction_Interaction}\r\n * @fires  beforesplit, aftersplit, pointermove\r\n * @param {*} \r\n *  @param {ol.source.Vector|Array<ol.source.Vector>} options.source a list of source to split (configured with useSpatialIndex set to true)\r\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to split\r\n *  @param {integer} options.snapDistance distance (in px) to snap to an object, default 25px\r\n *\t@param {string|undefined} options.cursor cursor name to display when hovering an objet\r\n *  @param {function|undefined} opttion.filter a filter that takes a feature and return true if it can be clipped, default always split.\r\n *  @param ol_style_Style | Array<ol_style_Style> | false | undefined} options.featureStyle Style for the selected features, choose false if you don't want feature selection. By default the default edit style is used.\r\n *  @param {ol_style_Style | Array<ol_style_Style> | undefined} options.sketchStyle Style for the sektch features. \r\n *  @param {function|undefined} options.tolerance Distance between the calculated intersection and a vertex on the source geometry below which the existing vertex will be used for the split.  Default is 1e-10.\r\n */\r\nvar ol_interaction_Split = function(options) {\r\n  if (!options) options = {};\r\n\r\n  ol_interaction_Interaction.call(this, {\r\n    handleEvent: function(e) {\r\n      switch (e.type) {\r\n        case \"singleclick\":\r\n          return this.handleDownEvent(e);\r\n        case \"pointermove\":\r\n          return this.handleMoveEvent(e);\r\n        default: \r\n          return true;\r\n      }\r\n      //return true;\r\n    }\r\n  });\r\n\r\n  // Snap distance (in px)\r\n  this.snapDistance_ = options.snapDistance || 25;\r\n  // Split tolerance between the calculated intersection and the geometry\r\n  this.tolerance_ = options.tolerance || 1e-10;\r\n  // Cursor\r\n  this.cursor_ = options.cursor;\r\n\r\n  // List of source to split\r\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\r\n\r\n  if (options.features) {\r\n    this.sources_.push (new ol_source_Vector({ features: options.features }));\r\n  }\r\n\r\n  // Get all features candidate\r\n  this.filterSplit_ = options.filter || function(){ return true; };\r\n\r\n  // Default style\r\n  var white = [255, 255, 255, 1];\r\n  var blue = [0, 153, 255, 1];\r\n  var width = 3;\r\n  var fill = new ol_style_Fill({ color: 'rgba(255,255,255,0.4)' });\r\n  var stroke = new ol_style_Stroke({\r\n    color: '#3399CC',\r\n    width: 1.25\r\n  });\r\n  var sketchStyle = [\r\n    new ol_style_Style({\r\n      image: new ol_style_Circle({\r\n        fill: fill,\r\n        stroke: stroke,\r\n        radius: 5\r\n      }),\r\n      fill: fill,\r\n      stroke: stroke\r\n    })\r\n  ];\r\n  var featureStyle = [\r\n    new ol_style_Style({\r\n      stroke: new ol_style_Stroke({\r\n        color: white,\r\n        width: width + 2\r\n      })\r\n    }),\r\n    new ol_style_Style({\r\n      image: new ol_style_Circle({\r\n        radius: 2*width,\r\n        fill: new ol_style_Fill({\r\n          color: blue\r\n        }),\r\n        stroke: new ol_style_Stroke({\r\n          color: white,\r\n          width: width/2\r\n        })\r\n      }),\r\n      stroke: new ol_style_Stroke({\r\n          color: blue,\r\n          width: width\r\n        })\r\n    }),\r\n  ];\r\n\r\n  // Custom style\r\n  if (options.sketchStyle) sketchStyle = options.sketchStyle instanceof Array ? options.sketchStyle : [options.sketchStyle];\r\n  if (options.featureStyle) featureStyle = options.featureStyle instanceof Array ? options.featureStyle : [options.featureStyle];\r\n\r\n  // Create a new overlay for the sketch\r\n  this.overlayLayer_ = new ol_layer_Vector({\r\n    source: new ol_source_Vector({\r\n      useSpatialIndex: false\r\n    }),\r\n    name:'Split overlay',\r\n    displayInLayerSwitcher: false,\r\n    style: function(f) {\r\n      if (f._sketch_) return sketchStyle;\r\n      else return featureStyle;\r\n    }\r\n  });\r\n\r\n};\r\nol_ext_inherits(ol_interaction_Split, ol_interaction_Interaction);\r\n\r\n/**\r\n * Remove the interaction from its current map, if any,  and attach it to a new\r\n * map, if any. Pass `null` to just remove the interaction from the current map.\r\n * @param {ol.Map} map Map.\r\n * @api stable\r\n */\r\nol_interaction_Split.prototype.setMap = function(map) {\r\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\r\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\r\n  this.overlayLayer_.setMap(map);\r\n};\r\n\r\n/** Get closest feature at pixel\r\n * @param {ol.Pixel} \r\n * @return {ol.feature} \r\n * @private\r\n */\r\nol_interaction_Split.prototype.getClosestFeature = function(e) {\r\n  var source, f, c, g, d = this.snapDistance_+1;\r\n  // Look for closest point in the sources\r\n  this.sources_.forEach(function(si) {\r\n    var fi = si.getClosestFeatureToCoordinate(e.coordinate);\r\n    if (fi && fi.getGeometry().splitAt) {\r\n      var ci = fi.getGeometry().getClosestPoint(e.coordinate);\r\n      var gi = new ol_geom_LineString([e.coordinate,ci]);\r\n      var di = gi.getLength() / e.frameState.viewState.resolution;\r\n      if (di < d) {\r\n        source = si;\r\n        d = di;\r\n        f = fi;\r\n        g = gi;\r\n        c = ci;\r\n      }\r\n    }\r\n  });\r\n  // Snap ?\r\n  if (d > this.snapDistance_) {\r\n    return false;\r\n  } else {\r\n    // Snap to node\r\n    var coord = this.getNearestCoord (c, f.getGeometry().getCoordinates());\r\n    var p = this.getMap().getPixelFromCoordinate(coord);\r\n    if (ol_coordinate_dist2d(e.pixel, p) < this.snapDistance_) {\r\n      c = coord;\r\n    }\r\n    //\r\n    return { source:source, feature:f, coord: c, link: g };\r\n  }\r\n}\r\n\r\n/** Get nearest coordinate in a list \r\n* @param {ol.coordinate} pt the point to find nearest\r\n* @param {Array<ol.coordinate>} coords list of coordinates\r\n* @return {ol.coordinate} the nearest coordinate in the list\r\n*/\r\nol_interaction_Split.prototype.getNearestCoord = function(pt, coords) {\r\n  var d, dm=Number.MAX_VALUE, p0;\r\n  for (var i=0; i < coords.length; i++) {\r\n    d = ol_coordinate_dist2d (pt, coords[i]);\r\n    if (d < dm) {\r\n      dm = d;\r\n      p0 = coords[i];\r\n    }\r\n  }\r\n  return p0;\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @return {boolean} `true` to start the drag sequence.\r\n */\r\nol_interaction_Split.prototype.handleDownEvent = function(evt) {\r\n  // Something to split ?\r\n  var current = this.getClosestFeature(evt);\r\n\r\n  if (current) {\r\n    var self = this;\r\n    self.overlayLayer_.getSource().clear();\r\n    var split = current.feature.getGeometry().splitAt(current.coord, this.tolerance_);\r\n    var i;\r\n    if (split.length > 1) {\r\n      var tosplit = [];\r\n      for (i=0; i<split.length; i++) {\r\n        var f = current.feature.clone();\r\n        f.setGeometry(split[i]);\r\n        tosplit.push(f);\r\n      }\r\n      self.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\r\n      current.source.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\r\n      current.source.removeFeature(current.feature);\r\n      for (i=0; i<tosplit.length; i++) {\r\n        current.source.addFeature(tosplit[i]);\r\n      }\r\n      self.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\r\n      current.source.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Event.\r\n */\r\nol_interaction_Split.prototype.handleMoveEvent = function(e) {\r\n  var map = e.map;\r\n  this.overlayLayer_.getSource().clear();\r\n  var current = this.getClosestFeature(e);\r\n\r\n  if (current && this.filterSplit_(current.feature)) {\r\n    var p, l;\r\n    // Draw sketch\r\n    this.overlayLayer_.getSource().addFeature(current.feature);\r\n    p = new ol_Feature(new ol_geom_Point(current.coord));\r\n    p._sketch_ = true;\r\n    this.overlayLayer_.getSource().addFeature(p);\r\n    //\r\n    l = new ol_Feature(current.link);\r\n    l._sketch_ = true;\r\n    this.overlayLayer_.getSource().addFeature(l);\r\n    // move event\r\n    this.dispatchEvent({\r\n      type: 'pointermove',\r\n      coordinate: e.coordinate,\r\n      frameState: e.frameState,\r\n      originalEvent: e.originalEvent,\r\n      map: e.map,\r\n      pixel: e.pixel,\r\n      feature: current.feature,\r\n      linkGeometry: current.link\r\n    });\r\n  } else {\r\n    this.dispatchEvent(e);\r\n  }\r\n\r\n  var element = map.getTargetElement();\r\n  if (this.cursor_) {\r\n    if (current) {\r\n      if (element.style.cursor != this.cursor_) {\r\n        this.previousCursor_ = element.style.cursor;\r\n        element.style.cursor = this.cursor_;\r\n      }\r\n    } else if (this.previousCursor_ !== undefined) {\r\n      element.style.cursor = this.previousCursor_;\r\n      this.previousCursor_ = undefined;\r\n    }\r\n  }\r\n};\r\n\r\nexport default ol_interaction_Split\r\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n\n//# sourceMappingURL=MapBrowserEventType.js.map","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection.CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection.CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove'\n};\n\n//# sourceMappingURL=CollectionEventType.js.map","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @api\n */\nvar Kinetic = function Kinetic(decay, minVelocity, delay) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.decay_ = decay;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minVelocity_ = minVelocity;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delay_ = delay;\n\n  /**\n   * @private\n   * @type {Array<number>}\n   */\n  this.points_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.initialVelocity_ = 0;\n};\n\n/**\n * FIXME empty description for jsdoc\n */\nKinetic.prototype.begin = function begin () {\n  this.points_.length = 0;\n  this.angle_ = 0;\n  this.initialVelocity_ = 0;\n};\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n */\nKinetic.prototype.update = function update (x, y) {\n  this.points_.push(x, y, Date.now());\n};\n\n/**\n * @return {boolean} Whether we should do kinetic animation.\n */\nKinetic.prototype.end = function end () {\n  if (this.points_.length < 6) {\n    // at least 2 points are required (i.e. there must be at least 6 elements\n    // in the array)\n    return false;\n  }\n  var delay = Date.now() - this.delay_;\n  var lastIndex = this.points_.length - 3;\n  if (this.points_[lastIndex + 2] < delay) {\n    // the last tracked point is too old, which means that the user stopped\n    // panning before releasing the map\n    return false;\n  }\n\n  // get the first point which still falls into the delay time\n  var firstIndex = lastIndex - 3;\n  while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n    firstIndex -= 3;\n  }\n\n  var duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n  // we don't want a duration of 0 (divide by zero)\n  // we also make sure the user panned for a duration of at least one frame\n  // (1/60s) to compute sane displacement values\n  if (duration < 1000 / 60) {\n    return false;\n  }\n\n  var dx = this.points_[lastIndex] - this.points_[firstIndex];\n  var dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n  this.angle_ = Math.atan2(dy, dx);\n  this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n  return this.initialVelocity_ > this.minVelocity_;\n};\n\n/**\n * @return {number} Total distance travelled (pixels).\n */\nKinetic.prototype.getDistance = function getDistance () {\n  return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n};\n\n/**\n * @return {number} Angle of the kinetic panning animation (radians).\n */\nKinetic.prototype.getAngle = function getAngle () {\n  return this.angle_;\n};\n\nexport default Kinetic;\n\n//# sourceMappingURL=Kinetic.js.map","/**\n * @module ol/Observable\n */\nimport {listen, unlistenByKey, unlisten, listenOnce} from './events.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @fires import(\"./events/Event.js\").Event\n * @api\n */\nvar Observable = /*@__PURE__*/(function (EventTarget) {\n  function Observable() {\n\n    EventTarget.call(this);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.revision_ = 0;\n\n  }\n\n  if ( EventTarget ) Observable.__proto__ = EventTarget;\n  Observable.prototype = Object.create( EventTarget && EventTarget.prototype );\n  Observable.prototype.constructor = Observable;\n\n  /**\n   * Increases the revision counter and dispatches a 'change' event.\n   * @api\n   */\n  Observable.prototype.changed = function changed () {\n    ++this.revision_;\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * Get the version number for this object.  Each time the object is modified,\n   * its version number will be incremented.\n   * @return {number} Revision.\n   * @api\n   */\n  Observable.prototype.getRevision = function getRevision () {\n    return this.revision_;\n  };\n\n  /**\n   * Listen for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  Observable.prototype.on = function on (type, listener) {\n    if (Array.isArray(type)) {\n      var len = type.length;\n      var keys = new Array(len);\n      for (var i = 0; i < len; ++i) {\n        keys[i] = listen(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listen(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  /**\n   * Listen once for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  Observable.prototype.once = function once (type, listener) {\n    if (Array.isArray(type)) {\n      var len = type.length;\n      var keys = new Array(len);\n      for (var i = 0; i < len; ++i) {\n        keys[i] = listenOnce(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listenOnce(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  /**\n   * Unlisten for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @api\n   */\n  Observable.prototype.un = function un (type, listener) {\n    if (Array.isArray(type)) {\n      for (var i = 0, ii = type.length; i < ii; ++i) {\n        unlisten(this, type[i], listener);\n      }\n      return;\n    } else {\n      unlisten(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  return Observable;\n}(EventTarget));\n\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (var i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {import(\"./events.js\").EventsKey} */ (key));\n  }\n}\n\n\nexport default Observable;\n\n//# sourceMappingURL=Observable.js.map","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1\n};\n\n//# sourceMappingURL=ViewHint.js.map","/**\n * @module ol/Feature\n */\nimport {assert} from './asserts.js';\nimport {listen, unlisten, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\n\n/**\n * @typedef {typeof Feature|typeof import(\"./render/Feature.js\").default} FeatureClass\n */\n\n/**\n * @typedef {Feature|import(\"./render/Feature.js\").default} FeatureLike\n */\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature';\n * import Polygon from 'ol/geom/Polygon';\n * import Point from 'ol/geom/Point';\n *\n * var feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon'\n * });\n *\n * // get the polygon geometry\n * var poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * var point = feature.getGeometry();\n * ```\n *\n * @api\n */\nvar Feature = /*@__PURE__*/(function (BaseObject) {\n  function Feature(opt_geometryOrProperties) {\n\n    BaseObject.call(this);\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = undefined;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.geometryName_ = 'geometry';\n\n    /**\n     * User provided style.\n     * @private\n     * @type {import(\"./style/Style.js\").StyleLike}\n     */\n    this.style_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./style/Style.js\").StyleFunction|undefined}\n     */\n    this.styleFunction_ = undefined;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.geometryChangeKey_ = null;\n\n    listen(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n\n    if (opt_geometryOrProperties) {\n      if (typeof /** @type {?} */ (opt_geometryOrProperties).getSimplifiedGeometry === 'function') {\n        var geometry = /** @type {import(\"./geom/Geometry.js\").default} */ (opt_geometryOrProperties);\n        this.setGeometry(geometry);\n      } else {\n        /** @type {Object<string, *>} */\n        var properties = opt_geometryOrProperties;\n        this.setProperties(properties);\n      }\n    }\n  }\n\n  if ( BaseObject ) Feature.__proto__ = BaseObject;\n  Feature.prototype = Object.create( BaseObject && BaseObject.prototype );\n  Feature.prototype.constructor = Feature;\n\n  /**\n   * Clone this feature. If the original feature has a geometry it\n   * is also cloned. The feature id is not set in the clone.\n   * @return {Feature} The clone.\n   * @api\n   */\n  Feature.prototype.clone = function clone () {\n    var clone = new Feature(this.getProperties());\n    clone.setGeometryName(this.getGeometryName());\n    var geometry = this.getGeometry();\n    if (geometry) {\n      clone.setGeometry(geometry.clone());\n    }\n    var style = this.getStyle();\n    if (style) {\n      clone.setStyle(style);\n    }\n    return clone;\n  };\n\n  /**\n   * Get the feature's default geometry.  A feature may have any number of named\n   * geometries.  The \"default\" geometry (the one that is rendered by default) is\n   * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n   * @return {import(\"./geom/Geometry.js\").default|undefined} The default geometry for the feature.\n   * @api\n   * @observable\n   */\n  Feature.prototype.getGeometry = function getGeometry () {\n    return (\n      /** @type {import(\"./geom/Geometry.js\").default|undefined} */ (this.get(this.geometryName_))\n    );\n  };\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is either set when reading data from a remote source or set explicitly by\n   * calling {@link module:ol/Feature~Feature#setId}.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  Feature.prototype.getId = function getId () {\n    return this.id_;\n  };\n\n  /**\n   * Get the name of the feature's default geometry.  By default, the default\n   * geometry is named `geometry`.\n   * @return {string} Get the property name associated with the default geometry\n   *     for this feature.\n   * @api\n   */\n  Feature.prototype.getGeometryName = function getGeometryName () {\n    return this.geometryName_;\n  };\n\n  /**\n   * Get the feature's style. Will return what was provided to the\n   * {@link module:ol/Feature~Feature#setStyle} method.\n   * @return {import(\"./style/Style.js\").StyleLike} The feature style.\n   * @api\n   */\n  Feature.prototype.getStyle = function getStyle () {\n    return this.style_;\n  };\n\n  /**\n   * Get the feature's style function.\n   * @return {import(\"./style/Style.js\").StyleFunction|undefined} Return a function\n   * representing the current style of this feature.\n   * @api\n   */\n  Feature.prototype.getStyleFunction = function getStyleFunction () {\n    return this.styleFunction_;\n  };\n\n  /**\n   * @private\n   */\n  Feature.prototype.handleGeometryChange_ = function handleGeometryChange_ () {\n    this.changed();\n  };\n\n  /**\n   * @private\n   */\n  Feature.prototype.handleGeometryChanged_ = function handleGeometryChanged_ () {\n    if (this.geometryChangeKey_) {\n      unlistenByKey(this.geometryChangeKey_);\n      this.geometryChangeKey_ = null;\n    }\n    var geometry = this.getGeometry();\n    if (geometry) {\n      this.geometryChangeKey_ = listen(geometry,\n        EventType.CHANGE, this.handleGeometryChange_, this);\n    }\n    this.changed();\n  };\n\n  /**\n   * Set the default geometry for the feature.  This will update the property\n   * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n   * @param {import(\"./geom/Geometry.js\").default|undefined} geometry The new geometry.\n   * @api\n   * @observable\n   */\n  Feature.prototype.setGeometry = function setGeometry (geometry) {\n    this.set(this.geometryName_, geometry);\n  };\n\n  /**\n   * Set the style for the feature.  This can be a single style object, an array\n   * of styles, or a function that takes a resolution and returns an array of\n   * styles. If it is `null` the feature has no style (a `null` style).\n   * @param {import(\"./style/Style.js\").StyleLike} style Style for this feature.\n   * @api\n   * @fires module:ol/events/Event~Event#event:change\n   */\n  Feature.prototype.setStyle = function setStyle (style) {\n    this.style_ = style;\n    this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n    this.changed();\n  };\n\n  /**\n   * Set the feature id.  The feature id is considered stable and may be used when\n   * requesting features or comparing identifiers returned from a remote source.\n   * The feature id can be used with the\n   * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n   * @param {number|string|undefined} id The feature id.\n   * @api\n   * @fires module:ol/events/Event~Event#event:change\n   */\n  Feature.prototype.setId = function setId (id) {\n    this.id_ = id;\n    this.changed();\n  };\n\n  /**\n   * Set the property name to be used when getting the feature's default geometry.\n   * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n   * this name will be returned.\n   * @param {string} name The property name of the default geometry.\n   * @api\n   */\n  Feature.prototype.setGeometryName = function setGeometryName (name) {\n    unlisten(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n    this.geometryName_ = name;\n    listen(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n    this.handleGeometryChanged_();\n  };\n\n  return Feature;\n}(BaseObject));\n\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of Style or single style objects wrapped\n * in a new feature style function.\n * @param {!import(\"./style/Style.js\").StyleFunction|!Array<import(\"./style/Style.js\").default>|!import(\"./style/Style.js\").default} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {import(\"./style/Style.js\").StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  } else {\n    /**\n     * @type {Array<import(\"./style/Style.js\").default>}\n     */\n    var styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(typeof /** @type {?} */ (obj).getZIndex === 'function',\n        41); // Expected an `import(\"./style/Style.js\").Style` or an array of `import(\"./style/Style.js\").Style`\n      var style = /** @type {import(\"./style/Style.js\").default} */ (obj);\n      styles = [style];\n    }\n    return function() {\n      return styles;\n    };\n  }\n}\nexport default Feature;\n\n//# sourceMappingURL=Feature.js.map","/**\n * @module ol/MapBrowserEvent\n */\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map browser event.\n */\nvar MapBrowserEvent = /*@__PURE__*/(function (MapEvent) {\n  function MapBrowserEvent(type, map, browserEvent, opt_dragging, opt_frameState) {\n\n    MapEvent.call(this, type, map, opt_frameState);\n\n    /**\n     * The original browser event.\n     * @const\n     * @type {Event}\n     * @api\n     */\n    this.originalEvent = browserEvent;\n\n    /**\n     * The map pixel relative to the viewport corresponding to the original browser event.\n     * @type {import(\"./pixel.js\").Pixel}\n     * @api\n     */\n    this.pixel = map.getEventPixel(browserEvent);\n\n    /**\n     * The coordinate in view projection corresponding to the original browser event.\n     * @type {import(\"./coordinate.js\").Coordinate}\n     * @api\n     */\n    this.coordinate = map.getCoordinateFromPixel(this.pixel);\n\n    /**\n     * Indicates if the map is currently being dragged. Only set for\n     * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n     *\n     * @type {boolean}\n     * @api\n     */\n    this.dragging = opt_dragging !== undefined ? opt_dragging : false;\n\n  }\n\n  if ( MapEvent ) MapBrowserEvent.__proto__ = MapEvent;\n  MapBrowserEvent.prototype = Object.create( MapEvent && MapEvent.prototype );\n  MapBrowserEvent.prototype.constructor = MapBrowserEvent;\n\n  /**\n   * Prevents the default browser action.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault.\n   * @override\n   * @api\n   */\n  MapBrowserEvent.prototype.preventDefault = function preventDefault () {\n    MapEvent.prototype.preventDefault.call(this);\n    this.originalEvent.preventDefault();\n  };\n\n  /**\n   * Prevents further propagation of the current event.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation.\n   * @override\n   * @api\n   */\n  MapBrowserEvent.prototype.stopPropagation = function stopPropagation () {\n    MapEvent.prototype.stopPropagation.call(this);\n    this.originalEvent.stopPropagation();\n  };\n\n  return MapBrowserEvent;\n}(MapEvent));\n\n\nexport default MapBrowserEvent;\n\n//# sourceMappingURL=MapBrowserEvent.js.map","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend'\n\n};\n\n//# sourceMappingURL=MapEventType.js.map","/**\n * @module ol/LayerType\n */\n\n/**\n * A layer type used when creating layer renderers.\n * @enum {string}\n */\nexport default {\n  IMAGE: 'IMAGE',\n  TILE: 'TILE',\n  VECTOR_TILE: 'VECTOR_TILE',\n  VECTOR: 'VECTOR'\n};\n\n//# sourceMappingURL=LayerType.js.map","/**\n * @module ol/Tile\n */\nimport TileState from './TileState.js';\nimport {easeIn} from './easing.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n\n/**\n * A function that takes an {@link module:ol/Tile} for the tile and a\n * `{string}` for the url as arguments. The default is\n * ```js\n * source.setTileLoadFunction(function(tile, src) {\n *   tile.getImage().src = src;\n * });\n * ```\n * For more fine grained control, the load function can use fetch or XMLHttpRequest and involve\n * error handling:\n *\n * ```js\n * import TileState from 'ol/TileState';\n *\n * source.setTileLoadFunction(function(tile, src) {\n *   var xhr = new XMLHttpRequest();\n *   xhr.responseType = 'blob';\n *   xhr.addEventListener('loadend', function (evt) {\n *     var data = this.response;\n *     if (data !== undefined) {\n *       tile.getImage().src = URL.createObjectURL(data);\n *     } else {\n *       tile.setState(TileState.ERROR);\n *     }\n *   });\n *   xhr.addEventListener('error', function () {\n *     tile.setState(TileState.ERROR);\n *   });\n *   xhr.open('GET', src);\n *   xhr.send();\n * });\n * ```\n *\n * @typedef {function(Tile, string)} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~Tile} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(import(\"./tilecoord.js\").TileCoord, number,\n *           import(\"./proj/Projection.js\").default): (string|undefined)} UrlFunction\n * @api\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @api\n */\n\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @abstract\n */\nvar Tile = /*@__PURE__*/(function (EventTarget) {\n  function Tile(tileCoord, state, opt_options) {\n    EventTarget.call(this);\n\n    var options = opt_options ? opt_options : {};\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.tileCoord = tileCoord;\n\n    /**\n     * @protected\n     * @type {TileState}\n     */\n    this.state = state;\n\n    /**\n     * An \"interim\" tile for this tile. The interim tile may be used while this\n     * one is loading, for \"smooth\" transitions when changing params/dimensions\n     * on the source.\n     * @type {Tile}\n     */\n    this.interimTile = null;\n\n    /**\n     * A key assigned to the tile. This is used by the tile source to determine\n     * if this tile can effectively be used, or if a new tile should be created\n     * and this one be used as an interim tile for this new tile.\n     * @type {string}\n     */\n    this.key = '';\n\n    /**\n     * The duration for the opacity transition.\n     * @type {number}\n     */\n    this.transition_ = options.transition === undefined ? 250 : options.transition;\n\n    /**\n     * Lookup of start times for rendering transitions.  If the start time is\n     * equal to -1, the transition is complete.\n     * @type {Object<string, number>}\n     */\n    this.transitionStarts_ = {};\n\n  }\n\n  if ( EventTarget ) Tile.__proto__ = EventTarget;\n  Tile.prototype = Object.create( EventTarget && EventTarget.prototype );\n  Tile.prototype.constructor = Tile;\n\n  /**\n   * @protected\n   */\n  Tile.prototype.changed = function changed () {\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * @return {string} Key.\n   */\n  Tile.prototype.getKey = function getKey () {\n    return this.key + '/' + this.tileCoord;\n  };\n\n  /**\n   * Get the interim tile most suitable for rendering using the chain of interim\n   * tiles. This corresponds to the  most recent tile that has been loaded, if no\n   * such tile exists, the original tile is returned.\n   * @return {!Tile} Best tile for rendering.\n   */\n  Tile.prototype.getInterimTile = function getInterimTile () {\n    if (!this.interimTile) {\n      //empty chain\n      return this;\n    }\n    var tile = this.interimTile;\n\n    // find the first loaded tile and return it. Since the chain is sorted in\n    // decreasing order of creation time, there is no need to search the remainder\n    // of the list (all those tiles correspond to older requests and will be\n    // cleaned up by refreshInterimChain)\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        return tile;\n      }\n      tile = tile.interimTile;\n    } while (tile);\n\n    // we can not find a better tile\n    return this;\n  };\n\n  /**\n   * Goes through the chain of interim tiles and discards sections of the chain\n   * that are no longer relevant.\n   */\n  Tile.prototype.refreshInterimChain = function refreshInterimChain () {\n    if (!this.interimTile) {\n      return;\n    }\n\n    var tile = this.interimTile;\n    var prev = /** @type {Tile} */ (this);\n\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        //we have a loaded tile, we can discard the rest of the list\n        //we would could abort any LOADING tile request\n        //older than this tile (i.e. any LOADING tile following this entry in the chain)\n        tile.interimTile = null;\n        break;\n      } else if (tile.getState() == TileState.LOADING) {\n        //keep this LOADING tile any loaded tiles later in the chain are\n        //older than this tile, so we're still interested in the request\n        prev = tile;\n      } else if (tile.getState() == TileState.IDLE) {\n        //the head of the list is the most current tile, we don't need\n        //to start any other requests for this chain\n        prev.interimTile = tile.interimTile;\n      } else {\n        prev = tile;\n      }\n      tile = prev.interimTile;\n    } while (tile);\n  };\n\n  /**\n   * Get the tile coordinate for this tile.\n   * @return {import(\"./tilecoord.js\").TileCoord} The tile coordinate.\n   * @api\n   */\n  Tile.prototype.getTileCoord = function getTileCoord () {\n    return this.tileCoord;\n  };\n\n  /**\n   * @return {TileState} State.\n   */\n  Tile.prototype.getState = function getState () {\n    return this.state;\n  };\n\n  /**\n   * Sets the state of this tile. If you write your own {@link module:ol/Tile~LoadFunction tileLoadFunction} ,\n   * it is important to set the state correctly to {@link module:ol/TileState~ERROR}\n   * when the tile cannot be loaded. Otherwise the tile cannot be removed from\n   * the tile queue and will block other requests.\n   * @param {TileState} state State.\n   * @api\n   */\n  Tile.prototype.setState = function setState (state) {\n    this.state = state;\n    this.changed();\n  };\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @abstract\n   * @api\n   */\n  Tile.prototype.load = function load () {};\n\n  /**\n   * Get the alpha value for rendering.\n   * @param {string} id An id for the renderer.\n   * @param {number} time The render frame time.\n   * @return {number} A number between 0 and 1.\n   */\n  Tile.prototype.getAlpha = function getAlpha (id, time) {\n    if (!this.transition_) {\n      return 1;\n    }\n\n    var start = this.transitionStarts_[id];\n    if (!start) {\n      start = time;\n      this.transitionStarts_[id] = start;\n    } else if (start === -1) {\n      return 1;\n    }\n\n    var delta = time - start + (1000 / 60); // avoid rendering at 0\n    if (delta >= this.transition_) {\n      return 1;\n    }\n    return easeIn(delta / this.transition_);\n  };\n\n  /**\n   * Determine if a tile is in an alpha transition.  A tile is considered in\n   * transition if tile.getAlpha() has not yet been called or has been called\n   * and returned 1.\n   * @param {string} id An id for the renderer.\n   * @return {boolean} The tile is in transition.\n   */\n  Tile.prototype.inTransition = function inTransition (id) {\n    if (!this.transition_) {\n      return false;\n    }\n    return this.transitionStarts_[id] !== -1;\n  };\n\n  /**\n   * Mark a transition as complete.\n   * @param {string} id An id for the renderer.\n   */\n  Tile.prototype.endTransition = function endTransition (id) {\n    if (this.transition_) {\n      this.transitionStarts_[id] = -1;\n    }\n  };\n\n  return Tile;\n}(EventTarget));\n\n\nexport default Tile;\n\n//# sourceMappingURL=Tile.js.map","/**\n * @module ol/MapBrowserEventHandler\n */\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapBrowserPointerEvent from './MapBrowserPointerEvent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventTarget from './events/Target.js';\nimport PointerEventType from './pointer/EventType.js';\nimport PointerEventHandler from './pointer/PointerEventHandler.js';\n\nvar MapBrowserEventHandler = /*@__PURE__*/(function (EventTarget) {\n  function MapBrowserEventHandler(map, moveTolerance) {\n\n    EventTarget.call(this);\n\n    /**\n     * This is the element that we will listen to the real events on.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {any}\n     * @private\n     */\n    this.clickTimeoutId_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dragging_ = false;\n\n    /**\n     * @type {!Array<import(\"./events.js\").EventsKey>}\n     * @private\n     */\n    this.dragListenerKeys_ = [];\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.moveTolerance_ = moveTolerance ?\n      moveTolerance * DEVICE_PIXEL_RATIO : DEVICE_PIXEL_RATIO;\n\n    /**\n     * The most recent \"down\" type event (or null if none have occurred).\n     * Set on pointerdown.\n     * @type {import(\"./pointer/PointerEvent.js\").default}\n     * @private\n     */\n    this.down_ = null;\n\n    var element = this.map_.getViewport();\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.activePointers_ = 0;\n\n    /**\n     * @type {!Object<number, boolean>}\n     * @private\n     */\n    this.trackedTouches_ = {};\n\n    /**\n     * Event handler which generates pointer events for\n     * the viewport element.\n     *\n     * @type {PointerEventHandler}\n     * @private\n     */\n    this.pointerEventHandler_ = new PointerEventHandler(element);\n\n    /**\n     * Event handler which generates pointer events for\n     * the document (used when dragging).\n     *\n     * @type {PointerEventHandler}\n     * @private\n     */\n    this.documentPointerEventHandler_ = null;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.pointerdownListenerKey_ = listen(this.pointerEventHandler_,\n      PointerEventType.POINTERDOWN,\n      this.handlePointerDown_, this);\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.relayedListenerKey_ = listen(this.pointerEventHandler_,\n      PointerEventType.POINTERMOVE,\n      this.relayEvent_, this);\n\n  }\n\n  if ( EventTarget ) MapBrowserEventHandler.__proto__ = EventTarget;\n  MapBrowserEventHandler.prototype = Object.create( EventTarget && EventTarget.prototype );\n  MapBrowserEventHandler.prototype.constructor = MapBrowserEventHandler;\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.emulateClick_ = function emulateClick_ (pointerEvent) {\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.CLICK, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n    if (this.clickTimeoutId_ !== undefined) {\n      // double-click\n      clearTimeout(this.clickTimeoutId_);\n      this.clickTimeoutId_ = undefined;\n      newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.DBLCLICK, this.map_, pointerEvent);\n      this.dispatchEvent(newEvent);\n    } else {\n      // click\n      this.clickTimeoutId_ = setTimeout(function() {\n        this.clickTimeoutId_ = undefined;\n        var newEvent = new MapBrowserPointerEvent(\n          MapBrowserEventType.SINGLECLICK, this.map_, pointerEvent);\n        this.dispatchEvent(newEvent);\n      }.bind(this), 250);\n    }\n  };\n\n  /**\n   * Keeps track on how many pointers are currently active.\n   *\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.updateActivePointers_ = function updateActivePointers_ (pointerEvent) {\n    var event = pointerEvent;\n\n    if (event.type == MapBrowserEventType.POINTERUP ||\n        event.type == MapBrowserEventType.POINTERCANCEL) {\n      delete this.trackedTouches_[event.pointerId];\n    } else if (event.type == MapBrowserEventType.POINTERDOWN) {\n      this.trackedTouches_[event.pointerId] = true;\n    }\n    this.activePointers_ = Object.keys(this.trackedTouches_).length;\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerUp_ = function handlePointerUp_ (pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERUP, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    // We emulate click events on left mouse button click, touch contact, and pen\n    // contact. isMouseActionButton returns true in these cases (evt.button is set\n    // to 0).\n    // See http://www.w3.org/TR/pointerevents/#button-states\n    // We only fire click, singleclick, and doubleclick if nobody has called\n    // event.stopPropagation() or event.preventDefault().\n    if (!newEvent.propagationStopped && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {\n      this.emulateClick_(this.down_);\n    }\n\n    if (this.activePointers_ === 0) {\n      this.dragListenerKeys_.forEach(unlistenByKey);\n      this.dragListenerKeys_.length = 0;\n      this.dragging_ = false;\n      this.down_ = null;\n      this.documentPointerEventHandler_.dispose();\n      this.documentPointerEventHandler_ = null;\n    }\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @return {boolean} If the left mouse button was pressed.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.isMouseActionButton_ = function isMouseActionButton_ (pointerEvent) {\n    return pointerEvent.button === 0;\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerDown_ = function handlePointerDown_ (pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERDOWN, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    this.down_ = pointerEvent;\n\n    if (this.dragListenerKeys_.length === 0) {\n      /* Set up a pointer event handler on the `document`,\n       * which is required when the pointer is moved outside\n       * the viewport when dragging.\n       */\n      this.documentPointerEventHandler_ =\n          new PointerEventHandler(document);\n\n      this.dragListenerKeys_.push(\n        listen(this.documentPointerEventHandler_,\n          MapBrowserEventType.POINTERMOVE,\n          this.handlePointerMove_, this),\n        listen(this.documentPointerEventHandler_,\n          MapBrowserEventType.POINTERUP,\n          this.handlePointerUp_, this),\n        /* Note that the listener for `pointercancel is set up on\n         * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n         * the `pointerup` and `pointermove` listeners.\n         *\n         * The reason for this is the following: `TouchSource.vacuumTouches_()`\n         * issues `pointercancel` events, when there was no `touchend` for a\n         * `touchstart`. Now, let's say a first `touchstart` is registered on\n         * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n         * But `documentPointerEventHandler_` doesn't know about the first\n         * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n         * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n         * only registered there.\n         */\n        listen(this.pointerEventHandler_,\n          MapBrowserEventType.POINTERCANCEL,\n          this.handlePointerUp_, this)\n      );\n    }\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerMove_ = function handlePointerMove_ (pointerEvent) {\n    // Between pointerdown and pointerup, pointermove events are triggered.\n    // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n    // moved a significant distance.\n    if (this.isMoving_(pointerEvent)) {\n      this.dragging_ = true;\n      var newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.POINTERDRAG, this.map_, pointerEvent,\n        this.dragging_);\n      this.dispatchEvent(newEvent);\n    }\n\n    // Some native android browser triggers mousemove events during small period\n    // of time. See: https://code.google.com/p/android/issues/detail?id=5491 or\n    // https://code.google.com/p/android/issues/detail?id=19827\n    // ex: Galaxy Tab P3110 + Android 4.1.1\n    pointerEvent.preventDefault();\n  };\n\n  /**\n   * Wrap and relay a pointer event.  Note that this requires that the type\n   * string for the MapBrowserPointerEvent matches the PointerEvent type.\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.relayEvent_ = function relayEvent_ (pointerEvent) {\n    var dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n    this.dispatchEvent(new MapBrowserPointerEvent(\n      pointerEvent.type, this.map_, pointerEvent, dragging));\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @return {boolean} Is moving.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.isMoving_ = function isMoving_ (pointerEvent) {\n    return this.dragging_ ||\n        Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ ||\n        Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  MapBrowserEventHandler.prototype.disposeInternal = function disposeInternal () {\n    if (this.relayedListenerKey_) {\n      unlistenByKey(this.relayedListenerKey_);\n      this.relayedListenerKey_ = null;\n    }\n    if (this.pointerdownListenerKey_) {\n      unlistenByKey(this.pointerdownListenerKey_);\n      this.pointerdownListenerKey_ = null;\n    }\n\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n\n    if (this.documentPointerEventHandler_) {\n      this.documentPointerEventHandler_.dispose();\n      this.documentPointerEventHandler_ = null;\n    }\n    if (this.pointerEventHandler_) {\n      this.pointerEventHandler_.dispose();\n      this.pointerEventHandler_ = null;\n    }\n    EventTarget.prototype.disposeInternal.call(this);\n  };\n\n  return MapBrowserEventHandler;\n}(EventTarget));\n\n\nexport default MapBrowserEventHandler;\n\n//# sourceMappingURL=MapBrowserEventHandler.js.map","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view'\n};\n\n//# sourceMappingURL=MapProperty.js.map","/**\n * @module ol/TileQueue\n */\nimport TileState from './TileState.js';\nimport {listen, unlisten} from './events.js';\nimport EventType from './events/EventType.js';\nimport PriorityQueue from './structs/PriorityQueue.js';\n\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\n\n\nvar TileQueue = /*@__PURE__*/(function (PriorityQueue) {\n  function TileQueue(tilePriorityFunction, tileChangeCallback) {\n\n    PriorityQueue.call(\n      /**\n       * @param {Array} element Element.\n       * @return {number} Priority.\n       */\n      this, function(element) {\n        return tilePriorityFunction.apply(null, element);\n      },\n      /**\n       * @param {Array} element Element.\n       * @return {string} Key.\n       */\n      function(element) {\n        return (/** @type {import(\"./Tile.js\").default} */ (element[0]).getKey());\n      });\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    this.tilesLoadingKeys_ = {};\n\n  }\n\n  if ( PriorityQueue ) TileQueue.__proto__ = PriorityQueue;\n  TileQueue.prototype = Object.create( PriorityQueue && PriorityQueue.prototype );\n  TileQueue.prototype.constructor = TileQueue;\n\n  /**\n   * @inheritDoc\n   */\n  TileQueue.prototype.enqueue = function enqueue (element) {\n    var added = PriorityQueue.prototype.enqueue.call(this, element);\n    if (added) {\n      var tile = element[0];\n      listen(tile, EventType.CHANGE, this.handleTileChange, this);\n    }\n    return added;\n  };\n\n  /**\n   * @return {number} Number of tiles loading.\n   */\n  TileQueue.prototype.getTilesLoading = function getTilesLoading () {\n    return this.tilesLoading_;\n  };\n\n  /**\n   * @param {import(\"./events/Event.js\").default} event Event.\n   * @protected\n   */\n  TileQueue.prototype.handleTileChange = function handleTileChange (event) {\n    var tile = /** @type {import(\"./Tile.js\").default} */ (event.target);\n    var state = tile.getState();\n    if (state === TileState.LOADED || state === TileState.ERROR ||\n        state === TileState.EMPTY || state === TileState.ABORT) {\n      unlisten(tile, EventType.CHANGE, this.handleTileChange, this);\n      var tileKey = tile.getKey();\n      if (tileKey in this.tilesLoadingKeys_) {\n        delete this.tilesLoadingKeys_[tileKey];\n        --this.tilesLoading_;\n      }\n      this.tileChangeCallback_();\n    }\n  };\n\n  /**\n   * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n   * @param {number} maxNewLoads Maximum number of new tiles to load.\n   */\n  TileQueue.prototype.loadMoreTiles = function loadMoreTiles (maxTotalLoading, maxNewLoads) {\n    var newLoads = 0;\n    var abortedTiles = false;\n    var state, tile, tileKey;\n    while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads &&\n           this.getCount() > 0) {\n      tile = /** @type {import(\"./Tile.js\").default} */ (this.dequeue()[0]);\n      tileKey = tile.getKey();\n      state = tile.getState();\n      if (state === TileState.ABORT) {\n        abortedTiles = true;\n      } else if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n        this.tilesLoadingKeys_[tileKey] = true;\n        ++this.tilesLoading_;\n        ++newLoads;\n        tile.load();\n      }\n    }\n    if (newLoads === 0 && abortedTiles) {\n      // Do not stop the render loop when all wanted tiles were aborted due to\n      // a small, saturated tile cache.\n      this.tileChangeCallback_();\n    }\n  };\n\n  return TileQueue;\n}(PriorityQueue));\n\n\nexport default TileQueue;\n\n//# sourceMappingURL=TileQueue.js.map","/**\n * @module ol/PluggableMap\n */\nimport {getUid} from './util.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport RenderEventType from './render/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport TileQueue from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {assert} from './asserts.js';\nimport {removeNode} from './dom.js';\nimport {listen, unlistenByKey, unlisten} from './events.js';\nimport {stopPropagation} from './events/Event.js';\nimport EventType from './events/EventType.js';\nimport {createEmpty, clone, createOrUpdateEmpty, equals, getForViewAndSize, isEmpty} from './extent.js';\nimport {TRUE} from './functions.js';\nimport {DEVICE_PIXEL_RATIO, TOUCH} from './has.js';\nimport LayerGroup from './layer/Group.js';\nimport {hasArea} from './size.js';\nimport {DROP} from './structs/PriorityQueue.js';\nimport {create as createTransform, apply as applyTransform} from './transform.js';\n\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {import(\"./View.js\").State} viewState The state of the current view.\n * @property {boolean} animate\n * @property {import(\"./transform.js\").Transform} coordinateToPixelTransform\n * @property {null|import(\"./extent.js\").Extent} extent\n * @property {import(\"./coordinate.js\").Coordinate} focus\n * @property {number} index\n * @property {Object<string, import(\"./layer/Layer.js\").State>} layerStates\n * @property {Array<import(\"./layer/Layer.js\").State>} layerStatesArray\n * @property {import(\"./transform.js\").Transform} pixelToCoordinateTransform\n * @property {Array<PostRenderFunction>} postRenderFunctions\n * @property {import(\"./size.js\").Size} size\n * @property {!Object<string, boolean>} skippedFeatureUids\n * @property {TileQueue} tileQueue\n * @property {Object<string, Object<string, import(\"./TileRange.js\").default>>} usedTiles\n * @property {Array<number>} viewHints\n * @property {!Object<string, Object<string, boolean>>} wantedTiles\n */\n\n\n/**\n * @typedef {function(PluggableMap, ?FrameState): boolean} PostRenderFunction\n */\n\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {undefined|function(import(\"./layer/Layer.js\").default): boolean} layerFilter Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in pixels. Pixels\n * inside the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {Collection<import(\"./control/Control.js\").default>} [controls]\n * @property {Collection<import(\"./interaction/Interaction.js\").default>} [interactions]\n * @property {HTMLElement|Document} keyboardEventTarget\n * @property {Collection<import(\"./Overlay.js\").default>} overlays\n * @property {Object<string, *>} values\n */\n\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {Collection<import(\"./control/Control.js\").default>|Array<import(\"./control/Control.js\").default>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control~defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>|Array<import(\"./interaction/Interaction.js\").default>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction~defaults} is used.\n * @property {HTMLElement|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>|LayerGroup} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {boolean} [loadTilesWhileAnimating=false] When set to `true`, tiles\n * will be loaded during animations. This may improve the user experience, but\n * can also make animations stutter on devices with slow memory.\n * @property {boolean} [loadTilesWhileInteracting=false] When set to `true`,\n * tiles will be loaded while interacting with the map. This may improve the\n * user experience, but can also make map panning and zooming choppy on devices\n * with slow memory.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {Collection<import(\"./Overlay.js\").default>|Array<import(\"./Overlay.js\").default>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {HTMLElement|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered.\n * @property {View} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n\n/**\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @fires module:ol/render/Event~RenderEvent#rendercomplete\n * @api\n */\nvar PluggableMap = /*@__PURE__*/(function (BaseObject) {\n  function PluggableMap(options) {\n\n    BaseObject.call(this);\n\n    var optionsInternal = createOptionsInternal(options);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxTilesLoading_ = options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.loadTilesWhileAnimating_ =\n        options.loadTilesWhileAnimating !== undefined ?\n          options.loadTilesWhileAnimating : false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.loadTilesWhileInteracting_ =\n        options.loadTilesWhileInteracting !== undefined ?\n          options.loadTilesWhileInteracting : false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = options.pixelRatio !== undefined ?\n      options.pixelRatio : DEVICE_PIXEL_RATIO;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.animationDelayKey_;\n\n    /**\n     * @private\n     */\n    this.animationDelay_ = function() {\n      this.animationDelayKey_ = undefined;\n      this.renderFrame_.call(this, Date.now());\n    }.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.coordinateToPixelTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.pixelToCoordinateTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.frameIndex_ = 0;\n\n    /**\n     * @private\n     * @type {?FrameState}\n     */\n    this.frameState_ = null;\n\n    /**\n     * The extent at the previous 'moveend' event.\n     * @private\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.previousExtent_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewPropertyListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewChangeListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.layerGroupPropertyListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.viewport_ = document.createElement('div');\n    this.viewport_.className = 'ol-viewport' + (TOUCH ? ' ol-touch' : '');\n    this.viewport_.style.position = 'relative';\n    this.viewport_.style.overflow = 'hidden';\n    this.viewport_.style.width = '100%';\n    this.viewport_.style.height = '100%';\n    // prevent page zoom on IE >= 10 browsers\n    this.viewport_.style.msTouchAction = 'none';\n    this.viewport_.style.touchAction = 'none';\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainer_ = document.createElement('div');\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.viewport_.appendChild(this.overlayContainer_);\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainerStopEvent_ = document.createElement('div');\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    var overlayEvents = [\n      EventType.CLICK,\n      EventType.DBLCLICK,\n      EventType.MOUSEDOWN,\n      EventType.TOUCHSTART,\n      EventType.MSPOINTERDOWN,\n      MapBrowserEventType.POINTERDOWN,\n      EventType.MOUSEWHEEL,\n      EventType.WHEEL\n    ];\n    for (var i = 0, ii = overlayEvents.length; i < ii; ++i) {\n      listen(this.overlayContainerStopEvent_, overlayEvents[i], stopPropagation);\n    }\n    this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n     * @private\n     * @type {MapBrowserEventHandler}\n     */\n    this.mapBrowserEventHandler_ = new MapBrowserEventHandler(this, options.moveTolerance);\n    for (var key in MapBrowserEventType) {\n      listen(this.mapBrowserEventHandler_, MapBrowserEventType[key],\n        this.handleMapBrowserEvent, this);\n    }\n\n    /**\n     * @private\n     * @type {HTMLElement|Document}\n     */\n    this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.keyHandlerKeys_ = null;\n\n    listen(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n    listen(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n    listen(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n\n    /**\n     * @type {Collection<import(\"./control/Control.js\").default>}\n     * @protected\n     */\n    this.controls = optionsInternal.controls || new Collection();\n\n    /**\n     * @type {Collection<import(\"./interaction/Interaction.js\").default>}\n     * @protected\n     */\n    this.interactions = optionsInternal.interactions || new Collection();\n\n    /**\n     * @type {Collection<import(\"./Overlay.js\").default>}\n     * @private\n     */\n    this.overlays_ = optionsInternal.overlays;\n\n    /**\n     * A lookup of overlays by id.\n     * @private\n     * @type {Object<string, import(\"./Overlay.js\").default>}\n     */\n    this.overlayIdIndex_ = {};\n\n    /**\n     * @type {import(\"./renderer/Map.js\").default}\n     * @private\n     */\n    this.renderer_ = this.createRenderer();\n\n    /**\n     * @type {function(Event)|undefined}\n     * @private\n     */\n    this.handleResize_;\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate}\n     */\n    this.focus_ = null;\n\n    /**\n     * @private\n     * @type {!Array<PostRenderFunction>}\n     */\n    this.postRenderFunctions_ = [];\n\n    /**\n     * @private\n     * @type {TileQueue}\n     */\n    this.tileQueue_ = new TileQueue(\n      this.getTilePriority.bind(this),\n      this.handleTileChange_.bind(this));\n\n    /**\n     * Uids of features to skip at rendering time.\n     * @type {Object<string, boolean>}\n     * @private\n     */\n    this.skippedFeatureUids_ = {};\n\n    listen(\n      this, getChangeEventType(MapProperty.LAYERGROUP),\n      this.handleLayerGroupChanged_, this);\n    listen(this, getChangeEventType(MapProperty.VIEW),\n      this.handleViewChanged_, this);\n    listen(this, getChangeEventType(MapProperty.SIZE),\n      this.handleSizeChanged_, this);\n    listen(this, getChangeEventType(MapProperty.TARGET),\n      this.handleTargetChanged_, this);\n\n    // setProperties will trigger the rendering of the map if the map\n    // is \"defined\" already.\n    this.setProperties(optionsInternal.values);\n\n    this.controls.forEach(\n      /**\n       * @param {import(\"./control/Control.js\").default} control Control.\n       * @this {PluggableMap}\n       */\n      (function(control) {\n        control.setMap(this);\n      }).bind(this));\n\n    listen(this.controls, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }, this);\n\n    listen(this.controls, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }, this);\n\n    this.interactions.forEach(\n      /**\n       * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction.\n       * @this {PluggableMap}\n       */\n      (function(interaction) {\n        interaction.setMap(this);\n      }).bind(this));\n\n    listen(this.interactions, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }, this);\n\n    listen(this.interactions, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }, this);\n\n    this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n\n    listen(this.overlays_, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        this.addOverlayInternal_(/** @type {import(\"./Overlay.js\").default} */ (event.element));\n      }, this);\n\n    listen(this.overlays_, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        var overlay = /** @type {import(\"./Overlay.js\").default} */ (event.element);\n        var id = overlay.getId();\n        if (id !== undefined) {\n          delete this.overlayIdIndex_[id.toString()];\n        }\n        event.element.setMap(null);\n      }, this);\n\n  }\n\n  if ( BaseObject ) PluggableMap.__proto__ = BaseObject;\n  PluggableMap.prototype = Object.create( BaseObject && BaseObject.prototype );\n  PluggableMap.prototype.constructor = PluggableMap;\n\n  /**\n   * @abstract\n   * @return {import(\"./renderer/Map.js\").default} The map renderer\n   */\n  PluggableMap.prototype.createRenderer = function createRenderer () {\n    throw new Error('Use a map type that has a createRenderer method');\n  };\n\n  /**\n   * Add the given control to the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @api\n   */\n  PluggableMap.prototype.addControl = function addControl (control) {\n    this.getControls().push(control);\n  };\n\n  /**\n   * Add the given interaction to the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to add.\n   * @api\n   */\n  PluggableMap.prototype.addInteraction = function addInteraction (interaction) {\n    this.getInteractions().push(interaction);\n  };\n\n  /**\n   * Adds the given layer to the top of this map. If you want to add a layer\n   * elsewhere in the stack, use `getLayers()` and the methods available on\n   * {@link module:ol/Collection~Collection}.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @api\n   */\n  PluggableMap.prototype.addLayer = function addLayer (layer) {\n    var layers = this.getLayerGroup().getLayers();\n    layers.push(layer);\n  };\n\n  /**\n   * Add the given overlay to the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @api\n   */\n  PluggableMap.prototype.addOverlay = function addOverlay (overlay) {\n    this.getOverlays().push(overlay);\n  };\n\n  /**\n   * This deals with map's overlay collection changes.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @private\n   */\n  PluggableMap.prototype.addOverlayInternal_ = function addOverlayInternal_ (overlay) {\n    var id = overlay.getId();\n    if (id !== undefined) {\n      this.overlayIdIndex_[id.toString()] = overlay;\n    }\n    overlay.setMap(this);\n  };\n\n  /**\n   *\n   * @inheritDoc\n   */\n  PluggableMap.prototype.disposeInternal = function disposeInternal () {\n    this.mapBrowserEventHandler_.dispose();\n    unlisten(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n    unlisten(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n    unlisten(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n    if (this.handleResize_ !== undefined) {\n      removeEventListener(EventType.RESIZE, this.handleResize_, false);\n      this.handleResize_ = undefined;\n    }\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n      this.animationDelayKey_ = undefined;\n    }\n    this.setTarget(null);\n    BaseObject.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * Detect features that intersect a pixel on the viewport, and execute a\n   * callback with each intersecting feature. Layers included in the detection can\n   * be configured through the `layerFilter` option in `opt_options`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./Feature.js\").FeatureLike,\n   *     import(\"./layer/Layer.js\").default): T} callback Feature callback. The callback will be\n   *     called with two arguments. The first argument is one\n   *     {@link module:ol/Feature feature} or\n   *     {@link module:ol/render/Feature render feature} at the pixel, the second is\n   *     the {@link module:ol/layer/Layer layer} of the feature and will be null for\n   *     unmanaged layers. To stop detection, callback functions can return a\n   *     truthy value.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  PluggableMap.prototype.forEachFeatureAtPixel = function forEachFeatureAtPixel (pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    var coordinate = this.getCoordinateFromPixel(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    var hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    var layerFilter = opt_options.layerFilter !== undefined ?\n      opt_options.layerFilter : TRUE;\n    return this.renderer_.forEachFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, callback, null,\n      layerFilter, null);\n  };\n\n  /**\n   * Get all features that intersect a pixel on the viewport.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {Array<import(\"./Feature.js\").FeatureLike>} The detected features or\n   * `null` if none were found.\n   * @api\n   */\n  PluggableMap.prototype.getFeaturesAtPixel = function getFeaturesAtPixel (pixel, opt_options) {\n    var features = null;\n    this.forEachFeatureAtPixel(pixel, function(feature) {\n      if (!features) {\n        features = [];\n      }\n      features.push(feature);\n    }, opt_options);\n    return features;\n  };\n\n  /**\n   * Detect layers that have a color value at a pixel on the viewport, and\n   * execute a callback with each matching layer. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./layer/Layer.js\").default, (Uint8ClampedArray|Uint8Array)): T} callback\n   *     Layer callback. This callback will receive two arguments: first is the\n   *     {@link module:ol/layer/Layer layer}, second argument is an array representing\n   *     [R, G, B, A] pixel values (0 - 255) and will be `null` for layer types\n   *     that do not currently support this argument. To stop detection, callback\n   *     functions can return a truthy value.\n   * @param {AtPixelOptions=} opt_options Configuration options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  PluggableMap.prototype.forEachLayerAtPixel = function forEachLayerAtPixel (pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    var options = opt_options || /** @type {AtPixelOptions} */ ({});\n    var hitTolerance = options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    var layerFilter = options.layerFilter || TRUE;\n    return this.renderer_.forEachLayerAtPixel(\n      pixel, this.frameState_, hitTolerance, callback, null, layerFilter, null);\n  };\n\n  /**\n   * Detect if features intersect a pixel on the viewport. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {boolean} Is there a feature at the given pixel?\n   * @template U\n   * @api\n   */\n  PluggableMap.prototype.hasFeatureAtPixel = function hasFeatureAtPixel (pixel, opt_options) {\n    if (!this.frameState_) {\n      return false;\n    }\n    var coordinate = this.getCoordinateFromPixel(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    var layerFilter = opt_options.layerFilter !== undefined ? opt_options.layerFilter : TRUE;\n    var hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    return this.renderer_.hasFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, layerFilter, null);\n  };\n\n  /**\n   * Returns the coordinate in view projection for a browser event.\n   * @param {Event} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  PluggableMap.prototype.getEventCoordinate = function getEventCoordinate (event) {\n    return this.getCoordinateFromPixel(this.getEventPixel(event));\n  };\n\n  /**\n   * Returns the map pixel position for a browser event relative to the viewport.\n   * @param {Event|TouchEvent} event Event.\n   * @return {import(\"./pixel.js\").Pixel} Pixel.\n   * @api\n   */\n  PluggableMap.prototype.getEventPixel = function getEventPixel (event) {\n    var viewportPosition = this.viewport_.getBoundingClientRect();\n    var eventPosition = 'changedTouches' in event ?\n      /** @type {TouchEvent} */ (event).changedTouches[0] :\n      /** @type {MouseEvent} */ (event);\n\n    return [\n      eventPosition.clientX - viewportPosition.left,\n      eventPosition.clientY - viewportPosition.top\n    ];\n  };\n\n  /**\n   * Get the target in which this map is rendered.\n   * Note that this returns what is entered as an option or in setTarget:\n   * if that was an element, it returns an element; if a string, it returns that.\n   * @return {HTMLElement|string|undefined} The Element or id of the Element that the\n   *     map is rendered in.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getTarget = function getTarget () {\n    return /** @type {HTMLElement|string|undefined} */ (this.get(MapProperty.TARGET));\n  };\n\n  /**\n   * Get the DOM element into which this map is rendered. In contrast to\n   * `getTarget` this method always return an `Element`, or `null` if the\n   * map has no target.\n   * @return {HTMLElement} The element that the map is rendered in.\n   * @api\n   */\n  PluggableMap.prototype.getTargetElement = function getTargetElement () {\n    var target = this.getTarget();\n    if (target !== undefined) {\n      return typeof target === 'string' ? document.getElementById(target) : target;\n    } else {\n      return null;\n    }\n  };\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * map view projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   * @api\n   */\n  PluggableMap.prototype.getCoordinateFromPixel = function getCoordinateFromPixel (pixel) {\n    var frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n    }\n  };\n\n  /**\n   * Get the map controls. Modifying this collection changes the controls\n   * associated with the map.\n   * @return {Collection<import(\"./control/Control.js\").default>} Controls.\n   * @api\n   */\n  PluggableMap.prototype.getControls = function getControls () {\n    return this.controls;\n  };\n\n  /**\n   * Get the map overlays. Modifying this collection changes the overlays\n   * associated with the map.\n   * @return {Collection<import(\"./Overlay.js\").default>} Overlays.\n   * @api\n   */\n  PluggableMap.prototype.getOverlays = function getOverlays () {\n    return this.overlays_;\n  };\n\n  /**\n   * Get an overlay by its identifier (the value returned by overlay.getId()).\n   * Note that the index treats string and numeric identifiers as the same. So\n   * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n   * @param {string|number} id Overlay identifier.\n   * @return {import(\"./Overlay.js\").default} Overlay.\n   * @api\n   */\n  PluggableMap.prototype.getOverlayById = function getOverlayById (id) {\n    var overlay = this.overlayIdIndex_[id.toString()];\n    return overlay !== undefined ? overlay : null;\n  };\n\n  /**\n   * Get the map interactions. Modifying this collection changes the interactions\n   * associated with the map.\n   *\n   * Interactions are used for e.g. pan, zoom and rotate.\n   * @return {Collection<import(\"./interaction/Interaction.js\").default>} Interactions.\n   * @api\n   */\n  PluggableMap.prototype.getInteractions = function getInteractions () {\n    return this.interactions;\n  };\n\n  /**\n   * Get the layergroup associated with this map.\n   * @return {LayerGroup} A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getLayerGroup = function getLayerGroup () {\n    return (\n      /** @type {LayerGroup} */ (this.get(MapProperty.LAYERGROUP))\n    );\n  };\n\n  /**\n   * Get the collection of layers associated with this map.\n   * @return {!Collection<import(\"./layer/Base.js\").default>} Layers.\n   * @api\n   */\n  PluggableMap.prototype.getLayers = function getLayers () {\n    var layers = this.getLayerGroup().getLayers();\n    return layers;\n  };\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the map view\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   * @api\n   */\n  PluggableMap.prototype.getPixelFromCoordinate = function getPixelFromCoordinate (coordinate) {\n    var frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.coordinateToPixelTransform, coordinate.slice(0, 2));\n    }\n  };\n\n  /**\n   * Get the map renderer.\n   * @return {import(\"./renderer/Map.js\").default} Renderer\n   */\n  PluggableMap.prototype.getRenderer = function getRenderer () {\n    return this.renderer_;\n  };\n\n  /**\n   * Get the size of this map.\n   * @return {import(\"./size.js\").Size|undefined} The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getSize = function getSize () {\n    return (\n      /** @type {import(\"./size.js\").Size|undefined} */ (this.get(MapProperty.SIZE))\n    );\n  };\n\n  /**\n   * Get the view associated with this map. A view manages properties such as\n   * center and resolution.\n   * @return {View} The view that controls this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getView = function getView () {\n    return (\n      /** @type {View} */ (this.get(MapProperty.VIEW))\n    );\n  };\n\n  /**\n   * Get the element that serves as the map viewport.\n   * @return {HTMLElement} Viewport.\n   * @api\n   */\n  PluggableMap.prototype.getViewport = function getViewport () {\n    return this.viewport_;\n  };\n\n  /**\n   * Get the element that serves as the container for overlays.  Elements added to\n   * this container will let mousedown and touchstart events through to the map,\n   * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n   * events.\n   * @return {!HTMLElement} The map's overlay container.\n   */\n  PluggableMap.prototype.getOverlayContainer = function getOverlayContainer () {\n    return this.overlayContainer_;\n  };\n\n  /**\n   * Get the element that serves as a container for overlays that don't allow\n   * event propagation. Elements added to this container won't let mousedown and\n   * touchstart events through to the map, so clicks and gestures on an overlay\n   * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n   * @return {!HTMLElement} The map's overlay container that stops events.\n   */\n  PluggableMap.prototype.getOverlayContainerStopEvent = function getOverlayContainerStopEvent () {\n    return this.overlayContainerStopEvent_;\n  };\n\n  /**\n   * @param {import(\"./Tile.js\").default} tile Tile.\n   * @param {string} tileSourceKey Tile source key.\n   * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n   * @param {number} tileResolution Tile resolution.\n   * @return {number} Tile priority.\n   */\n  PluggableMap.prototype.getTilePriority = function getTilePriority (tile, tileSourceKey, tileCenter, tileResolution) {\n    // Filter out tiles at higher zoom levels than the current zoom level, or that\n    // are outside the visible extent.\n    var frameState = this.frameState_;\n    if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n      return DROP;\n    }\n    if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n      return DROP;\n    }\n    // Prioritize the highest zoom level tiles closest to the focus.\n    // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n    // Within a zoom level, tiles are prioritized by the distance in pixels\n    // between the center of the tile and the focus.  The factor of 65536 means\n    // that the prioritization should behave as desired for tiles up to\n    // 65536 * Math.log(2) = 45426 pixels from the focus.\n    var deltaX = tileCenter[0] - frameState.focus[0];\n    var deltaY = tileCenter[1] - frameState.focus[1];\n    return 65536 * Math.log(tileResolution) +\n        Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n  };\n\n  /**\n   * @param {Event} browserEvent Browser event.\n   * @param {string=} opt_type Type.\n   */\n  PluggableMap.prototype.handleBrowserEvent = function handleBrowserEvent (browserEvent, opt_type) {\n    var type = opt_type || browserEvent.type;\n    var mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n    this.handleMapBrowserEvent(mapBrowserEvent);\n  };\n\n  /**\n   * @param {MapBrowserEvent} mapBrowserEvent The event to handle.\n   */\n  PluggableMap.prototype.handleMapBrowserEvent = function handleMapBrowserEvent (mapBrowserEvent) {\n    if (!this.frameState_) {\n      // With no view defined, we cannot translate pixels into geographical\n      // coordinates so interactions cannot be used.\n      return;\n    }\n    this.focus_ = mapBrowserEvent.coordinate;\n    mapBrowserEvent.frameState = this.frameState_;\n    var interactionsArray = this.getInteractions().getArray();\n    if (this.dispatchEvent(mapBrowserEvent) !== false) {\n      for (var i = interactionsArray.length - 1; i >= 0; i--) {\n        var interaction = interactionsArray[i];\n        if (!interaction.getActive()) {\n          continue;\n        }\n        var cont = interaction.handleEvent(mapBrowserEvent);\n        if (!cont) {\n          break;\n        }\n      }\n    }\n  };\n\n  /**\n   * @protected\n   */\n  PluggableMap.prototype.handlePostRender = function handlePostRender () {\n\n    var frameState = this.frameState_;\n\n    // Manage the tile queue\n    // Image loads are expensive and a limited resource, so try to use them\n    // efficiently:\n    // * When the view is static we allow a large number of parallel tile loads\n    //   to complete the frame as quickly as possible.\n    // * When animating or interacting, image loads can cause janks, so we reduce\n    //   the maximum number of loads per frame and limit the number of parallel\n    //   tile loads to remain reactive to view changes and to reduce the chance of\n    //   loading tiles that will quickly disappear from view.\n    var tileQueue = this.tileQueue_;\n    if (!tileQueue.isEmpty()) {\n      var maxTotalLoading = this.maxTilesLoading_;\n      var maxNewLoads = maxTotalLoading;\n      if (frameState) {\n        var hints = frameState.viewHints;\n        if (hints[ViewHint.ANIMATING]) {\n          maxTotalLoading = this.loadTilesWhileAnimating_ ? 8 : 0;\n          maxNewLoads = 2;\n        }\n        if (hints[ViewHint.INTERACTING]) {\n          maxTotalLoading = this.loadTilesWhileInteracting_ ? 8 : 0;\n          maxNewLoads = 2;\n        }\n      }\n      if (tileQueue.getTilesLoading() < maxTotalLoading) {\n        tileQueue.reprioritize(); // FIXME only call if view has changed\n        tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n      }\n    }\n    if (frameState && this.hasListener(RenderEventType.RENDERCOMPLETE) && !frameState.animate &&\n        !this.tileQueue_.getTilesLoading() && !getLoading(this.getLayers().getArray())) {\n      this.renderer_.dispatchRenderEvent(RenderEventType.RENDERCOMPLETE, frameState);\n    }\n\n    var postRenderFunctions = this.postRenderFunctions_;\n    for (var i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n      postRenderFunctions[i](this, frameState);\n    }\n    postRenderFunctions.length = 0;\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleSizeChanged_ = function handleSizeChanged_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleTargetChanged_ = function handleTargetChanged_ () {\n    // target may be undefined, null, a string or an Element.\n    // If it's a string we convert it to an Element before proceeding.\n    // If it's not now an Element we remove the viewport from the DOM.\n    // If it's an Element we append the viewport element to it.\n\n    var targetElement;\n    if (this.getTarget()) {\n      targetElement = this.getTargetElement();\n    }\n\n    if (this.keyHandlerKeys_) {\n      for (var i = 0, ii = this.keyHandlerKeys_.length; i < ii; ++i) {\n        unlistenByKey(this.keyHandlerKeys_[i]);\n      }\n      this.keyHandlerKeys_ = null;\n    }\n\n    if (!targetElement) {\n      this.renderer_.removeLayerRenderers();\n      removeNode(this.viewport_);\n      if (this.handleResize_ !== undefined) {\n        removeEventListener(EventType.RESIZE, this.handleResize_, false);\n        this.handleResize_ = undefined;\n      }\n    } else {\n      targetElement.appendChild(this.viewport_);\n\n      var keyboardEventTarget = !this.keyboardEventTarget_ ?\n        targetElement : this.keyboardEventTarget_;\n      this.keyHandlerKeys_ = [\n        listen(keyboardEventTarget, EventType.KEYDOWN, this.handleBrowserEvent, this),\n        listen(keyboardEventTarget, EventType.KEYPRESS, this.handleBrowserEvent, this)\n      ];\n\n      if (!this.handleResize_) {\n        this.handleResize_ = this.updateSize.bind(this);\n        window.addEventListener(EventType.RESIZE, this.handleResize_, false);\n      }\n    }\n\n    this.updateSize();\n    // updateSize calls setSize, so no need to call this.render\n    // ourselves here.\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleTileChange_ = function handleTileChange_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleViewPropertyChanged_ = function handleViewPropertyChanged_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleViewChanged_ = function handleViewChanged_ () {\n    if (this.viewPropertyListenerKey_) {\n      unlistenByKey(this.viewPropertyListenerKey_);\n      this.viewPropertyListenerKey_ = null;\n    }\n    if (this.viewChangeListenerKey_) {\n      unlistenByKey(this.viewChangeListenerKey_);\n      this.viewChangeListenerKey_ = null;\n    }\n    var view = this.getView();\n    if (view) {\n      this.viewport_.setAttribute('data-view', getUid(view));\n      this.viewPropertyListenerKey_ = listen(\n        view, ObjectEventType.PROPERTYCHANGE,\n        this.handleViewPropertyChanged_, this);\n      this.viewChangeListenerKey_ = listen(\n        view, EventType.CHANGE,\n        this.handleViewPropertyChanged_, this);\n    }\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleLayerGroupChanged_ = function handleLayerGroupChanged_ () {\n    if (this.layerGroupPropertyListenerKeys_) {\n      this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n      this.layerGroupPropertyListenerKeys_ = null;\n    }\n    var layerGroup = this.getLayerGroup();\n    if (layerGroup) {\n      this.layerGroupPropertyListenerKeys_ = [\n        listen(\n          layerGroup, ObjectEventType.PROPERTYCHANGE,\n          this.render, this),\n        listen(\n          layerGroup, EventType.CHANGE,\n          this.render, this)\n      ];\n    }\n    this.render();\n  };\n\n  /**\n   * @return {boolean} Is rendered.\n   */\n  PluggableMap.prototype.isRendered = function isRendered () {\n    return !!this.frameState_;\n  };\n\n  /**\n   * Requests an immediate render in a synchronous manner.\n   * @api\n   */\n  PluggableMap.prototype.renderSync = function renderSync () {\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n    }\n    this.animationDelay_();\n  };\n\n  /**\n   * Request a map rendering (at the next animation frame).\n   * @api\n   */\n  PluggableMap.prototype.render = function render () {\n    if (this.animationDelayKey_ === undefined) {\n      this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n    }\n  };\n\n  /**\n   * Remove the given control from the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @return {import(\"./control/Control.js\").default|undefined} The removed control (or undefined\n   *     if the control was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeControl = function removeControl (control) {\n    return this.getControls().remove(control);\n  };\n\n  /**\n   * Remove the given interaction from the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to remove.\n   * @return {import(\"./interaction/Interaction.js\").default|undefined} The removed interaction (or\n   *     undefined if the interaction was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeInteraction = function removeInteraction (interaction) {\n    return this.getInteractions().remove(interaction);\n  };\n\n  /**\n   * Removes the given layer from the map.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @return {import(\"./layer/Base.js\").default|undefined} The removed layer (or undefined if the\n   *     layer was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeLayer = function removeLayer (layer) {\n    var layers = this.getLayerGroup().getLayers();\n    return layers.remove(layer);\n  };\n\n  /**\n   * Remove the given overlay from the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @return {import(\"./Overlay.js\").default|undefined} The removed overlay (or undefined\n   *     if the overlay was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeOverlay = function removeOverlay (overlay) {\n    return this.getOverlays().remove(overlay);\n  };\n\n  /**\n   * @param {number} time Time.\n   * @private\n   */\n  PluggableMap.prototype.renderFrame_ = function renderFrame_ (time) {\n    var viewState;\n\n    var size = this.getSize();\n    var view = this.getView();\n    var extent = createEmpty();\n    var previousFrameState = this.frameState_;\n    /** @type {?FrameState} */\n    var frameState = null;\n    if (size !== undefined && hasArea(size) && view && view.isDef()) {\n      var viewHints = view.getHints(this.frameState_ ? this.frameState_.viewHints : undefined);\n      var layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n      var layerStates = {};\n      for (var i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n        layerStates[getUid(layerStatesArray[i].layer)] = layerStatesArray[i];\n      }\n      viewState = view.getState(this.pixelRatio_);\n      frameState = /** @type {FrameState} */ ({\n        animate: false,\n        coordinateToPixelTransform: this.coordinateToPixelTransform_,\n        extent: extent,\n        focus: this.focus_ ? this.focus_ : viewState.center,\n        index: this.frameIndex_++,\n        layerStates: layerStates,\n        layerStatesArray: layerStatesArray,\n        pixelRatio: this.pixelRatio_,\n        pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n        postRenderFunctions: [],\n        size: size,\n        skippedFeatureUids: this.skippedFeatureUids_,\n        tileQueue: this.tileQueue_,\n        time: time,\n        usedTiles: {},\n        viewState: viewState,\n        viewHints: viewHints,\n        wantedTiles: {}\n      });\n    }\n\n    if (frameState) {\n      frameState.extent = getForViewAndSize(viewState.center,\n        viewState.resolution, viewState.rotation, frameState.size, extent);\n    }\n\n    this.frameState_ = frameState;\n    this.renderer_.renderFrame(frameState);\n\n    if (frameState) {\n      if (frameState.animate) {\n        this.render();\n      }\n      Array.prototype.push.apply(this.postRenderFunctions_, frameState.postRenderFunctions);\n\n      if (previousFrameState) {\n        var moveStart = !this.previousExtent_ ||\n                    (!isEmpty(this.previousExtent_) &&\n                    !equals(frameState.extent, this.previousExtent_));\n        if (moveStart) {\n          this.dispatchEvent(\n            new MapEvent(MapEventType.MOVESTART, this, previousFrameState));\n          this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n        }\n      }\n\n      var idle = this.previousExtent_ &&\n          !frameState.viewHints[ViewHint.ANIMATING] &&\n          !frameState.viewHints[ViewHint.INTERACTING] &&\n          !equals(frameState.extent, this.previousExtent_);\n\n      if (idle) {\n        this.dispatchEvent(new MapEvent(MapEventType.MOVEEND, this, frameState));\n        clone(frameState.extent, this.previousExtent_);\n      }\n    }\n\n    this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n    setTimeout(this.handlePostRender.bind(this), 0);\n\n  };\n\n  /**\n   * Sets the layergroup of this map.\n   * @param {LayerGroup} layerGroup A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setLayerGroup = function setLayerGroup (layerGroup) {\n    this.set(MapProperty.LAYERGROUP, layerGroup);\n  };\n\n  /**\n   * Set the size of this map.\n   * @param {import(\"./size.js\").Size|undefined} size The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setSize = function setSize (size) {\n    this.set(MapProperty.SIZE, size);\n  };\n\n  /**\n   * Set the target element to render this map into.\n   * @param {HTMLElement|string|undefined} target The Element or id of the Element\n   *     that the map is rendered in.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setTarget = function setTarget (target) {\n    this.set(MapProperty.TARGET, target);\n  };\n\n  /**\n   * Set the view for this map.\n   * @param {View} view The view that controls this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setView = function setView (view) {\n    this.set(MapProperty.VIEW, view);\n  };\n\n  /**\n   * @param {import(\"./Feature.js\").default} feature Feature.\n   */\n  PluggableMap.prototype.skipFeature = function skipFeature (feature) {\n    this.skippedFeatureUids_[getUid(feature)] = true;\n    this.render();\n  };\n\n  /**\n   * Force a recalculation of the map viewport size.  This should be called when\n   * third-party code changes the size of the map viewport.\n   * @api\n   */\n  PluggableMap.prototype.updateSize = function updateSize () {\n    var targetElement = this.getTargetElement();\n\n    if (!targetElement) {\n      this.setSize(undefined);\n    } else {\n      var computedStyle = getComputedStyle(targetElement);\n      this.setSize([\n        targetElement.offsetWidth -\n            parseFloat(computedStyle['borderLeftWidth']) -\n            parseFloat(computedStyle['paddingLeft']) -\n            parseFloat(computedStyle['paddingRight']) -\n            parseFloat(computedStyle['borderRightWidth']),\n        targetElement.offsetHeight -\n            parseFloat(computedStyle['borderTopWidth']) -\n            parseFloat(computedStyle['paddingTop']) -\n            parseFloat(computedStyle['paddingBottom']) -\n            parseFloat(computedStyle['borderBottomWidth'])\n      ]);\n    }\n  };\n\n  /**\n   * @param {import(\"./Feature.js\").default} feature Feature.\n   */\n  PluggableMap.prototype.unskipFeature = function unskipFeature (feature) {\n    delete this.skippedFeatureUids_[getUid(feature)];\n    this.render();\n  };\n\n  return PluggableMap;\n}(BaseObject));\n\n\n/**\n * @param {MapOptions} options Map options.\n * @return {MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n\n  /**\n   * @type {HTMLElement|Document}\n   */\n  var keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget = typeof options.keyboardEventTarget === 'string' ?\n      document.getElementById(options.keyboardEventTarget) :\n      options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object<string, *>}\n   */\n  var values = {};\n\n  var layerGroup = options.layers && typeof /** @type {?} */ (options.layers).getLayers === 'function' ?\n    /** @type {LayerGroup} */ (options.layers) : new LayerGroup({layers: /** @type {Collection} */ (options.layers)});\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] = options.view !== undefined ?\n    options.view : new View();\n\n  var controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.controls).getArray === 'function',\n        47); // Expected `controls` to be an array or an `import(\"./Collection.js\").Collection`\n      controls = /** @type {Collection} */ (options.controls);\n    }\n  }\n\n  var interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.interactions).getArray === 'function',\n        48); // Expected `interactions` to be an array or an `import(\"./Collection.js\").Collection`\n      interactions = /** @type {Collection} */ (options.interactions);\n    }\n  }\n\n  var overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.overlays).getArray === 'function',\n        49); // Expected `overlays` to be an array or an `import(\"./Collection.js\").Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values\n  };\n\n}\nexport default PluggableMap;\n\n/**\n * @param  {Array<import(\"./layer/Base.js\").default>} layers Layers.\n * @return {boolean} Layers have sources that are still loading.\n */\nfunction getLoading(layers) {\n  for (var i = 0, ii = layers.length; i < ii; ++i) {\n    var layer = layers[i];\n    if (typeof /** @type {?} */ (layer).getLayers === 'function') {\n      return getLoading(/** @type {LayerGroup} */ (layer).getLayers().getArray());\n    } else {\n      var source = /** @type {import(\"./layer/Layer.js\").default} */ (\n        layer).getSource();\n      if (source && source.loading) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n//# sourceMappingURL=PluggableMap.js.map","/**\n * @module ol/Map\n */\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control/util.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport CanvasImageLayerRenderer from './renderer/canvas/ImageLayer.js';\nimport CanvasMapRenderer from './renderer/canvas/Map.js';\nimport CanvasTileLayerRenderer from './renderer/canvas/TileLayer.js';\nimport CanvasVectorLayerRenderer from './renderer/canvas/VectorLayer.js';\nimport CanvasVectorTileLayerRenderer from './renderer/canvas/VectorTileLayer.js';\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map';\n *     import View from 'ol/View';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *\n *     var map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~Group}\n * is a subclass of {@link module:ol/layer/Base}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nvar Map = /*@__PURE__*/(function (PluggableMap) {\n  function Map(options) {\n    options = assign({}, options);\n    if (!options.controls) {\n      options.controls = defaultControls();\n    }\n    if (!options.interactions) {\n      options.interactions = defaultInteractions();\n    }\n\n    PluggableMap.call(this, options);\n  }\n\n  if ( PluggableMap ) Map.__proto__ = PluggableMap;\n  Map.prototype = Object.create( PluggableMap && PluggableMap.prototype );\n  Map.prototype.constructor = Map;\n\n  Map.prototype.createRenderer = function createRenderer () {\n    var renderer = new CanvasMapRenderer(this);\n    renderer.registerLayerRenderers([\n      CanvasImageLayerRenderer,\n      CanvasTileLayerRenderer,\n      CanvasVectorLayerRenderer,\n      CanvasVectorTileLayerRenderer\n    ]);\n    return renderer;\n  };\n\n  return Map;\n}(PluggableMap));\n\n\nexport default Map;\n\n//# sourceMappingURL=Map.js.map","/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\n\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_geom_Polygon from 'ol/geom/Polygon'\r\nimport ol_geom_MultiPolygon from 'ol/geom/MultiPolygon'\r\nimport ol_geom_LinearRing from 'ol/geom/LinearRing'\r\nimport ol_interaction_Draw from 'ol/interaction/Draw'\r\nimport ol_interaction_Select from 'ol/interaction/Select'\r\n\r\n/** Interaction to draw holes in a polygon.\r\n * It fires a drawstart, drawend event when drawing the hole\r\n * and a modifystart, modifyend event before and after inserting the hole in the feature geometry.\r\n * @constructor\r\n * @extends {ol_interaction_Interaction}\r\n * @fires drawstart\r\n * @fires drawend\r\n * @fires modifystart\r\n * @fires modifyend\r\n * @param {olx.interaction.DrawHoleOptions} options extend olx.interaction.DrawOptions\r\n * \t@param {Array<ol.layer.Vector> | function | undefined} options.layers A list of layers from which polygons should be selected. Alternatively, a filter function can be provided. default: all visible layers\r\n * \t@param {Array<ol.Feature> | ol.Collection<ol.Feature> | function | undefined} options.features An array or a collection of features the interaction applies on or a function that takes a feature and a layer and returns true if the feature is a candidate\r\n * \t@param { ol.style.Style | Array<ol.style.Style> | StyleFunction | undefined }\tStyle for the selected features, default: default edit style\r\n */\r\nvar ol_interaction_DrawHole = function(options) {\r\n  if (!options) options = {};\r\n  var self = this;\r\n\r\n  // Select interaction for the current feature\r\n  this._select = new ol_interaction_Select({ style: options.style });\r\n  this._select.setActive(false);\r\n\r\n  // Geometry function that test points inside the current\r\n  var geometryFn, geomFn = options.geometryFunction;\r\n  if (geomFn) {\r\n    geometryFn = function(c,g) {\r\n      g = self._geometryFn (c, g);\r\n      return geomFn (c,g);\r\n    }\r\n  } else {\r\n    geometryFn = function(c,g) { return self._geometryFn (c, g); }\r\n  }\r\n\r\n  // Create draw interaction\r\n  options.type = \"Polygon\";\r\n  options.geometryFunction = geometryFn;\r\n  ol_interaction_Draw.call(this, options);\r\n\r\n  // Layer filter function\r\n  if (options.layers) {\r\n    if (typeof (options.layers) === 'function') {\r\n      this.layers_ = options.layers;\r\n    } else if (options.layers.indexOf) {\r\n      this.layers_ = function(l) {\r\n        return (options.layers.indexOf(l) >= 0); \r\n      };\r\n    }\r\n  }\r\n\r\n  // Features to apply on \r\n  if (typeof(options.features) === 'function') {\r\n    this._features = options.features;\r\n  } else if (options.features) {\r\n    var features = options.features;\r\n    this._features = function(f) {\r\n      if (features.indexOf) {\r\n        return !!features[features.indexOf(f)];\r\n      } else {\r\n        return !!features.item(features.getArray().indexOf(f));\r\n      }\r\n    }\r\n  } else {\r\n    this._features = function() { return true }\r\n  }\r\n\r\n  // Start drawing if inside a feature\r\n  this.on('drawstart', this._startDrawing.bind(this));\r\n  // End drawing add the hole to the current Polygon\r\n  this.on('drawend', this._finishDrawing.bind(this));\r\n};\r\nol_ext_inherits(ol_interaction_DrawHole, ol_interaction_Draw);\r\n\r\n/**\r\n * Remove the interaction from its current map, if any,  and attach it to a new\r\n * map, if any. Pass `null` to just remove the interaction from the current map.\r\n * @param {ol.Map} map Map.\r\n * @api stable\r\n */\r\nol_interaction_DrawHole.prototype.setMap = function(map) {\r\n  if (this.getMap()) this.getMap().removeInteraction(this._select);\r\n  if (map) map.addInteraction(this._select);\r\n  ol_interaction_Draw.prototype.setMap.call (this, map);\r\n};\r\n\r\n/**\r\n * Activate/deactivate the interaction\r\n * @param {boolean}\r\n * @api stable\r\n */\r\nol_interaction_DrawHole.prototype.setActive = function(b) {\r\n  this._select.getFeatures().clear();\r\n  ol_interaction_Draw.prototype.setActive.call (this, b);\r\n};\r\n\r\n/**\r\n * Remove last point of the feature currently being drawn \r\n * (test if points to remove before).\r\n */\r\nol_interaction_DrawHole.prototype.removeLastPoint = function() {\r\n  if (this._feature && this._feature.getGeometry().getCoordinates()[0].length>2) {\r\n    ol_interaction_Draw.prototype.removeLastPoint.call(this);\r\n  }\r\n};\r\n\r\n/** \r\n * Get the current polygon to hole\r\n * @return {ol.Feature}\r\n */\r\nol_interaction_DrawHole.prototype.getPolygon = function() {\r\n  return this._polygon;\r\n  // return this._select.getFeatures().item(0).getGeometry();\r\n};\r\n\r\n/**\r\n * Get current feature to add a hole and start drawing\r\n * @param {ol_interaction_Draw.Event} e\r\n * @private\r\n */\r\nol_interaction_DrawHole.prototype._startDrawing = function(e) {\r\n  var map = this.getMap();\r\n  this._feature = e.feature;\r\n  var coord = e.feature.getGeometry().getCoordinates()[0][0];\r\n  this._current = null;\r\n  // Check object under the pointer\r\n  map.forEachFeatureAtPixel(\r\n    map.getPixelFromCoordinate(coord),\r\n    function(feature, layer) {\r\n      if (this._features(feature, layer)) {\r\n        var poly = feature.getGeometry();\r\n        if (poly.getType() === \"Polygon\"\r\n          && poly.intersectsCoordinate(coord)) {\r\n          this._polygonIndex = false;\r\n          this._polygon = poly;\r\n          this._current = feature;\r\n        } else if (poly.getType() === \"MultiPolygon\"\r\n          && poly.intersectsCoordinate(coord)) {\r\n          for (var i=0, p; p=poly.getPolygon(i); i++) {\r\n            if (p.intersectsCoordinate(coord)) {\r\n              this._polygonIndex = i;\r\n              this._polygon = p;\r\n              this._current = feature;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }.bind(this), {\r\n      layerFilter: this.layers_\r\n    }\r\n  );\r\n  this._select.getFeatures().clear();\r\n  if (!this._current) {\r\n    this.setActive(false);\r\n    this.setActive(true);\r\n  } else {\r\n    this._select.getFeatures().push(this._current);\r\n  }\r\n};\r\n\r\n/**\r\n * Stop drawing and add the sketch feature to the target feature. \r\n * @param {ol_interaction_Draw.Event} e\r\n * @private\r\n */\r\nol_interaction_DrawHole.prototype._finishDrawing = function(e) {\r\n  // The feature is the hole\r\n  e.hole = e.feature;\r\n  // Get the current feature\r\n  e.feature = this._select.getFeatures().item(0);\r\n  this.dispatchEvent({ type: 'modifystart', features: [ this._current ] });\r\n  // Create the hole\r\n  var c = e.hole.getGeometry().getCoordinates()[0];\r\n  if (c.length > 3) {\r\n    if (this._polygonIndex!==false) {\r\n      var geom = e.feature.getGeometry();\r\n      var newGeom = new ol_geom_MultiPolygon([]);\r\n      for (var i=0, pi; pi=geom.getPolygon(i); i++) {\r\n        if (i===this._polygonIndex) {\r\n          pi.appendLinearRing(new ol_geom_LinearRing(c));\r\n          newGeom.appendPolygon(pi);\r\n        } else {\r\n          newGeom.appendPolygon(pi);\r\n        }\r\n      }\r\n      e.feature.setGeometry(newGeom);\r\n    } else {\r\n      this.getPolygon().appendLinearRing(new ol_geom_LinearRing(c));\r\n    }\r\n  }\r\n  this.dispatchEvent({ type: 'modifyend', features: [ this._current ] });\r\n  // reset\r\n  this._feature = null;\r\n  this._select.getFeatures().clear();\r\n};\r\n\r\n/**\r\n * Function that is called when a geometry's coordinates are updated.\r\n * @param {Array<ol.coordinate>} coordinates\r\n * @param {ol_geom_Polygon} geometry\r\n * @return {ol_geom_Polygon}\r\n * @private\r\n */\r\nol_interaction_DrawHole.prototype._geometryFn = function(coordinates, geometry) {\r\n  var coord = coordinates[0].pop();\r\n  if (!this.getPolygon() || this.getPolygon().intersectsCoordinate(coord)) {\r\n    this.lastOKCoord = [coord[0],coord[1]];\r\n  }\r\n  coordinates[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]);\r\n\r\n  if (geometry) {\r\n    geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\r\n  } else {\r\n    geometry = new ol_geom_Polygon(coordinates);\r\n  }\r\n  return geometry;\r\n};\r\n\r\nexport default ol_interaction_DrawHole\r\n","import ol_style_Style from 'ol/style/Style'\r\nimport ol_style_Circle from 'ol/style/Circle'\r\nimport ol_style_Stroke from 'ol/style/Stroke'\r\nimport ol_style_Fill from 'ol/style/Fill'\r\n\r\nvar ol_style_Style_defaultStyle;\r\n\r\n(function() {\r\n\r\n// Style\r\nvar white = [255, 255, 255, 1];\r\nvar blue = [0, 153, 255, 1];\r\nvar width = 3;\r\n\r\nvar defaultEditStyle = [\r\n  new ol_style_Style({\r\n    stroke: new ol_style_Stroke({ color: white, width: width + 2 })\r\n  }),\r\n  new ol_style_Style({\r\n    image: new ol_style_Circle({\r\n      radius: width * 2,\r\n      fill: new ol_style_Fill({ color: blue }),\r\n      stroke: new ol_style_Stroke({ color: white, width: width / 2 })\r\n    }),\r\n    stroke: new ol_style_Stroke({ color: blue, width: width }),\r\n    fill: new ol_style_Fill({\r\n      color: [255, 255, 255, 0.5]\r\n    })\r\n  })\r\n];\r\n\r\n/**\r\n * Get the default style\r\n * @param {boolean|*} [edit] true to get editing style or a { color, fillColor } object, default get default blue style\r\n * @return {Array<ol.style.Style>}\r\n */\r\nol_style_Style_defaultStyle = function(edit) {\r\n  if (edit===true) {\r\n    return defaultEditStyle;\r\n  } else {\r\n    edit = edit || {};\r\n    var fill = new ol_style_Fill({\r\n      color: edit.fillColor || 'rgba(255,255,255,0.4)'\r\n    });\r\n    var stroke = new ol_style_Stroke({\r\n      color: edit.color || '#3399CC',\r\n      width: 1.25\r\n    });\r\n    var style = new ol_style_Style({\r\n      image: new ol_style_Circle({\r\n        fill: fill,\r\n        stroke: stroke,\r\n        radius: 5\r\n      }),\r\n      fill: fill,\r\n      stroke: stroke\r\n    });\r\n    return [ style ];\r\n  }\r\n};\r\n\r\n})();\r\n\r\nexport default ol_style_Style_defaultStyle\r\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \r\n\treleased under the CeCILL-B license (French BSD license)\r\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\r\nimport ol_geom_LineString from 'ol/geom/LineString'\r\nimport ol_geom_Polygon from 'ol/geom/Polygon'\r\nimport {ol_coordinate_dist2d, ol_coordinate_findSegment, ol_coordinate_offsetCoords} from \"../geom/GeomUtils\";\r\n\r\nimport ol_style_Style_defaultStyle from '../style/defaultStyle'\r\n\r\n/** Offset interaction for offseting feature geometry\r\n * @constructor\r\n * @extends {ol_interaction_Pointer}\r\n * @fires offsetstart\r\n * @fires offsetting\r\n * @fires offsetend\r\n * @param {any} options\r\n *\t@param {ol.layer.Vector | Array<ol.layer.Vector>} options.layers list of feature to transform \r\n *\t@param {ol.Collection.<ol.Feature>} options.features collection of feature to transform\r\n *\t@param {ol.source.Vector | undefined} options.source source to duplicate feature when ctrl key is down\r\n *\t@param {boolean} options.duplicate force feature to duplicate (source must be set)\r\n *  @param {ol.style.Style | Array.<ol.style.Style> | ol.style.StyleFunction | undefined} style style for the sketch\r\n */\r\nvar ol_interaction_Offset = function(options) {\r\n  if (!options) options = {};\r\n\r\n\t// Extend pointer\r\n\tol_interaction_Pointer.call(this, {\r\n    handleDownEvent: this.handleDownEvent_,\r\n    handleDragEvent: this.handleDragEvent_,\r\n    handleMoveEvent: this.handleMoveEvent_,\r\n    handleUpEvent: this.handleUpEvent_\r\n  });\r\n    \r\n\t// Collection of feature to transform\r\n\tthis.features_ = options.features;\r\n\t// List of layers to transform\r\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\r\n  // duplicate\r\n  this.set('duplicate', options.duplicate);\r\n  this.source_ = options.source;\r\n  // Style\r\n  this._style = (typeof (options.style) === 'function') ? options.style : function () { \r\n    if (options.style) return options.style;\r\n    else return ol_style_Style_defaultStyle(true);\r\n  };\r\n\r\n  // init\r\n  this.previousCursor_ = false;\r\n};\r\nol_ext_inherits(ol_interaction_Offset, ol_interaction_Pointer);\r\n\r\n/**\r\n * Remove the interaction from its current map, if any,  and attach it to a new\r\n * map, if any. Pass `null` to just remove the interaction from the current map.\r\n * @param {ol.Map} map Map.\r\n * @api stable\r\n */\r\nol_interaction_Offset.prototype.setMap = function(map) {\r\n\tol_interaction_Pointer.prototype.setMap.call (this, map);\r\n};\r\n\r\n/** Get Feature at pixel\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @return {any} a feature and the hit point\r\n * @private\r\n */\r\nol_interaction_Offset.prototype.getFeatureAtPixel_ = function(e) {\r\n  var self = this;\r\n\treturn this.getMap().forEachFeatureAtPixel(e.pixel,\r\n\t\tfunction(feature, layer) {\r\n      var current;\r\n\t\t\t// feature belong to a layer\r\n\t\t\tif (self.layers_) {\r\n        for (var i=0; i<self.layers_.length; i++) {\r\n          if (self.layers_[i]===layer) {\r\n            current = feature;\r\n            break;\r\n          }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// feature in the collection\r\n\t\t\telse if (self.features_) {\r\n        self.features_.forEach (function(f) {\r\n          if (f===feature) {\r\n            current = feature \r\n          }\r\n        });\r\n\t\t\t}\r\n\t\t\t// Others\r\n\t\t\telse {\r\n        current = feature;\r\n      }\r\n\r\n      // Only poygon or linestring\r\n      var typeGeom = current.getGeometry().getType();\r\n      if (current && /Polygon|LineString/.test(typeGeom)) {\r\n        if (typeGeom==='Polygon' && current.getGeometry().getCoordinates().length>1) return false;\r\n        // test distance\r\n        var p = current.getGeometry().getClosestPoint(e.coordinate);\r\n        var dx = p[0]-e.coordinate[0];\r\n        var dy = p[1]-e.coordinate[1];\r\n        var d = Math.sqrt(dx*dx+dy*dy) / e.frameState.viewState.resolution;\r\n      \r\n        if (d<5) {\r\n          return { \r\n            feature: current, \r\n            hit: p, \r\n            coordinates: current.getGeometry().getCoordinates(),\r\n            geom: current.getGeometry().clone(),\r\n            geomType: typeGeom\r\n          }\r\n        } else {\r\n          return false;\r\n        }\r\n      } else {\r\n        return false;\r\n      }\r\n\t\t},  { hitTolerance: 5 });\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} e Map browser event.\r\n * @return {boolean} `true` to start the drag sequence.\r\n * @private\r\n */\r\nol_interaction_Offset.prototype.handleDownEvent_ = function(e) {\t\r\n  this.current_ = this.getFeatureAtPixel_(e);\r\n  if (this.current_) {\r\n    this.currentStyle_ = this.current_.feature.getStyle();\r\n    this.current_.feature.setStyle(this._style(this.current_.feature));\r\n    if (this.source_ && (this.get('duplicate') || e.originalEvent.ctrlKey)) {\r\n      this.current_.feature = this.current_.feature.clone();\r\n      this.source_.addFeature(this.current_.feature);\r\n    } else {\r\n      // Modify the current feature\r\n      this.dispatchEvent({ type:'modifystart', features: [ this.current_.feature ] });\r\n    }\r\n    this.dispatchEvent({ type:'offsetstart', feature: this.current_.feature, offset: 0 });\r\n    return true;\r\n  } else  {\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} e Map browser event.\r\n * @private\r\n */\r\nol_interaction_Offset.prototype.handleDragEvent_ = function(e) {\r\n  var p = this.current_.geom.getClosestPoint(e.coordinate);\r\n  var d = ol_coordinate_dist2d(p, e.coordinate);\r\n  var seg, v1, v2, offset;\r\n  switch (this.current_.geomType) {\r\n    case  'Polygon': {\r\n      seg = ol_coordinate_findSegment(p, this.current_.coordinates[0]).segment;\r\n      if (seg) {\r\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\r\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\r\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\r\n          d = -d;\r\n        }\r\n\r\n        offset = [];\r\n        for (var i=0; i<this.current_.coordinates.length; i++) {\r\n          offset.push( ol_coordinate_offsetCoords(this.current_.coordinates[i], i==0 ? d : -d) );\r\n        }\r\n        this.current_.feature.setGeometry(new ol_geom_Polygon(offset));\r\n      }\r\n      break;\r\n    }\r\n    case 'LineString': {\r\n      seg = ol_coordinate_findSegment(p, this.current_.coordinates).segment;\r\n      if (seg) {\r\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\r\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\r\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\r\n          d = -d;\r\n        }\r\n        offset = ol_coordinate_offsetCoords(this.current_.coordinates, d);\r\n        this.current_.feature.setGeometry(new ol_geom_LineString(offset));\r\n      }\r\n      break;\r\n    }\r\n    default: {\r\n      break;\r\n    }\r\n  }\r\n  this.dispatchEvent({ type:'offsetting', feature: this.current_.feature, offset: d, segment: [p, e.coordinate], coordinate: e.coordinate });  \r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} e Map browser event.\r\n * @private\r\n */\r\nol_interaction_Offset.prototype.handleUpEvent_ = function(e) {\r\n  this.dispatchEvent({ type:'offsetend', feature: this.current_.feature, coordinate: e.coordinate }); \r\n  this.current_.feature.setStyle(this.currentStyle_);\r\n  this.current_ = false;\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} e Event.\r\n * @private\r\n */\r\nol_interaction_Offset.prototype.handleMoveEvent_ = function(e) {\t\r\n  var f = this.getFeatureAtPixel_(e);\r\n  if (f) {\r\n    if (this.previousCursor_ === false) {\r\n      this.previousCursor_ = e.map.getTargetElement().style.cursor;\r\n    }\r\n    e.map.getTargetElement().style.cursor = 'pointer';\r\n  } else {\r\n    e.map.getTargetElement().style.cursor = this.previousCursor_;\r\n    this.previousCursor_ = false;\r\n  }\r\n};\r\n\r\nexport default ol_interaction_Offset\r\n","/** Vanilla JS helper to manipulate DOM without jQuery\r\n * @see https://github.com/nefe/You-Dont-Need-jQuery\r\n * @see https://plainjs.com/javascript/\r\n * @see http://youmightnotneedjquery.com/\r\n */\r\n var ol_ext_element = {};\r\n\r\n/**\r\n * Create an element\r\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\r\n * @param {*} options\r\n *  @param {string} options.className className The element class name \r\n *  @param {Element} options.parent Parent to append the element as child\r\n *  @param {Element|string} options.html Content of the element\r\n *  @param {string} options.* Any other attribut to add to the element\r\n */\r\nol_ext_element.create = function (tagName, options) {\r\n  options = options || {};\r\n  var elt;\r\n  // Create text node\r\n  if (tagName === 'TEXT') {\r\n    elt = document.createTextNode(options.html||'');\r\n    if (options.parent) options.parent.appendChild(elt);\r\n  } else {\r\n    // Other element\r\n    elt = document.createElement(tagName);\r\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\r\n    for (var attr in options) {\r\n      switch (attr) {\r\n        case 'className': {\r\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\r\n          break;\r\n        }\r\n        case 'html': {\r\n          if (options.html instanceof Element) elt.appendChild(options.html)\r\n          else if (options.html!==undefined) elt.innerHTML = options.html;\r\n          break;\r\n        }\r\n        case 'parent': {\r\n          if (options.parent) options.parent.appendChild(elt);\r\n          break;\r\n        }\r\n        case 'style': {\r\n          this.setStyle(elt, options.style);\r\n          break;\r\n        }\r\n        case 'change':\r\n        case 'click': {\r\n          ol_ext_element.addListener(elt, attr, options[attr]);\r\n          break;\r\n        }\r\n        case 'on': {\r\n          for (var e in options.on) {\r\n            ol_ext_element.addListener(elt, e, options.on[e]);\r\n          }\r\n          break;\r\n        }\r\n        case 'checked': {\r\n          elt.checked = !!options.checked;\r\n          break;\r\n        }\r\n        default: {\r\n          elt.setAttribute(attr, options[attr]);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return elt;\r\n};\r\n\r\n/** Set inner html or append a child element to an element\r\n * @param {Element} element\r\n * @param {Element|string} html Content of the element\r\n */\r\nol_ext_element.setHTML = function(element, html) {\r\n  if (html instanceof Element) element.appendChild(html)\r\n  else if (html!==undefined) element.innerHTML = html;\r\n};\r\n\r\n/** Append text into an elemnt\r\n * @param {Element} element\r\n * @param {string} text text content\r\n */\r\nol_ext_element.appendText = function(element, text) {\r\n  element.appendChild(document.createTextNode(text||''));\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.addListener = function (element, eventType, fn) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.addEventListener(e, fn);\r\n  });\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.removeListener = function (element, eventType, fn) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.removeEventListener(e, fn);\r\n  });\r\n};\r\n\r\n/**\r\n * Show an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.show = function (element) {\r\n  element.style.display = '';\r\n};\r\n\r\n/**\r\n * Hide an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.hide = function (element) {\r\n  element.style.display = 'none';\r\n};\r\n\r\n/**\r\n * Test if an element is hihdden\r\n * @param {Element} element\r\n * @return {boolean}\r\n */\r\nol_ext_element.hidden = function (element) {\r\n  return ol_ext_element.getStyle(element, 'display') === 'none';\r\n};\r\n\r\n/**\r\n * Toggle an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.toggle = function (element) {\r\n  element.style.display = (element.style.display==='none' ? '' : 'none');\r\n};\r\n\r\n/** Set style of an element\r\n * @param {DOMElement} el the element\r\n * @param {*} st list of style\r\n */\r\nol_ext_element.setStyle = function(el, st) {\r\n  for (var s in st) {\r\n    switch (s) {\r\n      case 'top':\r\n      case 'left':\r\n      case 'bottom':\r\n      case 'right':\r\n      case 'minWidth':\r\n      case 'maxWidth':\r\n      case 'width':\r\n      case 'height': {\r\n        if (typeof(st[s]) === 'number') {\r\n          el.style[s] = st[s]+'px';\r\n        } else {\r\n          el.style[s] = st[s];\r\n        }\r\n        break;\r\n      }\r\n      default: {\r\n        el.style[s] = st[s];\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get style propertie of an element\r\n * @param {DOMElement} el the element\r\n * @param {string} styleProp Propertie name\r\n * @return {*} style value\r\n */\r\nol_ext_element.getStyle = function(el, styleProp) {\r\n  var value, defaultView = (el.ownerDocument || document).defaultView;\r\n  // W3C standard way:\r\n  if (defaultView && defaultView.getComputedStyle) {\r\n    // sanitize property name to css notation\r\n    // (hypen separated words eg. font-Size)\r\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\r\n  } else if (el.currentStyle) { // IE\r\n    // sanitize property name to camelCase\r\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\r\n      return letter.toUpperCase();\r\n    });\r\n    value = el.currentStyle[styleProp];\r\n    // convert other units to pixels on IE\r\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \r\n      return (function(value) {\r\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\r\n        el.runtimeStyle.left = el.currentStyle.left;\r\n        el.style.left = value || 0;\r\n        value = el.style.pixelLeft + \"px\";\r\n        el.style.left = oldLeft;\r\n        el.runtimeStyle.left = oldRsLeft;\r\n        return value;\r\n      })(value);\r\n    }\r\n  }\r\n  if (/px$/.test(value)) return parseInt(value);\r\n  return value;\r\n};\r\n\r\n/** Get outerHeight of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerHeight = function(elt) {\r\n  return elt.offsetHeight + ol_ext_element.getStyle(elt, 'marginBottom')\r\n};\r\n\r\n/** Get outerWidth of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerWidth = function(elt) {\r\n  return elt.offsetWidth + ol_ext_element.getStyle(elt, 'marginLeft')\r\n};\r\n\r\n/** Get element offset rect\r\n * @param {DOMElement} elt\r\n * @return {*} \r\n */\r\nol_ext_element.offsetRect = function(elt) {\r\n  var rect = elt.getBoundingClientRect();\r\n  return {\r\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\r\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\r\n    height: rect.height || (rect.bottom - rect.top),\r\n    width: rect.widtth || (rect.right - rect.left)\r\n  }\r\n};\r\n\r\n/** Make a div scrollable without scrollbar.\r\n * On touch devices the default behavior is preserved\r\n * @param {DOMElement} elt\r\n * @param {function} onmove a function that takes a boolean indicating that the div is scrolling\r\n */\r\nol_ext_element.scrollDiv = function(elt, options) {\r\n  var pos = false;\r\n  var speed = 0;\r\n  var d, dt = 0;\r\n\r\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\r\n  var page = options.vertical ? 'pageY' : 'pageX';\r\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\r\n  var moving = false;\r\n\r\n  // Prevent image dragging\r\n  elt.querySelectorAll('img').forEach(function(i) {\r\n    i.ondragstart = function(){ return false; };\r\n  });\r\n  \r\n  // Start scrolling\r\n  ol_ext_element.addListener(elt, ['mousedown'], function(e) {\r\n    moving = false;\r\n    pos = e[page];\r\n    dt = new Date();\r\n    elt.classList.add('ol-move');\r\n  });\r\n  \r\n  // Register scroll\r\n  ol_ext_element.addListener(window, ['mousemove'], function(e) {\r\n    moving = true;\r\n    if (pos !== false) {\r\n      var delta = pos - e[page];\r\n      elt[scroll] += delta;\r\n      d = new Date();\r\n      if (d-dt) {\r\n        speed = (speed + delta / (d - dt))/2;\r\n      }\r\n      pos = e[page];\r\n      dt = d;\r\n      // Tell we are moving\r\n      if (delta) onmove(true);\r\n    } else {\r\n      // Not moving yet\r\n      onmove(false);\r\n    }\r\n  });\r\n  \r\n  // Stop scrolling\r\n  ol_ext_element.addListener(window, ['mouseup'], function(e) {\r\n    if (moving) setTimeout (function() { elt.classList.remove('ol-move'); });\r\n    else elt.classList.remove('ol-move');\r\n    moving = false;\r\n    dt = new Date() - dt;\r\n    if (dt>100) {\r\n      // User stop: no speed\r\n      speed = 0;\r\n    } else if (dt>0) {\r\n      // Calculate new speed\r\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\r\n    }\r\n    elt[scroll] += speed*100;\r\n    pos = false;\r\n    speed = 0;\r\n    dt = 0;\r\n  });\r\n\r\n  // Handle mousewheel\r\n  if (options.mousewheel && !elt.classList.contains('ol-touch')) {\r\n    ol_ext_element.addListener(elt, \r\n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n      function(e) {\r\n        var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\r\n        elt.classList.add('ol-move');\r\n        elt[scroll] -= delta*30;\r\n        elt.classList.remove('ol-move');\r\n        return false;\r\n      }\r\n    );\r\n  }\r\n};\r\n\r\n/** Dispatch an event to an Element \r\n * @param {string} eventName\r\n * @param {Element} element\r\n*/\r\nol_ext_element.dispatchEvent = function (eventName, element) {\r\n  var event;\r\n  try {\r\n    event = new CustomEvent(eventName);\r\n  } catch(e) {\r\n    // Try customevent on IE\r\n    event = document.createEvent(\"CustomEvent\");\r\n    event.initCustomEvent(eventName, true, true, {});\r\n  }\r\n  element.dispatchEvent(event);\r\n};\r\n\r\nexport default ol_ext_element\r\n","/**\n * @module ol/MapEvent\n */\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map event.\n */\nvar MapEvent = /*@__PURE__*/(function (Event) {\n  function MapEvent(type, map, opt_frameState) {\n\n    Event.call(this, type);\n\n    /**\n     * The map where the event occurred.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @api\n     */\n    this.map = map;\n\n    /**\n     * The frame state at the time of the event.\n     * @type {?import(\"./PluggableMap.js\").FrameState}\n     * @api\n     */\n    this.frameState = opt_frameState !== undefined ? opt_frameState : null;\n\n  }\n\n  if ( Event ) MapEvent.__proto__ = Event;\n  MapEvent.prototype = Object.create( Event && Event.prototype );\n  MapEvent.prototype.constructor = MapEvent;\n\n  return MapEvent;\n}(Event));\n\nexport default MapEvent;\n\n//# sourceMappingURL=MapEvent.js.map","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object.ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange'\n};\n\n//# sourceMappingURL=ObjectEventType.js.map","/**\n * @module ol/ImageTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\n\n\nvar ImageTile = /*@__PURE__*/(function (Tile) {\n  function ImageTile(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n\n    Tile.call(this, tileCoord, state, opt_options);\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ = crossOrigin;\n\n    /**\n     * Image URI\n     *\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.imageListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction_ = tileLoadFunction;\n\n  }\n\n  if ( Tile ) ImageTile.__proto__ = Tile;\n  ImageTile.prototype = Object.create( Tile && Tile.prototype );\n  ImageTile.prototype.constructor = ImageTile;\n\n  /**\n   * @inheritDoc\n   */\n  ImageTile.prototype.disposeInternal = function disposeInternal () {\n    if (this.state == TileState.LOADING) {\n      this.unlistenImage_();\n      this.image_ = getBlankImage();\n    }\n    if (this.interimTile) {\n      this.interimTile.dispose();\n    }\n    this.state = TileState.ABORT;\n    this.changed();\n    Tile.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  ImageTile.prototype.getImage = function getImage () {\n    return this.image_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  ImageTile.prototype.getKey = function getKey () {\n    return this.src_;\n  };\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  ImageTile.prototype.handleImageError_ = function handleImageError_ () {\n    this.state = TileState.ERROR;\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n    this.changed();\n  };\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  ImageTile.prototype.handleImageLoad_ = function handleImageLoad_ () {\n    var image = /** @type {HTMLImageElement} */ (this.image_);\n    if (image.naturalWidth && image.naturalHeight) {\n      this.state = TileState.LOADED;\n    } else {\n      this.state = TileState.EMPTY;\n    }\n    this.unlistenImage_();\n    this.changed();\n  };\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  ImageTile.prototype.load = function load () {\n    if (this.state == TileState.ERROR) {\n      this.state = TileState.IDLE;\n      this.image_ = new Image();\n      if (this.crossOrigin_ !== null) {\n        this.image_.crossOrigin = this.crossOrigin_;\n      }\n    }\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n      this.imageListenerKeys_ = [\n        listenOnce(this.image_, EventType.ERROR,\n          this.handleImageError_, this),\n        listenOnce(this.image_, EventType.LOAD,\n          this.handleImageLoad_, this)\n      ];\n      this.tileLoadFunction_(this, this.src_);\n    }\n  };\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  ImageTile.prototype.unlistenImage_ = function unlistenImage_ () {\n    this.imageListenerKeys_.forEach(unlistenByKey);\n    this.imageListenerKeys_ = null;\n  };\n\n  return ImageTile;\n}(Tile));\n\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  var ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n\n//# sourceMappingURL=ImageTile.js.map","/**\n * @module ol/AssertionError\n */\nimport {VERSION} from './util.js';\n\n/**\n * Error object thrown when an assertion failed. This is an ECMA-262 Error,\n * extended with a `code` property.\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error.\n */\nvar AssertionError = /*@__PURE__*/(function (Error) {\n  function AssertionError(code) {\n    var path = VERSION === 'latest' ? VERSION : 'v' + VERSION.split('-')[0];\n    var message = 'Assertion failed. See https://openlayers.org/en/' + path +\n    '/doc/errors/#' + code + ' for details.';\n\n    Error.call(this, message);\n\n    /**\n     * Error code. The meaning of the code can be found on\n     * https://openlayers.org/en/latest/doc/errors/ (replace `latest` with\n     * the version found in the OpenLayers script's header comment if a version\n     * other than the latest is used).\n     * @type {number}\n     * @api\n     */\n    this.code = code;\n\n    /**\n     * @type {string}\n     */\n    this.name = 'AssertionError';\n\n    // Re-assign message, see https://github.com/Rich-Harris/buble/issues/40\n    this.message = message;\n  }\n\n  if ( Error ) AssertionError.__proto__ = Error;\n  AssertionError.prototype = Object.create( Error && Error.prototype );\n  AssertionError.prototype.constructor = AssertionError;\n\n  return AssertionError;\n}(Error));\n\nexport default AssertionError;\n\n//# sourceMappingURL=AssertionError.js.map","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3\n};\n\n//# sourceMappingURL=ImageState.js.map","/**\n * @module ol/TileCache\n */\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\nvar TileCache = /*@__PURE__*/(function (LRUCache) {\n  function TileCache(opt_highWaterMark) {\n\n    LRUCache.call(this, opt_highWaterMark);\n\n  }\n\n  if ( LRUCache ) TileCache.__proto__ = LRUCache;\n  TileCache.prototype = Object.create( LRUCache && LRUCache.prototype );\n  TileCache.prototype.constructor = TileCache;\n\n  /**\n   * @param {!Object<string, import(\"./TileRange.js\").default>} usedTiles Used tiles.\n   */\n  TileCache.prototype.expireCache = function expireCache (usedTiles) {\n    while (this.canExpireCache()) {\n      var tile = this.peekLast();\n      var zKey = tile.tileCoord[0].toString();\n      if (zKey in usedTiles && usedTiles[zKey].contains(tile.tileCoord)) {\n        break;\n      } else {\n        this.pop().dispose();\n      }\n    }\n  };\n\n  /**\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\n   */\n  TileCache.prototype.pruneExceptNewestZ = function pruneExceptNewestZ () {\n    if (this.getCount() === 0) {\n      return;\n    }\n    var key = this.peekFirstKey();\n    var tileCoord = fromKey(key);\n    var z = tileCoord[0];\n    this.forEach(function(tile) {\n      if (tile.tileCoord[0] !== z) {\n        this.remove(getKey(tile.tileCoord));\n        tile.dispose();\n      }\n    }, this);\n  };\n\n  return TileCache;\n}(LRUCache));\n\n\nexport default TileCache;\n\n//# sourceMappingURL=TileCache.js.map","/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \r\n\treleased under the CeCILL-B license (French BSD license)\r\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\n\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_interaction_Select from 'ol/interaction/Select'\r\nimport ol_source_Vector from 'ol/source/Vector'\r\n\r\n/** A Select interaction to delete features on click.\r\n * @constructor\r\n * @extends {ol_interaction_Interaction}\r\n * @fires deletestart\r\n * @fires deleteend\r\n * @param {*} options ol.interaction.Select options\r\n */\r\nvar ol_interaction_Delete = function(options) {\r\n  ol_interaction_Select.call(this, options);\r\n  this.on('select', function(e) {\r\n    this.getFeatures().clear();\r\n    this.delete(e.selected);\r\n  }.bind(this));\r\n};\r\nol_ext_inherits(ol_interaction_Delete, ol_interaction_Select);\r\n\r\n/** Get vector source of the map\r\n * @return {Array<ol.source.Vector>}\r\n */\r\nol_interaction_Delete.prototype._getSources = function(layers) {\r\n  if (!this.getMap()) return [];\r\n  if (!layers) layers = this.getMap().getLayers();\r\n  var sources = [];\r\n  layers.forEach(function (l) {\r\n    // LayerGroup\r\n    if (l.getLayers) {\r\n      sources = sources.concat(this._getSources(l.getLayers()));\r\n    } else {\r\n      if (l.getSource && l.getSource() instanceof ol_source_Vector) {\r\n        sources.push(l.getSource());\r\n      }\r\n    }\r\n  }.bind(this));\r\n  return sources;\r\n};\r\n\r\n/** Delete features: remove the features from the map (from all layers in the map)\r\n * @param {ol.Collection<ol.Feature>|Array<ol.Feature>} features The features to delete\r\n * @api\r\n */\r\nol_interaction_Delete.prototype.delete = function(features) {\r\n  if (features && (features.length || features.getLength())) {\r\n    this.dispatchEvent({ type: 'deletestart', features: features });\r\n    var delFeatures = [];\r\n    // Get the sources concerned\r\n    this._getSources().forEach(function (source) {\r\n      try {\r\n        // Try to delete features in the source\r\n        features.forEach(function(f) {\r\n          source.removeFeature(f);\r\n          delFeatures.push(f);\r\n        });\r\n      } catch(e) { /* ok */ }\r\n    })\r\n    this.dispatchEvent({ type: 'deleteend', features: delFeatures });\r\n  }\r\n};\r\n\r\nexport default ol_interaction_Delete","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n\r\n  Usefull function to handle geometric operations\r\n*/\r\n\r\nimport {getCenter as ol_extent_getCenter} from 'ol/extent'\r\n\r\n/** Distance beetween 2 points\r\n *\tUsefull geometric functions\r\n * @param {ol.Coordinate} p1 first point\r\n * @param {ol.Coordinate} p2 second point\r\n * @return {number} distance\r\n */\r\nvar ol_coordinate_dist2d = function(p1, p2) {\r\n  var dx = p1[0]-p2[0];\r\n  var dy = p1[1]-p2[1];\r\n  return Math.sqrt(dx*dx+dy*dy);\r\n}\r\n\r\n/** 2 points are equal\r\n *\tUsefull geometric functions\r\n * @param {ol.Coordinate} p1 first point\r\n * @param {ol.Coordinate} p2 second point\r\n * @return {boolean}\r\n */\r\nvar ol_coordinate_equal = function(p1, p2) {\r\n  return (p1[0]==p2[0] && p1[1]==p2[1]);\r\n}\r\n\r\n/** Get center coordinate of a feature\r\n * @param {ol.Feature} f\r\n * @return {ol.coordinate} the center\r\n */\r\nvar ol_coordinate_getFeatureCenter = function(f) {\r\n  return ol_coordinate_getGeomCenter (f.getGeometry());\r\n};\r\n\r\n/** Get center coordinate of a geometry\r\n* @param {ol.Feature} geom\r\n* @return {ol.Coordinate} the center\r\n*/\r\nvar ol_coordinate_getGeomCenter = function(geom) {\r\n  switch (geom.getType()) {\r\n    case 'Point': \r\n      return geom.getCoordinates();\r\n    case \"MultiPolygon\":\r\n            geom = geom.getPolygon(0);\r\n            // fallthrough\r\n    case \"Polygon\":\r\n      return geom.getInteriorPoint().getCoordinates();\r\n    default:\r\n      return geom.getClosestPoint(ol_extent_getCenter(geom.getExtent()));\r\n  }\r\n};\r\n\r\n/** Offset a polyline\r\n * @param {Array<ol.Coordinate>} coords\r\n * @param {number} offset\r\n * @return {Array<ol.Coordinate>} resulting coord\r\n * @see http://stackoverflow.com/a/11970006/796832\r\n * @see https://drive.google.com/viewerng/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnxqa2dhZGdldHN0b3JlfGd4OjQ4MzI5M2Y0MjNmNzI2MjY\r\n */\r\nvar ol_coordinate_offsetCoords = function (coords, offset) {\r\n  var path = [];\r\n  var N = coords.length-1;\r\n  var max = N;\r\n  var mi, mi1, li, li1, ri, ri1, si, si1, Xi1, Yi1;\r\n  var p0, p1, p2;\r\n  var isClosed = ol_coordinate_equal(coords[0],coords[N]);\r\n  if (!isClosed) {\r\n    p0 = coords[0];\r\n    p1 = coords[1];\r\n    p2 = [\r\n      p0[0] + (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\r\n      p0[1] - (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\r\n    ];\r\n    path.push(p2);\r\n    coords.push(coords[N])\r\n    N++;\r\n    max--;\r\n  }\r\n  for (var i = 0; i < max; i++) {\r\n    p0 = coords[i];\r\n    p1 = coords[(i+1) % N];\r\n    p2 = coords[(i+2) % N];\r\n\r\n    mi = (p1[1] - p0[1])/(p1[0] - p0[0]);\r\n    mi1 = (p2[1] - p1[1])/(p2[0] - p1[0]);\r\n    // Prevent alignements\r\n    if (Math.abs(mi-mi1) > 1e-10) {\r\n      li = Math.sqrt((p1[0] - p0[0])*(p1[0] - p0[0])+(p1[1] - p0[1])*(p1[1] - p0[1]));\r\n      li1 = Math.sqrt((p2[0] - p1[0])*(p2[0] - p1[0])+(p2[1] - p1[1])*(p2[1] - p1[1]));\r\n      ri = p0[0] + offset*(p1[1] - p0[1])/li;\r\n      ri1 = p1[0] + offset*(p2[1] - p1[1])/li1;\r\n      si = p0[1] - offset*(p1[0] - p0[0])/li;\r\n      si1 = p1[1] - offset*(p2[0] - p1[0])/li1;\r\n      Xi1 = (mi1*ri1-mi*ri+si-si1) / (mi1-mi);\r\n      Yi1 = (mi*mi1*(ri1-ri)+mi1*si-mi*si1) / (mi1-mi);\r\n\r\n      // Correction for vertical lines\r\n      if(p1[0] - p0[0] == 0) {\r\n        Xi1 = p1[0] + offset*(p1[1] - p0[1])/Math.abs(p1[1] - p0[1]);\r\n        Yi1 = mi1*Xi1 - mi1*ri1 + si1;\r\n      }\r\n      if (p2[0] - p1[0] == 0 ) {\r\n        Xi1 = p2[0] + offset*(p2[1] - p1[1])/Math.abs(p2[1] - p1[1]);\r\n        Yi1 = mi*Xi1 - mi*ri + si;\r\n      }\r\n\r\n      path.push([Xi1, Yi1]);\r\n    }\r\n  }\r\n  if (isClosed) {\r\n    path.push(path[0]);\r\n  } else {\r\n    coords.pop();\r\n    p0 = coords[coords.length-1];\r\n    p1 = coords[coords.length-2];\r\n    p2 = [\r\n      p0[0] - (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\r\n      p0[1] + (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\r\n    ];\r\n    path.push(p2);\r\n  }\r\n  return path;\r\n}\r\n\r\n/** Find the segment a point belongs to\r\n * @param {ol.Coordinate} pt\r\n * @param {Array<ol.Coordinate>} coords\r\n * @return {} the index (-1 if not found) and the segment\r\n */\r\nvar ol_coordinate_findSegment = function (pt, coords) {\r\n  for (var i=0; i<coords.length-1; i++) {\r\n    var p0 = coords[i];\r\n    var p1 = coords[i+1];\r\n    if (ol_coordinate_equal(pt, p0) || ol_coordinate_equal(pt, p1)) {\r\n      return { index:1, segment: [p0,p1] };\r\n    } else {\r\n      var d0 = ol_coordinate_dist2d(p0,p1);\r\n      var v0 = [ (p1[0] - p0[0]) / d0, (p1[1] - p0[1]) / d0 ];\r\n      var d1 = ol_coordinate_dist2d(p0,pt);\r\n      var v1 = [ (pt[0] - p0[0]) / d1, (pt[1] - p0[1]) / d1 ];\r\n      if (Math.abs(v0[0]*v1[1] - v0[1]*v1[0]) < 1e-10) {\r\n        return { index:1, segment: [p0,p1] };\r\n      }\r\n    }\r\n  }\r\n  return { index: -1 };\r\n};\r\n\r\n/**\r\n * Split a Polygon geom with horizontal lines\r\n * @param {Array<ol.Coordinate>} geom\r\n * @param {number} y the y to split\r\n * @param {number} n contour index\r\n * @return {Array<Array<ol.Coordinate>>}\r\n */\r\nvar ol_coordinate_splitH = function (geom, y, n) {\r\n  var x, abs;\r\n  var list = [];\r\n  for (var i=0; i<geom.length-1; i++) {\r\n    // Hole separator?\r\n    if (!geom[i].length || !geom[i+1].length) continue;\r\n    // Intersect\r\n    if (geom[i][1]<=y && geom[i+1][1]>y || geom[i][1]>=y && geom[i+1][1]<y) {\r\n      abs = (y-geom[i][1]) / (geom[i+1][1]-geom[i][1]);\r\n      x = abs * (geom[i+1][0]-geom[i][0]) + geom[i][0];\r\n      list.push ({ contour: n, index: i, pt: [x,y], abs: abs });\r\n    }\r\n  }\r\n  // Sort x\r\n  list.sort(function(a,b) { return a.pt[0] - b.pt[0] });\r\n  // Horizontal segment\r\n  var result = [];\r\n  for (var j=0; j<list.length-1; j += 2) {\r\n    result.push([list[j], list[j+1]])\r\n  }\r\n  return result;\r\n};\r\n\r\nimport ol_geom_LineString from 'ol/geom/LineString'\r\nimport ol_geom_LinearRing from 'ol/geom/LinearRing'\r\nimport ol_geom_MultiLineString from 'ol/geom/MultiLineString'\r\nimport ol_geom_MultiPoint from 'ol/geom/MultiPoint'\r\nimport ol_geom_MultiPolygon from 'ol/geom/MultiPolygon'\r\nimport ol_geom_Point from 'ol/geom/Point'\r\nimport ol_geom_Polygon from 'ol/geom/Polygon'\r\n\r\n/** Create a geometry given a type and coordinates */\r\nvar ol_geom_createFromType = function (type, coordinates) {\r\n  switch (type) {\r\n    case 'LineString': return new ol_geom_LineString(coordinates);\r\n    case 'LinearRing': return new ol_geom_LinearRing(coordinates);\r\n    case 'MultiLineString': return new ol_geom_MultiLineString(coordinates);\r\n    case 'MultiPoint': return new ol_geom_MultiPoint(coordinates);\r\n    case 'MultiPolygon': return new ol_geom_MultiPolygon(coordinates);\r\n    case 'Point': return new ol_geom_Point(coordinates);\r\n    case 'Polygon': return new ol_geom_Polygon(coordinates);\r\n    default:\r\n      console.error('[createFromType] Unsupported type: '+type);\r\n      return null;\r\n  }\r\n};\r\n\r\nexport {ol_geom_createFromType}\r\nexport {ol_coordinate_dist2d, ol_coordinate_equal, ol_coordinate_findSegment, ol_coordinate_getFeatureCenter, ol_coordinate_getGeomCenter, ol_coordinate_offsetCoords, ol_coordinate_splitH}\r\n\r\n/** Intersect 2 lines\r\n * @param {Arrar<ol.coordinate>} d1\r\n * @param {Arrar<ol.coordinate>} d2\r\n */\r\nvar ol_coordinate_getIntersectionPoint = function (d1, d2) {\r\n  var d1x = d1[1][0] - d1[0][0];\r\n  var d1y = d1[1][1] - d1[0][1];\r\n  var d2x = d2[1][0] - d2[0][0];\r\n  var d2y = d2[1][1] - d2[0][1];\r\n  var det = d1x * d2y - d1y * d2x;\r\n  if (det != 0) {\r\n    var k = (d1x * d1[0][1] - d1x * d2[0][1] - d1y * d1[0][0] + d1y * d2[0][0]) / det;\r\n    return [d2[0][0] + k*d2x, d2[0][1] + k*d2y];\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nexport { ol_coordinate_getIntersectionPoint }\r\n","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation'\n};\n\n//# sourceMappingURL=ViewProperty.js.map","/**\n * @module ol/View\n */\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {getUid} from './util.js';\nimport {VOID} from './functions.js';\nimport {createExtent, none as centerNone} from './centerconstraint.js';\nimport BaseObject from './Object.js';\nimport {createSnapToResolutions, createSnapToPower} from './resolutionconstraint.js';\nimport {createSnapToZero, createSnapToN, none as rotationNone, disable} from './rotationconstraint.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {linearFindNearest} from './array.js';\nimport {assert} from './asserts.js';\nimport {add as addCoordinate, rotate as rotateCoordinate, equals as coordinatesEqual} from './coordinate.js';\nimport {inAndOut} from './easing.js';\nimport {getForViewAndSize, getCenter, getHeight, getWidth, isEmpty} from './extent.js';\nimport GeometryType from './geom/GeometryType.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\nimport {clamp, modulo} from './math.js';\nimport {assign} from './obj.js';\nimport {createProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\n\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {import(\"./coordinate.js\").Coordinate} [sourceCenter]\n * @property {import(\"./coordinate.js\").Coordinate} [targetCenter]\n * @property {number} [sourceResolution]\n * @property {number} [targetResolution]\n * @property {number} [sourceRotation]\n * @property {number} [targetRotation]\n * @property {import(\"./coordinate.js\").Coordinate} [anchor]\n * @property {number} start\n * @property {number} duration\n * @property {boolean} complete\n * @property {function(number):number} easing\n * @property {function(boolean)} callback\n */\n\n\n/**\n * @typedef {Object} Constraints\n * @property {import(\"./centerconstraint.js\").Type} center\n * @property {import(\"./resolutionconstraint.js\").Type} resolution\n * @property {import(\"./rotationconstraint.js\").Type} rotation\n */\n\n\n/**\n * @typedef {Object} FitOptions\n * @property {import(\"./size.js\").Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [constrainResolution=true] Constrain the resolution.\n * @property {boolean} [nearest=false] If `constrainResolution` is `true`, get\n * the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean)} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n\n/**\n * @typedef {Object} ViewOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The initial center for\n * the view. The coordinate system for the center is specified with the\n * `projection` option. Layer sources will not be fetched if this is not set,\n * but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {import(\"./extent.js\").Extent} [extent] The extent that constrains the\n * center, in other words, center cannot be set outside this extent.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {import(\"./proj.js\").ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array<number>} [resolutions] Resolutions to determine the\n * resolution constraint. If set the `maxResolution`, `minResolution`,\n * `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view. The initial\n * resolution is determined using the {@link #constrainResolution} method.\n * @property {number} [zoomFactor=2] The zoom factor used to determine the\n * resolution constraint.\n */\n\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The center of the view at the end of\n * the animation.\n * @property {number} [zoom] The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number} [resolution] The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number} [rotation] The rotation of the view at the end of\n * the animation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Optional anchor to remained fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {import(\"./coordinate.js\").Coordinate} center\n * @property {import(\"./proj/Projection.js\").default} projection\n * @property {number} resolution\n * @property {number} rotation\n * @property {number} zoom\n */\n\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nvar DEFAULT_MIN_ZOOM = 0;\n\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * ### The view states\n *\n * An View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * An View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Spherical Mercator (EPSG:3857).\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view. Any value can be passed to the setters. And the value\n * that is passed to a setter will effectively be the value set in the view,\n * and returned by the corresponding getter.\n *\n * But a View object also has a *resolution constraint*, a\n * *rotation constraint* and a *center constraint*.\n *\n * As said above, no constraints are applied when the setters are used to set\n * new states for the view. Applying constraints is done explicitly through\n * the use of the `constrain*` functions (`constrainResolution` and\n * `constrainRotation` and `constrainCenter`).\n *\n * The main users of the constraints are the interactions and the\n * controls. For example, double-clicking on the map changes the view to\n * the \"next\" resolution. And releasing the fingers after pinch-zooming\n * snaps to the closest resolution (with an animation).\n *\n * The *resolution constraint* snaps to specific resolutions. It is\n * determined by the following options: `resolutions`, `maxResolution`,\n * `maxZoom`, and `zoomFactor`. If `resolutions` is set, the other three\n * options are ignored. See documentation for each option for more\n * information.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default the rotation value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the center is not constrained at all.\n *\n  * @api\n */\nvar View = /*@__PURE__*/(function (BaseObject) {\n  function View(opt_options) {\n    BaseObject.call(this);\n\n    var options = assign({}, opt_options);\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.hints_ = [0, 0];\n\n    /**\n     * @private\n     * @type {Array<Array<Animation>>}\n     */\n    this.animations_ = [];\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.updateAnimationKey_;\n\n    this.updateAnimations_ = this.updateAnimations_.bind(this);\n\n    /**\n     * @private\n     * @const\n     * @type {import(\"./proj/Projection.js\").default}\n     */\n    this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n    this.applyOptions_(options);\n  }\n\n  if ( BaseObject ) View.__proto__ = BaseObject;\n  View.prototype = Object.create( BaseObject && BaseObject.prototype );\n  View.prototype.constructor = View;\n\n  /**\n   * Set up the view with the given options.\n   * @param {ViewOptions} options View options.\n   */\n  View.prototype.applyOptions_ = function applyOptions_ (options) {\n\n    /**\n     * @type {Object<string, *>}\n     */\n    var properties = {};\n    properties[ViewProperty.CENTER] = options.center !== undefined ?\n      options.center : null;\n\n    var resolutionConstraintInfo = createResolutionConstraint(options);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n    /**\n     * @private\n     * @type {Array<number>|undefined}\n     */\n    this.resolutions_ = options.resolutions;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n    var centerConstraint = createCenterConstraint(options);\n    var resolutionConstraint = resolutionConstraintInfo.constraint;\n    var rotationConstraint = createRotationConstraint(options);\n\n    /**\n     * @private\n     * @type {Constraints}\n     */\n    this.constraints_ = {\n      center: centerConstraint,\n      resolution: resolutionConstraint,\n      rotation: rotationConstraint\n    };\n\n    if (options.resolution !== undefined) {\n      properties[ViewProperty.RESOLUTION] = options.resolution;\n    } else if (options.zoom !== undefined) {\n      properties[ViewProperty.RESOLUTION] = this.constrainResolution(\n        this.maxResolution_, options.zoom - this.minZoom_);\n\n      if (this.resolutions_) { // in case map zoom is out of min/max zoom range\n        properties[ViewProperty.RESOLUTION] = clamp(\n          Number(this.getResolution() || properties[ViewProperty.RESOLUTION]),\n          this.minResolution_, this.maxResolution_);\n      }\n    }\n    properties[ViewProperty.ROTATION] = options.rotation !== undefined ? options.rotation : 0;\n    this.setProperties(properties);\n\n    /**\n     * @private\n     * @type {ViewOptions}\n     */\n    this.options_ = options;\n\n  };\n\n  /**\n   * Get an updated version of the view options used to construct the view.  The\n   * current resolution (or zoom), center, and rotation are applied to any stored\n   * options.  The provided options can be used to apply new min/max zoom or\n   * resolution limits.\n   * @param {ViewOptions} newOptions New options to be applied.\n   * @return {ViewOptions} New options updated with the current view state.\n   */\n  View.prototype.getUpdatedOptions_ = function getUpdatedOptions_ (newOptions) {\n    var options = assign({}, this.options_);\n\n    // preserve resolution (or zoom)\n    if (options.resolution !== undefined) {\n      options.resolution = this.getResolution();\n    } else {\n      options.zoom = this.getZoom();\n    }\n\n    // preserve center\n    options.center = this.getCenter();\n\n    // preserve rotation\n    options.rotation = this.getRotation();\n\n    return assign({}, options, newOptions);\n  };\n\n  /**\n   * Animate the view.  The view's center, zoom (or resolution), and rotation\n   * can be animated for smooth transitions between view states.  For example,\n   * to animate the view to a new zoom level:\n   *\n   *     view.animate({zoom: view.getZoom() + 1});\n   *\n   * By default, the animation lasts one second and uses in-and-out easing.  You\n   * can customize this behavior by including `duration` (in milliseconds) and\n   * `easing` options (see {@link module:ol/easing}).\n   *\n   * To chain together multiple animations, call the method with multiple\n   * animation objects.  For example, to first zoom and then pan:\n   *\n   *     view.animate({zoom: 10}, {center: [0, 0]});\n   *\n   * If you provide a function as the last argument to the animate method, it\n   * will get called at the end of an animation series.  The callback will be\n   * called with `true` if the animation series completed on its own or `false`\n   * if it was cancelled.\n   *\n   * Animations are cancelled by user interactions (e.g. dragging the map) or by\n   * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n   * (or another method that calls one of these).\n   *\n   * @param {...(AnimationOptions|function(boolean))} var_args Animation\n   *     options.  Multiple animations can be run in series by passing multiple\n   *     options objects.  To run multiple animations in parallel, call the method\n   *     multiple times.  An optional callback can be provided as a final\n   *     argument.  The callback will be called with a boolean indicating whether\n   *     the animation completed without being cancelled.\n   * @api\n   */\n  View.prototype.animate = function animate (var_args) {\n    var arguments$1 = arguments;\n\n    var animationCount = arguments.length;\n    var callback;\n    if (animationCount > 1 && typeof arguments[animationCount - 1] === 'function') {\n      callback = arguments[animationCount - 1];\n      --animationCount;\n    }\n    if (!this.isDef()) {\n      // if view properties are not yet set, shortcut to the final state\n      var state = arguments[animationCount - 1];\n      if (state.center) {\n        this.setCenter(state.center);\n      }\n      if (state.zoom !== undefined) {\n        this.setZoom(state.zoom);\n      }\n      if (state.rotation !== undefined) {\n        this.setRotation(state.rotation);\n      }\n      if (callback) {\n        animationCallback(callback, true);\n      }\n      return;\n    }\n    var start = Date.now();\n    var center = this.getCenter().slice();\n    var resolution = this.getResolution();\n    var rotation = this.getRotation();\n    var series = [];\n    for (var i = 0; i < animationCount; ++i) {\n      var options = /** @type {AnimationOptions} */ (arguments$1[i]);\n\n      var animation = /** @type {Animation} */ ({\n        start: start,\n        complete: false,\n        anchor: options.anchor,\n        duration: options.duration !== undefined ? options.duration : 1000,\n        easing: options.easing || inAndOut\n      });\n\n      if (options.center) {\n        animation.sourceCenter = center;\n        animation.targetCenter = options.center;\n        center = animation.targetCenter;\n      }\n\n      if (options.zoom !== undefined) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = this.constrainResolution(\n          this.maxResolution_, options.zoom - this.minZoom_, 0);\n        resolution = animation.targetResolution;\n      } else if (options.resolution) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = options.resolution;\n        resolution = animation.targetResolution;\n      }\n\n      if (options.rotation !== undefined) {\n        animation.sourceRotation = rotation;\n        var delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n        animation.targetRotation = rotation + delta;\n        rotation = animation.targetRotation;\n      }\n\n      animation.callback = callback;\n\n      // check if animation is a no-op\n      if (isNoopAnimation(animation)) {\n        animation.complete = true;\n        // we still push it onto the series for callback handling\n      } else {\n        start += animation.duration;\n      }\n      series.push(animation);\n    }\n    this.animations_.push(series);\n    this.setHint(ViewHint.ANIMATING, 1);\n    this.updateAnimations_();\n  };\n\n  /**\n   * Determine if the view is being animated.\n   * @return {boolean} The view is being animated.\n   * @api\n   */\n  View.prototype.getAnimating = function getAnimating () {\n    return this.hints_[ViewHint.ANIMATING] > 0;\n  };\n\n  /**\n   * Determine if the user is interacting with the view, such as panning or zooming.\n   * @return {boolean} The view is being interacted with.\n   * @api\n   */\n  View.prototype.getInteracting = function getInteracting () {\n    return this.hints_[ViewHint.INTERACTING] > 0;\n  };\n\n  /**\n   * Cancel any ongoing animations.\n   * @api\n   */\n  View.prototype.cancelAnimations = function cancelAnimations () {\n    this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n    for (var i = 0, ii = this.animations_.length; i < ii; ++i) {\n      var series = this.animations_[i];\n      if (series[0].callback) {\n        animationCallback(series[0].callback, false);\n      }\n    }\n    this.animations_.length = 0;\n  };\n\n  /**\n   * Update all animations.\n   */\n  View.prototype.updateAnimations_ = function updateAnimations_ () {\n    if (this.updateAnimationKey_ !== undefined) {\n      cancelAnimationFrame(this.updateAnimationKey_);\n      this.updateAnimationKey_ = undefined;\n    }\n    if (!this.getAnimating()) {\n      return;\n    }\n    var now = Date.now();\n    var more = false;\n    for (var i = this.animations_.length - 1; i >= 0; --i) {\n      var series = this.animations_[i];\n      var seriesComplete = true;\n      for (var j = 0, jj = series.length; j < jj; ++j) {\n        var animation = series[j];\n        if (animation.complete) {\n          continue;\n        }\n        var elapsed = now - animation.start;\n        var fraction = animation.duration > 0 ? elapsed / animation.duration : 1;\n        if (fraction >= 1) {\n          animation.complete = true;\n          fraction = 1;\n        } else {\n          seriesComplete = false;\n        }\n        var progress = animation.easing(fraction);\n        if (animation.sourceCenter) {\n          var x0 = animation.sourceCenter[0];\n          var y0 = animation.sourceCenter[1];\n          var x1 = animation.targetCenter[0];\n          var y1 = animation.targetCenter[1];\n          var x = x0 + progress * (x1 - x0);\n          var y = y0 + progress * (y1 - y0);\n          this.set(ViewProperty.CENTER, [x, y]);\n        }\n        if (animation.sourceResolution && animation.targetResolution) {\n          var resolution = progress === 1 ?\n            animation.targetResolution :\n            animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);\n          if (animation.anchor) {\n            this.set(ViewProperty.CENTER,\n              this.calculateCenterZoom(resolution, animation.anchor));\n          }\n          this.set(ViewProperty.RESOLUTION, resolution);\n        }\n        if (animation.sourceRotation !== undefined && animation.targetRotation !== undefined) {\n          var rotation = progress === 1 ?\n            modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI :\n            animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);\n          if (animation.anchor) {\n            this.set(ViewProperty.CENTER,\n              this.calculateCenterRotate(rotation, animation.anchor));\n          }\n          this.set(ViewProperty.ROTATION, rotation);\n        }\n        more = true;\n        if (!animation.complete) {\n          break;\n        }\n      }\n      if (seriesComplete) {\n        this.animations_[i] = null;\n        this.setHint(ViewHint.ANIMATING, -1);\n        var callback = series[0].callback;\n        if (callback) {\n          animationCallback(callback, true);\n        }\n      }\n    }\n    // prune completed series\n    this.animations_ = this.animations_.filter(Boolean);\n    if (more && this.updateAnimationKey_ === undefined) {\n      this.updateAnimationKey_ = requestAnimationFrame(this.updateAnimations_);\n    }\n  };\n\n  /**\n   * @param {number} rotation Target rotation.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Rotation anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for rotation and anchor.\n   */\n  View.prototype.calculateCenterRotate = function calculateCenterRotate (rotation, anchor) {\n    var center;\n    var currentCenter = this.getCenter();\n    if (currentCenter !== undefined) {\n      center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n      rotateCoordinate(center, rotation - this.getRotation());\n      addCoordinate(center, anchor);\n    }\n    return center;\n  };\n\n  /**\n   * @param {number} resolution Target resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Zoom anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for resolution and anchor.\n   */\n  View.prototype.calculateCenterZoom = function calculateCenterZoom (resolution, anchor) {\n    var center;\n    var currentCenter = this.getCenter();\n    var currentResolution = this.getResolution();\n    if (currentCenter !== undefined && currentResolution !== undefined) {\n      var x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;\n      var y = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;\n      center = [x, y];\n    }\n    return center;\n  };\n\n  /**\n   * @private\n   * @return {import(\"./size.js\").Size} Viewport size or `[100, 100]` when no viewport is found.\n   */\n  View.prototype.getSizeFromViewport_ = function getSizeFromViewport_ () {\n    var size = [100, 100];\n    var selector = '.ol-viewport[data-view=\"' + getUid(this) + '\"]';\n    var element = document.querySelector(selector);\n    if (element) {\n      var metrics = getComputedStyle(element);\n      size[0] = parseInt(metrics.width, 10);\n      size[1] = parseInt(metrics.height, 10);\n    }\n    return size;\n  };\n\n  /**\n   * Get the constrained center of this view.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center Center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Constrained center.\n   * @api\n   */\n  View.prototype.constrainCenter = function constrainCenter (center) {\n    return this.constraints_.center(center);\n  };\n\n  /**\n   * Get the constrained resolution of this view.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number=} opt_delta Delta. Default is `0`.\n   * @param {number=} opt_direction Direction. Default is `0`.\n   * @return {number|undefined} Constrained resolution.\n   * @api\n   */\n  View.prototype.constrainResolution = function constrainResolution (resolution, opt_delta, opt_direction) {\n    var delta = opt_delta || 0;\n    var direction = opt_direction || 0;\n    return this.constraints_.resolution(resolution, delta, direction);\n  };\n\n  /**\n   * Get the constrained rotation of this view.\n   * @param {number|undefined} rotation Rotation.\n   * @param {number=} opt_delta Delta. Default is `0`.\n   * @return {number|undefined} Constrained rotation.\n   * @api\n   */\n  View.prototype.constrainRotation = function constrainRotation (rotation, opt_delta) {\n    var delta = opt_delta || 0;\n    return this.constraints_.rotation(rotation, delta);\n  };\n\n  /**\n   * Get the view center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.getCenter = function getCenter () {\n    return (\n      /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (this.get(ViewProperty.CENTER))\n    );\n  };\n\n  /**\n   * @return {Constraints} Constraints.\n   */\n  View.prototype.getConstraints = function getConstraints () {\n    return this.constraints_;\n  };\n\n  /**\n   * @param {Array<number>=} opt_hints Destination array.\n   * @return {Array<number>} Hint.\n   */\n  View.prototype.getHints = function getHints (opt_hints) {\n    if (opt_hints !== undefined) {\n      opt_hints[0] = this.hints_[0];\n      opt_hints[1] = this.hints_[1];\n      return opt_hints;\n    } else {\n      return this.hints_.slice();\n    }\n  };\n\n  /**\n   * Calculate the extent for the current view state and the passed size.\n   * The size is the pixel dimensions of the box into which the calculated extent\n   * should fit. In most cases you want to get the extent of the entire map,\n   * that is `map.getSize()`.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size. If not provided, the size of the\n   * first map that uses this view will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   * @api\n   */\n  View.prototype.calculateExtent = function calculateExtent (opt_size) {\n    var size = opt_size || this.getSizeFromViewport_();\n    var center = /** @type {!import(\"./coordinate.js\").Coordinate} */ (this.getCenter());\n    assert(center, 1); // The view center is not defined\n    var resolution = /** @type {!number} */ (this.getResolution());\n    assert(resolution !== undefined, 2); // The view resolution is not defined\n    var rotation = /** @type {!number} */ (this.getRotation());\n    assert(rotation !== undefined, 3); // The view rotation is not defined\n\n    return getForViewAndSize(center, resolution, rotation, size);\n  };\n\n  /**\n   * Get the maximum resolution of the view.\n   * @return {number} The maximum resolution of the view.\n   * @api\n   */\n  View.prototype.getMaxResolution = function getMaxResolution () {\n    return this.maxResolution_;\n  };\n\n  /**\n   * Get the minimum resolution of the view.\n   * @return {number} The minimum resolution of the view.\n   * @api\n   */\n  View.prototype.getMinResolution = function getMinResolution () {\n    return this.minResolution_;\n  };\n\n  /**\n   * Get the maximum zoom level for the view.\n   * @return {number} The maximum zoom level.\n   * @api\n   */\n  View.prototype.getMaxZoom = function getMaxZoom () {\n    return /** @type {number} */ (this.getZoomForResolution(this.minResolution_));\n  };\n\n  /**\n   * Set a new maximum zoom level for the view.\n   * @param {number} zoom The maximum zoom level.\n   * @api\n   */\n  View.prototype.setMaxZoom = function setMaxZoom (zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n  };\n\n  /**\n   * Get the minimum zoom level for the view.\n   * @return {number} The minimum zoom level.\n   * @api\n   */\n  View.prototype.getMinZoom = function getMinZoom () {\n    return /** @type {number} */ (this.getZoomForResolution(this.maxResolution_));\n  };\n\n  /**\n   * Set a new minimum zoom level for the view.\n   * @param {number} zoom The minimum zoom level.\n   * @api\n   */\n  View.prototype.setMinZoom = function setMinZoom (zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n  };\n\n  /**\n   * Get the view projection.\n   * @return {import(\"./proj/Projection.js\").default} The projection of the view.\n   * @api\n   */\n  View.prototype.getProjection = function getProjection () {\n    return this.projection_;\n  };\n\n  /**\n   * Get the view resolution.\n   * @return {number|undefined} The resolution of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.getResolution = function getResolution () {\n    return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n  };\n\n  /**\n   * Get the resolutions for the view. This returns the array of resolutions\n   * passed to the constructor of the View, or undefined if none were given.\n   * @return {Array<number>|undefined} The resolutions of the view.\n   * @api\n   */\n  View.prototype.getResolutions = function getResolutions () {\n    return this.resolutions_;\n  };\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   * @api\n   */\n  View.prototype.getResolutionForExtent = function getResolutionForExtent (extent, opt_size) {\n    var size = opt_size || this.getSizeFromViewport_();\n    var xResolution = getWidth(extent) / size[0];\n    var yResolution = getHeight(extent) / size[1];\n    return Math.max(xResolution, yResolution);\n  };\n\n  /**\n   * Return a function that returns a value between 0 and 1 for a\n   * resolution. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Resolution for value function.\n   */\n  View.prototype.getResolutionForValueFunction = function getResolutionForValueFunction (opt_power) {\n    var power = opt_power || 2;\n    var maxResolution = this.maxResolution_;\n    var minResolution = this.minResolution_;\n    var max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} value Value.\n       * @return {number} Resolution.\n       */\n      function(value) {\n        var resolution = maxResolution / Math.pow(power, value * max);\n        return resolution;\n      });\n  };\n\n  /**\n   * Get the view rotation.\n   * @return {number} The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  View.prototype.getRotation = function getRotation () {\n    return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n  };\n\n  /**\n   * Return a function that returns a resolution for a value between\n   * 0 and 1. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Value for resolution function.\n   */\n  View.prototype.getValueForResolutionFunction = function getValueForResolutionFunction (opt_power) {\n    var power = opt_power || 2;\n    var maxResolution = this.maxResolution_;\n    var minResolution = this.minResolution_;\n    var max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} resolution Resolution.\n       * @return {number} Value.\n       */\n      function(resolution) {\n        var value = (Math.log(maxResolution / resolution) / Math.log(power)) / max;\n        return value;\n      });\n  };\n\n  /**\n   * @param {number} pixelRatio Pixel ratio for center rounding.\n   * @return {State} View state.\n   */\n  View.prototype.getState = function getState (pixelRatio) {\n    var center = /** @type {import(\"./coordinate.js\").Coordinate} */ (this.getCenter());\n    var projection = this.getProjection();\n    var resolution = /** @type {number} */ (this.getResolution());\n    var pixelResolution = resolution / pixelRatio;\n    var rotation = this.getRotation();\n    return (\n      /** @type {State} */ ({\n        center: [\n          Math.round(center[0] / pixelResolution) * pixelResolution,\n          Math.round(center[1] / pixelResolution) * pixelResolution\n        ],\n        projection: projection !== undefined ? projection : null,\n        resolution: resolution,\n        rotation: rotation,\n        zoom: this.getZoom()\n      })\n    );\n  };\n\n  /**\n   * Get the current zoom level.  If you configured your view with a resolutions\n   * array (this is rare), this method may return non-integer zoom levels (so\n   * the zoom level is not safe to use as an index into a resolutions array).\n   * @return {number|undefined} Zoom.\n   * @api\n   */\n  View.prototype.getZoom = function getZoom () {\n    var zoom;\n    var resolution = this.getResolution();\n    if (resolution !== undefined) {\n      zoom = this.getZoomForResolution(resolution);\n    }\n    return zoom;\n  };\n\n  /**\n   * Get the zoom level for a resolution.\n   * @param {number} resolution The resolution.\n   * @return {number|undefined} The zoom level for the provided resolution.\n   * @api\n   */\n  View.prototype.getZoomForResolution = function getZoomForResolution (resolution) {\n    var offset = this.minZoom_ || 0;\n    var max, zoomFactor;\n    if (this.resolutions_) {\n      var nearest = linearFindNearest(this.resolutions_, resolution, 1);\n      offset = nearest;\n      max = this.resolutions_[nearest];\n      if (nearest == this.resolutions_.length - 1) {\n        zoomFactor = 2;\n      } else {\n        zoomFactor = max / this.resolutions_[nearest + 1];\n      }\n    } else {\n      max = this.maxResolution_;\n      zoomFactor = this.zoomFactor_;\n    }\n    return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n  };\n\n  /**\n   * Get the resolution for a zoom level.\n   * @param {number} zoom Zoom level.\n   * @return {number} The view resolution for the provided zoom level.\n   * @api\n   */\n  View.prototype.getResolutionForZoom = function getResolutionForZoom (zoom) {\n    return /** @type {number} */ (this.constrainResolution(\n      this.maxResolution_, zoom - this.minZoom_, 0));\n  };\n\n  /**\n   * Fit the given geometry or extent based on the given map size and border.\n   * The size is pixel dimensions of the box to fit the extent into.\n   * In most cases you will want to use the map size, that is `map.getSize()`.\n   * Takes care of the map angle.\n   * @param {import(\"./geom/SimpleGeometry.js\").default|import(\"./extent.js\").Extent} geometryOrExtent The geometry or\n   *     extent to fit the view to.\n   * @param {FitOptions=} opt_options Options.\n   * @api\n   */\n  View.prototype.fit = function fit (geometryOrExtent, opt_options) {\n    var options = opt_options || {};\n    var size = options.size;\n    if (!size) {\n      size = this.getSizeFromViewport_();\n    }\n    /** @type {import(\"./geom/SimpleGeometry.js\").default} */\n    var geometry;\n    assert(Array.isArray(geometryOrExtent) || typeof /** @type {?} */ (geometryOrExtent).getSimplifiedGeometry === 'function',\n      24); // Invalid extent or geometry provided as `geometry`\n    if (Array.isArray(geometryOrExtent)) {\n      assert(!isEmpty(geometryOrExtent),\n        25); // Cannot fit empty extent provided as `geometry`\n      geometry = polygonFromExtent(geometryOrExtent);\n    } else if (geometryOrExtent.getType() === GeometryType.CIRCLE) {\n      geometryOrExtent = geometryOrExtent.getExtent();\n      geometry = polygonFromExtent(geometryOrExtent);\n      geometry.rotate(this.getRotation(), getCenter(geometryOrExtent));\n    } else {\n      geometry = geometryOrExtent;\n    }\n\n    var padding = options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n    var constrainResolution = options.constrainResolution !== undefined ?\n      options.constrainResolution : true;\n    var nearest = options.nearest !== undefined ? options.nearest : false;\n    var minResolution;\n    if (options.minResolution !== undefined) {\n      minResolution = options.minResolution;\n    } else if (options.maxZoom !== undefined) {\n      minResolution = this.constrainResolution(\n        this.maxResolution_, options.maxZoom - this.minZoom_, 0);\n    } else {\n      minResolution = 0;\n    }\n    var coords = geometry.getFlatCoordinates();\n\n    // calculate rotated extent\n    var rotation = this.getRotation();\n    var cosAngle = Math.cos(-rotation);\n    var sinAngle = Math.sin(-rotation);\n    var minRotX = +Infinity;\n    var minRotY = +Infinity;\n    var maxRotX = -Infinity;\n    var maxRotY = -Infinity;\n    var stride = geometry.getStride();\n    for (var i = 0, ii = coords.length; i < ii; i += stride) {\n      var rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n      var rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n      minRotX = Math.min(minRotX, rotX);\n      minRotY = Math.min(minRotY, rotY);\n      maxRotX = Math.max(maxRotX, rotX);\n      maxRotY = Math.max(maxRotY, rotY);\n    }\n\n    // calculate resolution\n    var resolution = this.getResolutionForExtent(\n      [minRotX, minRotY, maxRotX, maxRotY],\n      [size[0] - padding[1] - padding[3], size[1] - padding[0] - padding[2]]);\n    resolution = isNaN(resolution) ? minResolution :\n      Math.max(resolution, minResolution);\n    if (constrainResolution) {\n      var constrainedResolution = this.constrainResolution(resolution, 0, 0);\n      if (!nearest && constrainedResolution < resolution) {\n        constrainedResolution = this.constrainResolution(\n          constrainedResolution, -1, 0);\n      }\n      resolution = constrainedResolution;\n    }\n\n    // calculate center\n    sinAngle = -sinAngle; // go back to original rotation\n    var centerRotX = (minRotX + maxRotX) / 2;\n    var centerRotY = (minRotY + maxRotY) / 2;\n    centerRotX += (padding[1] - padding[3]) / 2 * resolution;\n    centerRotY += (padding[0] - padding[2]) / 2 * resolution;\n    var centerX = centerRotX * cosAngle - centerRotY * sinAngle;\n    var centerY = centerRotY * cosAngle + centerRotX * sinAngle;\n    var center = [centerX, centerY];\n    var callback = options.callback ? options.callback : VOID;\n\n    if (options.duration !== undefined) {\n      this.animate({\n        resolution: resolution,\n        center: center,\n        duration: options.duration,\n        easing: options.easing\n      }, callback);\n    } else {\n      this.setResolution(resolution);\n      this.setCenter(center);\n      animationCallback(callback, true);\n    }\n  };\n\n  /**\n   * Center on coordinate and view position.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   * @api\n   */\n  View.prototype.centerOn = function centerOn (coordinate, size, position) {\n    // calculate rotated position\n    var rotation = this.getRotation();\n    var cosAngle = Math.cos(-rotation);\n    var sinAngle = Math.sin(-rotation);\n    var rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n    var rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n    var resolution = this.getResolution();\n    rotX += (size[0] / 2 - position[0]) * resolution;\n    rotY += (position[1] - size[1] / 2) * resolution;\n\n    // go back to original angle\n    sinAngle = -sinAngle; // go back to original rotation\n    var centerX = rotX * cosAngle - rotY * sinAngle;\n    var centerY = rotY * cosAngle + rotX * sinAngle;\n\n    this.setCenter([centerX, centerY]);\n  };\n\n  /**\n   * @return {boolean} Is defined.\n   */\n  View.prototype.isDef = function isDef () {\n    return !!this.getCenter() && this.getResolution() !== undefined;\n  };\n\n  /**\n   * Rotate the view around a given coordinate.\n   * @param {number} rotation New rotation value for the view.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The rotation center.\n   * @api\n   */\n  View.prototype.rotate = function rotate (rotation, opt_anchor) {\n    if (opt_anchor !== undefined) {\n      var center = this.calculateCenterRotate(rotation, opt_anchor);\n      this.setCenter(center);\n    }\n    this.setRotation(rotation);\n  };\n\n  /**\n   * Set the center of the current view.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.setCenter = function setCenter (center) {\n    this.set(ViewProperty.CENTER, center);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * @param {ViewHint} hint Hint.\n   * @param {number} delta Delta.\n   * @return {number} New value.\n   */\n  View.prototype.setHint = function setHint (hint, delta) {\n    this.hints_[hint] += delta;\n    this.changed();\n    return this.hints_[hint];\n  };\n\n  /**\n   * Set the resolution for this view.\n   * @param {number|undefined} resolution The resolution of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.setResolution = function setResolution (resolution) {\n    this.set(ViewProperty.RESOLUTION, resolution);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * Set the rotation for this view.\n   * @param {number} rotation The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  View.prototype.setRotation = function setRotation (rotation) {\n    this.set(ViewProperty.ROTATION, rotation);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * Zoom to a specific zoom level.\n   * @param {number} zoom Zoom level.\n   * @api\n   */\n  View.prototype.setZoom = function setZoom (zoom) {\n    this.setResolution(this.getResolutionForZoom(zoom));\n  };\n\n  return View;\n}(BaseObject));\n\n\n/**\n * @param {Function} callback Callback.\n * @param {*} returnValue Return value.\n */\nfunction animationCallback(callback, returnValue) {\n  setTimeout(function() {\n    callback(returnValue);\n  }, 0);\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./centerconstraint.js\").Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    return createExtent(options.extent);\n  } else {\n    return centerNone;\n  }\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {{constraint: import(\"./resolutionconstraint.js\").Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  var resolutionConstraint;\n  var maxResolution;\n  var minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  var defaultMaxZoom = 28;\n  var defaultZoomFactor = 2;\n\n  var minZoom = options.minZoom !== undefined ?\n    options.minZoom : DEFAULT_MIN_ZOOM;\n\n  var maxZoom = options.maxZoom !== undefined ?\n    options.maxZoom : defaultMaxZoom;\n\n  var zoomFactor = options.zoomFactor !== undefined ?\n    options.zoomFactor : defaultZoomFactor;\n\n  if (options.resolutions !== undefined) {\n    var resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution = resolutions[maxZoom] !== undefined ?\n      resolutions[maxZoom] : resolutions[resolutions.length - 1];\n    resolutionConstraint = createSnapToResolutions(\n      resolutions);\n  } else {\n    // calculate the default min and max resolution\n    var projection = createProjection(options.projection, 'EPSG:3857');\n    var extent = projection.getExtent();\n    var size = !extent ?\n      // use an extent that can fit the whole world if need be\n      360 * METERS_PER_UNIT[Units.DEGREES] /\n            projection.getMetersPerUnit() :\n      Math.max(getWidth(extent), getHeight(extent));\n\n    var defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(\n      defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    var defaultMinResolution = defaultMaxResolution / Math.pow(\n      defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom = minZoom + Math.floor(\n      Math.log(maxResolution / minResolution) / Math.log(zoomFactor));\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    resolutionConstraint = createSnapToPower(\n      zoomFactor, maxResolution, maxZoom - minZoom);\n  }\n  return {constraint: resolutionConstraint, maxResolution: maxResolution,\n    minResolution: minResolution, minZoom: minZoom, zoomFactor: zoomFactor};\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./rotationconstraint.js\").Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  var enableRotation = options.enableRotation !== undefined ?\n    options.enableRotation : true;\n  if (enableRotation) {\n    var constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    } else {\n      return rotationNone;\n    }\n  } else {\n    return disable;\n  }\n}\n\n\n/**\n * Determine if an animation involves no view change.\n * @param {Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\nexport default View;\n\n//# sourceMappingURL=View.js.map","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  /**\n   * Indicates that tile loading failed\n   * @type {number}\n   */\n  ERROR: 3,\n  EMPTY: 4,\n  ABORT: 5\n};\n\n//# sourceMappingURL=TileState.js.map","/** @namespace  ol.ext\r\n */\r\n/*global ol*/\r\nif (window.ol && !ol.ext) {\r\n  ol.ext = {};\r\n}\r\n\r\n/** Inherit the prototype methods from one constructor into another.\r\n * replace deprecated ol method\r\n *\r\n * @param {!Function} childCtor Child constructor.\r\n * @param {!Function} parentCtor Parent constructor.\r\n * @function module:ol.inherits\r\n * @api\r\n */\r\nvar ol_ext_inherits = function(child,parent) {\r\n  child.prototype = Object.create(parent.prototype);\r\n  child.prototype.constructor = child;\r\n};\r\n\r\n// Compatibilty with ol > 5 to be removed when v6 is out\r\nif (window.ol) {\r\n  if (!ol.inherits) ol.inherits = ol_ext_inherits;\r\n}\r\n\r\n/* IE Polyfill */\r\n// NodeList.forEach\r\nif (window.NodeList && !NodeList.prototype.forEach) {\r\n  NodeList.prototype.forEach = Array.prototype.forEach;\r\n}\r\n// Element.remove\r\nif (window.Element && !Element.prototype.remove) {\r\n  Element.prototype.remove = function() {\r\n    if (this.parentNode) this.parentNode.removeChild(this);\r\n  }\r\n}\r\n/* End Polyfill */\r\n\r\nexport {ol_ext_inherits}\r\nexport default ol_ext_inherits\r\n","import {ol_coordinate_equal} from \"./GeomUtils\";\r\nimport ol_geom_LineString from \"ol/geom/LineString\";\r\n\r\n/** Split a lineString by a point or a list of points\r\n *\tNB: points must be on the line, use getClosestPoint() to get one\r\n* @param {ol.Coordinate | Array<ol.Coordinate>} pt points to split the line\r\n* @param {Number} tol distance tolerance for 2 points to be equal\r\n*/\r\nol_geom_LineString.prototype.splitAt = function(pt, tol) {\r\n  var i;\r\n  if (!pt) return [this];\r\n    if (!tol) tol = 1e-10;\r\n    // Test if list of points\r\n    if (pt.length && pt[0].length) {\r\n      var result = [this];\r\n      for (i=0; i<pt.length; i++) {\r\n        var r = [];\r\n        for (var k=0; k<result.length; k++) {\r\n          var ri = result[k].splitAt(pt[i], tol);\r\n          r = r.concat(ri);\r\n        }\r\n        result = r;\r\n      }\r\n      return result;\r\n    }\r\n    // Nothing to do\r\n    if (ol_coordinate_equal(pt,this.getFirstCoordinate())\r\n    || ol_coordinate_equal(pt,this.getLastCoordinate())) {\r\n      return [this];\r\n    }\r\n    // Get\r\n    var c0 = this.getCoordinates();\r\n    var ci=[c0[0]];\r\n    var c = [];\r\n    for (i=0; i<c0.length-1; i++) {\r\n      // Filter equal points\r\n      if (ol_coordinate_equal(c0[i],c0[i+1])) continue;\r\n      // Extremity found\r\n      if (ol_coordinate_equal(pt,c0[i+1])) {\r\n        ci.push(c0[i+1]);\r\n        c.push(new ol_geom_LineString(ci));\r\n        ci = [];\r\n      }\r\n      // Test alignement\r\n      else if (!ol_coordinate_equal(pt,c0[i])) {\r\n        var d1, d2, split=false;\r\n        if (c0[i][0] == c0[i+1][0]) {\r\n          d1 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\r\n          split = (c0[i][0] == pt[0]) && (0 < d1 && d1 <= 1)\r\n        } else if (c0[i][1] == c0[i+1][1]) {\r\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\r\n          split = (c0[i][1] == pt[1]) && (0 < d1 && d1 <= 1)\r\n        } else {\r\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\r\n          d2 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\r\n          split = (Math.abs(d1-d2) <= tol && 0 < d1 && d1 <= 1)\r\n        }\r\n        // pt is inside the segment > split\r\n        if (split) {\r\n          ci.push(pt);\r\n          c.push (new ol_geom_LineString(ci));\r\n          ci = [pt];\r\n        }\r\n      }\r\n      ci.push(c0[i+1]);\r\n    }\r\n    if (ci.length>1) c.push (new ol_geom_LineString(ci));\r\n    if (c.length) return c;\r\n    else return [this];\r\n}\r\n\r\n// import('ol-ext/geom/LineStringSplitAt')","import ol_source_Vector from 'ol/source/Vector'\r\n\r\n(function () {\r\n  var clear = ol_source_Vector.prototype.clear;\r\n\r\n  /** Overwrite ol/source/Vector clear to fire clearstart / clearend event\r\n   */\r\n  ol_source_Vector.prototype.clear = function(opt_fast) {\r\n    this.dispatchEvent({ type: 'clearstart' });\r\n    clear.call(this, opt_fast)\r\n    this.dispatchEvent({ type: 'clearend' });\r\n  };\r\n})();\r\n","import ol_ext_inherits from '../util/ext'\r\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\r\nimport ol_layer_Vector from 'ol/layer/Vector'\r\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\r\nimport '../source/Vector' \r\n\r\n/** Undo/redo interaction\r\n * @constructor\r\n * @extends {ol_interaction_Interaction}\r\n * @fires undo\r\n * @fires redo\r\n * @param {*} options\r\n */\r\nvar ol_interaction_UndoRedo = function(options) {\r\n  if (!options) options = {};\r\n\r\n\tol_interaction_Interaction.call(this, {\t\r\n    handleEvent: function() { \r\n      return true; \r\n    }\r\n  });\r\n\r\n  this._undoStack = [];\r\n  this._redoStack = [];\r\n  // Block counter\r\n  this._block = 0;\r\n  // Start recording\r\n  this._record = true;\r\n  // Custom definitions\r\n  this._defs = {};\r\n};\r\nol_ext_inherits(ol_interaction_UndoRedo, ol_interaction_Interaction);\r\n\r\n/** Add a custom undo/redo\r\n * @param {string} action the action key name\r\n * @param {function} undoFn function called when undoing\r\n * @param {function} redoFn function called when redoing\r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.define = function(action, undoFn, redoFn) {\r\n  this._defs['_'+action] = { undo: undoFn, redo: redoFn };\r\n};\r\n\r\n/** Set a custom undo/redo\r\n * @param {string} action the action key name\r\n * @param {any} prop an object that will be passed in the undo/redo fucntions of the action\r\n * @return {boolean} true if the action is defined\r\n */\r\nol_interaction_UndoRedo.prototype.push = function(action, prop) {\r\n  if (this._defs['_'+action]) {\r\n    this._undoStack.push({type: '_'+action, prop: prop });\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\n/** Activate or deactivate the interaction, ie. records or not events on the map.\r\n * @param {boolean} active\r\n * @api stable\r\n */\r\nol_interaction_UndoRedo.prototype.setActive = function(active) {\r\n  ol_interaction_Interaction.prototype.setActive.call (this, active);\r\n  this._record = active;\r\n};\r\n\r\n/**\r\n * Remove the interaction from its current map, if any, and attach it to a new\r\n * map, if any. Pass `null` to just remove the interaction from the current map.\r\n * @param {ol.Map} map Map.\r\n * @api stable\r\n */\r\nol_interaction_UndoRedo.prototype.setMap = function(map) {\r\n  if (this._mapListener) {\r\n    this._mapListener.forEach(function(l) { ol_Observable_unByKey(l); })\r\n  }\r\n  this._mapListener = [];\r\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\r\n  // Watch blocks\r\n  if (map) {\r\n    this._mapListener.push(map.on('undoblockstart', this.blockStart.bind(this)));\r\n    this._mapListener.push(map.on('undoblockend', this.blockEnd.bind(this)));\r\n  }\r\n  // Watch sources\r\n  this._watchSources();\r\n  this._watchInteractions();\r\n};\r\n\r\n/** Watch for changes in the map sources\r\n * @private\r\n */\r\nol_interaction_UndoRedo.prototype._watchSources = function() {\r\n  var map = this.getMap();\r\n  // Clear listeners\r\n  if (this._sourceListener) {\r\n    this._sourceListener.forEach(function(l) { ol_Observable_unByKey(l); })\r\n  }\r\n  this._sourceListener = [];\r\n\r\n  // Ges vector layers \r\n  function getVectorLayers(layers, init) {\r\n    if (!init) init = [];\r\n    layers.forEach(function(l) {\r\n      if (l instanceof ol_layer_Vector) {\r\n        init.push(l);\r\n      } else if (l.getLayers) {\r\n        getVectorLayers(l.getLayers(), init);\r\n      }\r\n    });\r\n    return init;\r\n  }\r\n\r\n  if (map) {\r\n    // Watch the vector sources in the map \r\n    var vectors = getVectorLayers(map.getLayers());\r\n    vectors.forEach((function(l) {\r\n      var s = l.getSource();\r\n      this._sourceListener.push( s.on(['addfeature', 'removefeature'], this._onAddRemove.bind(this)) );\r\n      this._sourceListener.push( s.on('clearstart', this.blockStart.bind(this)) );\r\n      this._sourceListener.push( s.on('clearend', this.blockEnd.bind(this)) );\r\n    }).bind(this));\r\n\r\n    // Watch new inserted/removed\r\n    this._sourceListener.push( map.getLayers().on(['add', 'remove'], this._watchSources.bind(this) ) );\r\n  }\r\n};\r\n\r\n/** Watch for interactions\r\n * @private\r\n */\r\nol_interaction_UndoRedo.prototype._watchInteractions = function() {\r\n  var map = this.getMap();\r\n  // Clear listeners\r\n  if (this._interactionListener) {\r\n    this._interactionListener.forEach(function(l) { ol_Observable_unByKey(l); })\r\n  }\r\n  this._interactionListener = [];\r\n\r\n  if (map) {\r\n    // Watch the interactions in the map \r\n    map.getInteractions().forEach((function(i) {\r\n      this._interactionListener.push(i.on(\r\n        ['setattributestart', 'modifystart', 'rotatestart', 'translatestart', 'scalestart', 'deletestart', 'deleteend', 'beforesplit', 'aftersplit'], \r\n        this._onInteraction.bind(this)\r\n      ));\r\n    }).bind(this));\r\n\r\n    // Watch new inserted / unwatch removed\r\n    this._interactionListener.push( map.getInteractions().on(\r\n      ['add', 'remove'], \r\n      this._watchInteractions.bind(this)\r\n    ));\r\n  }\r\n};\r\n\r\n/** A feature is added / removed\r\n */\r\nol_interaction_UndoRedo.prototype._onAddRemove = function(e) {\r\n  if (this._record) {\r\n    this._undoStack.push({type: e.type, source: e.target, feature: e.feature });\r\n    this._redoStack = [];\r\n  }\r\n};\r\n\r\nol_interaction_UndoRedo.prototype._onInteraction = function(e) {\r\n  var fn = this._onInteraction[e.type];\r\n  if (fn) fn.call(this,e);\r\n};\r\n\r\n/** Set attribute\r\n * @private\r\n */\r\nol_interaction_UndoRedo.prototype._onInteraction.setattributestart = function(e) {\r\n  this.blockStart();\r\n  var newp = Object.assign({}, e.properties);\r\n  e.features.forEach(function(f) {\r\n    var oldp = {};\r\n    for (var p in newp) {\r\n      oldp[p] = f.get(p);\r\n    }\r\n    this._undoStack.push({\r\n      type: 'changeattribute', \r\n      feature: f, \r\n      newProperties: newp,\r\n      oldProperties: oldp\r\n    });\r\n  }.bind(this));\r\n  this.blockEnd();\r\n};\r\n\r\nol_interaction_UndoRedo.prototype._onInteraction.rotatestart = \r\nol_interaction_UndoRedo.prototype._onInteraction.translatestart = \r\nol_interaction_UndoRedo.prototype._onInteraction.scalestart = \r\nol_interaction_UndoRedo.prototype._onInteraction.modifystart = function (e) {\r\n  this.blockStart();\r\n  e.features.forEach(function(m) {\r\n    this._undoStack.push({type: 'changefeature', feature: m, oldFeature: m.clone()  });\r\n  }.bind(this));\r\n  this.blockEnd();\r\n};\r\n\r\n/** Start an undo block\r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.blockStart = function () {\r\n  this._undoStack.push({ type: 'blockstart' });\r\n  this._redoStack = [];\r\n};\r\n\r\n/** @private\r\n */\r\nol_interaction_UndoRedo.prototype._onInteraction.beforesplit =\r\nol_interaction_UndoRedo.prototype._onInteraction.deletestart =\r\nol_interaction_UndoRedo.prototype.blockStart;\r\n\r\n/** End an undo block\r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.blockEnd = function () {\r\n  this._undoStack.push({ type: 'blockend' });\r\n};\r\n\r\n/** @private\r\n */\r\nol_interaction_UndoRedo.prototype._onInteraction.aftersplit =\r\nol_interaction_UndoRedo.prototype._onInteraction.deleteend =\r\nol_interaction_UndoRedo.prototype.blockEnd;\r\n\r\n/** handle undo/redo\r\n * @private\r\n */\r\nol_interaction_UndoRedo.prototype._handleDo = function(e, undo) {\r\n  // Not active\r\n  if (!this.getActive()) return;\r\n\r\n  // Stop recording while undoing\r\n  this._record = false;\r\n  switch (e.type) {\r\n    case 'addfeature': {\r\n      if (undo) e.source.removeFeature(e.feature);\r\n      else e.source.addFeature(e.feature);\r\n      break;\r\n    }\r\n    case 'removefeature': {\r\n      if (undo) e.source.addFeature(e.feature);\r\n      else e.source.removeFeature(e.feature);\r\n      break;\r\n    }\r\n    case 'changefeature': {\r\n      var geom = e.feature.getGeometry();\r\n      e.feature.setGeometry(e.oldFeature.getGeometry());\r\n      e.oldFeature.setGeometry(geom);\r\n      break;\r\n    }\r\n    case 'changeattribute': {\r\n      var newp = e.newProperties;\r\n      var oldp = e.oldProperties;\r\n      for (var p in oldp) {\r\n        if (oldp === undefined) e.feature.unset(p);\r\n        else e.feature.set(p, oldp[p]);\r\n      }\r\n      e.oldProperties = newp;\r\n      e.newProperties = oldp;\r\n      break;\r\n    }\r\n    case 'blockstart': {\r\n      this._block += undo ? -1 : 1;\r\n      break;\r\n    }\r\n    case 'blockend': {\r\n      this._block += undo ? 1 : -1;\r\n      break;\r\n    }\r\n    default: {\r\n      if (this._defs[e.type]) {\r\n        if (undo) this._defs[e.type].undo(e.prop);\r\n        else this._defs[e.type].redo(e.prop);\r\n      } else {\r\n        console.warn('[UndoRedoInteraction]: \"'+e.type.substr(1)+'\" is not defined.');\r\n      }\r\n    }\r\n  }\r\n\r\n  // Handle block\r\n  if (this._block<0) this._block = 0;\r\n  if (this._block) {\r\n    if (undo) this.undo();\r\n    else this.redo();\r\n  }\r\n  this._record = true;\r\n\r\n  // Dispatch event\r\n  this.dispatchEvent( { \r\n    type: undo ? 'undo' : 'redo',\r\n    action: e\r\n  });\r\n};\r\n\r\n/** Undo last operation\r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.undo = function() {\r\n  var e = this._undoStack.pop();\r\n  if (!e) return;\r\n  this._redoStack.push(e);\r\n  this._handleDo(e, true);\r\n};\r\n\r\n/** Redo last operation\r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.redo = function() {\r\n  var e = this._redoStack.pop();\r\n  if (!e) return;\r\n  this._undoStack.push(e);\r\n  this._handleDo(e, false);\r\n};\r\n\r\n/** Clear undo stack\r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.clear = function() {\r\n  this._undoStack = [];\r\n  this._redoStack = [];\r\n};\r\n\r\n/** Check if undo is avaliable\r\n * @return {number} the number of undo \r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.hasUndo = function() {\r\n  return this._undoStack.length;\r\n};\r\n\r\n/** Check if redo is avaliable\r\n * @return {number} the number of redo\r\n * @api\r\n */\r\nol_interaction_UndoRedo.prototype.hasRedo = function() {\r\n  return this._redoStack.length;\r\n};\r\n\r\nexport default ol_interaction_UndoRedo\r\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\n\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\r\nimport ol_style_Style_defaultStyle from '../style/defaultStyle'\r\nimport ol_Collection from 'ol/Collection'\r\nimport ol_layer_Vector from 'ol/layer/Vector'\r\nimport ol_source_Vector from 'ol/source/Vector'\r\nimport ol_geom_Circle from 'ol/geom/Circle'\r\nimport {fromCircle as ol_geom_Polygon_fromCircle} from 'ol/geom/Polygon'\r\nimport ol_geom_Point from 'ol/geom/Point'\r\nimport ol_geom_LineString from 'ol/geom/LineString'\r\nimport ol_geom_Polygon from 'ol/geom/Polygon'\r\nimport ol_Feature from 'ol/Feature'\r\n\r\n/** Interaction rotate\r\n * @constructor\r\n * @extends {ol_interaction_Interaction}\r\n * @fires drawstart, drawing, drawend, drawcancel\r\n * @param {olx.interaction.TransformOptions} options\r\n *  @param {Array<ol.Layer>} source Destination source for the drawn features\r\n *  @param {ol.Collection<ol.Feature>} features Destination collection for the drawn features \r\n *  @param {ol.style.Style | Array.<ol.style.Style> | ol.style.StyleFunction | undefined} style style for the sketch\r\n *  @param {integer} sides number of sides, default 0 = circle\r\n *  @param { ol.events.ConditionType | undefined } squareCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw square features.\r\n *  @param { ol.events.ConditionType | undefined } centerCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw centered features.\r\n *  @param { bool } canRotate Allow rotation when centered + square, default: true\r\n *  @param { number } clickTolerance click tolerance on touch devices, default: 6\r\n *  @param { number } maxCircleCoordinates Maximum number of point on a circle, default: 100\r\n */\r\nvar ol_interaction_DrawRegular = function(options) {\r\n  if (!options) options={};\r\n\r\n  this.squaredClickTolerance_ = options.clickTolerance ? options.clickTolerance * options.clickTolerance : 36;\r\n  this.maxCircleCoordinates_ = options.maxCircleCoordinates || 100;\r\n\r\n  // Collection of feature to transform \r\n  this.features_ = options.features;\r\n  // List of layers to transform \r\n  this.source_ = options.source;\r\n  // Square condition\r\n  this.squareFn_ = options.squareCondition;\r\n  // Centered condition\r\n  this.centeredFn_ = options.centerCondition;\r\n  // Allow rotation when centered + square\r\n  this.canRotate_ = (options.canRotate !== false);\r\n  // Specify custom geometry name\r\n  this.geometryName_ = options.geometryName\r\n\r\n  // Number of sides (default=0: circle)\r\n  this.setSides(options.sides);\r\n\r\n  // Style\r\n  var defaultStyle = ol_style_Style_defaultStyle(true);\r\n\r\n  // Create a new overlay layer for the sketch\r\n  this.sketch_ = new ol_Collection();\r\n  this.overlayLayer_ = new ol_layer_Vector({\r\n    source: new ol_source_Vector({\r\n      features: this.sketch_,\r\n      useSpatialIndex: false\r\n    }),\r\n    name:'DrawRegular overlay',\r\n    displayInLayerSwitcher: false,\r\n    style: options.style || defaultStyle\r\n  });\r\n\r\n  ol_interaction_Interaction.call(this, {\t\r\n      /*\r\n      handleDownEvent: this.handleDownEvent_,\r\n      handleMoveEvent: this.handleMoveEvent_,\r\n      handleUpEvent: this.handleUpEvent_,\r\n      */\r\n      handleEvent: this.handleEvent_\r\n    });\r\n};\r\nol_ext_inherits(ol_interaction_DrawRegular, ol_interaction_Interaction);\r\n\r\n/**\r\n * Remove the interaction from its current map, if any,  and attach it to a new\r\n * map, if any. Pass `null` to just remove the interaction from the current map.\r\n * @param {ol.Map} map Map.\r\n * @api stable\r\n */\r\nol_interaction_DrawRegular.prototype.setMap = function(map) {\r\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\r\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\r\n  this.overlayLayer_.setMap(map);\r\n};\r\n\r\n/**\r\n * Activate/deactivate the interaction\r\n * @param {boolean}\r\n * @api stable\r\n */\r\nol_interaction_DrawRegular.prototype.setActive = function(b) {\r\n  this.reset();\r\n  ol_interaction_Interaction.prototype.setActive.call (this, b);\r\n}\r\n\r\n/**\r\n * Reset the interaction\r\n * @api stable\r\n */\r\nol_interaction_DrawRegular.prototype.reset = function() {\r\n  this.overlayLayer_.getSource().clear();\r\n  this.started_ = false;\r\n}\r\n\r\n/**\r\n * Set the number of sides.\r\n * @param {int} number of sides.\r\n * @api stable\r\n */\r\nol_interaction_DrawRegular.prototype.setSides = function (nb) {\r\n  nb = parseInt(nb);\r\n  this.sides_ = nb>2 ? nb : 0;\r\n}\r\n\r\n/**\r\n * Allow rotation when centered + square\r\n * @param {bool} \r\n * @api stable\r\n */\r\nol_interaction_DrawRegular.prototype.canRotate = function (b) {\r\n  if (b===true || b===false) this.canRotate_ = b;\r\n  return this.canRotate_;\r\n}\r\n\r\n/**\r\n * Get the number of sides.\r\n * @return {int} number of sides.\r\n * @api stable\r\n */\r\nol_interaction_DrawRegular.prototype.getSides = function () {\r\n  return this.sides_;\r\n}\r\n\r\n/** Default start angle array for each sides\r\n*/\r\nol_interaction_DrawRegular.prototype.startAngle = {\r\n  'default':Math.PI/2,\r\n  3: -Math.PI/2,\r\n  4: Math.PI/4\r\n};\r\n\r\n/** Get geom of the current drawing\r\n* @return {ol.geom.Polygon | ol.geom.Point}\r\n*/\r\nol_interaction_DrawRegular.prototype.getGeom_ = function () {\r\n  this.overlayLayer_.getSource().clear();\r\n  if (!this.center_) return false;\r\n\r\n  var g;\r\n  if (this.coord_) {\r\n    var center = this.center_;\r\n    var coord = this.coord_;\r\n\r\n    // Specific case: circle\r\n    var d, dmax, r, circle, centerPx;\r\n    if (!this.sides_ && this.square_ && !this.centered_) {\r\n      center = [(coord[0] + center[0])/2, (coord[1] + center[1])/2];\r\n      d = [coord[0] - center[0], coord[1] - center[1]];\r\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\r\n      circle = new ol_geom_Circle(center, r, 'XY');\r\n      // Optimize points on the circle\r\n      centerPx = this.getMap().getPixelFromCoordinate(center);\r\n      dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\r\n      dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / 3 ));\r\n      return ol_geom_Polygon_fromCircle (circle, dmax, 0);\r\n    } else {\r\n      var hasrotation = this.canRotate_ && this.centered_ && this.square_;\r\n      d = [coord[0] - center[0], coord[1] - center[1]];\r\n      if (this.square_ && !hasrotation) {\r\n        //var d = [coord[0] - center[0], coord[1] - center[1]];\r\n        var dm = Math.max (Math.abs(d[0]), Math.abs(d[1])); \r\n        coord = [ \r\n          center[0] + (d[0]>0 ? dm:-dm),\r\n          center[1] + (d[1]>0 ? dm:-dm)\r\n        ];\r\n      }\r\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\r\n      if (r>0) {\r\n        circle = new ol_geom_Circle(center, r, 'XY');\r\n        var a;\r\n        if (hasrotation) a = Math.atan2(d[1], d[0]);\r\n        else a = this.startAngle[this.sides_] || this.startAngle['default'];\r\n\r\n        if (this.sides_) {\r\n          g = ol_geom_Polygon_fromCircle (circle, this.sides_, a);\r\n        } else {\r\n          // Optimize points on the circle\r\n          centerPx = this.getMap().getPixelFromCoordinate(this.center_);\r\n          dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\r\n          dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / (this.centered_ ? 3:5) ));\r\n          g = ol_geom_Polygon_fromCircle (circle, dmax, 0);\r\n        }\r\n\r\n        if (hasrotation) return g;\r\n      \r\n        // Scale polygon to fit extent\r\n        var ext = g.getExtent();\r\n        if (!this.centered_) center = this.center_;\r\n        else center = [ 2*this.center_[0]-this.coord_[0], 2*this.center_[1]-this.coord_[1] ];\r\n        var scx = (center[0] - coord[0]) / (ext[0] - ext[2]);\r\n        var scy = (center[1] - coord[1]) / (ext[1] - ext[3]);\r\n        if (this.square_) {\r\n          var sc = Math.min(Math.abs(scx),Math.abs(scy));\r\n          scx = Math.sign(scx)*sc;\r\n          scy = Math.sign(scy)*sc;\r\n        }\r\n        var t = [ center[0] - ext[0]*scx, center[1] - ext[1]*scy ];\r\n      \r\n        g.applyTransform(function(g1, g2, dim) {\r\n          for (var i=0; i<g1.length; i+=dim) {\r\n            g2[i] = g1[i]*scx + t[0];\r\n            g2[i+1] = g1[i+1]*scy + t[1];\r\n          }\r\n          return g2;\r\n        });\r\n        return g;\r\n      }\r\n    }\r\n  }\r\n\r\n  // No geom => return a point\r\n  return new ol_geom_Point(this.center_);\r\n};\r\n\r\n/** Draw sketch\r\n* @return {ol.Feature} The feature being drawn.\r\n*/\r\nol_interaction_DrawRegular.prototype.drawSketch_ = function(evt) {\r\n  this.overlayLayer_.getSource().clear();\r\n  if (evt) {\r\n    this.square_ = this.squareFn_ ? this.squareFn_(evt) : evt.originalEvent.shiftKey;\r\n    this.centered_ = this.centeredFn_ ? this.centeredFn_(evt) : evt.originalEvent.metaKey || evt.originalEvent.ctrlKey;\r\n    var g = this.getGeom_();\r\n    if (g) {\r\n      var f = this.feature_;\r\n      if (this.geometryName_) f.setGeometryName(this.geometryName_)\r\n\r\n      //f.setGeometry (g);\r\n      if (g.getType()==='Polygon') f.getGeometry().setCoordinates(g.getCoordinates());\r\n      this.overlayLayer_.getSource().addFeature(f);\r\n      if (this.coord_ \r\n        && this.square_ \r\n        && ((this.canRotate_ && this.centered_ && this.coord_) || (!this.sides_ && !this.centered_))) {\r\n        this.overlayLayer_.getSource().addFeature(new ol_Feature(new ol_geom_LineString([this.center_,this.coord_])));\r\n      }\r\n      return f;\r\n    }\r\n  }\r\n};\r\n\r\n/** Draw sketch (Point)\r\n*/\r\nol_interaction_DrawRegular.prototype.drawPoint_ = function(pt, noclear) {\r\n  if (!noclear) this.overlayLayer_.getSource().clear();\r\n  this.overlayLayer_.getSource().addFeature(new ol_Feature(new ol_geom_Point(pt)));\r\n};\r\n\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n */\r\nol_interaction_DrawRegular.prototype.handleEvent_ = function(evt) {\r\n  var dx, dy;\r\n  // Event date time\r\n  this._eventTime = new Date();\r\n  switch (evt.type) {\r\n    case \"pointerdown\": {\r\n      this.downPx_ = evt.pixel;\r\n      this.start_(evt);\r\n      // Test long touch\r\n      var dt = 500;\r\n      this._longTouch = false;\r\n      setTimeout(function() {\r\n        this._longTouch = (new Date() - this._eventTime > .9*dt);\r\n        if (this._longTouch) this.handleMoveEvent_(evt);\r\n      }.bind(this), dt);\r\n      break;\r\n    }\r\n    case \"pointerup\": {\r\n      // Started and fisrt move\r\n      if (this.started_ && this.coord_) {\r\n        dx = this.downPx_[0] - evt.pixel[0];\r\n        dy = this.downPx_[1] - evt.pixel[1];\r\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\r\n          // The pointer has moved\r\n          if ( this.lastEvent == \"pointermove\" || this.lastEvent == \"keydown\" ) {\r\n            this.end_(evt);\r\n          }\r\n          // On touch device there is no move event : terminate = click on the same point\r\n          else {\r\n            dx = this.upPx_[0] - evt.pixel[0];\r\n            dy = this.upPx_[1] - evt.pixel[1];\r\n            if ( dx*dx + dy*dy <= this.squaredClickTolerance_) {\r\n              this.end_(evt);\r\n            } else  {\r\n              this.handleMoveEvent_(evt);\r\n              this.drawPoint_(evt.coordinate,true);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.upPx_ = evt.pixel;\t\r\n      break;\r\n    }\r\n    case \"pointerdrag\": {\r\n      if (this.started_) {\r\n        var centerPx = this.getMap().getPixelFromCoordinate(this.center_);\r\n        dx = centerPx[0] - evt.pixel[0];\r\n        dy = centerPx[1] - evt.pixel[1];\r\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\r\n          this.reset();\r\n        }\r\n      }\r\n      return !this._longTouch;\r\n      // break;\r\n    }\r\n    case \"pointermove\": {\r\n      if (this.started_) {\r\n        dx = this.downPx_[0] - evt.pixel[0];\r\n        dy = this.downPx_[1] - evt.pixel[1];\r\n        if (dx*dx + dy*dy > this.squaredClickTolerance_) {\r\n          this.handleMoveEvent_(evt);\r\n          this.lastEvent = evt.type;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    default: {\r\n      this.lastEvent = evt.type;\r\n      // Prevent zoom in on dblclick\r\n      if (this.started_ && evt.type==='dblclick') {\r\n        //evt.stopPropagation();\r\n        return false;\r\n      }\r\n      break;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/** Stop drawing.\r\n */\r\nol_interaction_DrawRegular.prototype.finishDrawing = function() {\r\n  if (this.started_ && this.coord_) {\r\n    this.end_({ pixel: this.upPx_, coordinate: this.coord_});\r\n  }\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Event.\r\n */\r\nol_interaction_DrawRegular.prototype.handleMoveEvent_ = function(evt) {\r\n  if (this.started_) {\r\n    this.coord_ = evt.coordinate;\r\n    this.coordPx_ = evt.pixel;\r\n    var f = this.drawSketch_(evt);\r\n    this.dispatchEvent({ \r\n      type:'drawing', \r\n      feature: f, \r\n      pixel: evt.pixel, \r\n      startCoordinate: this.center_,\r\n      coordinate: evt.coordinate, \r\n      square: this.square_, \r\n      centered: this.centered_ \r\n    });\r\n  } else  {\r\n    this.drawPoint_(evt.coordinate);\r\n  }\r\n};\r\n\r\n/** Start an new draw\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @return {boolean} `false` to stop the drag sequence.\r\n */\r\nol_interaction_DrawRegular.prototype.start_ = function(evt) {\r\n  if (!this.started_) {\r\n    this.started_ = true;\r\n    this.center_ = evt.coordinate;\r\n    this.coord_ = null;\r\n    var geom = new ol_geom_Polygon([[evt.coordinate,evt.coordinate,evt.coordinate]]);\r\n    var f = this.feature_ = new ol_Feature(geom);\r\n    this.drawSketch_(evt);\r\n    this.dispatchEvent({ type:'drawstart', feature: f, pixel: evt.pixel, coordinate: evt.coordinate });\r\n  } else {\r\n    this.coord_ = evt.coordinate;\r\n  }\r\n};\r\n\r\n/** End drawing\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @return {boolean} `false` to stop the drag sequence.\r\n */\r\nol_interaction_DrawRegular.prototype.end_ = function(evt) {\r\n  this.coord_ = evt.coordinate;\r\n  this.started_ = false;\r\n  // Add new feature\r\n  if (this.coord_ && this.center_[0]!=this.coord_[0] && this.center_[1]!=this.coord_[1]) {\r\n    var f = this.feature_;\r\n    if (this.geometryName_) f.setGeometryName(this.geometryName_)\r\n\r\n    f.setGeometry(this.getGeom_());\r\n    if (this.source_) this.source_.addFeature(f);\r\n    else if (this.features_) this.features_.push(f);\r\n    this.dispatchEvent({ type:'drawend', feature: f, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\r\n  } else {\r\n    this.dispatchEvent({ type:'drawcancel', feature: null, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\r\n  }\r\n\r\n  this.center_ = this.coord_ = null;\r\n  this.drawSketch_();\r\n};\r\n\r\nexport default ol_interaction_DrawRegular\r\n","/**\n * @module ol/Disposable\n */\n\n/**\n * @classdesc\n * Objects that need to clean up after themselves.\n */\nvar Disposable = function Disposable() {\n  /**\n   * The object has already been disposed.\n   * @type {boolean}\n   * @private\n   */\n  this.disposed_ = false;\n};\n\n/**\n * Clean up.\n */\nDisposable.prototype.dispose = function dispose () {\n  if (!this.disposed_) {\n    this.disposed_ = true;\n    this.disposeInternal();\n  }\n};\n\n/**\n * Extension point for disposable objects.\n * @protected\n */\nDisposable.prototype.disposeInternal = function disposeInternal () {};\n\nexport default Disposable;\n\n//# sourceMappingURL=Disposable.js.map","/**\n * @module ol/TileRange\n */\n\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n */\nvar TileRange = function TileRange(minX, maxX, minY, maxY) {\n\n  /**\n   * @type {number}\n   */\n  this.minX = minX;\n\n  /**\n   * @type {number}\n   */\n  this.maxX = maxX;\n\n  /**\n   * @type {number}\n   */\n  this.minY = minY;\n\n  /**\n   * @type {number}\n   */\n  this.maxY = maxY;\n\n};\n\n/**\n * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @return {boolean} Contains tile coordinate.\n */\nTileRange.prototype.contains = function contains (tileCoord) {\n  return this.containsXY(tileCoord[1], tileCoord[2]);\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Contains.\n */\nTileRange.prototype.containsTileRange = function containsTileRange (tileRange) {\n  return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX &&\n     this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;\n};\n\n/**\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @return {boolean} Contains coordinate.\n */\nTileRange.prototype.containsXY = function containsXY (x, y) {\n  return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Equals.\n */\nTileRange.prototype.equals = function equals (tileRange) {\n  return this.minX == tileRange.minX && this.minY == tileRange.minY &&\n     this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n */\nTileRange.prototype.extend = function extend (tileRange) {\n  if (tileRange.minX < this.minX) {\n    this.minX = tileRange.minX;\n  }\n  if (tileRange.maxX > this.maxX) {\n    this.maxX = tileRange.maxX;\n  }\n  if (tileRange.minY < this.minY) {\n    this.minY = tileRange.minY;\n  }\n  if (tileRange.maxY > this.maxY) {\n    this.maxY = tileRange.maxY;\n  }\n};\n\n/**\n * @return {number} Height.\n */\nTileRange.prototype.getHeight = function getHeight () {\n  return this.maxY - this.minY + 1;\n};\n\n/**\n * @return {import(\"./size.js\").Size} Size.\n */\nTileRange.prototype.getSize = function getSize () {\n  return [this.getWidth(), this.getHeight()];\n};\n\n/**\n * @return {number} Width.\n */\nTileRange.prototype.getWidth = function getWidth () {\n  return this.maxX - this.minX + 1;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Intersects.\n */\nTileRange.prototype.intersects = function intersects (tileRange) {\n  return this.minX <= tileRange.maxX &&\n     this.maxX >= tileRange.minX &&\n     this.minY <= tileRange.maxY &&\n     this.maxY >= tileRange.minY;\n};\n\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {TileRange=} tileRange TileRange.\n * @return {TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  } else {\n    return new TileRange(minX, maxX, minY, maxY);\n  }\n}\n\n\nexport default TileRange;\n\n//# sourceMappingURL=TileRange.js.map","/**\n * @module ol/MapBrowserPointerEvent\n */\nimport MapBrowserEvent from './MapBrowserEvent.js';\n\nvar MapBrowserPointerEvent = /*@__PURE__*/(function (MapBrowserEvent) {\n  function MapBrowserPointerEvent(type, map, pointerEvent, opt_dragging, opt_frameState) {\n\n    MapBrowserEvent.call(this, type, map, pointerEvent.originalEvent, opt_dragging, opt_frameState);\n\n    /**\n     * @const\n     * @type {import(\"./pointer/PointerEvent.js\").default}\n     */\n    this.pointerEvent = pointerEvent;\n\n  }\n\n  if ( MapBrowserEvent ) MapBrowserPointerEvent.__proto__ = MapBrowserEvent;\n  MapBrowserPointerEvent.prototype = Object.create( MapBrowserEvent && MapBrowserEvent.prototype );\n  MapBrowserPointerEvent.prototype.constructor = MapBrowserPointerEvent;\n\n  return MapBrowserPointerEvent;\n}(MapBrowserEvent));\n\nexport default MapBrowserPointerEvent;\n\n//# sourceMappingURL=MapBrowserPointerEvent.js.map","/**\n * @module ol/Object\n */\nimport {getUid} from './util.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport Event from './events/Event.js';\nimport {assign} from './obj.js';\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of this type.\n */\nexport var ObjectEvent = /*@__PURE__*/(function (Event) {\n  function ObjectEvent(type, key, oldValue) {\n    Event.call(this, type);\n\n    /**\n     * The name of the property whose value is changing.\n     * @type {string}\n     * @api\n     */\n    this.key = key;\n\n    /**\n     * The old value. To get the new value use `e.target.get(e.key)` where\n     * `e` is the event object.\n     * @type {*}\n     * @api\n     */\n    this.oldValue = oldValue;\n\n  }\n\n  if ( Event ) ObjectEvent.__proto__ = Event;\n  ObjectEvent.prototype = Object.create( Event && Event.prototype );\n  ObjectEvent.prototype.constructor = ObjectEvent;\n\n  return ObjectEvent;\n}(Event));\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @fires ObjectEvent\n * @api\n */\nvar BaseObject = /*@__PURE__*/(function (Observable) {\n  function BaseObject(opt_values) {\n    Observable.call(this);\n\n    // Call {@link module:ol/util~getUid} to ensure that the order of objects' ids is\n    // the same as the order in which they were created.  This also helps to\n    // ensure that object properties are always added in the same order, which\n    // helps many JavaScript engines generate faster code.\n    getUid(this);\n\n    /**\n     * @private\n     * @type {!Object<string, *>}\n     */\n    this.values_ = {};\n\n    if (opt_values !== undefined) {\n      this.setProperties(opt_values);\n    }\n  }\n\n  if ( Observable ) BaseObject.__proto__ = Observable;\n  BaseObject.prototype = Object.create( Observable && Observable.prototype );\n  BaseObject.prototype.constructor = BaseObject;\n\n  /**\n   * Gets a value.\n   * @param {string} key Key name.\n   * @return {*} Value.\n   * @api\n   */\n  BaseObject.prototype.get = function get (key) {\n    var value;\n    if (this.values_.hasOwnProperty(key)) {\n      value = this.values_[key];\n    }\n    return value;\n  };\n\n  /**\n   * Get a list of object property names.\n   * @return {Array<string>} List of property names.\n   * @api\n   */\n  BaseObject.prototype.getKeys = function getKeys () {\n    return Object.keys(this.values_);\n  };\n\n  /**\n   * Get an object of all property names and values.\n   * @return {Object<string, *>} Object.\n   * @api\n   */\n  BaseObject.prototype.getProperties = function getProperties () {\n    return assign({}, this.values_);\n  };\n\n  /**\n   * @param {string} key Key name.\n   * @param {*} oldValue Old value.\n   */\n  BaseObject.prototype.notify = function notify (key, oldValue) {\n    var eventType;\n    eventType = getChangeEventType(key);\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    eventType = ObjectEventType.PROPERTYCHANGE;\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n  };\n\n  /**\n   * Sets a value.\n   * @param {string} key Key name.\n   * @param {*} value Value.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.set = function set (key, value, opt_silent) {\n    if (opt_silent) {\n      this.values_[key] = value;\n    } else {\n      var oldValue = this.values_[key];\n      this.values_[key] = value;\n      if (oldValue !== value) {\n        this.notify(key, oldValue);\n      }\n    }\n  };\n\n  /**\n   * Sets a collection of key-value pairs.  Note that this changes any existing\n   * properties and adds new ones (it does not remove any existing properties).\n   * @param {Object<string, *>} values Values.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.setProperties = function setProperties (values, opt_silent) {\n    for (var key in values) {\n      this.set(key, values[key], opt_silent);\n    }\n  };\n\n  /**\n   * Unsets a property.\n   * @param {string} key Key name.\n   * @param {boolean=} opt_silent Unset without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.unset = function unset (key, opt_silent) {\n    if (key in this.values_) {\n      var oldValue = this.values_[key];\n      delete this.values_[key];\n      if (!opt_silent) {\n        this.notify(key, oldValue);\n      }\n    }\n  };\n\n  return BaseObject;\n}(Observable));\n\n\n/**\n * @type {Object<string, string>}\n */\nvar changeEventTypeCache = {};\n\n\n/**\n * @param {string} key Key name.\n * @return {string} Change name.\n */\nexport function getChangeEventType(key) {\n  return changeEventTypeCache.hasOwnProperty(key) ?\n    changeEventTypeCache[key] :\n    (changeEventTypeCache[key] = 'change:' + key);\n}\n\n\nexport default BaseObject;\n\n//# sourceMappingURL=Object.js.map","/**\n * @module ol/Collection\n */\nimport AssertionError from './AssertionError.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport BaseObject from './Object.js';\nimport Event from './events/Event.js';\n\n\n/**\n * @enum {string}\n * @private\n */\nvar Property = {\n  LENGTH: 'length'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n */\nexport var CollectionEvent = /*@__PURE__*/(function (Event) {\n  function CollectionEvent(type, opt_element) {\n    Event.call(this, type);\n\n    /**\n     * The element that is added to or removed from the collection.\n     * @type {*}\n     * @api\n     */\n    this.element = opt_element;\n\n  }\n\n  if ( Event ) CollectionEvent.__proto__ = Event;\n  CollectionEvent.prototype = Object.create( Event && Event.prototype );\n  CollectionEvent.prototype.constructor = CollectionEvent;\n\n  return CollectionEvent;\n}(Event));\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @fires CollectionEvent\n *\n * @template T\n * @api\n */\nvar Collection = /*@__PURE__*/(function (BaseObject) {\n  function Collection(opt_array, opt_options) {\n\n    BaseObject.call(this);\n\n    var options = opt_options || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.unique_ = !!options.unique;\n\n    /**\n     * @private\n     * @type {!Array<T>}\n     */\n    this.array_ = opt_array ? opt_array : [];\n\n    if (this.unique_) {\n      for (var i = 0, ii = this.array_.length; i < ii; ++i) {\n        this.assertUnique_(this.array_[i], i);\n      }\n    }\n\n    this.updateLength_();\n\n  }\n\n  if ( BaseObject ) Collection.__proto__ = BaseObject;\n  Collection.prototype = Object.create( BaseObject && BaseObject.prototype );\n  Collection.prototype.constructor = Collection;\n\n  /**\n   * Remove all elements from the collection.\n   * @api\n   */\n  Collection.prototype.clear = function clear () {\n    while (this.getLength() > 0) {\n      this.pop();\n    }\n  };\n\n  /**\n   * Add elements to the collection.  This pushes each item in the provided array\n   * to the end of the collection.\n   * @param {!Array<T>} arr Array.\n   * @return {Collection<T>} This collection.\n   * @api\n   */\n  Collection.prototype.extend = function extend (arr) {\n    for (var i = 0, ii = arr.length; i < ii; ++i) {\n      this.push(arr[i]);\n    }\n    return this;\n  };\n\n  /**\n   * Iterate over each element, calling the provided callback.\n   * @param {function(T, number, Array<T>): *} f The function to call\n   *     for every element. This function takes 3 arguments (the element, the\n   *     index and the array). The return value is ignored.\n   * @api\n   */\n  Collection.prototype.forEach = function forEach (f) {\n    var array = this.array_;\n    for (var i = 0, ii = array.length; i < ii; ++i) {\n      f(array[i], i, array);\n    }\n  };\n\n  /**\n   * Get a reference to the underlying Array object. Warning: if the array\n   * is mutated, no events will be dispatched by the collection, and the\n   * collection's \"length\" property won't be in sync with the actual length\n   * of the array.\n   * @return {!Array<T>} Array.\n   * @api\n   */\n  Collection.prototype.getArray = function getArray () {\n    return this.array_;\n  };\n\n  /**\n   * Get the element at the provided index.\n   * @param {number} index Index.\n   * @return {T} Element.\n   * @api\n   */\n  Collection.prototype.item = function item (index) {\n    return this.array_[index];\n  };\n\n  /**\n   * Get the length of this collection.\n   * @return {number} The length of the array.\n   * @observable\n   * @api\n   */\n  Collection.prototype.getLength = function getLength () {\n    return this.get(Property.LENGTH);\n  };\n\n  /**\n   * Insert an element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  Collection.prototype.insertAt = function insertAt (index, elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    this.array_.splice(index, 0, elem);\n    this.updateLength_();\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem));\n  };\n\n  /**\n   * Remove the last element of the collection and return it.\n   * Return `undefined` if the collection is empty.\n   * @return {T|undefined} Element.\n   * @api\n   */\n  Collection.prototype.pop = function pop () {\n    return this.removeAt(this.getLength() - 1);\n  };\n\n  /**\n   * Insert the provided element at the end of the collection.\n   * @param {T} elem Element.\n   * @return {number} New length of the collection.\n   * @api\n   */\n  Collection.prototype.push = function push (elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    var n = this.getLength();\n    this.insertAt(n, elem);\n    return this.getLength();\n  };\n\n  /**\n   * Remove the first occurrence of an element from the collection.\n   * @param {T} elem Element.\n   * @return {T|undefined} The removed element or undefined if none found.\n   * @api\n   */\n  Collection.prototype.remove = function remove (elem) {\n    var arr = this.array_;\n    for (var i = 0, ii = arr.length; i < ii; ++i) {\n      if (arr[i] === elem) {\n        return this.removeAt(i);\n      }\n    }\n    return undefined;\n  };\n\n  /**\n   * Remove the element at the provided index and return it.\n   * Return `undefined` if the collection does not contain this index.\n   * @param {number} index Index.\n   * @return {T|undefined} Value.\n   * @api\n   */\n  Collection.prototype.removeAt = function removeAt (index) {\n    var prev = this.array_[index];\n    this.array_.splice(index, 1);\n    this.updateLength_();\n    this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE, prev));\n    return prev;\n  };\n\n  /**\n   * Set the element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  Collection.prototype.setAt = function setAt (index, elem) {\n    var n = this.getLength();\n    if (index < n) {\n      if (this.unique_) {\n        this.assertUnique_(elem, index);\n      }\n      var prev = this.array_[index];\n      this.array_[index] = elem;\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.REMOVE, prev));\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.ADD, elem));\n    } else {\n      for (var j = n; j < index; ++j) {\n        this.insertAt(j, undefined);\n      }\n      this.insertAt(index, elem);\n    }\n  };\n\n  /**\n   * @private\n   */\n  Collection.prototype.updateLength_ = function updateLength_ () {\n    this.set(Property.LENGTH, this.array_.length);\n  };\n\n  /**\n   * @private\n   * @param {T} elem Element.\n   * @param {number=} opt_except Optional index to ignore.\n   */\n  Collection.prototype.assertUnique_ = function assertUnique_ (elem, opt_except) {\n    for (var i = 0, ii = this.array_.length; i < ii; ++i) {\n      if (this.array_[i] === elem && i !== opt_except) {\n        throw new AssertionError(58);\n      }\n    }\n  };\n\n  return Collection;\n}(BaseObject));\n\n\nexport default Collection;\n\n//# sourceMappingURL=Collection.js.map","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\n\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\r\nimport ol_style_Style from 'ol/style/Style'\r\nimport ol_style_Stroke from 'ol/style/Stroke'\r\nimport ol_source_Vector from 'ol/source/Vector'\r\nimport ol_style_Fill from 'ol/style/Fill'\r\nimport ol_style_Circle from 'ol/style/Circle'\r\nimport ol_layer_Vector from 'ol/layer/Vector'\r\nimport ol_geom_Point from 'ol/geom/Point'\r\nimport ol_Feature from 'ol/Feature'\r\nimport ol_geom_LineString from 'ol/geom/LineString'\r\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\r\nimport {ol_coordinate_dist2d, ol_coordinate_equal} from \"../geom/GeomUtils\";\r\nimport {boundingExtent as ol_extent_boundingExtent} from 'ol/extent'\r\nimport {buffer as ol_extent_buffer} from 'ol/extent'\r\nimport {altKeyOnly as ol_events_condition_altKeyOnly} from 'ol/events/condition'\r\nimport {primaryAction as ol_events_condition_primaryAction} from 'ol/events/condition'\r\nimport {always as ol_events_condition_always} from 'ol/events/condition'\r\n\r\nimport '../geom/LineStringSplitAt'\r\n\r\n/** Interaction for modifying feature geometries. Similar to the core ol/interaction/Modify.\r\n * The interaction is more suitable to use to handle feature modification: only features concerned \r\n * by the modification are passed to the events (instead of all feature with ol/interaction/Modify)\r\n * - the modifystart event is fired before the feature is modified (no points still inserted)\r\n * - the modifyend event is fired after the modification\r\n * - it fires a modifying event\r\n * @constructor\r\n * @extends {ol_interaction_Pointer}\r\n * @fires modifystart\r\n * @fires modifying\r\n * @fires modifyend\r\n * @fires select\r\n * @param {*} options\r\n *\t@param {ol.source.Vector} options.source a source to modify (configured with useSpatialIndex set to true)\r\n *\t@param {ol.source.Vector|Array<ol.source.Vector>} options.sources a list of source to modify (configured with useSpatialIndex set to true)\r\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to modify\r\n *  @param {integer} options.pixelTolerance Pixel tolerance for considering the pointer close enough to a segment or vertex for editing. Default is 10.\r\n *  @param {function|undefined} options.filter a filter that takes a feature and return true if it can be modified, default always true.\r\n *  @param {ol.style.Style | Array<ol.style.Style> | undefined} options.style Style for the sketch features.\r\n *  @param {ol.EventsConditionType | undefined} options.condition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event will be considered to add or move a vertex to the sketch. Default is ol.events.condition.primaryAction.\r\n *  @param {ol.EventsConditionType | undefined} options.deleteCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled. By default, ol.events.condition.singleClick with ol.events.condition.altKeyOnly results in a vertex deletion.\r\n *  @param {ol.EventsConditionType | undefined} options.insertVertexCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether a new vertex can be added to the sketch features. Default is ol.events.condition.always\r\n *  @param {boolean} options.wrapX Wrap the world horizontally on the sketch overlay, default false\r\n */\r\nvar ol_interaction_ModifyFeature = function(options){\r\n  if (!options) options = {};\r\n\r\n  var dragging, modifying;\r\n  ol_interaction_Pointer.call(this,{\r\n    /*\r\n    handleDownEvent: this.handleDownEvent,\r\n    handleDragEvent: this.handleDragEvent,\r\n    handleMoveEvent: this.handleMoveEvent,\r\n    handleUpEvent: this.handleUpEvent,\r\n    */\r\n    handleEvent: function(e) {\r\n      switch(e.type) {\r\n        case 'pointerdown': {\r\n          dragging = this.handleDownEvent(e);\r\n          modifying = dragging || this._deleteCondition(e);\r\n          return !dragging;\r\n        }\r\n        case 'pointerup': {\r\n          dragging = false;\r\n          return this.handleUpEvent(e);\r\n        }\r\n        case 'pointerdrag': {\r\n          if (dragging) return this.handleDragEvent(e);\r\n          else return true;\r\n        }\r\n        case 'pointermove': {\r\n          if (!dragging) return this.handleMoveEvent(e);\r\n          else return true;\r\n        }\r\n        case 'singleclick':\r\n        case 'click': {\r\n          // Prevent click when modifying\r\n          return !modifying;\r\n        }\r\n        default: return true;\r\n      }\r\n    }\r\n  });\r\n\r\n  // Snap distance (in px)\r\n  this.snapDistance_ = options.pixelTolerance || 10;\r\n  // Split tolerance between the calculated intersection and the geometry\r\n  this.tolerance_ = 1e-10;\r\n  // Cursor\r\n  this.cursor_ = options.cursor;\r\n\r\n  // List of source to split\r\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\r\n  if (options.source) this.sources_.push (options.source);\r\n  if (options.features) this.sources_.push (new ol_source_Vector({ features: options.features }));\r\n\r\n  // Get all features candidate\r\n  this.filterSplit_ = options.filter || function(){ return true; };\r\n\r\n  this._condition = options.condition || ol_events_condition_primaryAction;\r\n  this._deleteCondition = options.deleteCondition || ol_events_condition_altKeyOnly;\r\n  this._insertVertexCondition = options.insertVertexCondition || ol_events_condition_always;\r\n\r\n  // Default style\r\n  var sketchStyle = function() {\r\n    return [ new ol_style_Style({\r\n        image: new ol_style_Circle({\r\n          radius: 6,\r\n          fill: new ol_style_Fill({ color: [0, 153, 255, 1] }),\r\n          stroke: new ol_style_Stroke({ color: '#FFF', width: 1.25 })\r\n        })\r\n      })\r\n    ];\r\n  }\r\n\r\n  // Custom style\r\n  if (options.style) {\r\n    if (typeof(options.style) === 'function') {\r\n      sketchStyle = options.style\r\n     } else {\r\n       sketchStyle = function() { return options.style; }\r\n     }\r\n  }\r\n\r\n  // Create a new overlay for the sketch\r\n  this.overlayLayer_ = new ol_layer_Vector({\r\n    source: new ol_source_Vector({\r\n      useSpatialIndex: false\r\n    }),\r\n    name:'Modify overlay',\r\n    displayInLayerSwitcher: false,\r\n    style: sketchStyle,\r\n    wrapX: options.wrapX\r\n  });\r\n\r\n};\r\nol_ext_inherits(ol_interaction_ModifyFeature, ol_interaction_Pointer);\r\n\r\n/**\r\n * Remove the interaction from its current map, if any,  and attach it to a new\r\n * map, if any. Pass `null` to just remove the interaction from the current map.\r\n * @param {ol.Map} map Map.\r\n * @api stable\r\n */\r\nol_interaction_ModifyFeature.prototype.setMap = function(map) {\r\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\r\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\r\n  this.overlayLayer_.setMap(map);\r\n};\r\n\r\n/**\r\n * Activate or deactivate the interaction + remove the sketch.\r\n * @param {boolean} active.\r\n * @api stable\r\n */\r\nol_interaction_ModifyFeature.prototype.setActive = function(active) {\r\n  ol_interaction_Interaction.prototype.setActive.call (this, active);\r\n  if (this.overlayLayer_) this.overlayLayer_.getSource().clear();\r\n};\r\n\r\n/** Get closest feature at pixel\r\n * @param {ol.Pixel} \r\n * @return {*} \r\n * @private\r\n */\r\nol_interaction_ModifyFeature.prototype.getClosestFeature = function(e) {\r\n  var f, c, d = this.snapDistance_+1;\r\n  for (var i=0; i<this.sources_.length; i++) {\r\n    var source = this.sources_[i];\r\n    f = source.getClosestFeatureToCoordinate(e.coordinate);\r\n    if (f && this.filterSplit_(f)) {\r\n      var ci = f.getGeometry().getClosestPoint(e.coordinate);\r\n      var di = ol_coordinate_dist2d(e.coordinate,ci) / e.frameState.viewState.resolution;\r\n      if (di < d){\r\n        d = di;\r\n        c = ci;\r\n      }\r\n      break;\r\n    }\r\n  }\r\n  if (d > this.snapDistance_) {\r\n    if (this.currentFeature) this.dispatchEvent({ type: 'select', selected: [], deselected: [this.currentFeature] })\r\n    this.currentFeature = null;\r\n    return false;\r\n  } else {\r\n    // Snap to node\r\n    var coord = this.getNearestCoord (c, f.getGeometry());\r\n    if (coord) {\r\n      coord = coord.coord;\r\n      var p = this.getMap().getPixelFromCoordinate(coord);\r\n      if (ol_coordinate_dist2d(e.pixel, p) < this.snapDistance_) {\r\n        c = coord;\r\n      }\r\n      //\r\n      if (this.currentFeature !== f) this.dispatchEvent({ type: 'select', selected: [f], deselected: [this.currentFeature] })\r\n      this.currentFeature = f;\r\n      return { source:source, feature:f, coord: c };\r\n    }\r\n  }\r\n}\r\n\r\n/** Get nearest coordinate in a list \r\n* @param {ol.coordinate} pt the point to find nearest\r\n* @param {ol.geom} coords list of coordinates\r\n* @return {*} the nearest point with a coord (projected point), dist (distance to the geom), ring (if Polygon)\r\n*/\r\nol_interaction_ModifyFeature.prototype.getNearestCoord = function(pt, geom) {\r\n  var i, l, p, p0, dm;\r\n  switch (geom.getType()) {\r\n    case 'Point': {\r\n      return { coord: geom.getCoordinates(), dist: ol_coordinate_dist2d(geom.getCoordinates(), pt) };\r\n    }\r\n    case 'MultiPoint': {\r\n      return this.getNearestCoord (pt, new ol_geom_LineString(geom.getCoordinates()));\r\n    }\r\n    case 'LineString':\r\n    case 'LinearRing': {\r\n      var d;\r\n      dm = Number.MAX_VALUE;\r\n      var coords = geom.getCoordinates();\r\n      for (i=0; i < coords.length; i++) {\r\n        d = ol_coordinate_dist2d (pt, coords[i]);\r\n        if (d < dm) {\r\n          dm = d;\r\n          p0 = coords[i];\r\n        }\r\n      }\r\n      return { coord: p0, dist: dm };\r\n    }\r\n    case 'MultiLineString': {\r\n      var lstring = geom.getLineStrings();\r\n      p0 = false, dm = Number.MAX_VALUE;\r\n      for (i=0; l=lstring[i]; i++) {\r\n        p = this.getNearestCoord(pt, l);\r\n        if (p && p.dist<dm) {\r\n          p0 = p;\r\n          dm = p.dist;\r\n          p0.ring = i;\r\n        }\r\n      }\r\n      return p0;\r\n    }\r\n    case 'Polygon': {\r\n      var lring = geom.getLinearRings();\r\n      p0 = false;\r\n      dm = Number.MAX_VALUE;\r\n      for (i=0; l=lring[i]; i++) {\r\n        p = this.getNearestCoord(pt, l);\r\n        if (p && p.dist<dm) {\r\n          p0 = p;\r\n          dm = p.dist;\r\n          p0.ring = i;\r\n        }\r\n      }\r\n      return p0;\r\n    }\r\n    case 'MultiPolygon': {\r\n      var poly = geom.getPolygons();\r\n      p0 = false;\r\n      dm = Number.MAX_VALUE;\r\n      for (i=0; l=poly[i]; i++) {\r\n        p = this.getNearestCoord(pt, l);\r\n        if (p && p.dist<dm) {\r\n          p0 = p;\r\n          dm = p.dist;\r\n          p0.poly = i;\r\n        }\r\n      }\r\n      return p0;\r\n    }\r\n    case 'GeometryCollection': {\r\n      var g = geom.getGeometries();\r\n      p0 = false;\r\n      dm = Number.MAX_VALUE;\r\n      for (i=0; l=g[i]; i++) {\r\n        p = this.getNearestCoord(pt, l);\r\n        if (p && p.dist<dm) {\r\n          p0 = p;\r\n          dm = p.dist;\r\n          p0.geom = i;\r\n        }\r\n      }\r\n      return p0;\r\n    }\r\n    default: return false;\r\n  }\r\n};\r\n\r\n/** Get arcs concerned by a modification \r\n * @param {ol.geom} geom the geometry concerned\r\n * @param {ol.coordinate} coord pointed coordinates\r\n */\r\nol_interaction_ModifyFeature.prototype.getArcs = function(geom, coord) {\r\n  var arcs = false;\r\n  var coords, i, s, l, g;\r\n  switch(geom.getType()) {\r\n    case 'Point': {\r\n      if (ol_coordinate_equal(coord, geom.getCoordinates())) {\r\n        arcs = { \r\n          geom: geom, \r\n          type: geom.getType(),\r\n          coord1: [],\r\n          coord2: [],\r\n          node: true\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'MultiPoint': {\r\n      coords = geom.getCoordinates();\r\n      for (i=0; i < coords.length; i++) {\r\n        if (ol_coordinate_equal(coord, coords[i])) {\r\n          arcs = { \r\n            geom: geom, \r\n            type: geom.getType(),\r\n            index: i,\r\n            coord1: [],\r\n            coord2: [],\r\n            node: true\r\n          }\r\n          break;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'LinearRing': \r\n    case 'LineString': {\r\n      var p = geom.getClosestPoint(coord);\r\n      if (ol_coordinate_dist2d(p,coord) < 1.5*this.tolerance_) {\r\n        var split;\r\n        // Split the line in two\r\n        if (geom.getType() === 'LinearRing') {\r\n          g = new ol_geom_LineString(geom.getCoordinates());\r\n          split = g.splitAt(coord, this.tolerance_);\r\n        } else {\r\n          split = geom.splitAt(coord, this.tolerance_);\r\n        }\r\n        // If more than 2\r\n        if (split.length>2) {\r\n          coords = split[1].getCoordinates();\r\n          for (i=2; s=split[i]; i++) {\r\n            var c = s.getCoordinates();\r\n            c.shift();\r\n            coords = coords.concat(c);\r\n          }\r\n          split = [ split[0], new ol_geom_LineString(coords) ];\r\n        }\r\n        // Split in two\r\n        if (split.length === 2) {\r\n          var c0 = split[0].getCoordinates();\r\n          var c1 = split[1].getCoordinates();\r\n          var nbpt = c0.length + c1.length -1;\r\n          c0.pop();\r\n          c1.shift();\r\n          arcs = { \r\n            geom: geom, \r\n            type: geom.getType(),\r\n            coord1: c0, \r\n            coord2: c1,\r\n            node: (geom.getCoordinates().length === nbpt),\r\n            closed: false\r\n          }\r\n        } else if (split.length === 1) {\r\n          s = split[0].getCoordinates();\r\n          var start = ol_coordinate_equal(s[0], coord);\r\n          var end = ol_coordinate_equal(s[s.length-1], coord);\r\n          // Move first point\r\n          if (start) {\r\n            s.shift();\r\n            if (end) s.pop();\r\n            arcs = { \r\n              geom: geom, \r\n              type: geom.getType(),\r\n              coord1: [], \r\n              coord2: s,\r\n              node: true,\r\n              closed: end\r\n            }\r\n          } else if (end) {\r\n            // Move last point\r\n            s.pop()\r\n            arcs = { \r\n              geom: geom, \r\n              type: geom.getType(),\r\n              coord1: s, \r\n              coord2: [],\r\n              node: true,\r\n              closed: false\r\n            }\r\n          }\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'MultiLineString': {\r\n      var lstring = geom.getLineStrings();\r\n      for (i=0; l=lstring[i]; i++) {\r\n        arcs = this.getArcs(l, coord);\r\n        if (arcs) {\r\n          arcs.geom = geom;\r\n          arcs.type = geom.getType();\r\n          arcs.lstring = i;\r\n          break;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'Polygon': {\r\n      var lring = geom.getLinearRings();\r\n      for (i=0; l=lring[i]; i++) {\r\n        arcs = this.getArcs(l, coord);\r\n        if (arcs) {\r\n          arcs.geom = geom;\r\n          arcs.type = geom.getType();\r\n          arcs.index = i;\r\n          break;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'MultiPolygon': {\r\n      var poly = geom.getPolygons();\r\n      for (i=0; l=poly[i]; i++) {\r\n        arcs = this.getArcs(l, coord);\r\n        if (arcs) {\r\n          arcs.geom = geom;\r\n          arcs.type = geom.getType();\r\n          arcs.poly = i;\r\n          break;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'GeometryCollection': {\r\n      g = geom.getGeometries();\r\n      for (i=0; l=g[i]; i++) {\r\n        arcs = this.getArcs(l, coord);\r\n        if (arcs) {\r\n          arcs.geom = geom;\r\n          arcs.g = i;\r\n          arcs.typeg = arcs.type;\r\n          arcs.type = geom.getType();\r\n          break;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    default: {\r\n      console.error('ol/interaction/ModifyFeature '+geom.getType()+' not supported!');\r\n      break;\r\n    }\r\n  }\r\n  return arcs;\r\n};\r\n\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @return {boolean} `true` to start the drag sequence.\r\n */\r\nol_interaction_ModifyFeature.prototype.handleDownEvent = function(evt) {\r\n  if (!this.getActive()) return false;\r\n\r\n  // Something to move ?\r\n  var current = this.getClosestFeature(evt);\r\n\r\n  if (current && (this._condition(evt) || this._deleteCondition(evt))) {\r\n    var features = [];\r\n    this.arcs = [];\r\n\r\n    // Get features concerned\r\n    this.sources_.forEach(function(s) {\r\n      var extent = ol_extent_buffer (ol_extent_boundingExtent([current.coord]), this.tolerance_);\r\n      features = features.concat(features, s.getFeaturesInExtent(extent));\r\n    }.bind(this));\r\n\r\n    // Get arcs concerned\r\n    this._modifiedFeatures = [];\r\n    features.forEach(function(f) {\r\n      var a = this.getArcs(f.getGeometry(), current.coord);\r\n      if (a) {\r\n        if (this._insertVertexCondition(evt) || a.node) {\r\n          a.feature = f;\r\n          this._modifiedFeatures.push(f);\r\n          this.arcs.push(a);\r\n        }\r\n      }\r\n    }.bind(this));\r\n\r\n    if (this._modifiedFeatures.length) {\r\n      if (this._deleteCondition(evt)) {\r\n        return !this._removePoint(current, evt); \r\n      } else {\r\n        this.dispatchEvent({ \r\n          type:'modifystart', \r\n          coordinate: current.coord,\r\n          originalEvent: evt.originalEvent,\r\n          features: this._modifiedFeatures\r\n        });\r\n        this.handleDragEvent({ \r\n          coordinate: current.coord,\r\n          originalEvent: evt.originalEvent\r\n        })\r\n        return true;\r\n      }\r\n    } else {\r\n      return true;\r\n    }\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\n/** Get modified features\r\n * @return {Array<ol.Feature>} list of modified features\r\n */\r\nol_interaction_ModifyFeature.prototype.getModifiedFeatures = function() {\r\n  return this._modifiedFeatures || [];\r\n};\r\n\r\n/** Removes the vertex currently being pointed.\r\n */\r\nol_interaction_ModifyFeature.prototype.removePoint = function() {\r\n  this._removePoint({},{});\r\n};\r\n\r\n/**\r\n * @private\r\n */\r\nol_interaction_ModifyFeature.prototype._getModification = function(a) {\r\n  var coords = a.coord1.concat(a.coord2);\r\n  switch (a.type) {\r\n    case 'LineString': {\r\n      if (a.closed) coords.push(coords[0]);\r\n      if (coords.length>1) {\r\n        if (a.geom.getCoordinates().length != coords.length) {\r\n          a.coords = coords;\r\n          return true;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'MultiLineString': {\r\n      if (a.closed) coords.push(coords[0]);\r\n      if (coords.length>1) {\r\n        var c = a.geom.getCoordinates();\r\n        if (c[a.lstring].length != coords.length) {\r\n          c[a.lstring] = coords;\r\n          a.coords = c;\r\n          return true;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'Polygon': {\r\n      if (a.closed) coords.push(coords[0]);\r\n      if (coords.length>3) {\r\n        c = a.geom.getCoordinates();\r\n        if (c[a.index].length != coords.length) {\r\n          c[a.index] = coords;\r\n          a.coords = c;\r\n          return true;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'MultiPolygon': {\r\n      if (a.closed) coords.push(coords[0]);\r\n      if (coords.length>3) {\r\n        c = a.geom.getCoordinates();\r\n        if (c[a.poly][a.index].length != coords.length) {\r\n          c[a.poly][a.index] = coords;\r\n          a.coords = c;\r\n          return true;\r\n        }\r\n      }\r\n      break;\r\n    }\r\n    case 'GeometryCollection': {\r\n      a.type = a.typeg;\r\n      var geom = a.geom;\r\n      var geoms = geom.getGeometries();\r\n      a.geom = geoms[a.g];\r\n      var found = this._getModification(a);\r\n      // Restore current arc\r\n      geom.setGeometries(geoms);\r\n      a.geom = geom;\r\n      a.type = 'GeometryCollection';\r\n      return found;\r\n    }\r\n    default: {\r\n      //console.error('ol/interaction/ModifyFeature '+a.type+' not supported!');\r\n      break;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\n/** Removes the vertex currently being pointed.\r\n * @private\r\n */\r\nol_interaction_ModifyFeature.prototype._removePoint = function(current, evt) {\r\n  if (!this.arcs) return false;\r\n\r\n  this.overlayLayer_.getSource().clear();\r\n\r\n  var found = false;\r\n  // Get all modifications\r\n  this.arcs.forEach(function(a) {\r\n    found = found || this._getModification(a);\r\n  }.bind(this));\r\n\r\n  // Almost one point is removed\r\n  if (found) {\r\n    this.dispatchEvent({ \r\n      type:'modifystart', \r\n      coordinate: current.coord,\r\n      originalEvent: evt.originalEvent,\r\n      features: this._modifiedFeatures\r\n    });\r\n    this.arcs.forEach(function(a) {\r\n      if (a.geom.getType() === 'GeometryCollection') {\r\n        if (a.coords) {\r\n          var geoms = a.geom.getGeometries();\r\n          geoms[a.g].setCoordinates(a.coords);\r\n          a.geom.setGeometries(geoms);\r\n        }\r\n      } else {\r\n        if (a.coords) a.geom.setCoordinates(a.coords);\r\n      }\r\n    }.bind(this));\r\n    this.dispatchEvent({ \r\n      type:'modifyend', \r\n      coordinate: current.coord,\r\n      originalEvent: evt.originalEvent,\r\n      features: this._modifiedFeatures\r\n    });\r\n  }\r\n\r\n  this.arcs = [];\r\n  return found;\r\n};\r\n\r\n/**\r\n * @private\r\n */\r\nol_interaction_ModifyFeature.prototype.handleUpEvent = function(e) {\r\n  if (!this.getActive()) return false;\r\n  if (!this.arcs || !this.arcs.length) return true;\r\n\r\n  this.overlayLayer_.getSource().clear();\r\n  this.dispatchEvent({ \r\n    type:'modifyend', \r\n    coordinate: e.coordinate,\r\n    originalEvent: e.originalEvent,\r\n    features: this._modifiedFeatures\r\n  });\r\n  \r\n  this.arcs = [];\r\n  return true;\r\n};\r\n\r\n/**\r\n * @private\r\n */\r\nol_interaction_ModifyFeature.prototype.setArcCoordinates = function(a, coords) {\r\n  var c;\r\n  switch (a.type) {\r\n    case 'Point': {\r\n      a.geom.setCoordinates(coords[0]);\r\n      break;\r\n    }\r\n    case 'MultiPoint': {\r\n      c = a.geom.getCoordinates();\r\n      c[a.index] = coords[0];\r\n      a.geom.setCoordinates(c);\r\n      break;\r\n    }\r\n    case 'LineString': {\r\n      a.geom.setCoordinates(coords);\r\n      break;\r\n    }\r\n    case 'MultiLineString': {\r\n      c = a.geom.getCoordinates();\r\n      c[a.lstring] = coords;\r\n      a.geom.setCoordinates(c);\r\n      break;\r\n    }\r\n    case 'Polygon': {\r\n      c = a.geom.getCoordinates();\r\n      c[a.index] = coords;\r\n      a.geom.setCoordinates(c);\r\n      break;\r\n    }\r\n    case 'MultiPolygon': {\r\n      c = a.geom.getCoordinates();\r\n      c[a.poly][a.index] = coords;\r\n      a.geom.setCoordinates(c);\r\n      break;\r\n    }\r\n    case 'GeometryCollection': {\r\n      a.type = a.typeg;\r\n      var geom = a.geom;\r\n      var geoms = geom.getGeometries();\r\n      a.geom = geoms[a.g];\r\n      this.setArcCoordinates(a, coords);\r\n      geom.setGeometries(geoms);\r\n      a.geom = geom;\r\n      a.type = 'GeometryCollection';\r\n      break;\r\n    }\r\n  }\r\n};\r\n/**\r\n * @private\r\n */\r\nol_interaction_ModifyFeature.prototype.handleDragEvent = function(e) {\r\n  if (!this.getActive()) return false;\r\n  if (!this.arcs) return true;\r\n\r\n  // Show sketch\r\n  this.overlayLayer_.getSource().clear();\r\n  var p = new ol_Feature(new ol_geom_Point(e.coordinate));\r\n  this.overlayLayer_.getSource().addFeature(p);\r\n\r\n  // Nothing to do\r\n  if (!this.arcs.length) return true;\r\n\r\n  // Move arcs\r\n  this.arcs.forEach(function(a) {\r\n    var coords = a.coord1.concat([e.coordinate], a.coord2);\r\n    if (a.closed) coords.push(e.coordinate);\r\n    this.setArcCoordinates(a, coords);\r\n  }.bind(this));\r\n\r\n  this.dispatchEvent({ \r\n    type:'modifying', \r\n    coordinate: e.coordinate,\r\n    originalEvent: e.originalEvent,\r\n    features: this._modifiedFeatures\r\n  });\r\n\r\n  return true;\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Event.\r\n * @private\r\n */\r\nol_interaction_ModifyFeature.prototype.handleMoveEvent = function(e) {\r\n  if (!this.getActive()) return false;\r\n\r\n  this.overlayLayer_.getSource().clear();\r\n  var current = this.getClosestFeature(e);\r\n\r\n  // Draw sketch\r\n  if (current) {\r\n    var p = new ol_Feature(new ol_geom_Point(current.coord));\r\n    this.overlayLayer_.getSource().addFeature(p);\r\n  }\r\n\r\n  // Show cursor\r\n  var element = e.map.getTargetElement();\r\n  if (this.cursor_) {\r\n    if (current) {\r\n      if (element.style.cursor != this.cursor_) {\r\n        this.previousCursor_ = element.style.cursor;\r\n        element.style.cursor = this.cursor_;\r\n      }\r\n    } else if (this.previousCursor_ !== undefined) {\r\n      element.style.cursor = this.previousCursor_;\r\n      this.previousCursor_ = undefined;\r\n    }\r\n  }\r\n};\r\n\r\n/** Get the current feature to modify\r\n * @return {ol.Feature} \r\n */\r\nol_interaction_ModifyFeature.prototype.getCurrentFeature = function() {\r\n  return this.currentFeature;\r\n};\r\n\r\nexport default ol_interaction_ModifyFeature","import ol_ext_inherits from '../util/ext'\r\nimport ol_style_Style from 'ol/style/Style'\r\nimport ol_style_Stroke from 'ol/style/Stroke'\r\nimport ol_source_Vector from 'ol/source/Vector'\r\nimport ol_style_Fill from 'ol/style/Fill'\r\nimport ol_layer_Vector from 'ol/layer/Vector'\r\nimport ol_geom_Point from 'ol/geom/Point'\r\nimport ol_Feature from 'ol/Feature'\r\nimport ol_Collection from 'ol/Collection'\r\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\r\nimport ol_style_RegularShape from 'ol/style/RegularShape'\r\nimport {fromExtent as ol_geom_Polygon_fromExtent} from 'ol/geom/Polygon'\r\nimport {boundingExtent as ol_extent_boundingExtent, buffer as ol_extent_buffer, createEmpty as ol_extent_createEmpty, extend as ol_extent_extend, getCenter as ol_extent_getCenter} from 'ol/extent'\r\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\r\n\r\n/** Interaction rotate\r\n * @constructor\r\n * @extends {ol_interaction_Pointer}\r\n * @fires select | rotatestart | rotating | rotateend | translatestart | translating | translateend | scalestart | scaling | scaleend\r\n * @param {any} options\r\n *  @param {function} options.filter A function that takes a Feature and a Layer and returns true if the feature may be transformed or false otherwise.\r\n *  @param {Array<ol.Layer>} options.layers array of layers to transform,\r\n *  @param {ol.Collection<ol.Feature>} options.features collection of feature to transform,\r\n *\t@param {ol.EventsConditionType|undefined} options.condition A function that takes an ol.MapBrowserEvent and a feature collection and returns a boolean to indicate whether that event should be handled. default: ol.events.condition.always.\r\n *\t@param {ol.EventsConditionType|undefined} options.addCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled ie. the feature will be added to the transforms features. default: ol.events.condition.never.\r\n *\t@param {number | undefined} options.hitTolerance Tolerance to select feature in pixel, default 0\r\n *\t@param {bool} options.translateFeature Translate when click on feature\r\n *\t@param {bool} options.translate Can translate the feature\r\n *  @param {bool} options.translateBBox Enable translate when the user drags inside the bounding box\r\n *\t@param {bool} options.stretch can stretch the feature\r\n *\t@param {bool} options.scale can scale the feature\r\n *\t@param {bool} options.rotate can rotate the feature\r\n *\t@param {bool} options.noFlip prevent the feature geometry to flip, default false\r\n *\t@param {bool} options.selection the intraction handle selection/deselection, if not use the select prototype to add features to transform, default true\r\n *\t@param {ol.events.ConditionType | undefined} options.keepAspectRatio A function that takes an ol.MapBrowserEvent and returns a boolean to keep aspect ratio, default ol.events.condition.shiftKeyOnly.\r\n *\t@param {ol.events.ConditionType | undefined} options.modifyCenter A function that takes an ol.MapBrowserEvent and returns a boolean to apply scale & strech from the center, default ol.events.condition.metaKey or ol.events.condition.ctrlKey.\r\n *\t@param {boolean} options.enableRotatedTransform Enable transform when map is rotated\r\n *\t@param {} options.style list of ol.style for handles\r\n *\r\n */\r\nvar ol_interaction_Transform = function(options) {\r\n  if (!options) options = {};\r\n\tvar self = this;\r\n\r\n  this.selection_ = new ol_Collection();\r\n\r\n\t// Create a new overlay layer for the sketch\r\n\tthis.handles_ = new ol_Collection();\r\n\tthis.overlayLayer_ = new ol_layer_Vector({\r\n    source: new ol_source_Vector({\r\n      features: this.handles_,\r\n      useSpatialIndex: false,\r\n      wrapX: false // For vector editing across the -180° and 180° meridians to work properly, this should be set to false\r\n    }),\r\n    name:'Transform overlay',\r\n    displayInLayerSwitcher: false,\r\n    // Return the style according to the handle type\r\n    style: function (feature) {\r\n      return (self.style[(feature.get('handle')||'default')+(feature.get('constraint')||'')+(feature.get('option')||'')]);\r\n    },\r\n  });\r\n\r\n  // Extend pointer\r\n  ol_interaction_Pointer.call(this, {\r\n    handleDownEvent: this.handleDownEvent_,\r\n    handleDragEvent: this.handleDragEvent_,\r\n    handleMoveEvent: this.handleMoveEvent_,\r\n    handleUpEvent: this.handleUpEvent_\r\n  });\r\n\r\n  // Collection of feature to transform\r\n  this.features_ = options.features;\r\n  // Filter or list of layers to transform\r\n  if (typeof(options.filter)==='function') this._filter = options.filter;\r\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\r\n\r\n  this._handleEvent = options.condition || function() { return true; };\r\n  this.addFn_ = options.addCondition || function() { return false; };\r\n  /* Translate when click on feature */\r\n  this.set('translateFeature', (options.translateFeature!==false));\r\n  /* Can translate the feature */\r\n  this.set('translate', (options.translate!==false));\r\n  /* Translate when click on the bounding box */\r\n  this.set('translateBBox', (options.translateBBox===true));\r\n  /* Can stretch the feature */\r\n  this.set('stretch', (options.stretch!==false));\r\n  /* Can scale the feature */\r\n  this.set('scale', (options.scale!==false));\r\n  /* Can rotate the feature */\r\n  this.set('rotate', (options.rotate!==false));\r\n  /* Keep aspect ratio */\r\n  this.set('keepAspectRatio', (options.keepAspectRatio || function(e){ return e.originalEvent.shiftKey }));\r\n  /* Modify center */\r\n  this.set('modifyCenter', (options.modifyCenter || function(e){ return e.originalEvent.metaKey || e.originalEvent.ctrlKey }));\r\n  /* Prevent flip */\r\n  this.set('noFlip', (options.noFlip || false));\r\n  /* Handle selection */\r\n  this.set('selection', (options.selection !== false));\r\n  /*  */\r\n  this.set('hitTolerance', (options.hitTolerance || 0));\r\n  /* Enable view rotated transforms */\r\n  this.set('enableRotatedTransform', (options.enableRotatedTransform || false));\r\n\r\n\r\n  // Force redraw when changed\r\n  this.on ('propertychange', function() {\r\n    this.drawSketch_();\r\n  });\r\n\r\n  // setstyle\r\n  this.setDefaultStyle();\r\n};\r\nol_ext_inherits(ol_interaction_Transform, ol_interaction_Pointer);\r\n\r\n/** Cursors for transform\r\n*/\r\nol_interaction_Transform.prototype.Cursors = {\r\n  'default': 'auto',\r\n  'select': 'pointer',\r\n  'translate': 'move',\r\n  'rotate': 'move',\r\n  'rotate0': 'move',\r\n  'scale': 'nesw-resize',\r\n  'scale1': 'nwse-resize',\r\n  'scale2': 'nesw-resize',\r\n  'scale3': 'nwse-resize',\r\n  'scalev': 'ew-resize',\r\n  'scaleh1': 'ns-resize',\r\n  'scalev2': 'ew-resize',\r\n  'scaleh3': 'ns-resize'\r\n};\r\n\r\n/**\r\n * Remove the interaction from its current map, if any,  and attach it to a new\r\n * map, if any. Pass `null` to just remove the interaction from the current map.\r\n * @param {ol.Map} map Map.\r\n * @api stable\r\n */\r\nol_interaction_Transform.prototype.setMap = function(map) {\r\n  var oldMap = this.getMap();\r\n  if (oldMap) {\r\n    var targetElement = oldMap.getTargetElement();\r\n    oldMap.removeLayer(this.overlayLayer_);\r\n    if (this.previousCursor_ && targetElement) {\r\n      targetElement.style.cursor = this.previousCursor_;\r\n    }\r\n    this.previousCursor_ = undefined;\r\n  }\r\n  ol_interaction_Pointer.prototype.setMap.call (this, map);\r\n  this.overlayLayer_.setMap(map);\r\n  if (map === null) {\r\n    this.select(null);\r\n  }\r\n  if (map !== null) {\r\n    this.isTouch = /touch/.test(map.getViewport().className);\r\n    this.setDefaultStyle();\r\n  }\r\n};\r\n\r\n/**\r\n * Activate/deactivate interaction\r\n * @param {bool}\r\n * @api stable\r\n */\r\nol_interaction_Transform.prototype.setActive = function(b) {\r\n  this.select(null);\r\n  this.overlayLayer_.setVisible(b);\r\n  ol_interaction_Pointer.prototype.setActive.call (this, b);\r\n};\r\n\r\n/** Set efault sketch style\r\n*/\r\nol_interaction_Transform.prototype.setDefaultStyle = function() {\r\n  // Style\r\n  var stroke = new ol_style_Stroke({ color: [255,0,0,1], width: 1 });\r\n  var strokedash = new ol_style_Stroke({ color: [255,0,0,1], width: 1, lineDash:[4,4] });\r\n  var fill0 = new ol_style_Fill({ color:[255,0,0,0.01] });\r\n  var fill = new ol_style_Fill({ color:[255,255,255,0.8] });\r\n  var circle = new ol_style_RegularShape({\r\n      fill: fill,\r\n      stroke: stroke,\r\n      radius: this.isTouch ? 12 : 6,\r\n      points: 15\r\n    });\r\n  circle.getAnchor()[0] = this.isTouch ? -10 : -5;\r\n  var bigpt = new ol_style_RegularShape({\r\n      fill: fill,\r\n      stroke: stroke,\r\n      radius: this.isTouch ? 16 : 8,\r\n      points: 4,\r\n      angle: Math.PI/4\r\n    });\r\n  var smallpt = new ol_style_RegularShape({\r\n      fill: fill,\r\n      stroke: stroke,\r\n      radius: this.isTouch ? 12 : 6,\r\n      points: 4,\r\n      angle: Math.PI/4\r\n    });\r\n  function createStyle (img, stroke, fill) {\r\n    return [ new ol_style_Style({image:img, stroke:stroke, fill:fill}) ];\r\n  }\r\n  /** Style for handles */\r\n  this.style = {\r\n    'default': createStyle (bigpt, strokedash, fill0),\r\n    'translate': createStyle (bigpt, stroke, fill),\r\n    'rotate': createStyle (circle, stroke, fill),\r\n    'rotate0': createStyle (bigpt, stroke, fill),\r\n    'scale': createStyle (bigpt, stroke, fill),\r\n    'scale1': createStyle (bigpt, stroke, fill),\r\n    'scale2': createStyle (bigpt, stroke, fill),\r\n    'scale3': createStyle (bigpt, stroke, fill),\r\n    'scalev': createStyle (smallpt, stroke, fill),\r\n    'scaleh1': createStyle (smallpt, stroke, fill),\r\n    'scalev2': createStyle (smallpt, stroke, fill),\r\n    'scaleh3': createStyle (smallpt, stroke, fill),\r\n  };\r\n  this.drawSketch_();\r\n}\r\n\r\n/**\r\n * Set sketch style.\r\n * @param {style} style Style name: 'default','translate','rotate','rotate0','scale','scale1','scale2','scale3','scalev','scaleh1','scalev2','scaleh3'\r\n * @param {ol.style.Style|Array<ol.style.Style>} olstyle\r\n * @api stable\r\n */\r\nol_interaction_Transform.prototype.setStyle = function(style, olstyle) {\r\n  if (!olstyle) return;\r\n  if (olstyle instanceof Array) this.style[style] = olstyle;\r\n  else this.style[style] = [ olstyle ];\r\n  for (var i=0; i<this.style[style].length; i++) {\r\n    var im = this.style[style][i].getImage();\r\n    if (im) {\r\n      if (style == 'rotate') im.getAnchor()[0] = -5;\r\n      if (this.isTouch) im.setScale(1.8);\r\n    }\r\n    var tx = this.style[style][i].getText();\r\n    if (tx) {\r\n      if (style == 'rotate') tx.setOffsetX(this.isTouch ? 14 : 7);\r\n      if (this.isTouch) tx.setScale(1.8);\r\n    }\r\n  }\r\n  this.drawSketch_();\r\n};\r\n\r\n/** Get Feature at pixel\r\n * @param {ol.Pixel}\r\n * @return {ol.feature}\r\n * @private\r\n */\r\nol_interaction_Transform.prototype.getFeatureAtPixel_ = function(pixel) {\r\n  var self = this;\r\n  return this.getMap().forEachFeatureAtPixel(pixel,\r\n    function(feature, layer) {\r\n      var found = false;\r\n      // Overlay ?\r\n      if (!layer) {\r\n        if (feature===self.bbox_) {\r\n          if (self.get('translateBBox')) {\r\n            return { feature: feature, handle: 'translate', constraint:'', option: '' };\r\n          } else {\r\n            return false;\r\n          }\r\n        }\r\n        self.handles_.forEach (function(f) { if (f===feature) found=true; });\r\n        if (found) return { feature: feature, handle:feature.get('handle'), constraint:feature.get('constraint'), option:feature.get('option') };\r\n      }\r\n      // No seletion\r\n      if (!self.get('selection')) {\r\n        // Return the currently selected feature the user is interacting with.\r\n        if (self.selection_.getArray().some(function(f) { return feature === f; })) {\r\n          return { feature: feature };\r\n        }\r\n        return null;\r\n      }\r\n      // filter condition\r\n      if (self._filter) {\r\n        if (self._filter(feature,layer)) return { feature: feature };\r\n        else return null;\r\n      }\r\n      // feature belong to a layer\r\n      else if (self.layers_) {\r\n        for (var i=0; i<self.layers_.length; i++) {\r\n          if (self.layers_[i]===layer) return { feature: feature };\r\n        }\r\n        return null;\r\n      }\r\n      // feature in the collection\r\n      else if (self.features_) {\r\n        self.features_.forEach (function(f) { if (f===feature) found=true; });\r\n        if (found) return { feature: feature };\r\n        else return null;\r\n      }\r\n      // Others\r\n      else return { feature: feature };\r\n    },\r\n    { hitTolerance: this.get('hitTolerance') }\r\n  ) || {};\r\n}\r\n\r\n/** Rotate feature from map view rotation\r\n * @param {ol.Feature} f the feature\r\n * @param {boolean} clone clone resulting geom\r\n * @param {ol.geom.Geometry} rotated geometry\r\n */\r\nol_interaction_Transform.prototype.getGeometryRotateToZero_ = function(f, clone) {\r\n  var origGeom = f.getGeometry();\r\n  var viewRotation = this.getMap().getView().getRotation();\r\n  if (viewRotation === 0 || !this.get('enableRotatedTransform')) {\r\n    return (clone) ? origGeom.clone() : origGeom;\r\n  }\r\n  var rotGeom = origGeom.clone();\r\n  rotGeom.rotate(viewRotation * -1, this.getMap().getView().getCenter());\r\n  return rotGeom;\r\n}\r\n\r\n/** Draw transform sketch\r\n* @param {boolean} draw only the center\r\n*/\r\nol_interaction_Transform.prototype.drawSketch_ = function(center) {\r\n  var i, f, geom;\r\n  this.overlayLayer_.getSource().clear();\r\n  if (!this.selection_.getLength()) return;\r\n  var viewRotation = this.getMap().getView().getRotation();\r\n  var ext = this.getGeometryRotateToZero_(this.selection_.item(0)).getExtent();\r\n  // Clone and extend\r\n  ext = ol_extent_buffer(ext, 0);\r\n  this.selection_.forEach(function (f) {\r\n    var extendExt = this.getGeometryRotateToZero_(f).getExtent();\r\n    ol_extent_extend(ext, extendExt);\r\n  }.bind(this));\r\n\r\n  if (center===true) {\r\n    if (!this.ispt_) {\r\n      this.overlayLayer_.getSource().addFeature(new ol_Feature( { geometry: new ol_geom_Point(this.center_), handle:'rotate0' }) );\r\n      geom = ol_geom_Polygon_fromExtent(ext);\r\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n        geom.rotate(viewRotation, this.getMap().getView().getCenter())\r\n      }\r\n      f = this.bbox_ = new ol_Feature(geom);\r\n      this.overlayLayer_.getSource().addFeature (f);\r\n    }\r\n  }\r\n  else {\r\n    if (this.ispt_) {\r\n      var p = this.getMap().getPixelFromCoordinate([ext[0], ext[1]]);\r\n      ext = ol_extent_boundingExtent([\r\n        this.getMap().getCoordinateFromPixel([p[0]-10, p[1]-10]),\r\n        this.getMap().getCoordinateFromPixel([p[0]+10, p[1]+10])\r\n      ]);\r\n    }\r\n    geom = ol_geom_Polygon_fromExtent(ext);\r\n    if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n      geom.rotate(viewRotation, this.getMap().getView().getCenter())\r\n    }\r\n    f = this.bbox_ = new ol_Feature(geom);\r\n    var features = [];\r\n    var g = geom.getCoordinates()[0];\r\n    if (!this.ispt_) {\r\n      features.push(f);\r\n      // Middle\r\n      if (!this.iscircle_ && this.get('stretch') && this.get('scale')) for (i=0; i<g.length-1; i++) {\r\n        f = new ol_Feature( { geometry: new ol_geom_Point([(g[i][0]+g[i+1][0])/2,(g[i][1]+g[i+1][1])/2]), handle:'scale', constraint:i%2?\"h\":\"v\", option:i });\r\n        features.push(f);\r\n      }\r\n      // Handles\r\n      if (this.get('scale')) for (i=0; i<g.length-1; i++) {\r\n        f = new ol_Feature( { geometry: new ol_geom_Point(g[i]), handle:'scale', option:i });\r\n        features.push(f);\r\n      }\r\n      // Center\r\n      if (this.get('translate') && !this.get('translateFeature')) {\r\n        f = new ol_Feature( { geometry: new ol_geom_Point([(g[0][0]+g[2][0])/2, (g[0][1]+g[2][1])/2]), handle:'translate' });\r\n        features.push(f);\r\n      }\r\n    }\r\n    // Rotate\r\n    if (!this.iscircle_ && this.get('rotate')) {\r\n      f = new ol_Feature( { geometry: new ol_geom_Point(g[3]), handle:'rotate' });\r\n      features.push(f);\r\n    }\r\n    // Add sketch\r\n    this.overlayLayer_.getSource().addFeatures(features);\r\n  }\r\n\r\n};\r\n\r\n/** Select a feature to transform\r\n* @param {ol.Feature} feature the feature to transform\r\n* @param {boolean} add true to add the feature to the selection, default false\r\n*/\r\nol_interaction_Transform.prototype.select = function(feature, add) {\r\n  if (!feature) {\r\n    this.selection_.clear();\r\n    this.drawSketch_();\r\n    return;\r\n  }\r\n  if (!feature.getGeometry || !feature.getGeometry()) return;\r\n  // Add to selection\r\n  if (add) {\r\n    this.selection_.push(feature);\r\n  } else {\r\n\tvar index = this.selection_.getArray().indexOf(feature);\r\n\tthis.selection_.removeAt(index);\t\r\n  }\r\n  this.ispt_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false);\r\n  this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\r\n  this.drawSketch_();\r\n  this.watchFeatures_();\r\n  // select event\r\n  this.dispatchEvent({ type:'select', feature: feature, features: this.selection_ });\r\n};\r\n\r\n/** Update the selection collection.\r\n* @param {ol.Collection<ol.Feature>} features the features to transform\r\n*/\r\nol_interaction_Transform.prototype.setSelection = function(features) {\r\n  this.selection_.clear();\r\n  features.forEach(function(feature) {\r\n    this.selection_.push(feature);\r\n  }.bind(this));\r\n\r\n  this.ispt_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false);\r\n  this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\r\n  this.drawSketch_();\r\n  this.watchFeatures_();\r\n  // select event\r\n  this.dispatchEvent({ type:'select', features: this.selection_ });\r\n};\r\n\r\n/** Watch selected features\r\n * @private\r\n */\r\nol_interaction_Transform.prototype.watchFeatures_ = function() {\r\n  // Listen to feature modification\r\n  if (this._featureListeners) {\r\n    this._featureListeners.forEach(function (l) {\r\n      ol_Observable_unByKey(l)\r\n    });\r\n  }\r\n  this._featureListeners = [];\r\n  this.selection_.forEach(function(f) {\r\n    this._featureListeners.push(\r\n      f.on('change', function() {\r\n        if (!this.isUpdating_) {\r\n          this.drawSketch_();\r\n        }\r\n      }.bind(this))\r\n    );\r\n  }.bind(this));\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @return {boolean} `true` to start the drag sequence.\r\n * @private\r\n */\r\nol_interaction_Transform.prototype.handleDownEvent_ = function(evt) {\r\n  if (!this._handleEvent(evt, this.selection_)) return;\r\n  var sel = this.getFeatureAtPixel_(evt.pixel);\r\n  var feature = sel.feature;\r\n  if (this.selection_.getLength()\r\n    && this.selection_.getArray().indexOf(feature) >= 0\r\n    && ((this.ispt_ && this.get('translate')) || this.get('translateFeature'))\r\n  ){\r\n    sel.handle = 'translate';\r\n  }\r\n  if (sel.handle) {\r\n    this.mode_ = sel.handle;\r\n    this.opt_ = sel.option;\r\n    this.constraint_ = sel.constraint;\r\n    // Save info\r\n    var viewRotation = this.getMap().getView().getRotation();\r\n    this.coordinate_ = evt.coordinate;\r\n    this.pixel_ = evt.pixel;\r\n    this.geoms_ = [];\r\n    this.rotatedGeoms_ = [];\r\n    var extent = ol_extent_createEmpty();\r\n    var rotExtent = ol_extent_createEmpty();\r\n    for (var i=0, f; f=this.selection_.item(i); i++) {\r\n      this.geoms_.push(f.getGeometry().clone());\r\n      extent = ol_extent_extend(extent, f.getGeometry().getExtent());\r\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n        var rotGeom = this.getGeometryRotateToZero_(f, true);\r\n        this.rotatedGeoms_.push(rotGeom);\r\n        rotExtent = ol_extent_extend(rotExtent, rotGeom.getExtent());\r\n      }\r\n    }\r\n    this.extent_ = (ol_geom_Polygon_fromExtent(extent)).getCoordinates()[0];\r\n    if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n      this.rotatedExtent_ = (ol_geom_Polygon_fromExtent(rotExtent)).getCoordinates()[0];\r\n    }\r\n    if (this.mode_==='rotate') {\r\n      this.center_ = this.getCenter() || ol_extent_getCenter(extent);\r\n      // we are now rotating (cursor down on rotate mode), so apply the grabbing cursor\r\n      var element = evt.map.getTargetElement();\r\n      element.style.cursor = this.Cursors.rotate0;\r\n      this.previousCursor_ = element.style.cursor;\r\n    } else {\r\n      this.center_ = ol_extent_getCenter(extent);\r\n    }\r\n    this.angle_ = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\r\n\r\n    this.dispatchEvent({\r\n      type: this.mode_+'start',\r\n      feature: this.selection_.item(0), // backward compatibility\r\n      features: this.selection_,\r\n      pixel: evt.pixel,\r\n      coordinate: evt.coordinate\r\n    });\r\n    return true;\r\n  }\r\n  else if (this.get('selection')) {\r\n    if (feature){\r\n      if (!this.addFn_(evt)) this.selection_.clear();\r\n      var index = this.selection_.getArray().indexOf(feature);\r\n      if (index < 0) this.selection_.push(feature);\r\n      else this.selection_.removeAt(index);\r\n    } else {\r\n      this.selection_.clear();\r\n    }\r\n    this.ispt_ = this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false;\r\n    this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\r\n    this.drawSketch_();\r\n    this.watchFeatures_();\r\n    this.dispatchEvent({ type:'select', feature: feature, features: this.selection_, pixel: evt.pixel, coordinate: evt.coordinate });\r\n    return false;\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Get features to transform\r\n * @return {ol.Collection<ol.Feature>}\r\n */\r\nol_interaction_Transform.prototype.getFeatures = function() {\r\n  return this.selection_;\r\n};\r\n\r\n/**\r\n * Get the rotation center\r\n * @return {ol.coordinates|undefined}\r\n */\r\nol_interaction_Transform.prototype.getCenter = function() {\r\n  return this.get('center');\r\n};\r\n\r\n/**\r\n * Set the rotation center\r\n * @param {ol.coordinates|undefined} c the center point, default center on the objet\r\n */\r\nol_interaction_Transform.prototype.setCenter = function(c) {\r\n  return this.set('center', c);\r\n}\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @private\r\n */\r\nol_interaction_Transform.prototype.handleDragEvent_ = function(evt) {\r\n  if (!this._handleEvent(evt, this.features_)) return;\r\n  var viewRotation = this.getMap().getView().getRotation();\r\n  var i, f, geometry;\r\n  var pt0 = [this.coordinate_[0], this.coordinate_[1]];\r\n  var pt = [evt.coordinate[0], evt.coordinate[1]];\r\n  this.isUpdating_ = true;\r\n  switch (this.mode_) {\r\n    case 'rotate': {\r\n      var a = Math.atan2(this.center_[1]-pt[1], this.center_[0]-pt[0]);\r\n      if (!this.ispt) {\r\n        // var geometry = this.geom_.clone();\r\n        // geometry.rotate(a-this.angle_, this.center_);\r\n        // this.feature_.setGeometry(geometry);\r\n        for (i=0, f; f=this.selection_.item(i); i++) {\r\n          geometry = this.geoms_[i].clone();\r\n          geometry.rotate(a - this.angle_, this.center_);\r\n          // bug: ol, bad calculation circle geom extent\r\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\r\n          f.setGeometry(geometry);\r\n        }\r\n      }\r\n      this.drawSketch_(true);\r\n      this.dispatchEvent({\r\n        type:'rotating',\r\n        feature: this.selection_.item(0),\r\n        features: this.selection_,\r\n        angle: a-this.angle_,\r\n        pixel: evt.pixel,\r\n        coordinate: evt.coordinate\r\n      });\r\n      break;\r\n    }\r\n    case 'translate': {\r\n      var deltaX = pt[0] - pt0[0];\r\n      var deltaY = pt[1] - pt0[1];\r\n\r\n      //this.feature_.getGeometry().translate(deltaX, deltaY);\r\n      for (i=0, f; f=this.selection_.item(i); i++) {\r\n        f.getGeometry().translate(deltaX, deltaY);\r\n      }\r\n      this.handles_.forEach(function(f) {\r\n        f.getGeometry().translate(deltaX, deltaY);\r\n      });\r\n\r\n      this.coordinate_ = evt.coordinate;\r\n      this.dispatchEvent({\r\n        type:'translating',\r\n        feature: this.selection_.item(0),\r\n        features: this.selection_,\r\n        delta:[deltaX,deltaY],\r\n        pixel: evt.pixel,\r\n        coordinate: evt.coordinate\r\n      });\r\n      break;\r\n    }\r\n    case 'scale': {\r\n      var center = this.center_;\r\n      if (this.get('modifyCenter')(evt)) {\r\n        var extentCoordinates = this.extent_;\r\n        if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n          extentCoordinates = this.rotatedExtent_;\r\n        }\r\n        center = extentCoordinates[(Number(this.opt_)+2)%4];\r\n      }\r\n\r\n      var downCoordinate = this.coordinate_;\r\n      var dragCoordinate = evt.coordinate;\r\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n        var downPoint = new ol_geom_Point(this.coordinate_);\r\n        downPoint.rotate(viewRotation * -1, center);\r\n        downCoordinate = downPoint.getCoordinates();\r\n\r\n        var dragPoint = new ol_geom_Point(evt.coordinate);\r\n        dragPoint.rotate(viewRotation * -1, center);\r\n        dragCoordinate = dragPoint.getCoordinates();\r\n      }\r\n\r\n      var scx = ((dragCoordinate)[0] - (center)[0]) / (downCoordinate[0] - (center)[0]);\r\n      var scy = ((dragCoordinate)[1] - (center)[1]) / (downCoordinate[1] - (center)[1]);\r\n\r\n      if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n        var centerPoint = new ol_geom_Point(center);\r\n        centerPoint.rotate(viewRotation * -1, this.getMap().getView().getCenter());\r\n        center = centerPoint.getCoordinates();\r\n      }\r\n\r\n      if (this.get('noFlip')) {\r\n        if (scx<0) scx=-scx;\r\n        if (scy<0) scy=-scy;\r\n      }\r\n\r\n      if (this.constraint_) {\r\n        if (this.constraint_==\"h\") scx=1;\r\n        else scy=1;\r\n      } else {\r\n        if (this.get('keepAspectRatio')(evt)) {\r\n          scx = scy = Math.min(scx,scy);\r\n        }\r\n      }\r\n\r\n      for (i=0, f; f=this.selection_.item(i); i++) {\r\n        geometry = (viewRotation === 0 || !this.get('enableRotatedTransform')) ? this.geoms_[i].clone() : this.rotatedGeoms_[i].clone();\r\n        geometry.applyTransform(function(g1, g2, dim) {\r\n          if (dim<2) return g2;\r\n\r\n          for (var j=0; j<g1.length; j+=dim) {\r\n            if (scx!=1) g2[j] = center[0] + (g1[j]-center[0])*scx;\r\n            if (scy!=1) g2[j+1] = center[1] + (g1[j+1]-center[1])*scy;\r\n          }\r\n          // bug: ol, bad calculation circle geom extent\r\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\r\n          return g2;\r\n        });\r\n        if (this.get('enableRotatedTransform') && viewRotation !== 0) {\r\n          //geometry.rotate(viewRotation, rotationCenter);\r\n          geometry.rotate(viewRotation, this.getMap().getView().getCenter());\r\n        }\r\n        f.setGeometry(geometry);\r\n      }\r\n      this.drawSketch_();\r\n      this.dispatchEvent({\r\n        type:'scaling',\r\n        feature: this.selection_.item(0),\r\n        features: this.selection_,\r\n        scale:[scx,scy],\r\n        pixel: evt.pixel,\r\n        coordinate: evt.coordinate\r\n      });\r\n      break;\r\n    }\r\n    default: break;\r\n  }\r\n  this.isUpdating_ = false;\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Event.\r\n * @private\r\n */\r\nol_interaction_Transform.prototype.handleMoveEvent_ = function(evt) {\r\n  if (!this._handleEvent(evt, this.features_)) return;\r\n  // console.log(\"handleMoveEvent\");\r\n  if (!this.mode_) {\r\n    var sel = this.getFeatureAtPixel_(evt.pixel);\r\n    var element = evt.map.getTargetElement();\r\n    if (sel.feature) {\r\n      var c = sel.handle ? this.Cursors[(sel.handle||'default')+(sel.constraint||'')+(sel.option||'')] : this.Cursors.select;\r\n\r\n      if (this.previousCursor_===undefined) {\r\n        this.previousCursor_ = element.style.cursor;\r\n      }\r\n      element.style.cursor = c;\r\n    } else {\r\n      if (this.previousCursor_!==undefined) element.style.cursor = this.previousCursor_;\r\n      this.previousCursor_ = undefined;\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * @param {ol.MapBrowserEvent} evt Map browser event.\r\n * @return {boolean} `false` to stop the drag sequence.\r\n */\r\nol_interaction_Transform.prototype.handleUpEvent_ = function(evt) {\r\n  // remove rotate0 cursor on Up event, otherwise it's stuck on grab/grabbing\r\n  if (this.mode_ === 'rotate') {\r\n    var element = evt.map.getTargetElement();\r\n    element.style.cursor = this.Cursors.default;\r\n    this.previousCursor_ = undefined;\r\n  }\r\n\r\n  //dispatchEvent\r\n  this.dispatchEvent({\r\n    type:this.mode_+'end',\r\n    feature: this.selection_.item(0),\r\n    features: this.selection_,\r\n    oldgeom: this.geoms_[0],\r\n    oldgeoms: this.geoms_\r\n  });\r\n\r\n  this.drawSketch_();\r\n  this.mode_ = null;\r\n  return false;\r\n};\r\n\r\n/** Get the features that are selected for transform\r\n * @return ol.Collection\r\n */\r\nol_interaction_Transform.prototype.getFeatures = function() {\r\n  return this.selection_;\r\n};\r\n\r\nexport default ol_interaction_Transform\r\n","/**\n * @module ol/ImageBase\n */\nimport {abstract} from './util.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @abstract\n */\nvar ImageBase = /*@__PURE__*/(function (EventTarget) {\n  function ImageBase(extent, resolution, pixelRatio, state) {\n\n    EventTarget.call(this);\n\n    /**\n     * @protected\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.extent = extent;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @protected\n     * @type {number|undefined}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @protected\n     * @type {import(\"./ImageState.js\").default}\n     */\n    this.state = state;\n\n  }\n\n  if ( EventTarget ) ImageBase.__proto__ = EventTarget;\n  ImageBase.prototype = Object.create( EventTarget && EventTarget.prototype );\n  ImageBase.prototype.constructor = ImageBase;\n\n  /**\n   * @protected\n   */\n  ImageBase.prototype.changed = function changed () {\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  ImageBase.prototype.getExtent = function getExtent () {\n    return this.extent;\n  };\n\n  /**\n   * @abstract\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   */\n  ImageBase.prototype.getImage = function getImage () {\n    return abstract();\n  };\n\n  /**\n   * @return {number} PixelRatio.\n   */\n  ImageBase.prototype.getPixelRatio = function getPixelRatio () {\n    return this.pixelRatio_;\n  };\n\n  /**\n   * @return {number} Resolution.\n   */\n  ImageBase.prototype.getResolution = function getResolution () {\n    return /** @type {number} */ (this.resolution);\n  };\n\n  /**\n   * @return {import(\"./ImageState.js\").default} State.\n   */\n  ImageBase.prototype.getState = function getState () {\n    return this.state;\n  };\n\n  /**\n   * Load not yet loaded URI.\n   * @abstract\n   */\n  ImageBase.prototype.load = function load () {\n    abstract();\n  };\n\n  return ImageBase;\n}(EventTarget));\n\n\nexport default ImageBase;\n\n//# sourceMappingURL=ImageBase.js.map","/**\n * @module ol/ImageCanvas\n */\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n\n\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error=))} Loader\n */\n\n\nvar ImageCanvas = /*@__PURE__*/(function (ImageBase) {\n  function ImageCanvas(extent, resolution, pixelRatio, canvas, opt_loader) {\n\n    var state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n\n    ImageBase.call(this, extent, resolution, pixelRatio, state);\n\n    /**\n     * Optional canvas loader function.\n     * @type {?Loader}\n     * @private\n     */\n    this.loader_ = opt_loader !== undefined ? opt_loader : null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = canvas;\n\n    /**\n     * @private\n     * @type {Error}\n     */\n    this.error_ = null;\n\n  }\n\n  if ( ImageBase ) ImageCanvas.__proto__ = ImageBase;\n  ImageCanvas.prototype = Object.create( ImageBase && ImageBase.prototype );\n  ImageCanvas.prototype.constructor = ImageCanvas;\n\n  /**\n   * Get any error associated with asynchronous rendering.\n   * @return {Error} Any error that occurred during rendering.\n   */\n  ImageCanvas.prototype.getError = function getError () {\n    return this.error_;\n  };\n\n  /**\n   * Handle async drawing complete.\n   * @param {Error=} err Any error during drawing.\n   * @private\n   */\n  ImageCanvas.prototype.handleLoad_ = function handleLoad_ (err) {\n    if (err) {\n      this.error_ = err;\n      this.state = ImageState.ERROR;\n    } else {\n      this.state = ImageState.LOADED;\n    }\n    this.changed();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  ImageCanvas.prototype.load = function load () {\n    if (this.state == ImageState.IDLE) {\n      this.state = ImageState.LOADING;\n      this.changed();\n      this.loader_(this.handleLoad_.bind(this));\n    }\n  };\n\n  /**\n   * @return {HTMLCanvasElement} Canvas element.\n   */\n  ImageCanvas.prototype.getImage = function getImage () {\n    return this.canvas_;\n  };\n\n  return ImageCanvas;\n}(ImageBase));\n\n\nexport default ImageCanvas;\n\n//# sourceMappingURL=ImageCanvas.js.map"],"sourceRoot":""}