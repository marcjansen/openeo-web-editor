{"version":3,"sources":["webpack:///./node_modules/ol/render/EventType.js","webpack:///./node_modules/ol/renderer/Layer.js","webpack:///./node_modules/ol/renderer/canvas/Layer.js","webpack:///./node_modules/ol/pointer/EventSource.js","webpack:///./node_modules/ol/render/ReplayGroup.js","webpack:///./node_modules/ol/render/canvas/Instruction.js","webpack:///./node_modules/ol/render/canvas/Replay.js","webpack:///./node_modules/ol/render/canvas/ImageReplay.js","webpack:///./node_modules/ol/render/canvas/LineStringReplay.js","webpack:///./node_modules/ol/render/canvas/PolygonReplay.js","webpack:///./node_modules/ol/render/canvas/TextReplay.js","webpack:///./node_modules/ol/render/canvas/ReplayGroup.js","webpack:///./node_modules/ol/proj/Projection.js","webpack:///./node_modules/ol/proj/epsg3857.js","webpack:///./node_modules/ol/proj/epsg4326.js","webpack:///./node_modules/ol/proj/projections.js","webpack:///./node_modules/ol/proj/transforms.js","webpack:///./node_modules/ol/proj.js","webpack:///./node_modules/ol/reproj.js","webpack:///./node_modules/ol/reproj/Triangulation.js","webpack:///./node_modules/ol/reproj/Tile.js","webpack:///./node_modules/ol/renderer/vector.js","webpack:///./node_modules/ol/render/Event.js","webpack:///./node_modules/ol/size.js","webpack:///./node_modules/ol/renderer/canvas/ImageLayer.js","webpack:///./node_modules/ol/pointer/MouseSource.js","webpack:///./node_modules/ol/renderer/canvas/IntermediateCanvas.js","webpack:///./node_modules/ol/rotationconstraint.js","webpack:///./node_modules/ol/renderer/Map.js","webpack:///./node_modules/ol/renderer/canvas/Map.js","webpack:///./node_modules/ol/render/replay.js","webpack:///./node_modules/ol/render/ReplayType.js","webpack:///./node_modules/ol/reproj/common.js","webpack:///./node_modules/ol/resolutionconstraint.js","webpack:///./node_modules/ol/pointer/MsSource.js","webpack:///./node_modules/ol/pointer/NativeSource.js","webpack:///./node_modules/ol/pointer/PointerEvent.js","webpack:///./node_modules/ol/pointer/TouchSource.js","webpack:///./node_modules/ol/pointer/PointerEventHandler.js","webpack:///./node_modules/ol/renderer/canvas/VectorTileLayer.js","webpack:///./node_modules/ol/renderer/canvas/TileLayer.js","webpack:///./node_modules/ol/render/canvas/Immediate.js","webpack:///./node_modules/ol/render/Box.js","webpack:///./node_modules/ol/pointer/EventType.js","webpack:///./node_modules/ol/renderer/canvas/VectorLayer.js","webpack:///./node_modules/ol/render/canvas.js","webpack:///./node_modules/ol/render/VectorContext.js","webpack:///./node_modules/ol/proj/Units.js"],"names":["POSTCOMPOSE","PRECOMPOSE","RENDER","RENDERCOMPLETE","Observable","LayerRenderer","layer","call","this","layer_","__proto__","prototype","Object","create","constructor","createLoadedTileFinder","source","projection","tiles","zoom","tileRange","callback","tile","tileCoord","toString","forEachLoadedTile","forEachFeatureAtCoordinate","coordinate","frameState","hitTolerance","getLayer","handleImageChange_","event","image","getState","ImageState","LOADED","renderIfReadyAndVisible","hasFeatureAtCoordinate","loadImage","imageState","ERROR","CHANGE","IDLE","load","getVisible","getSourceState","READY","changed","scheduleExpireCache","tileSource","canExpireCache","postRenderFunction","map","tileSourceKey","usedTiles","expireCache","viewState","bind","postRenderFunctions","push","updateUsedTiles","z","zKey","extend","manageTilePyramid","tileGrid","pixelRatio","extent","currentZ","preload","opt_tileCallback","opt_this","wantedTiles","tileResolution","x","y","tileQueue","minZoom","getMinZoom","getTileRangeForExtentAndZ","getResolution","minX","maxX","minY","maxY","getTile","TileState","getKey","isKeyQueued","enqueue","getTileCoordCenter","undefined","useTile","Layer","CanvasLayerRenderer","renderedResolution","transform_","clip","context","width","size","height","rotation","topLeft","topRight","bottomRight","bottomLeft","coordinateToPixelTransform","save","beginPath","moveTo","lineTo","dispatchComposeEvent_","type","opt_transform","hasListener","transform","getTransform","render","composeEvent","dispatchEvent","forEachLayerAtCoordinate","thisArg","hasFeature","postCompose","layerState","preCompose","dispatchRenderEvent","offsetX","dx1","dy1","sx","resolution","sy","angle","dx2","center","dy2","composeFrame","prepareFrame","EventSource","dispatcher","mapping","mapping_","getEvents","keys","getHandlerForEvent","eventType","getReplay","zIndex","replayType","isEmpty","addDeclutter","group","Instruction","BEGIN_GEOMETRY","BEGIN_PATH","CIRCLE","CLOSE_PATH","CUSTOM","DRAW_CHARS","DRAW_IMAGE","END_GEOMETRY","FILL","MOVE_TO_LINE_TO","SET_FILL_STYLE","SET_STROKE_STYLE","STROKE","beginPathInstruction","closePathInstruction","tmpExtent","tmpTransform","VectorContext","CanvasReplay","tolerance","maxExtent","overlaps","declutterTree","maxLineWidth","alignFill_","beginGeometryInstruction1_","beginGeometryInstruction2_","bufferedMaxExtent_","instructions","coordinates","coordinateCache_","renderedTransform_","hitDetectionInstructions","pixelCoordinates_","state","viewRotation_","replayTextBackground_","p1","p2","p3","p4","fillInstruction","strokeInstruction","apply","fill_","setStrokeStyle_","stroke","replayImage_","anchorX","anchorY","declutterGroup","opacity","originX","originY","scale","snapToPixel","padding","fillStroke","w","h","boxW","boxH","boxX","boxY","centerX","centerY","canvas","strokePadding","intersects","Math","round","declutterArgs","slice","applyPixelRatio","dashArray","dash","appendFlatCoordinates","flatCoordinates","offset","end","stride","closed","skipFirst","myEnd","length","getBufferedMaxExtent","i","lastRel","nextRel","lastCoord","nextCoord","NaN","skipped","Relationship","INTERSECTING","drawCustomCoordinates_","ends","replayEnds","ii","replayEnd","drawCustom","geometry","feature","renderer","beginGeometry","replayEndss","getType","getStride","replayBegin","GeometryType","MULTI_POLYGON","getOrientedFlatCoordinates","endss","getEndss","myEnds","inflate","POLYGON","MULTI_LINE_STRING","getFlatCoordinates","getEnds","LINE_STRING","MULTI_POINT","POINT","endGeometry","finish","origin","repeatSize","translate","rotate","fill","setTransform","instruction","strokeStyle","lineWidth","lineCap","lineJoin","miterLimit","lineDashOffset","setLineDash","renderDeclutter_","groupCount","box","value","collides","insert","j","jj","declutterData","replay_","skippedFeaturesHash","featureCallback","opt_hitExtent","pixelCoordinates","dd","prevX","prevY","roundX","roundY","skipFeatures","d","pendingFill","pendingStroke","lastFillInstruction","lastStrokeInstruction","coordinateCache","viewRotation","batchSize","getGeometry","getExtent","x1","y1","x2","y2","dx","dy","r","sqrt","arc","PI","closePath","fn","coords","rotateWithView","backgroundFill","backgroundStroke","begin","baseline","overflow","fillKey","maxAngle","measure","offsetY","strokeKey","strokeWidth","text","textKey","textScale","pathLength","textLength","textReplay","textAlign","textStates","startM","parts","c","cc","chars","label","part","getImage","result","fillStyle","replay","replayHitDetection","opt_featureCallback","reverseHitDetectionInstructions","reverse","n","setFillStrokeStyle","fillStyleColor","getColor","strokeStyleColor","strokeStyleLineCap","getLineCap","strokeStyleLineDash","getLineDash","lineDash","strokeStyleLineDashOffset","getLineDashOffset","strokeStyleLineJoin","getLineJoin","strokeStyleWidth","getWidth","strokeStyleMiterLimit","getMiterLimit","createFill","applyStroke","createStroke","updateFillStyle","currentFillStyle","updateStrokeStyle","currentStrokeStyle","currentLineCap","currentLineDash","currentLineDashOffset","currentLineJoin","currentLineWidth","currentMiterLimit","endGeometryInstruction","CanvasImageReplay","declutterGroup_","hitDetectionImage_","image_","anchorX_","anchorY_","height_","opacity_","originX_","originY_","rotateWithView_","rotation_","scale_","width_","drawCoordinates_","drawPoint","pointGeometry","myBegin","drawMultiPoint","multiPointGeometry","setImageStyle","imageStyle","anchor","getAnchor","getSize","hitDetectionImage","getHitDetectionImage","getOrigin","getOpacity","getRotateWithView","getRotation","getScale","CanvasLineStringReplay","drawFlatCoordinates_","moveToLineToInstruction","drawLineString","lineStringGeometry","drawMultiLineString","multiLineStringGeometry","lastStroke","CanvasPolygonReplay","drawFlatCoordinatess_","numEnds","drawCircle","circleGeometry","setFillStrokeStyles_","circleInstruction","drawPolygon","polygonGeometry","drawMultiPolygon","multiPolygonGeometry","CanvasTextReplay","labels_","text_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textFillState_","fillStates","textStrokeState_","strokeStates","textState_","textKey_","fillKey_","strokeKey_","widths_","prune","drawText","fillState","strokeState","textState","geometryType","placement","TextPlacement","LINE","flatEnd","flatOffset","o","oo","range","drawChars_","getFlatMidpoint","getCenter","getFlatMidpoints","getFlatInteriorPoint","interiorPoints","getFlatInteriorPoints","drawTextImage_","key","containsKey","align","lines","split","numLines","widths","measureTextWidths","font","lineHeight","renderWidth","ceil","set","textBaseline","leftRight","strokeText","fillText","get","p","setTextStyle","textStyle","textFillStyle","getFill","textStrokeStyle","getStroke","getFont","getOverflow","getMaxAngle","getPlacement","getTextAlign","getTextBaseline","getBackgroundFill","getBackgroundStroke","getPadding","textOffsetX","getOffsetX","textOffsetY","getOffsetY","textRotateWithView","textRotation","getText","join","currentWidth","max","BATCH_CONSTRUCTORS","ReplayGroup","CanvasReplayGroup","opt_renderBuffer","declutterTree_","tolerance_","maxExtent_","overlaps_","pixelRatio_","resolution_","renderBuffer_","replaysByZIndex_","hitDetectionContext_","hitDetectionTransform_","declutter","flatClipCoords","getClipCoords","hasReplays","replays","candidates","replayKey","declutterReplays","hitExtent","contextSize","clearRect","declutteredFeatures","mask","getCircleArray","imageData","getImageData","data","ReplayType","IMAGE","TEXT","indexOf","all","entry","zs","Number","sort","zIndexKey","Constructor","getReplays","opt_replayTypes","opt_declutterReplays","replayTypes","restore","circleArrayCache","0","fillCircleArrayRowToMiddle","array","radius","floor","arraySize","arr","Array","error","replayDeclutter","skippedFeatureUids","zz","replayData","options","code_","code","units_","extent_","worldExtent_","worldExtent","axisOrientation_","axisOrientation","global_","global","canWrapX_","getPointResolutionFunc_","getPointResolution","defaultTileGrid_","metersPerUnit_","metersPerUnit","canWrapX","getCode","getUnits","getMetersPerUnit","getWorldExtent","getAxisOrientation","isGlobal","setGlobal","getDefaultTileGrid","setDefaultTileGrid","setExtent","setWorldExtent","setGetPointResolution","func","getPointResolutionFunc","RADIUS","HALF_SIZE","EXTENT","WORLD_EXTENT","Projection","EPSG3857Projection","units","Units","METERS","point","PROJECTIONS","fromEPSG4326","input","opt_output","opt_dimension","dimension","output","halfSize","log","tan","atan","exp","METERS_PER_UNIT","EPSG4326Projection","opt_axisOrientation","DEGREES","cache","add","transforms","destination","transformFn","sourceCode","destinationCode","cloneTransform","identityTransform","addProjection","addProjections","projections","forEach","projectionLike","opt_units","pointResolution","getter","toEPSG4326","getTransformFromProjections","vertices","addEquivalentProjections","addEquivalentTransforms","projections1","projections2","forwardTransform","inverseTransform","projection1","projection2","createProjection","defaultCode","fromLonLat","opt_projection","toLonLat","lonLat","lon","equivalent","equalUnits","transformFunc","sourceProjection","destinationProjection","transformExtent","addCommon","calculateSourceResolution","sourceProj","targetProj","targetCenter","targetResolution","sourceCenter","sourceResolution","targetMetersPerUnit","sourceMetersPerUnit","sourceExtent","compensationFactor","isFinite","enlargeClipPoint","centroidX","centroidY","dX","dY","distance","targetExtent","triangulation","sources","gutter","opt_renderEdges","sourceDataExtent","src","canvasWidthInUnits","canvasHeightInUnits","stitchContext","stitchScale","xPos","yPos","srcWidth","srcHeight","drawImage","targetTopLeft","getTriangles","triangle","target","x0","y0","u0","v0","u1","v1","u2","v2","sourceNumericalShiftX","sourceNumericalShiftY","augmentedMatrix","affineCoefs","p0","MAX_SUBDIVISION","MAX_TRIANGLE_WIDTH","maxSourceExtent","errorThreshold","sourceProj_","targetProj_","transformInvCache","transformInv","transformInv_","maxSourceExtent_","errorThresholdSquared_","triangles_","wrapsXInSource_","canWrapXInSource_","sourceWorldWidth_","targetWorldWidth_","destinationTopLeft","destinationTopRight","destinationBottomRight","destinationBottomLeft","sourceTopLeft","sourceTopRight","sourceBottomRight","sourceBottomLeft","addQuad_","leftBound","Infinity","min","newTriangle","addTriangle_","a","b","aSrc","bSrc","cSrc","dSrc","maxSubdivision","sourceQuadExtent","sourceCoverageX","sourceWorldWidth","wrapsX","needsSubdivision","targetQuadExtent","targetCoverageX","centerSrc","centerSrcEstimX","centerSrcErrorSquared","abs","bc","bcSrc","da","daSrc","ab","abSrc","cd","cdSrc","calculateSourceExtent","Tile","ReprojTile","sourceTileGrid","targetTileGrid","wrappedTileCoord","getTileFunction","opt_errorThreshold","renderEdges_","gutter_","canvas_","sourceTileGrid_","targetTileGrid_","wrappedTileCoord_","sourceTiles_","sourcesListenerKeys_","sourceZ_","getTileCoordExtent","maxTargetExtent","limitedTargetExtent","sourceProjExtent","EMPTY","errorThresholdInPixels","triangulation_","getZForResolution","sourceRange","srcX","srcY","disposeInternal","LOADING","unlistenSources_","reproject_","getTileSize","leftToLoad","sourceListenKey","EventType","e","setTimeout","SIMPLIFY_TOLERANCE","GEOMETRY_RENDERERS","renderPointGeometry","renderLineStringGeometry","renderPolygonGeometry","renderMultiPointGeometry","renderMultiLineStringGeometry","renderMultiPolygonGeometry","renderGeometryCollectionGeometry","renderCircleGeometry","defaultOrder","feature1","feature2","parseInt","getSquaredTolerance","getTolerance","replayGroup","style","circleReplay","getZIndex","renderFeature","squaredTolerance","listener","loading","getImageState","unlistenImageChange","listenImageChange","renderFeatureInternal","getGeometryFunction","simplifiedGeometry","getSimplifiedGeometry","getRenderer","renderGeometry","geometryRenderer","GEOMETRY_COLLECTION","DEFAULT","geometries","getGeometries","getGeometriesArray","lineStringReplay","polygonReplay","imageReplay","RenderEvent","Event","opt_vectorContext","opt_frameState","opt_context","opt_glContext","vectorContext","glContext","hasArea","ratio","opt_size","toSize","isArray","CanvasImageLayerRenderer","IntermediateCanvasRenderer","imageLayer","imageTransform_","skippedFeatures_","vectorRenderer_","VECTOR","ctor","dispose","getImageTransform","viewCenter","viewResolution","imageSource","getSource","hints","viewHints","vectorRenderer","renderedExtent","ANIMATING","INTERACTING","getProjection","skippedFeatures","imageFrameState","newSkippedFeatures","replayGroupChanged","compose","imageExtent","imageResolution","imagePixelRatio","getPixelRatio","coordinateToCanvasPixelTransform","getRenderMode","mapRenderer","POINTER_ID","POINTER_TYPE","DEDUP_DIST","mousedown","inEvent","isEventSimulatedFromTouch_","pointerMap","cancel","prepareEvent","down","mousemove","move","mouseup","button","up","cleanupMouse","mouseover","enterOver","mouseout","leaveOut","MouseSource","lastTouches","lts","clientX","clientY","l","t","cloneEvent","pd","preventDefault","pointerId","isPrimary","pointerType","hitCanvasContext_","clipped","imageTransform","alpha","globalAlpha","dw","dh","pixel","disable","delta","none","createSnapToN","theta","createSnapToZero","opt_tolerance","Disposable","MapRenderer","map_","layerRenderers_","layerRendererListeners_","layerRendererConstructors_","registerLayerRenderers","constructors","calculateMatrices2D","pixelToCoordinateTransform","removeLayerRenderers","removeLayerRendererByKey_","layerFilter","thisArg2","managed","layerStates","translatedCoordinate","projectionExtent","worldWidth","worldsAway","layerStatesArray","numLayers","layerRenderer","getLayerRenderer","getWrapX","forEachLayerAtPixel","layerKey","candidate","Error","handleLayerRendererChange_","getLayerRendererByKey","getLayerRenderers","getMap","removeUnusedLayerRenderers_","renderFrame","scheduleExpireIconCache","scheduleRemoveUnusedLayerRenderers","expireIconCache","expire","sortByZIndex","state1","state2","Map","layerRendererConstructors","CanvasMapRenderer","container","getViewport","context_","display","className","insertBefore","childNodes","renderedVisible_","sourceState","ORDER","TEXT_ALIGN","ERROR_THRESHOLD","ENABLE_RASTER_REPROJECTION","createSnapToResolutions","resolutions","direction","index","power","pow","createSnapToPower","maxResolution","opt_maxLevel","oldLevel","newLevel","POINTER_TYPES","msPointerDown","prepareEvent_","msPointerMove","msPointerUp","cleanup","msPointerOut","msPointerOver","msPointerCancel","msLostPointerCapture","makeEvent","msGotPointerCapture","MsSource","pointerDown","fireNativeEvent","pointerMove","pointerUp","pointerOut","pointerOver","pointerCancel","lostPointerCapture","gotPointerCapture","NativeSource","HAS_BUTTONS","PointerEvent","_Event","originalEvent","opt_eventDict","eventDict","buttons","getButtons","pressure","getPressure","bubbles","cancelable","view","detail","screenX","screenY","ctrlKey","altKey","shiftKey","metaKey","relatedTarget","tiltX","tiltY","hwTimestamp","which","ev","MouseEvent","CLICK_COUNT_TIMEOUT","touchstart","vacuumTouches_","setPrimaryTouch_","changedTouches","dedupSynthMouse_","clickCount_","processTouches_","overDown_","touchmove","moveOverOut_","touchend","upOut_","touchcancel","cancelOut_","TouchSource","mouseSource","firstTouchId_","resetId_","dedupTimeout_","isPrimaryTouch_","inTouch","identifier","count","cancelResetClickCount_","removePrimaryPointer_","inPointer","resetClickCount_","resetClickCountHandler_","clearTimeout","touchToPointer_","browserEvent","radiusX","radiusY","force","inFunction","touches","pointer","findTouch_","touchList","searchId","touch","out","i$1","outTarget","over","enter","outEvent","leave","cleanUpPointer_","lt","CLONE_PROPS","EventTarget","PointerEventHandler","element","element_","eventMap_","eventSourceList_","registerSources","registerSource","register_","name","s","newEvents","handler","eventSource","addEvents_","unregister_","removeEvents_","eventHandler_","events","eventName","eventCopy","fireEvent","POINTERDOWN","POINTERMOVE","POINTERUP","POINTERENTER","POINTERLEAVE","POINTEROVER","POINTEROUT","POINTERCANCEL","contains_","contained","contains","inType","wrapMouseEvent","pointerEvent","IMAGE_REPLAYS","VECTOR_REPLAYS","CanvasVectorTileLayerRenderer","CanvasTileLayerRenderer","getDeclutter","dirty_","renderedLayerRevision_","tmpTransform_","renderMode","zDirection","CLEAR","handleFontsChanged_","createReplayGroup_","renderTileImage_","getTileImage","tileLayer","layerRevision","getRevision","renderedTiles","this$1","revision","renderOrder","getRenderOrder","replayState","getReplayState","dirty","renderedRevision","renderedRenderOrder","getTileGrid","getTileGridForProjection","tileExtent","loop","tt","sourceTile","tileKeys","sourceTileCoord","sourceTileExtent","sharedExtent","bufferedExtent","getRenderBuffer","tileProjection","reproject","setProjection","getOverlaps","styles","styleFunction","getStyleFunction","features","getFeatures","TILE_PIXELS","setReplayGroup","found","getReplayGroup","getReplayTransform_","renderResolution","handleStyleImageChange_","clear","clips","ABORT","worldOffset","currentClip","renderedTileRevision","getContext","getTilePixelSize","pixelScale","VECTOR_TILE","opt_noContext","oversampling_","renderedExtent_","newTiles_","tmpTileRange_","isDrawableTile_","tileState","useInterimTilesOnError","getUseInterimTilesOnError","getPreload","setState","getInterimTile","sourceRevision","oversampling","getTileRangeExtent","tilePixelRatio","getTilePixelRatio","tilesToDrawByZ","findLoadedTiles","animatingOrInteracting","tmpTileRange","Date","now","time","uid","inTransition","getAlpha","childTileRange","getTileCoordChildTileRange","covered","forEachTileCoordParentTileRange","tilePixelSize","getHeight","currentResolution","currentScale","currentTilePixelSize","tileGutter","tilesToDraw","tileCoordKey","getGutterForProjection","getTileCoord","drawTileImage","transition","getOpaque","alphaChanged","animate","endTransition","TILE","CanvasImmediateRenderer","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageWidth_","textScale_","tmpLocalTransform_","drawImages_","localTransform","drawText_","setContextFillState_","setContextStrokeState_","setContextTextState_","moveToLineTo_","close","drawRings_","setStyle","drawGeometry","drawGeometryCollection","drawFeature","flatMidpoint","geometryExtent","flatMidpoints","flatInteriorPoint","flatInteriorPoints","contextFillState","contextStrokeState","contextTextState","imageAnchor","imageImage","imageOrigin","imageSize","textFillStyleColor","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","textText","textTextAlign","textTextBaseline","RenderBox","geometry_","document","createElement","position","startPixel_","endPixel_","setMap","render_","startPixel","endPixel","px","left","top","getOverlayContainer","removeChild","appendChild","setPixels","createOrUpdateGeometry","pixels","getCoordinateFromPixel","setCoordinates","CanvasVectorLayerRenderer","vectorLayer","renderedRevision_","renderedResolution_","renderedRenderOrder_","replayGroup_","vectorSource","clipExtent","replayContext","drawOffsetX","drawOffsetY","transparentLayer","hasRenderListeners","drawWidth","drawHeight","drawSize","startX","world","mainContextAlpha","animating","interacting","updateWhileAnimating","getUpdateWhileAnimating","updateWhileInteracting","getUpdateWhileInteracting","frameStateExtent","vectorLayerRevision","vectorLayerRenderBuffer","vectorLayerRenderOrder","loadFeatures","forEachFeatureInExtent","defaultFont","defaultFillStyle","defaultLineCap","defaultLineDash","defaultLineDashOffset","defaultLineJoin","defaultMiterLimit","defaultStrokeStyle","defaultTextAlign","defaultTextBaseline","defaultPadding","defaultLineWidth","labelCache","checkedFonts","measureContext","textHeights","checkFont","interval","referenceWidth","retries","checked","referenceFonts","len","isAvailable","getMeasureContext","weight","fontWeight","available","referenceFont","measureText","check","done","clearInterval","fontSpec","fontFamilies","fontFamily","setInterval","measureTextHeight","span","heights","textContent","margin","body","offsetHeight","measureTextWidth","rotateAtOffset","resetTransform","geometryCollectionGeometry","opt_declutterGroup","FEET","PIXELS","USFEET"],"mappings":"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","file":"js/chunk-fe073106.137db4ce.js","sourcesContent":["/**\n * @module ol/render/EventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * @event module:ol/render/Event~RenderEvent#postcompose\n   * @api\n   */\n  POSTCOMPOSE: 'postcompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#precompose\n   * @api\n   */\n  PRECOMPOSE: 'precompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#render\n   * @api\n   */\n  RENDER: 'render',\n  /**\n   * Triggered when rendering is complete, i.e. all sources and tiles have\n   * finished loading for the current viewport, and all tiles are faded in.\n   * @event module:ol/render/Event~RenderEvent#rendercomplete\n   * @api\n   */\n  RENDERCOMPLETE: 'rendercomplete'\n};\n\n//# sourceMappingURL=EventType.js.map","/**\n * @module ol/renderer/Layer\n */\nimport {getUid} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport Observable from '../Observable.js';\nimport TileState from '../TileState.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport SourceState from '../source/State.js';\n\nvar LayerRenderer = /*@__PURE__*/(function (Observable) {\n  function LayerRenderer(layer) {\n\n    Observable.call(this);\n\n    /**\n     * @private\n     * @type {import(\"../layer/Layer.js\").default}\n     */\n    this.layer_ = layer;\n\n  }\n\n  if ( Observable ) LayerRenderer.__proto__ = Observable;\n  LayerRenderer.prototype = Object.create( Observable && Observable.prototype );\n  LayerRenderer.prototype.constructor = LayerRenderer;\n\n  /**\n   * Create a function that adds loaded tiles to the tile lookup.\n   * @param {import(\"../source/Tile.js\").default} source Tile source.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection of the tiles.\n   * @param {Object<number, Object<string, import(\"../Tile.js\").default>>} tiles Lookup of loaded tiles by zoom level.\n   * @return {function(number, import(\"../TileRange.js\").default):boolean} A function that can be\n   *     called with a zoom level and a tile range to add loaded tiles to the lookup.\n   * @protected\n   */\n  LayerRenderer.prototype.createLoadedTileFinder = function createLoadedTileFinder (source, projection, tiles) {\n    return (\n      /**\n       * @param {number} zoom Zoom level.\n       * @param {import(\"../TileRange.js\").default} tileRange Tile range.\n       * @return {boolean} The tile range is fully loaded.\n       */\n      function(zoom, tileRange) {\n        /**\n         * @param {import(\"../Tile.js\").default} tile Tile.\n         */\n        function callback(tile) {\n          if (!tiles[zoom]) {\n            tiles[zoom] = {};\n          }\n          tiles[zoom][tile.tileCoord.toString()] = tile;\n        }\n        return source.forEachLoadedTile(projection, zoom, tileRange, callback);\n      }\n    );\n  };\n\n  /**\n   * @abstract\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(import(\"../Feature.js\").FeatureLike, import(\"../layer/Layer.js\").default): T} callback Feature callback.\n   * @return {T|void} Callback result.\n   * @template T\n   */\n  LayerRenderer.prototype.forEachFeatureAtCoordinate = function forEachFeatureAtCoordinate (coordinate, frameState, hitTolerance, callback) {};\n\n  /**\n   * @return {import(\"../layer/Layer.js\").default} Layer.\n   */\n  LayerRenderer.prototype.getLayer = function getLayer () {\n    return this.layer_;\n  };\n\n  /**\n   * Handle changes in image state.\n   * @param {import(\"../events/Event.js\").default} event Image change event.\n   * @private\n   */\n  LayerRenderer.prototype.handleImageChange_ = function handleImageChange_ (event) {\n    var image = /** @type {import(\"../Image.js\").default} */ (event.target);\n    if (image.getState() === ImageState.LOADED) {\n      this.renderIfReadyAndVisible();\n    }\n  };\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {boolean} Is there a feature at the given coordinate?\n   */\n  LayerRenderer.prototype.hasFeatureAtCoordinate = function hasFeatureAtCoordinate (coordinate, frameState) {\n    return false;\n  };\n\n  /**\n   * Load the image if not already loaded, and register the image change\n   * listener if needed.\n   * @param {import(\"../ImageBase.js\").default} image Image.\n   * @return {boolean} `true` if the image is already loaded, `false` otherwise.\n   * @protected\n   */\n  LayerRenderer.prototype.loadImage = function loadImage (image) {\n    var imageState = image.getState();\n    if (imageState != ImageState.LOADED && imageState != ImageState.ERROR) {\n      listen(image, EventType.CHANGE, this.handleImageChange_, this);\n    }\n    if (imageState == ImageState.IDLE) {\n      image.load();\n      imageState = image.getState();\n    }\n    return imageState == ImageState.LOADED;\n  };\n\n  /**\n   * @protected\n   */\n  LayerRenderer.prototype.renderIfReadyAndVisible = function renderIfReadyAndVisible () {\n    var layer = this.getLayer();\n    if (layer.getVisible() && layer.getSourceState() == SourceState.READY) {\n      this.changed();\n    }\n  };\n\n  /**\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../source/Tile.js\").default} tileSource Tile source.\n   * @protected\n   */\n  LayerRenderer.prototype.scheduleExpireCache = function scheduleExpireCache (frameState, tileSource) {\n    if (tileSource.canExpireCache()) {\n      /**\n       * @param {import(\"../source/Tile.js\").default} tileSource Tile source.\n       * @param {import(\"../PluggableMap.js\").default} map Map.\n       * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n       */\n      var postRenderFunction = function(tileSource, map, frameState) {\n        var tileSourceKey = getUid(tileSource);\n        if (tileSourceKey in frameState.usedTiles) {\n          tileSource.expireCache(frameState.viewState.projection,\n            frameState.usedTiles[tileSourceKey]);\n        }\n      }.bind(null, tileSource);\n\n      frameState.postRenderFunctions.push(\n        /** @type {import(\"../PluggableMap.js\").PostRenderFunction} */ (postRenderFunction)\n      );\n    }\n  };\n\n  /**\n   * @param {!Object<string, !Object<string, import(\"../TileRange.js\").default>>} usedTiles Used tiles.\n   * @param {import(\"../source/Tile.js\").default} tileSource Tile source.\n   * @param {number} z Z.\n   * @param {import(\"../TileRange.js\").default} tileRange Tile range.\n   * @protected\n   */\n  LayerRenderer.prototype.updateUsedTiles = function updateUsedTiles (usedTiles, tileSource, z, tileRange) {\n    // FIXME should we use tilesToDrawByZ instead?\n    var tileSourceKey = getUid(tileSource);\n    var zKey = z.toString();\n    if (tileSourceKey in usedTiles) {\n      if (zKey in usedTiles[tileSourceKey]) {\n        usedTiles[tileSourceKey][zKey].extend(tileRange);\n      } else {\n        usedTiles[tileSourceKey][zKey] = tileRange;\n      }\n    } else {\n      usedTiles[tileSourceKey] = {};\n      usedTiles[tileSourceKey][zKey] = tileRange;\n    }\n  };\n\n  /**\n   * Manage tile pyramid.\n   * This function performs a number of functions related to the tiles at the\n   * current zoom and lower zoom levels:\n   * - registers idle tiles in frameState.wantedTiles so that they are not\n   *   discarded by the tile queue\n   * - enqueues missing tiles\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../source/Tile.js\").default} tileSource Tile source.\n   * @param {import(\"../tilegrid/TileGrid.js\").default} tileGrid Tile grid.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} currentZ Current Z.\n   * @param {number} preload Load low resolution tiles up to 'preload' levels.\n   * @param {function(this: T, import(\"../Tile.js\").default)=} opt_tileCallback Tile callback.\n   * @param {T=} opt_this Object to use as `this` in `opt_tileCallback`.\n   * @protected\n   * @template T\n   */\n  LayerRenderer.prototype.manageTilePyramid = function manageTilePyramid (\n    frameState,\n    tileSource,\n    tileGrid,\n    pixelRatio,\n    projection,\n    extent,\n    currentZ,\n    preload,\n    opt_tileCallback,\n    opt_this\n  ) {\n    var tileSourceKey = getUid(tileSource);\n    if (!(tileSourceKey in frameState.wantedTiles)) {\n      frameState.wantedTiles[tileSourceKey] = {};\n    }\n    var wantedTiles = frameState.wantedTiles[tileSourceKey];\n    var tileQueue = frameState.tileQueue;\n    var minZoom = tileGrid.getMinZoom();\n    var tile, tileRange, tileResolution, x, y, z;\n    for (z = minZoom; z <= currentZ; ++z) {\n      tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, tileRange);\n      tileResolution = tileGrid.getResolution(z);\n      for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n        for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n          if (currentZ - z <= preload) {\n            tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n            if (tile.getState() == TileState.IDLE) {\n              wantedTiles[tile.getKey()] = true;\n              if (!tileQueue.isKeyQueued(tile.getKey())) {\n                tileQueue.enqueue([tile, tileSourceKey,\n                  tileGrid.getTileCoordCenter(tile.tileCoord), tileResolution]);\n              }\n            }\n            if (opt_tileCallback !== undefined) {\n              opt_tileCallback.call(opt_this, tile);\n            }\n          } else {\n            tileSource.useTile(z, x, y, projection);\n          }\n        }\n      }\n    }\n  };\n\n  return LayerRenderer;\n}(Observable));\n\nexport default LayerRenderer;\n\n//# sourceMappingURL=Layer.js.map","/**\n * @module ol/renderer/canvas/Layer\n */\nimport {abstract} from '../../util.js';\nimport {getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../../extent.js';\nimport {TRUE} from '../../functions.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport LayerRenderer from '../Layer.js';\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @abstract\n */\nvar CanvasLayerRenderer = /*@__PURE__*/(function (LayerRenderer) {\n  function CanvasLayerRenderer(layer) {\n\n    LayerRenderer.call(this, layer);\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.renderedResolution;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.transform_ = createTransform();\n\n  }\n\n  if ( LayerRenderer ) CanvasLayerRenderer.__proto__ = LayerRenderer;\n  CanvasLayerRenderer.prototype = Object.create( LayerRenderer && LayerRenderer.prototype );\n  CanvasLayerRenderer.prototype.constructor = CanvasLayerRenderer;\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../extent.js\").Extent} extent Clip extent.\n   * @protected\n   */\n  CanvasLayerRenderer.prototype.clip = function clip (context, frameState, extent) {\n    var pixelRatio = frameState.pixelRatio;\n    var width = frameState.size[0] * pixelRatio;\n    var height = frameState.size[1] * pixelRatio;\n    var rotation = frameState.viewState.rotation;\n    var topLeft = getTopLeft(extent);\n    var topRight = getTopRight(extent);\n    var bottomRight = getBottomRight(extent);\n    var bottomLeft = getBottomLeft(extent);\n\n    applyTransform(frameState.coordinateToPixelTransform, topLeft);\n    applyTransform(frameState.coordinateToPixelTransform, topRight);\n    applyTransform(frameState.coordinateToPixelTransform, bottomRight);\n    applyTransform(frameState.coordinateToPixelTransform, bottomLeft);\n\n    context.save();\n    rotateAtOffset(context, -rotation, width / 2, height / 2);\n    context.beginPath();\n    context.moveTo(topLeft[0] * pixelRatio, topLeft[1] * pixelRatio);\n    context.lineTo(topRight[0] * pixelRatio, topRight[1] * pixelRatio);\n    context.lineTo(bottomRight[0] * pixelRatio, bottomRight[1] * pixelRatio);\n    context.lineTo(bottomLeft[0] * pixelRatio, bottomLeft[1] * pixelRatio);\n    context.clip();\n    rotateAtOffset(context, rotation, width / 2, height / 2);\n  };\n\n  /**\n   * @param {import(\"../../render/EventType.js\").default} type Event type.\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../transform.js\").Transform=} opt_transform Transform.\n   * @private\n   */\n  CanvasLayerRenderer.prototype.dispatchComposeEvent_ = function dispatchComposeEvent_ (type, context, frameState, opt_transform) {\n    var layer = this.getLayer();\n    if (layer.hasListener(type)) {\n      var width = frameState.size[0] * frameState.pixelRatio;\n      var height = frameState.size[1] * frameState.pixelRatio;\n      var rotation = frameState.viewState.rotation;\n      rotateAtOffset(context, -rotation, width / 2, height / 2);\n      var transform = opt_transform !== undefined ?\n        opt_transform : this.getTransform(frameState, 0);\n      var render = new CanvasImmediateRenderer(\n        context, frameState.pixelRatio, frameState.extent, transform,\n        frameState.viewState.rotation);\n      var composeEvent = new RenderEvent(type, render, frameState,\n        context, null);\n      layer.dispatchEvent(composeEvent);\n      rotateAtOffset(context, rotation, width / 2, height / 2);\n    }\n  };\n\n  /**\n   * @param {import(\"../../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(this: S, import(\"../../layer/Layer.js\").default, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n   *     callback.\n   * @param {S} thisArg Value to use as `this` when executing `callback`.\n   * @return {T|undefined} Callback result.\n   * @template S,T,U\n   */\n  CanvasLayerRenderer.prototype.forEachLayerAtCoordinate = function forEachLayerAtCoordinate (coordinate, frameState, hitTolerance, callback, thisArg) {\n    var hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, TRUE);\n\n    if (hasFeature) {\n      return callback.call(thisArg, this.getLayer(), null);\n    } else {\n      return undefined;\n    }\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../layer/Layer.js\").State} layerState Layer state.\n   * @param {import(\"../../transform.js\").Transform=} opt_transform Transform.\n   * @protected\n   */\n  CanvasLayerRenderer.prototype.postCompose = function postCompose (context, frameState, layerState, opt_transform) {\n    this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, context, frameState, opt_transform);\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../transform.js\").Transform=} opt_transform Transform.\n   * @protected\n   */\n  CanvasLayerRenderer.prototype.preCompose = function preCompose (context, frameState, opt_transform) {\n    this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, context, frameState, opt_transform);\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../transform.js\").Transform=} opt_transform Transform.\n   * @protected\n   */\n  CanvasLayerRenderer.prototype.dispatchRenderEvent = function dispatchRenderEvent (context, frameState, opt_transform) {\n    this.dispatchComposeEvent_(RenderEventType.RENDER, context, frameState, opt_transform);\n  };\n\n  /**\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {number} offsetX Offset on the x-axis in view coordinates.\n   * @protected\n   * @return {!import(\"../../transform.js\").Transform} Transform.\n   */\n  CanvasLayerRenderer.prototype.getTransform = function getTransform (frameState, offsetX) {\n    var viewState = frameState.viewState;\n    var pixelRatio = frameState.pixelRatio;\n    var dx1 = pixelRatio * frameState.size[0] / 2;\n    var dy1 = pixelRatio * frameState.size[1] / 2;\n    var sx = pixelRatio / viewState.resolution;\n    var sy = -sx;\n    var angle = -viewState.rotation;\n    var dx2 = -viewState.center[0] + offsetX;\n    var dy2 = -viewState.center[1];\n    return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n  };\n\n  /**\n   * @abstract\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../layer/Layer.js\").State} layerState Layer state.\n   * @param {CanvasRenderingContext2D} context Context.\n   */\n  CanvasLayerRenderer.prototype.composeFrame = function composeFrame (frameState, layerState, context) {\n    abstract();\n  };\n\n  /**\n   * @abstract\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../layer/Layer.js\").State} layerState Layer state.\n   * @return {boolean} whether composeFrame should be called.\n   */\n  CanvasLayerRenderer.prototype.prepareFrame = function prepareFrame (frameState, layerState) {\n    return abstract();\n  };\n\n  return CanvasLayerRenderer;\n}(LayerRenderer));\n\nexport default CanvasLayerRenderer;\n\n//# sourceMappingURL=Layer.js.map","/**\n * @module ol/pointer/EventSource\n */\n\nvar EventSource = function EventSource(dispatcher, mapping) {\n\n  /**\n   * @type {import(\"./PointerEventHandler.js\").default}\n   */\n  this.dispatcher = dispatcher;\n\n  /**\n   * @private\n   * @const\n   * @type {!Object<string, function(Event)>}\n   */\n  this.mapping_ = mapping;\n};\n\n/**\n * List of events supported by this source.\n * @return {Array<string>} Event names\n */\nEventSource.prototype.getEvents = function getEvents () {\n  return Object.keys(this.mapping_);\n};\n\n/**\n * Returns the handler that should handle a given event type.\n * @param {string} eventType The event type.\n * @return {function(Event)} Handler\n */\nEventSource.prototype.getHandlerForEvent = function getHandlerForEvent (eventType) {\n  return this.mapping_[eventType];\n};\n\nexport default EventSource;\n\n//# sourceMappingURL=EventSource.js.map","/**\n * @module ol/render/ReplayGroup\n */\nimport {abstract} from '../util.js';\n\n/**\n * Base class for replay groups.\n */\nvar ReplayGroup = function ReplayGroup () {};\n\nReplayGroup.prototype.getReplay = function getReplay (zIndex, replayType) {\n  return abstract();\n};\n\n/**\n * @abstract\n * @return {boolean} Is empty.\n */\nReplayGroup.prototype.isEmpty = function isEmpty () {\n  return abstract();\n};\n\n/**\n * @abstract\n * @param {boolean} group Group with previous replay\n * @return {Array<*>} The resulting instruction group\n */\nReplayGroup.prototype.addDeclutter = function addDeclutter (group) {\n  return abstract();\n};\n\nexport default ReplayGroup;\n\n//# sourceMappingURL=ReplayGroup.js.map","/**\n * @module ol/render/canvas/Instruction\n */\n\n/**\n * @enum {number}\n */\nvar Instruction = {\n  BEGIN_GEOMETRY: 0,\n  BEGIN_PATH: 1,\n  CIRCLE: 2,\n  CLOSE_PATH: 3,\n  CUSTOM: 4,\n  DRAW_CHARS: 5,\n  DRAW_IMAGE: 6,\n  END_GEOMETRY: 7,\n  FILL: 8,\n  MOVE_TO_LINE_TO: 9,\n  SET_FILL_STYLE: 10,\n  SET_STROKE_STYLE: 11,\n  STROKE: 12\n};\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport var fillInstruction = [Instruction.FILL];\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport var strokeInstruction = [Instruction.STROKE];\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport var beginPathInstruction = [Instruction.BEGIN_PATH];\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport var closePathInstruction = [Instruction.CLOSE_PATH];\n\n\nexport default Instruction;\n\n//# sourceMappingURL=Instruction.js.map","/**\n * @module ol/render/canvas/Replay\n */\nimport {getUid} from '../../util.js';\nimport {equals, reverseSubArray} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {buffer, clone, coordinateRelationship, createEmpty, createOrUpdate,\n  createOrUpdateEmpty, extend, extendCoordinate, intersects} from '../../extent.js';\nimport Relationship from '../../extent/Relationship.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {inflateCoordinates, inflateCoordinatesArray, inflateMultiCoordinatesArray} from '../../geom/flat/inflate.js';\nimport {lineStringLength} from '../../geom/flat/length.js';\nimport {drawTextOnPath} from '../../geom/flat/textpath.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {isEmpty} from '../../obj.js';\nimport VectorContext from '../VectorContext.js';\nimport {drawImage, resetTransform, defaultPadding, defaultFillStyle, defaultStrokeStyle,\n  defaultMiterLimit, defaultLineWidth, defaultLineJoin, defaultLineDashOffset,\n  defaultLineDash, defaultLineCap} from '../canvas.js';\nimport CanvasInstruction from './Instruction.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  apply as applyTransform,\n  setFromArray as transformSetFromArray\n} from '../../transform.js';\n\n\n/**\n * @type {import(\"../../extent.js\").Extent}\n */\nvar tmpExtent = createEmpty();\n\n\n/**\n * @type {!import(\"../../transform.js\").Transform}\n */\nvar tmpTransform = createTransform();\n\n\nvar CanvasReplay = /*@__PURE__*/(function (VectorContext) {\n  function CanvasReplay(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n    VectorContext.call(this);\n\n    /**\n     * @type {?}\n     */\n    this.declutterTree = declutterTree;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.tolerance = tolerance;\n\n    /**\n     * @protected\n     * @const\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.maxExtent = maxExtent;\n\n    /**\n     * @protected\n     * @type {boolean}\n     */\n    this.overlaps = overlaps;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.pixelRatio = pixelRatio;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.maxLineWidth = 0;\n\n    /**\n     * @protected\n     * @const\n     * @type {number}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.alignFill_;\n\n    /**\n     * @private\n     * @type {Array<*>}\n     */\n    this.beginGeometryInstruction1_ = null;\n\n    /**\n     * @private\n     * @type {Array<*>}\n     */\n    this.beginGeometryInstruction2_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.bufferedMaxExtent_ = null;\n\n    /**\n     * @protected\n     * @type {Array<*>}\n     */\n    this.instructions = [];\n\n    /**\n     * @protected\n     * @type {Array<number>}\n     */\n    this.coordinates = [];\n\n    /**\n     * @private\n     * @type {!Object<number,import(\"../../coordinate.js\").Coordinate|Array<import(\"../../coordinate.js\").Coordinate>|Array<Array<import(\"../../coordinate.js\").Coordinate>>>}\n     */\n    this.coordinateCache_ = {};\n\n    /**\n     * @private\n     * @type {!import(\"../../transform.js\").Transform}\n     */\n    this.renderedTransform_ = createTransform();\n\n    /**\n     * @protected\n     * @type {Array<*>}\n     */\n    this.hitDetectionInstructions = [];\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.pixelCoordinates_ = null;\n\n    /**\n     * @protected\n     * @type {import(\"../canvas.js\").FillStrokeState}\n     */\n    this.state = /** @type {import(\"../canvas.js\").FillStrokeState} */ ({});\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.viewRotation_ = 0;\n\n  }\n\n  if ( VectorContext ) CanvasReplay.__proto__ = VectorContext;\n  CanvasReplay.prototype = Object.create( VectorContext && VectorContext.prototype );\n  CanvasReplay.prototype.constructor = CanvasReplay;\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../coordinate.js\").Coordinate} p1 1st point of the background box.\n   * @param {import(\"../../coordinate.js\").Coordinate} p2 2nd point of the background box.\n   * @param {import(\"../../coordinate.js\").Coordinate} p3 3rd point of the background box.\n   * @param {import(\"../../coordinate.js\").Coordinate} p4 4th point of the background box.\n   * @param {Array<*>} fillInstruction Fill instruction.\n   * @param {Array<*>} strokeInstruction Stroke instruction.\n   */\n  CanvasReplay.prototype.replayTextBackground_ = function replayTextBackground_ (context, p1, p2, p3, p4, fillInstruction, strokeInstruction) {\n    context.beginPath();\n    context.moveTo.apply(context, p1);\n    context.lineTo.apply(context, p2);\n    context.lineTo.apply(context, p3);\n    context.lineTo.apply(context, p4);\n    context.lineTo.apply(context, p1);\n    if (fillInstruction) {\n      this.alignFill_ = /** @type {boolean} */ (fillInstruction[2]);\n      this.fill_(context);\n    }\n    if (strokeInstruction) {\n      this.setStrokeStyle_(context, /** @type {Array<*>} */ (strokeInstruction));\n      context.stroke();\n    }\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} x X.\n   * @param {number} y Y.\n   * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n   * @param {number} anchorX Anchor X.\n   * @param {number} anchorY Anchor Y.\n   * @param {import(\"../canvas.js\").DeclutterGroup} declutterGroup Declutter group.\n   * @param {number} height Height.\n   * @param {number} opacity Opacity.\n   * @param {number} originX Origin X.\n   * @param {number} originY Origin Y.\n   * @param {number} rotation Rotation.\n   * @param {number} scale Scale.\n   * @param {boolean} snapToPixel Snap to pixel.\n   * @param {number} width Width.\n   * @param {Array<number>} padding Padding.\n   * @param {Array<*>} fillInstruction Fill instruction.\n   * @param {Array<*>} strokeInstruction Stroke instruction.\n   */\n  CanvasReplay.prototype.replayImage_ = function replayImage_ (\n    context,\n    x,\n    y,\n    image,\n    anchorX,\n    anchorY,\n    declutterGroup,\n    height,\n    opacity,\n    originX,\n    originY,\n    rotation,\n    scale,\n    snapToPixel,\n    width,\n    padding,\n    fillInstruction,\n    strokeInstruction\n  ) {\n    var fillStroke = fillInstruction || strokeInstruction;\n    anchorX *= scale;\n    anchorY *= scale;\n    x -= anchorX;\n    y -= anchorY;\n\n    var w = (width + originX > image.width) ? image.width - originX : width;\n    var h = (height + originY > image.height) ? image.height - originY : height;\n    var boxW = padding[3] + w * scale + padding[1];\n    var boxH = padding[0] + h * scale + padding[2];\n    var boxX = x - padding[3];\n    var boxY = y - padding[0];\n\n    /** @type {import(\"../../coordinate.js\").Coordinate} */\n    var p1;\n    /** @type {import(\"../../coordinate.js\").Coordinate} */\n    var p2;\n    /** @type {import(\"../../coordinate.js\").Coordinate} */\n    var p3;\n    /** @type {import(\"../../coordinate.js\").Coordinate} */\n    var p4;\n    if (fillStroke || rotation !== 0) {\n      p1 = [boxX, boxY];\n      p2 = [boxX + boxW, boxY];\n      p3 = [boxX + boxW, boxY + boxH];\n      p4 = [boxX, boxY + boxH];\n    }\n\n    var transform = null;\n    if (rotation !== 0) {\n      var centerX = x + anchorX;\n      var centerY = y + anchorY;\n      transform = composeTransform(tmpTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n\n      createOrUpdateEmpty(tmpExtent);\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p1));\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p2));\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p3));\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p4));\n    } else {\n      createOrUpdate(boxX, boxY, boxX + boxW, boxY + boxH, tmpExtent);\n    }\n    var canvas = context.canvas;\n    var strokePadding = strokeInstruction ? (strokeInstruction[2] * scale / 2) : 0;\n    var intersects =\n        tmpExtent[0] - strokePadding <= canvas.width && tmpExtent[2] + strokePadding >= 0 &&\n        tmpExtent[1] - strokePadding <= canvas.height && tmpExtent[3] + strokePadding >= 0;\n\n    if (snapToPixel) {\n      x = Math.round(x);\n      y = Math.round(y);\n    }\n\n    if (declutterGroup) {\n      if (!intersects && declutterGroup[4] == 1) {\n        return;\n      }\n      extend(declutterGroup, tmpExtent);\n      var declutterArgs = intersects ?\n        [context, transform ? transform.slice(0) : null, opacity, image, originX, originY, w, h, x, y, scale] :\n        null;\n      if (declutterArgs && fillStroke) {\n        declutterArgs.push(fillInstruction, strokeInstruction, p1, p2, p3, p4);\n      }\n      declutterGroup.push(declutterArgs);\n    } else if (intersects) {\n      if (fillStroke) {\n        this.replayTextBackground_(context, p1, p2, p3, p4,\n          /** @type {Array<*>} */ (fillInstruction),\n          /** @type {Array<*>} */ (strokeInstruction));\n      }\n      drawImage(context, transform, opacity, image, originX, originY, w, h, x, y, scale);\n    }\n  };\n\n  /**\n   * @protected\n   * @param {Array<number>} dashArray Dash array.\n   * @return {Array<number>} Dash array with pixel ratio applied\n   */\n  CanvasReplay.prototype.applyPixelRatio = function applyPixelRatio (dashArray) {\n    var pixelRatio = this.pixelRatio;\n    return pixelRatio == 1 ? dashArray : dashArray.map(function(dash) {\n      return dash * pixelRatio;\n    });\n  };\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} closed Last input coordinate equals first.\n   * @param {boolean} skipFirst Skip first coordinate.\n   * @protected\n   * @return {number} My end.\n   */\n  CanvasReplay.prototype.appendFlatCoordinates = function appendFlatCoordinates (flatCoordinates, offset, end, stride, closed, skipFirst) {\n\n    var myEnd = this.coordinates.length;\n    var extent = this.getBufferedMaxExtent();\n    if (skipFirst) {\n      offset += stride;\n    }\n    var lastCoord = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n    var nextCoord = [NaN, NaN];\n    var skipped = true;\n\n    var i, lastRel, nextRel;\n    for (i = offset + stride; i < end; i += stride) {\n      nextCoord[0] = flatCoordinates[i];\n      nextCoord[1] = flatCoordinates[i + 1];\n      nextRel = coordinateRelationship(extent, nextCoord);\n      if (nextRel !== lastRel) {\n        if (skipped) {\n          this.coordinates[myEnd++] = lastCoord[0];\n          this.coordinates[myEnd++] = lastCoord[1];\n        }\n        this.coordinates[myEnd++] = nextCoord[0];\n        this.coordinates[myEnd++] = nextCoord[1];\n        skipped = false;\n      } else if (nextRel === Relationship.INTERSECTING) {\n        this.coordinates[myEnd++] = nextCoord[0];\n        this.coordinates[myEnd++] = nextCoord[1];\n        skipped = false;\n      } else {\n        skipped = true;\n      }\n      lastCoord[0] = nextCoord[0];\n      lastCoord[1] = nextCoord[1];\n      lastRel = nextRel;\n    }\n\n    // Last coordinate equals first or only one point to append:\n    if ((closed && skipped) || i === offset + stride) {\n      this.coordinates[myEnd++] = lastCoord[0];\n      this.coordinates[myEnd++] = lastCoord[1];\n    }\n    return myEnd;\n  };\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @param {Array<number>} replayEnds Replay ends.\n   * @return {number} Offset.\n   */\n  CanvasReplay.prototype.drawCustomCoordinates_ = function drawCustomCoordinates_ (flatCoordinates, offset, ends, stride, replayEnds) {\n    for (var i = 0, ii = ends.length; i < ii; ++i) {\n      var end = ends[i];\n      var replayEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n      replayEnds.push(replayEnd);\n      offset = end;\n    }\n    return offset;\n  };\n\n  /**\n   * @inheritDoc.\n   */\n  CanvasReplay.prototype.drawCustom = function drawCustom (geometry, feature, renderer) {\n    this.beginGeometry(geometry, feature);\n    var type = geometry.getType();\n    var stride = geometry.getStride();\n    var replayBegin = this.coordinates.length;\n    var flatCoordinates, replayEnd, replayEnds, replayEndss;\n    var offset;\n    if (type == GeometryType.MULTI_POLYGON) {\n      geometry = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry);\n      flatCoordinates = geometry.getOrientedFlatCoordinates();\n      replayEndss = [];\n      var endss = geometry.getEndss();\n      offset = 0;\n      for (var i = 0, ii = endss.length; i < ii; ++i) {\n        var myEnds = [];\n        offset = this.drawCustomCoordinates_(flatCoordinates, offset, endss[i], stride, myEnds);\n        replayEndss.push(myEnds);\n      }\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        replayBegin, replayEndss, geometry, renderer, inflateMultiCoordinatesArray]);\n    } else if (type == GeometryType.POLYGON || type == GeometryType.MULTI_LINE_STRING) {\n      replayEnds = [];\n      flatCoordinates = (type == GeometryType.POLYGON) ?\n        /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry).getOrientedFlatCoordinates() :\n        geometry.getFlatCoordinates();\n      offset = this.drawCustomCoordinates_(flatCoordinates, 0,\n        /** @type {import(\"../../geom/Polygon.js\").default|import(\"../../geom/MultiLineString.js\").default} */ (geometry).getEnds(),\n        stride, replayEnds);\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        replayBegin, replayEnds, geometry, renderer, inflateCoordinatesArray]);\n    } else if (type == GeometryType.LINE_STRING || type == GeometryType.MULTI_POINT) {\n      flatCoordinates = geometry.getFlatCoordinates();\n      replayEnd = this.appendFlatCoordinates(\n        flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        replayBegin, replayEnd, geometry, renderer, inflateCoordinates]);\n    } else if (type == GeometryType.POINT) {\n      flatCoordinates = geometry.getFlatCoordinates();\n      this.coordinates.push(flatCoordinates[0], flatCoordinates[1]);\n      replayEnd = this.coordinates.length;\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        replayBegin, replayEnd, geometry, renderer]);\n    }\n    this.endGeometry(geometry, feature);\n  };\n\n  /**\n   * @protected\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry Geometry.\n   * @param {import(\"../../Feature.js\").default|import(\"../Feature.js\").default} feature Feature.\n   */\n  CanvasReplay.prototype.beginGeometry = function beginGeometry (geometry, feature) {\n    this.beginGeometryInstruction1_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n    this.instructions.push(this.beginGeometryInstruction1_);\n    this.beginGeometryInstruction2_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n    this.hitDetectionInstructions.push(this.beginGeometryInstruction2_);\n  };\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  CanvasReplay.prototype.finish = function finish () {};\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} context Context.\n   */\n  CanvasReplay.prototype.fill_ = function fill_ (context) {\n    if (this.alignFill_) {\n      var origin = applyTransform(this.renderedTransform_, [0, 0]);\n      var repeatSize = 512 * this.pixelRatio;\n      context.translate(origin[0] % repeatSize, origin[1] % repeatSize);\n      context.rotate(this.viewRotation_);\n    }\n    context.fill();\n    if (this.alignFill_) {\n      context.setTransform.apply(context, resetTransform);\n    }\n  };\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {Array<*>} instruction Instruction.\n   */\n  CanvasReplay.prototype.setStrokeStyle_ = function setStrokeStyle_ (context, instruction) {\n    context.strokeStyle = /** @type {import(\"../../colorlike.js\").ColorLike} */ (instruction[1]);\n    context.lineWidth = /** @type {number} */ (instruction[2]);\n    context.lineCap = /** @type {CanvasLineCap} */ (instruction[3]);\n    context.lineJoin = /** @type {CanvasLineJoin} */ (instruction[4]);\n    context.miterLimit = /** @type {number} */ (instruction[5]);\n    if (CANVAS_LINE_DASH) {\n      context.lineDashOffset = /** @type {number} */ (instruction[7]);\n      context.setLineDash(/** @type {Array<number>} */ (instruction[6]));\n    }\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").DeclutterGroup} declutterGroup Declutter group.\n   * @param {import(\"../../Feature.js\").default|import(\"../Feature.js\").default} feature Feature.\n   */\n  CanvasReplay.prototype.renderDeclutter_ = function renderDeclutter_ (declutterGroup, feature) {\n    if (declutterGroup && declutterGroup.length > 5) {\n      var groupCount = declutterGroup[4];\n      if (groupCount == 1 || groupCount == declutterGroup.length - 5) {\n        /** @type {import(\"../../structs/RBush.js\").Entry} */\n        var box = {\n          minX: /** @type {number} */ (declutterGroup[0]),\n          minY: /** @type {number} */ (declutterGroup[1]),\n          maxX: /** @type {number} */ (declutterGroup[2]),\n          maxY: /** @type {number} */ (declutterGroup[3]),\n          value: feature\n        };\n        if (!this.declutterTree.collides(box)) {\n          this.declutterTree.insert(box);\n          for (var j = 5, jj = declutterGroup.length; j < jj; ++j) {\n            var declutterData = /** @type {Array} */ (declutterGroup[j]);\n            if (declutterData) {\n              if (declutterData.length > 11) {\n                this.replayTextBackground_(declutterData[0],\n                  declutterData[13], declutterData[14], declutterData[15], declutterData[16],\n                  declutterData[11], declutterData[12]);\n              }\n              drawImage.apply(undefined, declutterData);\n            }\n          }\n        }\n        declutterGroup.length = 5;\n        createOrUpdateEmpty(declutterGroup);\n      }\n    }\n  };\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features\n   *     to skip.\n   * @param {Array<*>} instructions Instructions array.\n   * @param {boolean} snapToPixel Snap point symbols and text to integer pixels.\n   * @param {function((import(\"../../Feature.js\").default|import(\"../Feature.js\").default)): T|undefined} featureCallback Feature callback.\n   * @param {import(\"../../extent.js\").Extent=} opt_hitExtent Only check features that intersect this\n   *     extent.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  CanvasReplay.prototype.replay_ = function replay_ (\n    context,\n    transform,\n    skippedFeaturesHash,\n    instructions,\n    snapToPixel,\n    featureCallback,\n    opt_hitExtent\n  ) {\n    /** @type {Array<number>} */\n    var pixelCoordinates;\n    if (this.pixelCoordinates_ && equals(transform, this.renderedTransform_)) {\n      pixelCoordinates = this.pixelCoordinates_;\n    } else {\n      if (!this.pixelCoordinates_) {\n        this.pixelCoordinates_ = [];\n      }\n      pixelCoordinates = transform2D(\n        this.coordinates, 0, this.coordinates.length, 2,\n        transform, this.pixelCoordinates_);\n      transformSetFromArray(this.renderedTransform_, transform);\n    }\n    var skipFeatures = !isEmpty(skippedFeaturesHash);\n    var i = 0; // instruction index\n    var ii = instructions.length; // end of instructions\n    var d = 0; // data index\n    var dd; // end of per-instruction data\n    var anchorX, anchorY, prevX, prevY, roundX, roundY, declutterGroup, image;\n    var pendingFill = 0;\n    var pendingStroke = 0;\n    var lastFillInstruction = null;\n    var lastStrokeInstruction = null;\n    var coordinateCache = this.coordinateCache_;\n    var viewRotation = this.viewRotation_;\n\n    var state = /** @type {import(\"../../render.js\").State} */ ({\n      context: context,\n      pixelRatio: this.pixelRatio,\n      resolution: this.resolution,\n      rotation: viewRotation\n    });\n\n    // When the batch size gets too big, performance decreases. 200 is a good\n    // balance between batch size and number of fill/stroke instructions.\n    var batchSize = this.instructions != instructions || this.overlaps ? 0 : 200;\n    var /** @type {import(\"../../Feature.js\").default|import(\"../Feature.js\").default} */ feature;\n    var x, y;\n    while (i < ii) {\n      var instruction = instructions[i];\n      var type = /** @type {CanvasInstruction} */ (instruction[0]);\n      switch (type) {\n        case CanvasInstruction.BEGIN_GEOMETRY:\n          feature = /** @type {import(\"../../Feature.js\").default|import(\"../Feature.js\").default} */ (instruction[1]);\n          if ((skipFeatures && skippedFeaturesHash[getUid(feature)]) || !feature.getGeometry()) {\n            i = /** @type {number} */ (instruction[2]);\n          } else if (opt_hitExtent !== undefined && !intersects(\n            opt_hitExtent, feature.getGeometry().getExtent())) {\n            i = /** @type {number} */ (instruction[2]) + 1;\n          } else {\n            ++i;\n          }\n          break;\n        case CanvasInstruction.BEGIN_PATH:\n          if (pendingFill > batchSize) {\n            this.fill_(context);\n            pendingFill = 0;\n          }\n          if (pendingStroke > batchSize) {\n            context.stroke();\n            pendingStroke = 0;\n          }\n          if (!pendingFill && !pendingStroke) {\n            context.beginPath();\n            prevX = prevY = NaN;\n          }\n          ++i;\n          break;\n        case CanvasInstruction.CIRCLE:\n          d = /** @type {number} */ (instruction[1]);\n          var x1 = pixelCoordinates[d];\n          var y1 = pixelCoordinates[d + 1];\n          var x2 = pixelCoordinates[d + 2];\n          var y2 = pixelCoordinates[d + 3];\n          var dx = x2 - x1;\n          var dy = y2 - y1;\n          var r = Math.sqrt(dx * dx + dy * dy);\n          context.moveTo(x1 + r, y1);\n          context.arc(x1, y1, r, 0, 2 * Math.PI, true);\n          ++i;\n          break;\n        case CanvasInstruction.CLOSE_PATH:\n          context.closePath();\n          ++i;\n          break;\n        case CanvasInstruction.CUSTOM:\n          d = /** @type {number} */ (instruction[1]);\n          dd = instruction[2];\n          var geometry = /** @type {import(\"../../geom/SimpleGeometry.js\").default} */ (instruction[3]);\n          var renderer = instruction[4];\n          var fn = instruction.length == 6 ? instruction[5] : undefined;\n          state.geometry = geometry;\n          state.feature = feature;\n          if (!(i in coordinateCache)) {\n            coordinateCache[i] = [];\n          }\n          var coords = coordinateCache[i];\n          if (fn) {\n            fn(pixelCoordinates, d, dd, 2, coords);\n          } else {\n            coords[0] = pixelCoordinates[d];\n            coords[1] = pixelCoordinates[d + 1];\n            coords.length = 2;\n          }\n          renderer(coords, state);\n          ++i;\n          break;\n        case CanvasInstruction.DRAW_IMAGE:\n          d = /** @type {number} */ (instruction[1]);\n          dd = /** @type {number} */ (instruction[2]);\n          image = /** @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement} */\n              (instruction[3]);\n          // Remaining arguments in DRAW_IMAGE are in alphabetical order\n          anchorX = /** @type {number} */ (instruction[4]);\n          anchorY = /** @type {number} */ (instruction[5]);\n          declutterGroup = featureCallback ? null : /** @type {import(\"../canvas.js\").DeclutterGroup} */ (instruction[6]);\n          var height = /** @type {number} */ (instruction[7]);\n          var opacity = /** @type {number} */ (instruction[8]);\n          var originX = /** @type {number} */ (instruction[9]);\n          var originY = /** @type {number} */ (instruction[10]);\n          var rotateWithView = /** @type {boolean} */ (instruction[11]);\n          var rotation = /** @type {number} */ (instruction[12]);\n          var scale = /** @type {number} */ (instruction[13]);\n          var width = /** @type {number} */ (instruction[14]);\n\n          var padding = (void 0), backgroundFill = (void 0), backgroundStroke = (void 0);\n          if (instruction.length > 16) {\n            padding = /** @type {Array<number>} */ (instruction[15]);\n            backgroundFill = /** @type {boolean} */ (instruction[16]);\n            backgroundStroke = /** @type {boolean} */ (instruction[17]);\n          } else {\n            padding = defaultPadding;\n            backgroundFill = backgroundStroke = false;\n          }\n\n          if (rotateWithView) {\n            rotation += viewRotation;\n          }\n          for (; d < dd; d += 2) {\n            this.replayImage_(context,\n              pixelCoordinates[d], pixelCoordinates[d + 1], image, anchorX, anchorY,\n              declutterGroup, height, opacity, originX, originY, rotation, scale,\n              snapToPixel, width, padding,\n              backgroundFill ? /** @type {Array<*>} */ (lastFillInstruction) : null,\n              backgroundStroke ? /** @type {Array<*>} */ (lastStrokeInstruction) : null);\n          }\n          this.renderDeclutter_(declutterGroup, feature);\n          ++i;\n          break;\n        case CanvasInstruction.DRAW_CHARS:\n          var begin = /** @type {number} */ (instruction[1]);\n          var end = /** @type {number} */ (instruction[2]);\n          var baseline = /** @type {number} */ (instruction[3]);\n          declutterGroup = featureCallback ? null : /** @type {import(\"../canvas.js\").DeclutterGroup} */ (instruction[4]);\n          var overflow = /** @type {number} */ (instruction[5]);\n          var fillKey = /** @type {string} */ (instruction[6]);\n          var maxAngle = /** @type {number} */ (instruction[7]);\n          var measure = /** @type {function(string):number} */ (instruction[8]);\n          var offsetY = /** @type {number} */ (instruction[9]);\n          var strokeKey = /** @type {string} */ (instruction[10]);\n          var strokeWidth = /** @type {number} */ (instruction[11]);\n          var text = /** @type {string} */ (instruction[12]);\n          var textKey = /** @type {string} */ (instruction[13]);\n          var textScale = /** @type {number} */ (instruction[14]);\n\n          var pathLength = lineStringLength(pixelCoordinates, begin, end, 2);\n          var textLength = measure(text);\n          if (overflow || textLength <= pathLength) {\n            /** @type {import(\"./TextReplay.js\").default} */\n            var textReplay = /** @type {?} */ (this);\n            var textAlign = textReplay.textStates[textKey].textAlign;\n            var startM = (pathLength - textLength) * TEXT_ALIGN[textAlign];\n            var parts = drawTextOnPath(\n              pixelCoordinates, begin, end, 2, text, measure, startM, maxAngle);\n            if (parts) {\n              var c = (void 0), cc = (void 0), chars = (void 0), label = (void 0), part = (void 0);\n              if (strokeKey) {\n                for (c = 0, cc = parts.length; c < cc; ++c) {\n                  part = parts[c]; // x, y, anchorX, rotation, chunk\n                  chars = /** @type {string} */ (part[4]);\n                  label = textReplay.getImage(chars, textKey, '', strokeKey);\n                  anchorX = /** @type {number} */ (part[2]) + strokeWidth;\n                  anchorY = baseline * label.height + (0.5 - baseline) * 2 * strokeWidth - offsetY;\n                  this.replayImage_(context,\n                    /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                    anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                    /** @type {number} */ (part[3]), textScale, false, label.width,\n                    defaultPadding, null, null);\n                }\n              }\n              if (fillKey) {\n                for (c = 0, cc = parts.length; c < cc; ++c) {\n                  part = parts[c]; // x, y, anchorX, rotation, chunk\n                  chars = /** @type {string} */ (part[4]);\n                  label = textReplay.getImage(chars, textKey, fillKey, '');\n                  anchorX = /** @type {number} */ (part[2]);\n                  anchorY = baseline * label.height - offsetY;\n                  this.replayImage_(context,\n                    /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                    anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                    /** @type {number} */ (part[3]), textScale, false, label.width,\n                    defaultPadding, null, null);\n                }\n              }\n            }\n          }\n          this.renderDeclutter_(declutterGroup, feature);\n          ++i;\n          break;\n        case CanvasInstruction.END_GEOMETRY:\n          if (featureCallback !== undefined) {\n            feature = /** @type {import(\"../../Feature.js\").default|import(\"../Feature.js\").default} */ (instruction[1]);\n            var result = featureCallback(feature);\n            if (result) {\n              return result;\n            }\n          }\n          ++i;\n          break;\n        case CanvasInstruction.FILL:\n          if (batchSize) {\n            pendingFill++;\n          } else {\n            this.fill_(context);\n          }\n          ++i;\n          break;\n        case CanvasInstruction.MOVE_TO_LINE_TO:\n          d = /** @type {number} */ (instruction[1]);\n          dd = /** @type {number} */ (instruction[2]);\n          x = pixelCoordinates[d];\n          y = pixelCoordinates[d + 1];\n          roundX = (x + 0.5) | 0;\n          roundY = (y + 0.5) | 0;\n          if (roundX !== prevX || roundY !== prevY) {\n            context.moveTo(x, y);\n            prevX = roundX;\n            prevY = roundY;\n          }\n          for (d += 2; d < dd; d += 2) {\n            x = pixelCoordinates[d];\n            y = pixelCoordinates[d + 1];\n            roundX = (x + 0.5) | 0;\n            roundY = (y + 0.5) | 0;\n            if (d == dd - 2 || roundX !== prevX || roundY !== prevY) {\n              context.lineTo(x, y);\n              prevX = roundX;\n              prevY = roundY;\n            }\n          }\n          ++i;\n          break;\n        case CanvasInstruction.SET_FILL_STYLE:\n          lastFillInstruction = instruction;\n          this.alignFill_ = instruction[2];\n\n          if (pendingFill) {\n            this.fill_(context);\n            pendingFill = 0;\n            if (pendingStroke) {\n              context.stroke();\n              pendingStroke = 0;\n            }\n          }\n\n          context.fillStyle = /** @type {import(\"../../colorlike.js\").ColorLike} */ (instruction[1]);\n          ++i;\n          break;\n        case CanvasInstruction.SET_STROKE_STYLE:\n          lastStrokeInstruction = instruction;\n          if (pendingStroke) {\n            context.stroke();\n            pendingStroke = 0;\n          }\n          this.setStrokeStyle_(context, /** @type {Array<*>} */ (instruction));\n          ++i;\n          break;\n        case CanvasInstruction.STROKE:\n          if (batchSize) {\n            pendingStroke++;\n          } else {\n            context.stroke();\n          }\n          ++i;\n          break;\n        default:\n          ++i; // consume the instruction anyway, to avoid an infinite loop\n          break;\n      }\n    }\n    if (pendingFill) {\n      this.fill_(context);\n    }\n    if (pendingStroke) {\n      context.stroke();\n    }\n    return undefined;\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features\n   *     to skip.\n   * @param {boolean} snapToPixel Snap point symbols and text to integer pixels.\n   */\n  CanvasReplay.prototype.replay = function replay (context, transform, viewRotation, skippedFeaturesHash, snapToPixel) {\n    this.viewRotation_ = viewRotation;\n    this.replay_(context, transform,\n      skippedFeaturesHash, this.instructions, snapToPixel, undefined, undefined);\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features\n   *     to skip.\n   * @param {function((import(\"../../Feature.js\").default|import(\"../Feature.js\").default)): T=} opt_featureCallback\n   *     Feature callback.\n   * @param {import(\"../../extent.js\").Extent=} opt_hitExtent Only check features that intersect this\n   *     extent.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  CanvasReplay.prototype.replayHitDetection = function replayHitDetection (\n    context,\n    transform,\n    viewRotation,\n    skippedFeaturesHash,\n    opt_featureCallback,\n    opt_hitExtent\n  ) {\n    this.viewRotation_ = viewRotation;\n    return this.replay_(context, transform, skippedFeaturesHash,\n      this.hitDetectionInstructions, true, opt_featureCallback, opt_hitExtent);\n  };\n\n  /**\n   * Reverse the hit detection instructions.\n   */\n  CanvasReplay.prototype.reverseHitDetectionInstructions = function reverseHitDetectionInstructions () {\n    var hitDetectionInstructions = this.hitDetectionInstructions;\n    // step 1 - reverse array\n    hitDetectionInstructions.reverse();\n    // step 2 - reverse instructions within geometry blocks\n    var i;\n    var n = hitDetectionInstructions.length;\n    var instruction;\n    var type;\n    var begin = -1;\n    for (i = 0; i < n; ++i) {\n      instruction = hitDetectionInstructions[i];\n      type = /** @type {CanvasInstruction} */ (instruction[0]);\n      if (type == CanvasInstruction.END_GEOMETRY) {\n        begin = i;\n      } else if (type == CanvasInstruction.BEGIN_GEOMETRY) {\n        instruction[2] = i;\n        reverseSubArray(this.hitDetectionInstructions, begin, i);\n        begin = -1;\n      }\n    }\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasReplay.prototype.setFillStrokeStyle = function setFillStrokeStyle (fillStyle, strokeStyle) {\n    var state = this.state;\n    if (fillStyle) {\n      var fillStyleColor = fillStyle.getColor();\n      state.fillStyle = asColorLike(fillStyleColor ?\n        fillStyleColor : defaultFillStyle);\n    } else {\n      state.fillStyle = undefined;\n    }\n    if (strokeStyle) {\n      var strokeStyleColor = strokeStyle.getColor();\n      state.strokeStyle = asColorLike(strokeStyleColor ?\n        strokeStyleColor : defaultStrokeStyle);\n      var strokeStyleLineCap = strokeStyle.getLineCap();\n      state.lineCap = strokeStyleLineCap !== undefined ?\n        strokeStyleLineCap : defaultLineCap;\n      var strokeStyleLineDash = strokeStyle.getLineDash();\n      state.lineDash = strokeStyleLineDash ?\n        strokeStyleLineDash.slice() : defaultLineDash;\n      var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      state.lineDashOffset = strokeStyleLineDashOffset ?\n        strokeStyleLineDashOffset : defaultLineDashOffset;\n      var strokeStyleLineJoin = strokeStyle.getLineJoin();\n      state.lineJoin = strokeStyleLineJoin !== undefined ?\n        strokeStyleLineJoin : defaultLineJoin;\n      var strokeStyleWidth = strokeStyle.getWidth();\n      state.lineWidth = strokeStyleWidth !== undefined ?\n        strokeStyleWidth : defaultLineWidth;\n      var strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      state.miterLimit = strokeStyleMiterLimit !== undefined ?\n        strokeStyleMiterLimit : defaultMiterLimit;\n\n      if (state.lineWidth > this.maxLineWidth) {\n        this.maxLineWidth = state.lineWidth;\n        // invalidate the buffered max extent cache\n        this.bufferedMaxExtent_ = null;\n      }\n    } else {\n      state.strokeStyle = undefined;\n      state.lineCap = undefined;\n      state.lineDash = null;\n      state.lineDashOffset = undefined;\n      state.lineJoin = undefined;\n      state.lineWidth = undefined;\n      state.miterLimit = undefined;\n    }\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry Geometry.\n   * @return {Array<*>} Fill instruction.\n   */\n  CanvasReplay.prototype.createFill = function createFill (state, geometry) {\n    var fillStyle = state.fillStyle;\n    /** @type {Array<*>} */\n    var fillInstruction = [CanvasInstruction.SET_FILL_STYLE, fillStyle];\n    if (typeof fillStyle !== 'string') {\n      // Fill is a pattern or gradient - align it!\n      fillInstruction.push(true);\n    }\n    return fillInstruction;\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   */\n  CanvasReplay.prototype.applyStroke = function applyStroke (state) {\n    this.instructions.push(this.createStroke(state));\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @return {Array<*>} Stroke instruction.\n   */\n  CanvasReplay.prototype.createStroke = function createStroke (state) {\n    return [\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth * this.pixelRatio, state.lineCap,\n      state.lineJoin, state.miterLimit,\n      this.applyPixelRatio(state.lineDash), state.lineDashOffset * this.pixelRatio\n    ];\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @param {function(this:CanvasReplay, import(\"../canvas.js\").FillStrokeState, (import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default)):Array<*>} createFill Create fill.\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry Geometry.\n   */\n  CanvasReplay.prototype.updateFillStyle = function updateFillStyle (state, createFill, geometry) {\n    var fillStyle = state.fillStyle;\n    if (typeof fillStyle !== 'string' || state.currentFillStyle != fillStyle) {\n      if (fillStyle !== undefined) {\n        this.instructions.push(createFill.call(this, state, geometry));\n      }\n      state.currentFillStyle = fillStyle;\n    }\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @param {function(this:CanvasReplay, import(\"../canvas.js\").FillStrokeState)} applyStroke Apply stroke.\n   */\n  CanvasReplay.prototype.updateStrokeStyle = function updateStrokeStyle (state, applyStroke) {\n    var strokeStyle = state.strokeStyle;\n    var lineCap = state.lineCap;\n    var lineDash = state.lineDash;\n    var lineDashOffset = state.lineDashOffset;\n    var lineJoin = state.lineJoin;\n    var lineWidth = state.lineWidth;\n    var miterLimit = state.miterLimit;\n    if (state.currentStrokeStyle != strokeStyle ||\n        state.currentLineCap != lineCap ||\n        (lineDash != state.currentLineDash && !equals(state.currentLineDash, lineDash)) ||\n        state.currentLineDashOffset != lineDashOffset ||\n        state.currentLineJoin != lineJoin ||\n        state.currentLineWidth != lineWidth ||\n        state.currentMiterLimit != miterLimit) {\n      if (strokeStyle !== undefined) {\n        applyStroke.call(this, state);\n      }\n      state.currentStrokeStyle = strokeStyle;\n      state.currentLineCap = lineCap;\n      state.currentLineDash = lineDash;\n      state.currentLineDashOffset = lineDashOffset;\n      state.currentLineJoin = lineJoin;\n      state.currentLineWidth = lineWidth;\n      state.currentMiterLimit = miterLimit;\n    }\n  };\n\n  /**\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry Geometry.\n   * @param {import(\"../../Feature.js\").default|import(\"../Feature.js\").default} feature Feature.\n   */\n  CanvasReplay.prototype.endGeometry = function endGeometry (geometry, feature) {\n    this.beginGeometryInstruction1_[2] = this.instructions.length;\n    this.beginGeometryInstruction1_ = null;\n    this.beginGeometryInstruction2_[2] = this.hitDetectionInstructions.length;\n    this.beginGeometryInstruction2_ = null;\n    var endGeometryInstruction = [CanvasInstruction.END_GEOMETRY, feature];\n    this.instructions.push(endGeometryInstruction);\n    this.hitDetectionInstructions.push(endGeometryInstruction);\n  };\n\n  /**\n   * Get the buffered rendering extent.  Rendering will be clipped to the extent\n   * provided to the constructor.  To account for symbolizers that may intersect\n   * this extent, we calculate a buffered extent (e.g. based on stroke width).\n   * @return {import(\"../../extent.js\").Extent} The buffered rendering extent.\n   * @protected\n   */\n  CanvasReplay.prototype.getBufferedMaxExtent = function getBufferedMaxExtent () {\n    if (!this.bufferedMaxExtent_) {\n      this.bufferedMaxExtent_ = clone(this.maxExtent);\n      if (this.maxLineWidth > 0) {\n        var width = this.resolution * (this.maxLineWidth + 1) / 2;\n        buffer(this.bufferedMaxExtent_, width, this.bufferedMaxExtent_);\n      }\n    }\n    return this.bufferedMaxExtent_;\n  };\n\n  return CanvasReplay;\n}(VectorContext));\n\n\nexport default CanvasReplay;\n\n//# sourceMappingURL=Replay.js.map","/**\n * @module ol/render/canvas/ImageReplay\n */\nimport CanvasInstruction from './Instruction.js';\nimport CanvasReplay from './Replay.js';\n\nvar CanvasImageReplay = /*@__PURE__*/(function (CanvasReplay) {\n  function CanvasImageReplay(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n    CanvasReplay.call(this, tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n    /**\n     * @private\n     * @type {import(\"../canvas.js\").DeclutterGroup}\n     */\n    this.declutterGroup_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    this.hitDetectionImage_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.anchorX_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.anchorY_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.height_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.opacity_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.originX_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.originY_ = undefined;\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.rotateWithView_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.rotation_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.scale_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.width_ = undefined;\n\n  }\n\n  if ( CanvasReplay ) CanvasImageReplay.__proto__ = CanvasReplay;\n  CanvasImageReplay.prototype = Object.create( CanvasReplay && CanvasReplay.prototype );\n  CanvasImageReplay.prototype.constructor = CanvasImageReplay;\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} My end.\n   */\n  CanvasImageReplay.prototype.drawCoordinates_ = function drawCoordinates_ (flatCoordinates, offset, end, stride) {\n    return this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageReplay.prototype.drawPoint = function drawPoint (pointGeometry, feature) {\n    if (!this.image_) {\n      return;\n    }\n    this.beginGeometry(pointGeometry, feature);\n    var flatCoordinates = pointGeometry.getFlatCoordinates();\n    var stride = pointGeometry.getStride();\n    var myBegin = this.coordinates.length;\n    var myEnd = this.drawCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n    this.instructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_ * this.pixelRatio, this.width_\n    ]);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_, this.width_\n    ]);\n    this.endGeometry(pointGeometry, feature);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageReplay.prototype.drawMultiPoint = function drawMultiPoint (multiPointGeometry, feature) {\n    if (!this.image_) {\n      return;\n    }\n    this.beginGeometry(multiPointGeometry, feature);\n    var flatCoordinates = multiPointGeometry.getFlatCoordinates();\n    var stride = multiPointGeometry.getStride();\n    var myBegin = this.coordinates.length;\n    var myEnd = this.drawCoordinates_(\n      flatCoordinates, 0, flatCoordinates.length, stride);\n    this.instructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_ * this.pixelRatio, this.width_\n    ]);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_, this.width_\n    ]);\n    this.endGeometry(multiPointGeometry, feature);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageReplay.prototype.finish = function finish () {\n    this.reverseHitDetectionInstructions();\n    // FIXME this doesn't really protect us against further calls to draw*Geometry\n    this.anchorX_ = undefined;\n    this.anchorY_ = undefined;\n    this.hitDetectionImage_ = null;\n    this.image_ = null;\n    this.height_ = undefined;\n    this.scale_ = undefined;\n    this.opacity_ = undefined;\n    this.originX_ = undefined;\n    this.originY_ = undefined;\n    this.rotateWithView_ = undefined;\n    this.rotation_ = undefined;\n    this.width_ = undefined;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageReplay.prototype.setImageStyle = function setImageStyle (imageStyle, declutterGroup) {\n    var anchor = imageStyle.getAnchor();\n    var size = imageStyle.getSize();\n    var hitDetectionImage = imageStyle.getHitDetectionImage(1);\n    var image = imageStyle.getImage(1);\n    var origin = imageStyle.getOrigin();\n    this.anchorX_ = anchor[0];\n    this.anchorY_ = anchor[1];\n    this.declutterGroup_ = /** @type {import(\"../canvas.js\").DeclutterGroup} */ (declutterGroup);\n    this.hitDetectionImage_ = hitDetectionImage;\n    this.image_ = image;\n    this.height_ = size[1];\n    this.opacity_ = imageStyle.getOpacity();\n    this.originX_ = origin[0];\n    this.originY_ = origin[1];\n    this.rotateWithView_ = imageStyle.getRotateWithView();\n    this.rotation_ = imageStyle.getRotation();\n    this.scale_ = imageStyle.getScale();\n    this.width_ = size[0];\n  };\n\n  return CanvasImageReplay;\n}(CanvasReplay));\n\n\nexport default CanvasImageReplay;\n\n//# sourceMappingURL=ImageReplay.js.map","/**\n * @module ol/render/canvas/LineStringReplay\n */\nimport CanvasInstruction, {strokeInstruction, beginPathInstruction} from './Instruction.js';\nimport CanvasReplay from './Replay.js';\n\nvar CanvasLineStringReplay = /*@__PURE__*/(function (CanvasReplay) {\n  function CanvasLineStringReplay(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n    CanvasReplay.call(this, tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n  }\n\n  if ( CanvasReplay ) CanvasLineStringReplay.__proto__ = CanvasReplay;\n  CanvasLineStringReplay.prototype = Object.create( CanvasReplay && CanvasReplay.prototype );\n  CanvasLineStringReplay.prototype.constructor = CanvasLineStringReplay;\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} end.\n   */\n  CanvasLineStringReplay.prototype.drawFlatCoordinates_ = function drawFlatCoordinates_ (flatCoordinates, offset, end, stride) {\n    var myBegin = this.coordinates.length;\n    var myEnd = this.appendFlatCoordinates(\n      flatCoordinates, offset, end, stride, false, false);\n    var moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n    this.instructions.push(moveToLineToInstruction);\n    this.hitDetectionInstructions.push(moveToLineToInstruction);\n    return end;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasLineStringReplay.prototype.drawLineString = function drawLineString (lineStringGeometry, feature) {\n    var state = this.state;\n    var strokeStyle = state.strokeStyle;\n    var lineWidth = state.lineWidth;\n    if (strokeStyle === undefined || lineWidth === undefined) {\n      return;\n    }\n    this.updateStrokeStyle(state, this.applyStroke);\n    this.beginGeometry(lineStringGeometry, feature);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ], beginPathInstruction);\n    var flatCoordinates = lineStringGeometry.getFlatCoordinates();\n    var stride = lineStringGeometry.getStride();\n    this.drawFlatCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n    this.hitDetectionInstructions.push(strokeInstruction);\n    this.endGeometry(lineStringGeometry, feature);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasLineStringReplay.prototype.drawMultiLineString = function drawMultiLineString (multiLineStringGeometry, feature) {\n    var state = this.state;\n    var strokeStyle = state.strokeStyle;\n    var lineWidth = state.lineWidth;\n    if (strokeStyle === undefined || lineWidth === undefined) {\n      return;\n    }\n    this.updateStrokeStyle(state, this.applyStroke);\n    this.beginGeometry(multiLineStringGeometry, feature);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ], beginPathInstruction);\n    var ends = multiLineStringGeometry.getEnds();\n    var flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n    var stride = multiLineStringGeometry.getStride();\n    var offset = 0;\n    for (var i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.drawFlatCoordinates_(flatCoordinates, offset, ends[i], stride);\n    }\n    this.hitDetectionInstructions.push(strokeInstruction);\n    this.endGeometry(multiLineStringGeometry, feature);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasLineStringReplay.prototype.finish = function finish () {\n    var state = this.state;\n    if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n      this.instructions.push(strokeInstruction);\n    }\n    this.reverseHitDetectionInstructions();\n    this.state = null;\n  };\n\n  /**\n   * @inheritDoc.\n   */\n  CanvasLineStringReplay.prototype.applyStroke = function applyStroke (state) {\n    if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n      this.instructions.push(strokeInstruction);\n      state.lastStroke = this.coordinates.length;\n    }\n    state.lastStroke = 0;\n    CanvasReplay.prototype.applyStroke.call(this, state);\n    this.instructions.push(beginPathInstruction);\n  };\n\n  return CanvasLineStringReplay;\n}(CanvasReplay));\n\n\nexport default CanvasLineStringReplay;\n\n//# sourceMappingURL=LineStringReplay.js.map","/**\n * @module ol/render/canvas/PolygonReplay\n */\nimport {asString} from '../../color.js';\nimport {snap} from '../../geom/flat/simplify.js';\nimport {defaultFillStyle} from '../canvas.js';\nimport CanvasInstruction, {\n  fillInstruction, strokeInstruction, beginPathInstruction, closePathInstruction\n} from './Instruction.js';\nimport CanvasReplay from './Replay.js';\n\n\nvar CanvasPolygonReplay = /*@__PURE__*/(function (CanvasReplay) {\n  function CanvasPolygonReplay(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n    CanvasReplay.call(this, tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n  }\n\n  if ( CanvasReplay ) CanvasPolygonReplay.__proto__ = CanvasReplay;\n  CanvasPolygonReplay.prototype = Object.create( CanvasReplay && CanvasReplay.prototype );\n  CanvasPolygonReplay.prototype.constructor = CanvasPolygonReplay;\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n  CanvasPolygonReplay.prototype.drawFlatCoordinatess_ = function drawFlatCoordinatess_ (flatCoordinates, offset, ends, stride) {\n    var state = this.state;\n    var fill = state.fillStyle !== undefined;\n    var stroke = state.strokeStyle != undefined;\n    var numEnds = ends.length;\n    this.instructions.push(beginPathInstruction);\n    this.hitDetectionInstructions.push(beginPathInstruction);\n    for (var i = 0; i < numEnds; ++i) {\n      var end = ends[i];\n      var myBegin = this.coordinates.length;\n      var myEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, true, !stroke);\n      var moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n      this.instructions.push(moveToLineToInstruction);\n      this.hitDetectionInstructions.push(moveToLineToInstruction);\n      if (stroke) {\n        // Performance optimization: only call closePath() when we have a stroke.\n        // Otherwise the ring is closed already (see appendFlatCoordinates above).\n        this.instructions.push(closePathInstruction);\n        this.hitDetectionInstructions.push(closePathInstruction);\n      }\n      offset = end;\n    }\n    if (fill) {\n      this.instructions.push(fillInstruction);\n      this.hitDetectionInstructions.push(fillInstruction);\n    }\n    if (stroke) {\n      this.instructions.push(strokeInstruction);\n      this.hitDetectionInstructions.push(strokeInstruction);\n    }\n    return offset;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasPolygonReplay.prototype.drawCircle = function drawCircle (circleGeometry, feature) {\n    var state = this.state;\n    var fillStyle = state.fillStyle;\n    var strokeStyle = state.strokeStyle;\n    if (fillStyle === undefined && strokeStyle === undefined) {\n      return;\n    }\n    this.setFillStrokeStyles_(circleGeometry);\n    this.beginGeometry(circleGeometry, feature);\n    if (state.fillStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_FILL_STYLE,\n        asString(defaultFillStyle)\n      ]);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_STROKE_STYLE,\n        state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n        state.miterLimit, state.lineDash, state.lineDashOffset\n      ]);\n    }\n    var flatCoordinates = circleGeometry.getFlatCoordinates();\n    var stride = circleGeometry.getStride();\n    var myBegin = this.coordinates.length;\n    this.appendFlatCoordinates(\n      flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n    var circleInstruction = [CanvasInstruction.CIRCLE, myBegin];\n    this.instructions.push(beginPathInstruction, circleInstruction);\n    this.hitDetectionInstructions.push(beginPathInstruction, circleInstruction);\n    this.hitDetectionInstructions.push(fillInstruction);\n    if (state.fillStyle !== undefined) {\n      this.instructions.push(fillInstruction);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.instructions.push(strokeInstruction);\n      this.hitDetectionInstructions.push(strokeInstruction);\n    }\n    this.endGeometry(circleGeometry, feature);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasPolygonReplay.prototype.drawPolygon = function drawPolygon (polygonGeometry, feature) {\n    var state = this.state;\n    var fillStyle = state.fillStyle;\n    var strokeStyle = state.strokeStyle;\n    if (fillStyle === undefined && strokeStyle === undefined) {\n      return;\n    }\n    this.setFillStrokeStyles_(polygonGeometry);\n    this.beginGeometry(polygonGeometry, feature);\n    if (state.fillStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_FILL_STYLE,\n        asString(defaultFillStyle)\n      ]);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_STROKE_STYLE,\n        state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n        state.miterLimit, state.lineDash, state.lineDashOffset\n      ]);\n    }\n    var ends = polygonGeometry.getEnds();\n    var flatCoordinates = polygonGeometry.getOrientedFlatCoordinates();\n    var stride = polygonGeometry.getStride();\n    this.drawFlatCoordinatess_(flatCoordinates, 0, ends, stride);\n    this.endGeometry(polygonGeometry, feature);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasPolygonReplay.prototype.drawMultiPolygon = function drawMultiPolygon (multiPolygonGeometry, feature) {\n    var state = this.state;\n    var fillStyle = state.fillStyle;\n    var strokeStyle = state.strokeStyle;\n    if (fillStyle === undefined && strokeStyle === undefined) {\n      return;\n    }\n    this.setFillStrokeStyles_(multiPolygonGeometry);\n    this.beginGeometry(multiPolygonGeometry, feature);\n    if (state.fillStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_FILL_STYLE,\n        asString(defaultFillStyle)\n      ]);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_STROKE_STYLE,\n        state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n        state.miterLimit, state.lineDash, state.lineDashOffset\n      ]);\n    }\n    var endss = multiPolygonGeometry.getEndss();\n    var flatCoordinates = multiPolygonGeometry.getOrientedFlatCoordinates();\n    var stride = multiPolygonGeometry.getStride();\n    var offset = 0;\n    for (var i = 0, ii = endss.length; i < ii; ++i) {\n      offset = this.drawFlatCoordinatess_(flatCoordinates, offset, endss[i], stride);\n    }\n    this.endGeometry(multiPolygonGeometry, feature);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasPolygonReplay.prototype.finish = function finish () {\n    this.reverseHitDetectionInstructions();\n    this.state = null;\n    // We want to preserve topology when drawing polygons.  Polygons are\n    // simplified using quantization and point elimination. However, we might\n    // have received a mix of quantized and non-quantized geometries, so ensure\n    // that all are quantized by quantizing all coordinates in the batch.\n    var tolerance = this.tolerance;\n    if (tolerance !== 0) {\n      var coordinates = this.coordinates;\n      for (var i = 0, ii = coordinates.length; i < ii; ++i) {\n        coordinates[i] = snap(coordinates[i], tolerance);\n      }\n    }\n  };\n\n  /**\n   * @private\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry Geometry.\n   */\n  CanvasPolygonReplay.prototype.setFillStrokeStyles_ = function setFillStrokeStyles_ (geometry) {\n    var state = this.state;\n    var fillStyle = state.fillStyle;\n    if (fillStyle !== undefined) {\n      this.updateFillStyle(state, this.createFill, geometry);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.updateStrokeStyle(state, this.applyStroke);\n    }\n  };\n\n  return CanvasPolygonReplay;\n}(CanvasReplay));\n\n\nexport default CanvasPolygonReplay;\n\n//# sourceMappingURL=PolygonReplay.js.map","/**\n * @module ol/render/canvas/TextReplay\n */\nimport {getUid} from '../../util.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {intersects} from '../../extent.js';\nimport {matchingChunk} from '../../geom/flat/straightchunk.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {labelCache, measureTextWidth, defaultTextAlign, measureTextHeight, defaultPadding, defaultLineCap, defaultLineDashOffset, defaultLineDash, defaultLineJoin, defaultFillStyle, checkFont, defaultFont, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline} from '../canvas.js';\nimport CanvasInstruction from './Instruction.js';\nimport CanvasReplay from './Replay.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport TextPlacement from '../../style/TextPlacement.js';\n\nvar CanvasTextReplay = /*@__PURE__*/(function (CanvasReplay) {\n  function CanvasTextReplay(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n    CanvasReplay.call(this, tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n    /**\n     * @private\n     * @type {import(\"../canvas.js\").DeclutterGroup}\n     */\n    this.declutterGroup_;\n\n    /**\n     * @private\n     * @type {Array<HTMLCanvasElement>}\n     */\n    this.labels_ = null;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.text_ = '';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.textRotateWithView_ = undefined;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textRotation_ = 0;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.textFillState_ = null;\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").FillState>}\n     */\n    this.fillStates = {};\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.textStrokeState_ = null;\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").StrokeState>}\n     */\n    this.strokeStates = {};\n\n    /**\n     * @private\n     * @type {import(\"../canvas.js\").TextState}\n     */\n    this.textState_ = /** @type {import(\"../canvas.js\").TextState} */ ({});\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").TextState>}\n     */\n    this.textStates = {};\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.textKey_ = '';\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.fillKey_ = '';\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.strokeKey_ = '';\n\n    /**\n     * @private\n     * @type {Object<string, Object<string, number>>}\n     */\n    this.widths_ = {};\n\n    labelCache.prune();\n\n  }\n\n  if ( CanvasReplay ) CanvasTextReplay.__proto__ = CanvasReplay;\n  CanvasTextReplay.prototype = Object.create( CanvasReplay && CanvasReplay.prototype );\n  CanvasTextReplay.prototype.constructor = CanvasTextReplay;\n\n  /**\n   * @inheritDoc\n   */\n  CanvasTextReplay.prototype.drawText = function drawText (geometry, feature) {\n    var fillState = this.textFillState_;\n    var strokeState = this.textStrokeState_;\n    var textState = this.textState_;\n    if (this.text_ === '' || !textState || (!fillState && !strokeState)) {\n      return;\n    }\n\n    var begin = this.coordinates.length;\n\n    var geometryType = geometry.getType();\n    var flatCoordinates = null;\n    var end = 2;\n    var stride = 2;\n    var i, ii;\n\n    if (textState.placement === TextPlacement.LINE) {\n      if (!intersects(this.getBufferedMaxExtent(), geometry.getExtent())) {\n        return;\n      }\n      var ends;\n      flatCoordinates = geometry.getFlatCoordinates();\n      stride = geometry.getStride();\n      if (geometryType == GeometryType.LINE_STRING) {\n        ends = [flatCoordinates.length];\n      } else if (geometryType == GeometryType.MULTI_LINE_STRING) {\n        ends = geometry.getEnds();\n      } else if (geometryType == GeometryType.POLYGON) {\n        ends = geometry.getEnds().slice(0, 1);\n      } else if (geometryType == GeometryType.MULTI_POLYGON) {\n        var endss = geometry.getEndss();\n        ends = [];\n        for (i = 0, ii = endss.length; i < ii; ++i) {\n          ends.push(endss[i][0]);\n        }\n      }\n      this.beginGeometry(geometry, feature);\n      var textAlign = textState.textAlign;\n      var flatOffset = 0;\n      var flatEnd;\n      for (var o = 0, oo = ends.length; o < oo; ++o) {\n        if (textAlign == undefined) {\n          var range = matchingChunk(textState.maxAngle, flatCoordinates, flatOffset, ends[o], stride);\n          flatOffset = range[0];\n          flatEnd = range[1];\n        } else {\n          flatEnd = ends[o];\n        }\n        for (i = flatOffset; i < flatEnd; i += stride) {\n          this.coordinates.push(flatCoordinates[i], flatCoordinates[i + 1]);\n        }\n        end = this.coordinates.length;\n        flatOffset = ends[o];\n        this.drawChars_(begin, end, this.declutterGroup_);\n        begin = end;\n      }\n      this.endGeometry(geometry, feature);\n\n    } else {\n      var label = this.getImage(this.text_, this.textKey_, this.fillKey_, this.strokeKey_);\n      var width = label.width / this.pixelRatio;\n      switch (geometryType) {\n        case GeometryType.POINT:\n        case GeometryType.MULTI_POINT:\n          flatCoordinates = geometry.getFlatCoordinates();\n          end = flatCoordinates.length;\n          break;\n        case GeometryType.LINE_STRING:\n          flatCoordinates = /** @type {import(\"../../geom/LineString.js\").default} */ (geometry).getFlatMidpoint();\n          break;\n        case GeometryType.CIRCLE:\n          flatCoordinates = /** @type {import(\"../../geom/Circle.js\").default} */ (geometry).getCenter();\n          break;\n        case GeometryType.MULTI_LINE_STRING:\n          flatCoordinates = /** @type {import(\"../../geom/MultiLineString.js\").default} */ (geometry).getFlatMidpoints();\n          end = flatCoordinates.length;\n          break;\n        case GeometryType.POLYGON:\n          flatCoordinates = /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry).getFlatInteriorPoint();\n          if (!textState.overflow && flatCoordinates[2] / this.resolution < width) {\n            return;\n          }\n          stride = 3;\n          break;\n        case GeometryType.MULTI_POLYGON:\n          var interiorPoints = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry).getFlatInteriorPoints();\n          flatCoordinates = [];\n          for (i = 0, ii = interiorPoints.length; i < ii; i += 3) {\n            if (textState.overflow || interiorPoints[i + 2] / this.resolution >= width) {\n              flatCoordinates.push(interiorPoints[i], interiorPoints[i + 1]);\n            }\n          }\n          end = flatCoordinates.length;\n          if (end == 0) {\n            return;\n          }\n          break;\n        default:\n      }\n      end = this.appendFlatCoordinates(flatCoordinates, 0, end, stride, false, false);\n      if (textState.backgroundFill || textState.backgroundStroke) {\n        this.setFillStrokeStyle(textState.backgroundFill, textState.backgroundStroke);\n        if (textState.backgroundFill) {\n          this.updateFillStyle(this.state, this.createFill, geometry);\n          this.hitDetectionInstructions.push(this.createFill(this.state, geometry));\n        }\n        if (textState.backgroundStroke) {\n          this.updateStrokeStyle(this.state, this.applyStroke);\n          this.hitDetectionInstructions.push(this.createStroke(this.state));\n        }\n      }\n      this.beginGeometry(geometry, feature);\n      this.drawTextImage_(label, begin, end);\n      this.endGeometry(geometry, feature);\n    }\n  };\n\n  /**\n   * @param {string} text Text.\n   * @param {string} textKey Text style key.\n   * @param {string} fillKey Fill style key.\n   * @param {string} strokeKey Stroke style key.\n   * @return {HTMLCanvasElement} Image.\n   */\n  CanvasTextReplay.prototype.getImage = function getImage (text, textKey, fillKey, strokeKey) {\n    var label;\n    var key = strokeKey + textKey + text + fillKey + this.pixelRatio;\n\n    if (!labelCache.containsKey(key)) {\n      var strokeState = strokeKey ? this.strokeStates[strokeKey] || this.textStrokeState_ : null;\n      var fillState = fillKey ? this.fillStates[fillKey] || this.textFillState_ : null;\n      var textState = this.textStates[textKey] || this.textState_;\n      var pixelRatio = this.pixelRatio;\n      var scale = textState.scale * pixelRatio;\n      var align = TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n      var strokeWidth = strokeKey && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n      var lines = text.split('\\n');\n      var numLines = lines.length;\n      var widths = [];\n      var width = measureTextWidths(textState.font, lines, widths);\n      var lineHeight = measureTextHeight(textState.font);\n      var height = lineHeight * numLines;\n      var renderWidth = (width + strokeWidth);\n      var context = createCanvasContext2D(\n        Math.ceil(renderWidth * scale),\n        Math.ceil((height + strokeWidth) * scale));\n      label = context.canvas;\n      labelCache.set(key, label);\n      if (scale != 1) {\n        context.scale(scale, scale);\n      }\n      context.font = textState.font;\n      if (strokeKey) {\n        context.strokeStyle = strokeState.strokeStyle;\n        context.lineWidth = strokeWidth;\n        context.lineCap = /** @type {CanvasLineCap} */ (strokeState.lineCap);\n        context.lineJoin = /** @type {CanvasLineJoin} */ (strokeState.lineJoin);\n        context.miterLimit = strokeState.miterLimit;\n        if (CANVAS_LINE_DASH && strokeState.lineDash.length) {\n          context.setLineDash(strokeState.lineDash);\n          context.lineDashOffset = strokeState.lineDashOffset;\n        }\n      }\n      if (fillKey) {\n        context.fillStyle = fillState.fillStyle;\n      }\n      context.textBaseline = 'middle';\n      context.textAlign = 'center';\n      var leftRight = (0.5 - align);\n      var x = align * label.width / scale + leftRight * strokeWidth;\n      var i;\n      if (strokeKey) {\n        for (i = 0; i < numLines; ++i) {\n          context.strokeText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n        }\n      }\n      if (fillKey) {\n        for (i = 0; i < numLines; ++i) {\n          context.fillText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n        }\n      }\n    }\n    return labelCache.get(key);\n  };\n\n  /**\n   * @private\n   * @param {HTMLCanvasElement} label Label.\n   * @param {number} begin Begin.\n   * @param {number} end End.\n   */\n  CanvasTextReplay.prototype.drawTextImage_ = function drawTextImage_ (label, begin, end) {\n    var textState = this.textState_;\n    var strokeState = this.textStrokeState_;\n    var pixelRatio = this.pixelRatio;\n    var align = TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n    var baseline = TEXT_ALIGN[textState.textBaseline];\n    var strokeWidth = strokeState && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n    var anchorX = align * label.width / pixelRatio + 2 * (0.5 - align) * strokeWidth;\n    var anchorY = baseline * label.height / pixelRatio + 2 * (0.5 - baseline) * strokeWidth;\n    this.instructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n      label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n      this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n      1, label.width,\n      textState.padding == defaultPadding ?\n        defaultPadding : textState.padding.map(function(p) {\n          return p * pixelRatio;\n        }),\n      !!textState.backgroundFill, !!textState.backgroundStroke\n    ]);\n    this.hitDetectionInstructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n      label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n      this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n      1 / pixelRatio, label.width, textState.padding,\n      !!textState.backgroundFill, !!textState.backgroundStroke\n    ]);\n  };\n\n  /**\n   * @private\n   * @param {number} begin Begin.\n   * @param {number} end End.\n   * @param {import(\"../canvas.js\").DeclutterGroup} declutterGroup Declutter group.\n   */\n  CanvasTextReplay.prototype.drawChars_ = function drawChars_ (begin, end, declutterGroup) {\n    var strokeState = this.textStrokeState_;\n    var textState = this.textState_;\n    var fillState = this.textFillState_;\n\n    var strokeKey = this.strokeKey_;\n    if (strokeState) {\n      if (!(strokeKey in this.strokeStates)) {\n        this.strokeStates[strokeKey] = /** @type {import(\"../canvas.js\").StrokeState} */ ({\n          strokeStyle: strokeState.strokeStyle,\n          lineCap: strokeState.lineCap,\n          lineDashOffset: strokeState.lineDashOffset,\n          lineWidth: strokeState.lineWidth,\n          lineJoin: strokeState.lineJoin,\n          miterLimit: strokeState.miterLimit,\n          lineDash: strokeState.lineDash\n        });\n      }\n    }\n    var textKey = this.textKey_;\n    if (!(this.textKey_ in this.textStates)) {\n      this.textStates[this.textKey_] = /** @type {import(\"../canvas.js\").TextState} */ ({\n        font: textState.font,\n        textAlign: textState.textAlign || defaultTextAlign,\n        scale: textState.scale\n      });\n    }\n    var fillKey = this.fillKey_;\n    if (fillState) {\n      if (!(fillKey in this.fillStates)) {\n        this.fillStates[fillKey] = /** @type {import(\"../canvas.js\").FillState} */ ({\n          fillStyle: fillState.fillStyle\n        });\n      }\n    }\n\n    var pixelRatio = this.pixelRatio;\n    var baseline = TEXT_ALIGN[textState.textBaseline];\n\n    var offsetY = this.textOffsetY_ * pixelRatio;\n    var text = this.text_;\n    var font = textState.font;\n    var textScale = textState.scale;\n    var strokeWidth = strokeState ? strokeState.lineWidth * textScale / 2 : 0;\n    var widths = this.widths_[font];\n    if (!widths) {\n      this.widths_[font] = widths = {};\n    }\n    this.instructions.push([CanvasInstruction.DRAW_CHARS,\n      begin, end, baseline, declutterGroup,\n      textState.overflow, fillKey, textState.maxAngle,\n      function(text) {\n        var width = widths[text];\n        if (!width) {\n          width = widths[text] = measureTextWidth(font, text);\n        }\n        return width * textScale * pixelRatio;\n      },\n      offsetY, strokeKey, strokeWidth * pixelRatio, text, textKey, 1\n    ]);\n    this.hitDetectionInstructions.push([CanvasInstruction.DRAW_CHARS,\n      begin, end, baseline, declutterGroup,\n      textState.overflow, fillKey, textState.maxAngle,\n      function(text) {\n        var width = widths[text];\n        if (!width) {\n          width = widths[text] = measureTextWidth(font, text);\n        }\n        return width * textScale;\n      },\n      offsetY, strokeKey, strokeWidth, text, textKey, 1 / pixelRatio\n    ]);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasTextReplay.prototype.setTextStyle = function setTextStyle (textStyle, declutterGroup) {\n    var textState, fillState, strokeState;\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      this.declutterGroup_ = /** @type {import(\"../canvas.js\").DeclutterGroup} */ (declutterGroup);\n\n      var textFillStyle = textStyle.getFill();\n      if (!textFillStyle) {\n        fillState = this.textFillState_ = null;\n      } else {\n        fillState = this.textFillState_;\n        if (!fillState) {\n          fillState = this.textFillState_ = /** @type {import(\"../canvas.js\").FillState} */ ({});\n        }\n        fillState.fillStyle = asColorLike(\n          textFillStyle.getColor() || defaultFillStyle);\n      }\n\n      var textStrokeStyle = textStyle.getStroke();\n      if (!textStrokeStyle) {\n        strokeState = this.textStrokeState_ = null;\n      } else {\n        strokeState = this.textStrokeState_;\n        if (!strokeState) {\n          strokeState = this.textStrokeState_ = /** @type {import(\"../canvas.js\").StrokeState} */ ({});\n        }\n        var lineDash = textStrokeStyle.getLineDash();\n        var lineDashOffset = textStrokeStyle.getLineDashOffset();\n        var lineWidth = textStrokeStyle.getWidth();\n        var miterLimit = textStrokeStyle.getMiterLimit();\n        strokeState.lineCap = textStrokeStyle.getLineCap() || defaultLineCap;\n        strokeState.lineDash = lineDash ? lineDash.slice() : defaultLineDash;\n        strokeState.lineDashOffset =\n            lineDashOffset === undefined ? defaultLineDashOffset : lineDashOffset;\n        strokeState.lineJoin = textStrokeStyle.getLineJoin() || defaultLineJoin;\n        strokeState.lineWidth =\n            lineWidth === undefined ? defaultLineWidth : lineWidth;\n        strokeState.miterLimit =\n            miterLimit === undefined ? defaultMiterLimit : miterLimit;\n        strokeState.strokeStyle = asColorLike(\n          textStrokeStyle.getColor() || defaultStrokeStyle);\n      }\n\n      textState = this.textState_;\n      var font = textStyle.getFont() || defaultFont;\n      checkFont(font);\n      var textScale = textStyle.getScale();\n      textState.overflow = textStyle.getOverflow();\n      textState.font = font;\n      textState.maxAngle = textStyle.getMaxAngle();\n      textState.placement = textStyle.getPlacement();\n      textState.textAlign = textStyle.getTextAlign();\n      textState.textBaseline = textStyle.getTextBaseline() || defaultTextBaseline;\n      textState.backgroundFill = textStyle.getBackgroundFill();\n      textState.backgroundStroke = textStyle.getBackgroundStroke();\n      textState.padding = textStyle.getPadding() || defaultPadding;\n      textState.scale = textScale === undefined ? 1 : textScale;\n\n      var textOffsetX = textStyle.getOffsetX();\n      var textOffsetY = textStyle.getOffsetY();\n      var textRotateWithView = textStyle.getRotateWithView();\n      var textRotation = textStyle.getRotation();\n      this.text_ = textStyle.getText() || '';\n      this.textOffsetX_ = textOffsetX === undefined ? 0 : textOffsetX;\n      this.textOffsetY_ = textOffsetY === undefined ? 0 : textOffsetY;\n      this.textRotateWithView_ = textRotateWithView === undefined ? false : textRotateWithView;\n      this.textRotation_ = textRotation === undefined ? 0 : textRotation;\n\n      this.strokeKey_ = strokeState ?\n        (typeof strokeState.strokeStyle == 'string' ? strokeState.strokeStyle : getUid(strokeState.strokeStyle)) +\n        strokeState.lineCap + strokeState.lineDashOffset + '|' + strokeState.lineWidth +\n        strokeState.lineJoin + strokeState.miterLimit + '[' + strokeState.lineDash.join() + ']' :\n        '';\n      this.textKey_ = textState.font + textState.scale + (textState.textAlign || '?');\n      this.fillKey_ = fillState ?\n        (typeof fillState.fillStyle == 'string' ? fillState.fillStyle : ('|' + getUid(fillState.fillStyle))) :\n        '';\n    }\n  };\n\n  return CanvasTextReplay;\n}(CanvasReplay));\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @param {Array<string>} lines Lines to measure.\n * @param {Array<number>} widths Array will be populated with the widths of\n * each line.\n * @return {number} Width of the whole text.\n */\nexport function measureTextWidths(font, lines, widths) {\n  var numLines = lines.length;\n  var width = 0;\n  for (var i = 0; i < numLines; ++i) {\n    var currentWidth = measureTextWidth(font, lines[i]);\n    width = Math.max(width, currentWidth);\n    widths.push(currentWidth);\n  }\n  return width;\n}\n\n\nexport default CanvasTextReplay;\n\n//# sourceMappingURL=TextReplay.js.map","/**\n * @module ol/render/canvas/ReplayGroup\n */\n\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {buffer, createEmpty, extendCoordinate} from '../../extent.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {isEmpty} from '../../obj.js';\nimport ReplayGroup from '../ReplayGroup.js';\nimport ReplayType from '../ReplayType.js';\nimport CanvasReplay from './Replay.js';\nimport CanvasImageReplay from './ImageReplay.js';\nimport CanvasLineStringReplay from './LineStringReplay.js';\nimport CanvasPolygonReplay from './PolygonReplay.js';\nimport CanvasTextReplay from './TextReplay.js';\nimport {ORDER} from '../replay.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n\n/**\n * @type {Object<ReplayType, typeof CanvasReplay>}\n */\nvar BATCH_CONSTRUCTORS = {\n  'Circle': CanvasPolygonReplay,\n  'Default': CanvasReplay,\n  'Image': CanvasImageReplay,\n  'LineString': CanvasLineStringReplay,\n  'Polygon': CanvasPolygonReplay,\n  'Text': CanvasTextReplay\n};\n\n\nvar CanvasReplayGroup = /*@__PURE__*/(function (ReplayGroup) {\n  function CanvasReplayGroup(\n    tolerance,\n    maxExtent,\n    resolution,\n    pixelRatio,\n    overlaps,\n    declutterTree,\n    opt_renderBuffer\n  ) {\n    ReplayGroup.call(this);\n\n    /**\n     * Declutter tree.\n     * @private\n     */\n    this.declutterTree_ = declutterTree;\n\n    /**\n     * @type {import(\"../canvas.js\").DeclutterGroup}\n     * @private\n     */\n    this.declutterGroup_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tolerance_ = tolerance;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.maxExtent_ = maxExtent;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.overlaps_ = overlaps;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.resolution_ = resolution;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.renderBuffer_ = opt_renderBuffer;\n\n    /**\n     * @private\n     * @type {!Object<string, !Object<ReplayType, CanvasReplay>>}\n     */\n    this.replaysByZIndex_ = {};\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.hitDetectionContext_ = createCanvasContext2D(1, 1);\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.hitDetectionTransform_ = createTransform();\n  }\n\n  if ( ReplayGroup ) CanvasReplayGroup.__proto__ = ReplayGroup;\n  CanvasReplayGroup.prototype = Object.create( ReplayGroup && ReplayGroup.prototype );\n  CanvasReplayGroup.prototype.constructor = CanvasReplayGroup;\n\n  /**\n   * @inheritDoc\n   */\n  CanvasReplayGroup.prototype.addDeclutter = function addDeclutter (group) {\n    var declutter = null;\n    if (this.declutterTree_) {\n      if (group) {\n        declutter = this.declutterGroup_;\n        /** @type {number} */ (declutter[4])++;\n      } else {\n        declutter = this.declutterGroup_ = createEmpty();\n        declutter.push(1);\n      }\n    }\n    return declutter;\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   */\n  CanvasReplayGroup.prototype.clip = function clip (context, transform) {\n    var flatClipCoords = this.getClipCoords(transform);\n    context.beginPath();\n    context.moveTo(flatClipCoords[0], flatClipCoords[1]);\n    context.lineTo(flatClipCoords[2], flatClipCoords[3]);\n    context.lineTo(flatClipCoords[4], flatClipCoords[5]);\n    context.lineTo(flatClipCoords[6], flatClipCoords[7]);\n    context.clip();\n  };\n\n  /**\n   * @param {Array<ReplayType>} replays Replays.\n   * @return {boolean} Has replays of the provided types.\n   */\n  CanvasReplayGroup.prototype.hasReplays = function hasReplays (replays) {\n    for (var zIndex in this.replaysByZIndex_) {\n      var candidates = this.replaysByZIndex_[zIndex];\n      for (var i = 0, ii = replays.length; i < ii; ++i) {\n        if (replays[i] in candidates) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  CanvasReplayGroup.prototype.finish = function finish () {\n    for (var zKey in this.replaysByZIndex_) {\n      var replays = this.replaysByZIndex_[zKey];\n      for (var replayKey in replays) {\n        replays[replayKey].finish();\n      }\n    }\n  };\n\n  /**\n   * @param {import(\"../../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {number} resolution Resolution.\n   * @param {number} rotation Rotation.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features to skip.\n   * @param {function((import(\"../../Feature.js\").default|import(\"../Feature.js\").default)): T} callback Feature callback.\n   * @param {Object<string, import(\"../canvas.js\").DeclutterGroup>} declutterReplays Declutter replays.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  CanvasReplayGroup.prototype.forEachFeatureAtCoordinate = function forEachFeatureAtCoordinate (\n    coordinate,\n    resolution,\n    rotation,\n    hitTolerance,\n    skippedFeaturesHash,\n    callback,\n    declutterReplays\n  ) {\n\n    hitTolerance = Math.round(hitTolerance);\n    var contextSize = hitTolerance * 2 + 1;\n    var transform = composeTransform(this.hitDetectionTransform_,\n      hitTolerance + 0.5, hitTolerance + 0.5,\n      1 / resolution, -1 / resolution,\n      -rotation,\n      -coordinate[0], -coordinate[1]);\n    var context = this.hitDetectionContext_;\n\n    if (context.canvas.width !== contextSize || context.canvas.height !== contextSize) {\n      context.canvas.width = contextSize;\n      context.canvas.height = contextSize;\n    } else {\n      context.clearRect(0, 0, contextSize, contextSize);\n    }\n\n    /**\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    var hitExtent;\n    if (this.renderBuffer_ !== undefined) {\n      hitExtent = createEmpty();\n      extendCoordinate(hitExtent, coordinate);\n      buffer(hitExtent, resolution * (this.renderBuffer_ + hitTolerance), hitExtent);\n    }\n\n    var mask = getCircleArray(hitTolerance);\n    var declutteredFeatures;\n    if (this.declutterTree_) {\n      declutteredFeatures = this.declutterTree_.all().map(function(entry) {\n        return entry.value;\n      });\n    }\n\n    var replayType;\n\n    /**\n     * @param {import(\"../../Feature.js\").default|import(\"../Feature.js\").default} feature Feature.\n     * @return {?} Callback result.\n     */\n    function featureCallback(feature) {\n      var imageData = context.getImageData(0, 0, contextSize, contextSize).data;\n      for (var i = 0; i < contextSize; i++) {\n        for (var j = 0; j < contextSize; j++) {\n          if (mask[i][j]) {\n            if (imageData[(j * contextSize + i) * 4 + 3] > 0) {\n              var result = (void 0);\n              if (!(declutteredFeatures && (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) ||\n                  declutteredFeatures.indexOf(feature) !== -1) {\n                result = callback(feature);\n              }\n              if (result) {\n                return result;\n              } else {\n                context.clearRect(0, 0, contextSize, contextSize);\n                return undefined;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    /** @type {Array<number>} */\n    var zs = Object.keys(this.replaysByZIndex_).map(Number);\n    zs.sort(numberSafeCompareFunction);\n\n    var i, j, replays, replay, result;\n    for (i = zs.length - 1; i >= 0; --i) {\n      var zIndexKey = zs[i].toString();\n      replays = this.replaysByZIndex_[zIndexKey];\n      for (j = ORDER.length - 1; j >= 0; --j) {\n        replayType = ORDER[j];\n        replay = replays[replayType];\n        if (replay !== undefined) {\n          if (declutterReplays &&\n              (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n            var declutter = declutterReplays[zIndexKey];\n            if (!declutter) {\n              declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n            } else {\n              declutter.push(replay, transform.slice(0));\n            }\n          } else {\n            result = replay.replayHitDetection(context, transform, rotation,\n              skippedFeaturesHash, featureCallback, hitExtent);\n            if (result) {\n              return result;\n            }\n          }\n        }\n      }\n    }\n    return undefined;\n  };\n\n  /**\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @return {Array<number>} Clip coordinates.\n   */\n  CanvasReplayGroup.prototype.getClipCoords = function getClipCoords (transform) {\n    var maxExtent = this.maxExtent_;\n    var minX = maxExtent[0];\n    var minY = maxExtent[1];\n    var maxX = maxExtent[2];\n    var maxY = maxExtent[3];\n    var flatClipCoords = [minX, minY, minX, maxY, maxX, maxY, maxX, minY];\n    transform2D(\n      flatClipCoords, 0, 8, 2, transform, flatClipCoords);\n    return flatClipCoords;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasReplayGroup.prototype.getReplay = function getReplay (zIndex, replayType) {\n    var zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n    var replays = this.replaysByZIndex_[zIndexKey];\n    if (replays === undefined) {\n      replays = {};\n      this.replaysByZIndex_[zIndexKey] = replays;\n    }\n    var replay = replays[replayType];\n    if (replay === undefined) {\n      var Constructor = BATCH_CONSTRUCTORS[replayType];\n      replay = new Constructor(this.tolerance_, this.maxExtent_,\n        this.resolution_, this.pixelRatio_, this.overlaps_, this.declutterTree_);\n      replays[replayType] = replay;\n    }\n    return replay;\n  };\n\n  /**\n   * @return {Object<string, Object<ReplayType, CanvasReplay>>} Replays.\n   */\n  CanvasReplayGroup.prototype.getReplays = function getReplays () {\n    return this.replaysByZIndex_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasReplayGroup.prototype.isEmpty = function isEmpty$1 () {\n    return isEmpty(this.replaysByZIndex_);\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {Object<string, boolean>} skippedFeaturesHash Ids of features to skip.\n   * @param {boolean} snapToPixel Snap point symbols and test to integer pixel.\n   * @param {Array<ReplayType>=} opt_replayTypes Ordered replay types to replay.\n   *     Default is {@link module:ol/render/replay~ORDER}\n   * @param {Object<string, import(\"../canvas.js\").DeclutterGroup>=} opt_declutterReplays Declutter replays.\n   */\n  CanvasReplayGroup.prototype.replay = function replay (\n    context,\n    transform,\n    viewRotation,\n    skippedFeaturesHash,\n    snapToPixel,\n    opt_replayTypes,\n    opt_declutterReplays\n  ) {\n\n    /** @type {Array<number>} */\n    var zs = Object.keys(this.replaysByZIndex_).map(Number);\n    zs.sort(numberSafeCompareFunction);\n\n    // setup clipping so that the parts of over-simplified geometries are not\n    // visible outside the current extent when panning\n    context.save();\n    this.clip(context, transform);\n\n    var replayTypes = opt_replayTypes ? opt_replayTypes : ORDER;\n    var i, ii, j, jj, replays, replay;\n    for (i = 0, ii = zs.length; i < ii; ++i) {\n      var zIndexKey = zs[i].toString();\n      replays = this.replaysByZIndex_[zIndexKey];\n      for (j = 0, jj = replayTypes.length; j < jj; ++j) {\n        var replayType = replayTypes[j];\n        replay = replays[replayType];\n        if (replay !== undefined) {\n          if (opt_declutterReplays &&\n              (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n            var declutter = opt_declutterReplays[zIndexKey];\n            if (!declutter) {\n              opt_declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n            } else {\n              declutter.push(replay, transform.slice(0));\n            }\n          } else {\n            replay.replay(context, transform, viewRotation, skippedFeaturesHash, snapToPixel);\n          }\n        }\n      }\n    }\n\n    context.restore();\n  };\n\n  return CanvasReplayGroup;\n}(ReplayGroup));\n\n\n/**\n * This cache is used for storing calculated pixel circles for increasing performance.\n * It is a static property to allow each Replaygroup to access it.\n * @type {Object<number, Array<Array<(boolean|undefined)>>>}\n */\nvar circleArrayCache = {\n  0: [[true]]\n};\n\n\n/**\n * This method fills a row in the array from the given coordinate to the\n * middle with `true`.\n * @param {Array<Array<(boolean|undefined)>>} array The array that will be altered.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n */\nfunction fillCircleArrayRowToMiddle(array, x, y) {\n  var i;\n  var radius = Math.floor(array.length / 2);\n  if (x >= radius) {\n    for (i = radius; i < x; i++) {\n      array[i][y] = true;\n    }\n  } else if (x < radius) {\n    for (i = x + 1; i < radius; i++) {\n      array[i][y] = true;\n    }\n  }\n}\n\n\n/**\n * This methods creates a circle inside a fitting array. Points inside the\n * circle are marked by true, points on the outside are undefined.\n * It uses the midpoint circle algorithm.\n * A cache is used to increase performance.\n * @param {number} radius Radius.\n * @returns {Array<Array<(boolean|undefined)>>} An array with marked circle points.\n */\nexport function getCircleArray(radius) {\n  if (circleArrayCache[radius] !== undefined) {\n    return circleArrayCache[radius];\n  }\n\n  var arraySize = radius * 2 + 1;\n  var arr = new Array(arraySize);\n  for (var i = 0; i < arraySize; i++) {\n    arr[i] = new Array(arraySize);\n  }\n\n  var x = radius;\n  var y = 0;\n  var error = 0;\n\n  while (x >= y) {\n    fillCircleArrayRowToMiddle(arr, radius + x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius - y);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + x, radius - y);\n\n    y++;\n    error += 1 + 2 * y;\n    if (2 * (error - x) + 1 > 0) {\n      x -= 1;\n      error += 1 - 2 * x;\n    }\n  }\n\n  circleArrayCache[radius] = arr;\n  return arr;\n}\n\n\n/**\n * @param {!Object<string, Array<*>>} declutterReplays Declutter replays.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n * @param {boolean} snapToPixel Snap point symbols and text to integer pixels.\n */\nexport function replayDeclutter(declutterReplays, context, rotation, snapToPixel) {\n  var zs = Object.keys(declutterReplays).map(Number).sort(numberSafeCompareFunction);\n  var skippedFeatureUids = {};\n  for (var z = 0, zz = zs.length; z < zz; ++z) {\n    var replayData = declutterReplays[zs[z].toString()];\n    for (var i = 0, ii = replayData.length; i < ii;) {\n      var replay = replayData[i++];\n      var transform = replayData[i++];\n      replay.replay(context, transform, rotation, skippedFeatureUids, snapToPixel);\n    }\n  }\n}\n\n\nexport default CanvasReplayGroup;\n\n//# sourceMappingURL=ReplayGroup.js.map","/**\n * @module ol/proj/Projection\n */\nimport {METERS_PER_UNIT} from './Units.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} code The SRS identifier code, e.g. `EPSG:4326`.\n * @property {import(\"./Units.js\").default|string} [units] Units. Required unless a\n * proj4 projection is defined for `code`.\n * @property {import(\"../extent.js\").Extent} [extent] The validity extent for the SRS.\n * @property {string} [axisOrientation='enu'] The axis orientation as specified in Proj4.\n * @property {boolean} [global=false] Whether the projection is valid for the whole globe.\n * @property {number} [metersPerUnit] The meters per unit for the SRS.\n * If not provided, the `units` are used to get the meters per unit from the {@link module:ol/proj/Units~METERS_PER_UNIT}\n * lookup table.\n * @property {import(\"../extent.js\").Extent} [worldExtent] The world extent for the SRS.\n * @property {function(number, import(\"../coordinate.js\").Coordinate):number} [getPointResolution]\n * Function to determine resolution at a point. The function is called with a\n * `{number}` view resolution and an `{import(\"../coordinate.js\").Coordinate}` as arguments, and returns\n * the `{number}` resolution at the passed coordinate. If this is `undefined`,\n * the default {@link module:ol/proj#getPointResolution} function will be used.\n */\n\n\n/**\n * @classdesc\n * Projection definition class. One of these is created for each projection\n * supported in the application and stored in the {@link module:ol/proj} namespace.\n * You can use these in applications, but this is not required, as API params\n * and options use {@link module:ol/proj~ProjectionLike} which means the simple string\n * code will suffice.\n *\n * You can use {@link module:ol/proj~get} to retrieve the object for a particular\n * projection.\n *\n * The library includes definitions for `EPSG:4326` and `EPSG:3857`, together\n * with the following aliases:\n * * `EPSG:4326`: CRS:84, urn:ogc:def:crs:EPSG:6.6:4326,\n *     urn:ogc:def:crs:OGC:1.3:CRS84, urn:ogc:def:crs:OGC:2:84,\n *     http://www.opengis.net/gml/srs/epsg.xml#4326,\n *     urn:x-ogc:def:crs:EPSG:4326\n * * `EPSG:3857`: EPSG:102100, EPSG:102113, EPSG:900913,\n *     urn:ogc:def:crs:EPSG:6.18:3:3857,\n *     http://www.opengis.net/gml/srs/epsg.xml#3857\n *\n * If you use [proj4js](https://github.com/proj4js/proj4js), aliases can\n * be added using `proj4.defs()`. After all required projection definitions are\n * added, call the {@link module:ol/proj/proj4~register} function.\n *\n * @api\n */\nvar Projection = function Projection(options) {\n  /**\n   * @private\n   * @type {string}\n   */\n  this.code_ = options.code;\n\n  /**\n   * Units of projected coordinates. When set to `TILE_PIXELS`, a\n   * `this.extent_` and `this.worldExtent_` must be configured properly for each\n   * tile.\n   * @private\n   * @type {import(\"./Units.js\").default}\n   */\n  this.units_ = /** @type {import(\"./Units.js\").default} */ (options.units);\n\n  /**\n   * Validity extent of the projection in projected coordinates. For projections\n   * with `TILE_PIXELS` units, this is the extent of the tile in\n   * tile pixel space.\n   * @private\n   * @type {import(\"../extent.js\").Extent}\n   */\n  this.extent_ = options.extent !== undefined ? options.extent : null;\n\n  /**\n   * Extent of the world in EPSG:4326. For projections with\n   * `TILE_PIXELS` units, this is the extent of the tile in\n   * projected coordinate space.\n   * @private\n   * @type {import(\"../extent.js\").Extent}\n   */\n  this.worldExtent_ = options.worldExtent !== undefined ?\n    options.worldExtent : null;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.axisOrientation_ = options.axisOrientation !== undefined ?\n    options.axisOrientation : 'enu';\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.global_ = options.global !== undefined ? options.global : false;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.canWrapX_ = !!(this.global_ && this.extent_);\n\n  /**\n   * @private\n   * @type {function(number, import(\"../coordinate.js\").Coordinate):number|undefined}\n   */\n  this.getPointResolutionFunc_ = options.getPointResolution;\n\n  /**\n   * @private\n   * @type {import(\"../tilegrid/TileGrid.js\").default}\n   */\n  this.defaultTileGrid_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.metersPerUnit_ = options.metersPerUnit;\n};\n\n/**\n * @return {boolean} The projection is suitable for wrapping the x-axis\n */\nProjection.prototype.canWrapX = function canWrapX () {\n  return this.canWrapX_;\n};\n\n/**\n * Get the code for this projection, e.g. 'EPSG:4326'.\n * @return {string} Code.\n * @api\n */\nProjection.prototype.getCode = function getCode () {\n  return this.code_;\n};\n\n/**\n * Get the validity extent for this projection.\n * @return {import(\"../extent.js\").Extent} Extent.\n * @api\n */\nProjection.prototype.getExtent = function getExtent () {\n  return this.extent_;\n};\n\n/**\n * Get the units of this projection.\n * @return {import(\"./Units.js\").default} Units.\n * @api\n */\nProjection.prototype.getUnits = function getUnits () {\n  return this.units_;\n};\n\n/**\n * Get the amount of meters per unit of this projection.If the projection is\n * not configured with `metersPerUnit` or a units identifier, the return is\n * `undefined`.\n * @return {number|undefined} Meters.\n * @api\n */\nProjection.prototype.getMetersPerUnit = function getMetersPerUnit () {\n  return this.metersPerUnit_ || METERS_PER_UNIT[this.units_];\n};\n\n/**\n * Get the world extent for this projection.\n * @return {import(\"../extent.js\").Extent} Extent.\n * @api\n */\nProjection.prototype.getWorldExtent = function getWorldExtent () {\n  return this.worldExtent_;\n};\n\n/**\n * Get the axis orientation of this projection.\n * Example values are:\n * enu - the default easting, northing, elevation.\n * neu - northing, easting, up - useful for \"lat/long\" geographic coordinates,\n *   or south orientated transverse mercator.\n * wnu - westing, northing, up - some planetary coordinate systems have\n *   \"west positive\" coordinate systems\n * @return {string} Axis orientation.\n * @api\n */\nProjection.prototype.getAxisOrientation = function getAxisOrientation () {\n  return this.axisOrientation_;\n};\n\n/**\n * Is this projection a global projection which spans the whole world?\n * @return {boolean} Whether the projection is global.\n * @api\n */\nProjection.prototype.isGlobal = function isGlobal () {\n  return this.global_;\n};\n\n/**\n * Set if the projection is a global projection which spans the whole world\n * @param {boolean} global Whether the projection is global.\n * @api\n */\nProjection.prototype.setGlobal = function setGlobal (global) {\n  this.global_ = global;\n  this.canWrapX_ = !!(global && this.extent_);\n};\n\n/**\n * @return {import(\"../tilegrid/TileGrid.js\").default} The default tile grid.\n */\nProjection.prototype.getDefaultTileGrid = function getDefaultTileGrid () {\n  return this.defaultTileGrid_;\n};\n\n/**\n * @param {import(\"../tilegrid/TileGrid.js\").default} tileGrid The default tile grid.\n */\nProjection.prototype.setDefaultTileGrid = function setDefaultTileGrid (tileGrid) {\n  this.defaultTileGrid_ = tileGrid;\n};\n\n/**\n * Set the validity extent for this projection.\n * @param {import(\"../extent.js\").Extent} extent Extent.\n * @api\n */\nProjection.prototype.setExtent = function setExtent (extent) {\n  this.extent_ = extent;\n  this.canWrapX_ = !!(this.global_ && extent);\n};\n\n/**\n * Set the world extent for this projection.\n * @param {import(\"../extent.js\").Extent} worldExtent World extent\n *   [minlon, minlat, maxlon, maxlat].\n * @api\n */\nProjection.prototype.setWorldExtent = function setWorldExtent (worldExtent) {\n  this.worldExtent_ = worldExtent;\n};\n\n/**\n * Set the getPointResolution function (see {@link module:ol/proj~getPointResolution}\n * for this projection.\n * @param {function(number, import(\"../coordinate.js\").Coordinate):number} func Function\n * @api\n */\nProjection.prototype.setGetPointResolution = function setGetPointResolution (func) {\n  this.getPointResolutionFunc_ = func;\n};\n\n/**\n * Get the custom point resolution function for this projection (if set).\n * @return {function(number, import(\"../coordinate.js\").Coordinate):number|undefined} The custom point\n * resolution function (if set).\n */\nProjection.prototype.getPointResolutionFunc = function getPointResolutionFunc () {\n  return this.getPointResolutionFunc_;\n};\n\nexport default Projection;\n\n//# sourceMappingURL=Projection.js.map","/**\n * @module ol/proj/epsg3857\n */\nimport {cosh} from '../math.js';\nimport Projection from './Projection.js';\nimport Units from './Units.js';\n\n\n/**\n * Radius of WGS84 sphere\n *\n * @const\n * @type {number}\n */\nexport var RADIUS = 6378137;\n\n\n/**\n * @const\n * @type {number}\n */\nexport var HALF_SIZE = Math.PI * RADIUS;\n\n\n/**\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport var EXTENT = [\n  -HALF_SIZE, -HALF_SIZE,\n  HALF_SIZE, HALF_SIZE\n];\n\n\n/**\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport var WORLD_EXTENT = [-180, -85, 180, 85];\n\n\n/**\n * @classdesc\n * Projection object for web/spherical Mercator (EPSG:3857).\n */\nvar EPSG3857Projection = /*@__PURE__*/(function (Projection) {\n  function EPSG3857Projection(code) {\n    Projection.call(this, {\n      code: code,\n      units: Units.METERS,\n      extent: EXTENT,\n      global: true,\n      worldExtent: WORLD_EXTENT,\n      getPointResolution: function(resolution, point) {\n        return resolution / cosh(point[1] / RADIUS);\n      }\n    });\n\n  }\n\n  if ( Projection ) EPSG3857Projection.__proto__ = Projection;\n  EPSG3857Projection.prototype = Object.create( Projection && Projection.prototype );\n  EPSG3857Projection.prototype.constructor = EPSG3857Projection;\n\n  return EPSG3857Projection;\n}(Projection));\n\n\n/**\n * Projections equal to EPSG:3857.\n *\n * @const\n * @type {Array<import(\"./Projection.js\").default>}\n */\nexport var PROJECTIONS = [\n  new EPSG3857Projection('EPSG:3857'),\n  new EPSG3857Projection('EPSG:102100'),\n  new EPSG3857Projection('EPSG:102113'),\n  new EPSG3857Projection('EPSG:900913'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG:6.18:3:3857'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG::3857'),\n  new EPSG3857Projection('http://www.opengis.net/gml/srs/epsg.xml#3857')\n];\n\n\n/**\n * Transformation from EPSG:4326 to EPSG:3857.\n *\n * @param {Array<number>} input Input array of coordinate values.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array<number>} Output array of coordinate values.\n */\nexport function fromEPSG4326(input, opt_output, opt_dimension) {\n  var length = input.length;\n  var dimension = opt_dimension > 1 ? opt_dimension : 2;\n  var output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  var halfSize = HALF_SIZE;\n  for (var i = 0; i < length; i += dimension) {\n    output[i] = halfSize * input[i] / 180;\n    var y = RADIUS *\n        Math.log(Math.tan(Math.PI * (input[i + 1] + 90) / 360));\n    if (y > halfSize) {\n      y = halfSize;\n    } else if (y < -halfSize) {\n      y = -halfSize;\n    }\n    output[i + 1] = y;\n  }\n  return output;\n}\n\n\n/**\n * Transformation from EPSG:3857 to EPSG:4326.\n *\n * @param {Array<number>} input Input array of coordinate values.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array<number>} Output array of coordinate values.\n */\nexport function toEPSG4326(input, opt_output, opt_dimension) {\n  var length = input.length;\n  var dimension = opt_dimension > 1 ? opt_dimension : 2;\n  var output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  for (var i = 0; i < length; i += dimension) {\n    output[i] = 180 * input[i] / HALF_SIZE;\n    output[i + 1] = 360 * Math.atan(\n      Math.exp(input[i + 1] / RADIUS)) / Math.PI - 90;\n  }\n  return output;\n}\n\n//# sourceMappingURL=epsg3857.js.map","/**\n * @module ol/proj/epsg4326\n */\nimport Projection from './Projection.js';\nimport Units from './Units.js';\n\n\n/**\n * Semi-major radius of the WGS84 ellipsoid.\n *\n * @const\n * @type {number}\n */\nexport var RADIUS = 6378137;\n\n\n/**\n * Extent of the EPSG:4326 projection which is the whole world.\n *\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport var EXTENT = [-180, -90, 180, 90];\n\n\n/**\n * @const\n * @type {number}\n */\nexport var METERS_PER_UNIT = Math.PI * RADIUS / 180;\n\n\n/**\n * @classdesc\n * Projection object for WGS84 geographic coordinates (EPSG:4326).\n *\n * Note that OpenLayers does not strictly comply with the EPSG definition.\n * The EPSG registry defines 4326 as a CRS for Latitude,Longitude (y,x).\n * OpenLayers treats EPSG:4326 as a pseudo-projection, with x,y coordinates.\n */\nvar EPSG4326Projection = /*@__PURE__*/(function (Projection) {\n  function EPSG4326Projection(code, opt_axisOrientation) {\n    Projection.call(this, {\n      code: code,\n      units: Units.DEGREES,\n      extent: EXTENT,\n      axisOrientation: opt_axisOrientation,\n      global: true,\n      metersPerUnit: METERS_PER_UNIT,\n      worldExtent: EXTENT\n    });\n\n  }\n\n  if ( Projection ) EPSG4326Projection.__proto__ = Projection;\n  EPSG4326Projection.prototype = Object.create( Projection && Projection.prototype );\n  EPSG4326Projection.prototype.constructor = EPSG4326Projection;\n\n  return EPSG4326Projection;\n}(Projection));\n\n\n/**\n * Projections equal to EPSG:4326.\n *\n * @const\n * @type {Array<import(\"./Projection.js\").default>}\n */\nexport var PROJECTIONS = [\n  new EPSG4326Projection('CRS:84'),\n  new EPSG4326Projection('EPSG:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG::4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG:6.6:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:1.3:CRS84'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:2:84'),\n  new EPSG4326Projection('http://www.opengis.net/gml/srs/epsg.xml#4326', 'neu'),\n  new EPSG4326Projection('urn:x-ogc:def:crs:EPSG:4326', 'neu')\n];\n\n//# sourceMappingURL=epsg4326.js.map","/**\n * @module ol/proj/projections\n */\n\n\n/**\n * @type {Object<string, import(\"./Projection.js\").default>}\n */\nvar cache = {};\n\n\n/**\n * Clear the projections cache.\n */\nexport function clear() {\n  cache = {};\n}\n\n\n/**\n * Get a cached projection by code.\n * @param {string} code The code for the projection.\n * @return {import(\"./Projection.js\").default} The projection (if cached).\n */\nexport function get(code) {\n  return cache[code] || null;\n}\n\n\n/**\n * Add a projection to the cache.\n * @param {string} code The projection code.\n * @param {import(\"./Projection.js\").default} projection The projection to cache.\n */\nexport function add(code, projection) {\n  cache[code] = projection;\n}\n\n//# sourceMappingURL=projections.js.map","/**\n * @module ol/proj/transforms\n */\nimport {isEmpty} from '../obj.js';\n\n\n/**\n * @private\n * @type {!Object<string, Object<string, import(\"../proj.js\").TransformFunction>>}\n */\nvar transforms = {};\n\n\n/**\n * Clear the transform cache.\n */\nexport function clear() {\n  transforms = {};\n}\n\n\n/**\n * Registers a conversion function to convert coordinates from the source\n * projection to the destination projection.\n *\n * @param {import(\"./Projection.js\").default} source Source.\n * @param {import(\"./Projection.js\").default} destination Destination.\n * @param {import(\"../proj.js\").TransformFunction} transformFn Transform.\n */\nexport function add(source, destination, transformFn) {\n  var sourceCode = source.getCode();\n  var destinationCode = destination.getCode();\n  if (!(sourceCode in transforms)) {\n    transforms[sourceCode] = {};\n  }\n  transforms[sourceCode][destinationCode] = transformFn;\n}\n\n\n/**\n * Unregisters the conversion function to convert coordinates from the source\n * projection to the destination projection.  This method is used to clean up\n * cached transforms during testing.\n *\n * @param {import(\"./Projection.js\").default} source Source projection.\n * @param {import(\"./Projection.js\").default} destination Destination projection.\n * @return {import(\"../proj.js\").TransformFunction} transformFn The unregistered transform.\n */\nexport function remove(source, destination) {\n  var sourceCode = source.getCode();\n  var destinationCode = destination.getCode();\n  var transform = transforms[sourceCode][destinationCode];\n  delete transforms[sourceCode][destinationCode];\n  if (isEmpty(transforms[sourceCode])) {\n    delete transforms[sourceCode];\n  }\n  return transform;\n}\n\n\n/**\n * Get a transform given a source code and a destination code.\n * @param {string} sourceCode The code for the source projection.\n * @param {string} destinationCode The code for the destination projection.\n * @return {import(\"../proj.js\").TransformFunction|undefined} The transform function (if found).\n */\nexport function get(sourceCode, destinationCode) {\n  var transform;\n  if (sourceCode in transforms && destinationCode in transforms[sourceCode]) {\n    transform = transforms[sourceCode][destinationCode];\n  }\n  return transform;\n}\n\n//# sourceMappingURL=transforms.js.map","/**\n * @module ol/proj\n */\n\n/**\n * The ol/proj module stores:\n * * a list of {@link module:ol/proj/Projection}\n * objects, one for each projection supported by the application\n * * a list of transform functions needed to convert coordinates in one projection\n * into another.\n *\n * The static functions are the methods used to maintain these.\n * Each transform function can handle not only simple coordinate pairs, but also\n * large arrays of coordinates such as vector geometries.\n *\n * When loaded, the library adds projection objects for EPSG:4326 (WGS84\n * geographic coordinates) and EPSG:3857 (Web or Spherical Mercator, as used\n * for example by Bing Maps or OpenStreetMap), together with the relevant\n * transform functions.\n *\n * Additional transforms may be added by using the http://proj4js.org/\n * library (version 2.2 or later). You can use the full build supplied by\n * Proj4js, or create a custom build to support those projections you need; see\n * the Proj4js website for how to do this. You also need the Proj4js definitions\n * for the required projections. These definitions can be obtained from\n * https://epsg.io/, and are a JS function, so can be loaded in a script\n * tag (as in the examples) or pasted into your application.\n *\n * After all required projection definitions are added to proj4's registry (by\n * using `proj4.defs()`), simply call `register(proj4)` from the `ol/proj/proj4`\n * package. Existing transforms are not changed by this function. See\n * examples/wms-image-custom-proj for an example of this.\n *\n * Additional projection definitions can be registered with `proj4.defs()` any\n * time. Just make sure to call `register(proj4)` again; for example, with user-supplied data where you don't\n * know in advance what projections are needed, you can initially load minimal\n * support and then load whichever are requested.\n *\n * Note that Proj4js does not support projection extents. If you want to add\n * one for creating default tile grids, you can add it after the Projection\n * object has been created with `setExtent`, for example,\n * `get('EPSG:1234').setExtent(extent)`.\n *\n * In addition to Proj4js support, any transform functions can be added with\n * {@link module:ol/proj~addCoordinateTransforms}. To use this, you must first create\n * a {@link module:ol/proj/Projection} object for the new projection and add it with\n * {@link module:ol/proj~addProjection}. You can then add the forward and inverse\n * functions with {@link module:ol/proj~addCoordinateTransforms}. See\n * examples/wms-custom-proj for an example of this.\n *\n * Note that if no transforms are needed and you only need to define the\n * projection, just add a {@link module:ol/proj/Projection} with\n * {@link module:ol/proj~addProjection}. See examples/wms-no-proj for an example of\n * this.\n */\nimport {getDistance} from './sphere.js';\nimport {applyTransform} from './extent.js';\nimport {modulo} from './math.js';\nimport {toEPSG4326, fromEPSG4326, PROJECTIONS as EPSG3857_PROJECTIONS} from './proj/epsg3857.js';\nimport {PROJECTIONS as EPSG4326_PROJECTIONS} from './proj/epsg4326.js';\nimport Projection from './proj/Projection.js';\nimport Units, {METERS_PER_UNIT} from './proj/Units.js';\nimport * as projections from './proj/projections.js';\nimport {add as addTransformFunc, clear as clearTransformFuncs, get as getTransformFunc} from './proj/transforms.js';\n\n\n/**\n * A projection as {@link module:ol/proj/Projection}, SRS identifier\n * string or undefined.\n * @typedef {Projection|string|undefined} ProjectionLike\n * @api\n */\n\n\n/**\n * A transform function accepts an array of input coordinate values, an optional\n * output array, and an optional dimension (default should be 2).  The function\n * transforms the input coordinate values, populates the output array, and\n * returns the output array.\n *\n * @typedef {function(Array<number>, Array<number>=, number=): Array<number>} TransformFunction\n * @api\n */\n\n\nexport {METERS_PER_UNIT};\n\nexport {Projection};\n\n/**\n * @param {Array<number>} input Input coordinate array.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array<number>} Output coordinate array (new array, same coordinate\n *     values).\n */\nexport function cloneTransform(input, opt_output, opt_dimension) {\n  var output;\n  if (opt_output !== undefined) {\n    for (var i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    output = opt_output;\n  } else {\n    output = input.slice();\n  }\n  return output;\n}\n\n\n/**\n * @param {Array<number>} input Input coordinate array.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array<number>} Input coordinate array (same array as input).\n */\nexport function identityTransform(input, opt_output, opt_dimension) {\n  if (opt_output !== undefined && input !== opt_output) {\n    for (var i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    input = opt_output;\n  }\n  return input;\n}\n\n\n/**\n * Add a Projection object to the list of supported projections that can be\n * looked up by their code.\n *\n * @param {Projection} projection Projection instance.\n * @api\n */\nexport function addProjection(projection) {\n  projections.add(projection.getCode(), projection);\n  addTransformFunc(projection, projection, cloneTransform);\n}\n\n\n/**\n * @param {Array<Projection>} projections Projections.\n */\nexport function addProjections(projections) {\n  projections.forEach(addProjection);\n}\n\n\n/**\n * Fetches a Projection object for the code specified.\n *\n * @param {ProjectionLike} projectionLike Either a code string which is\n *     a combination of authority and identifier such as \"EPSG:4326\", or an\n *     existing projection object, or undefined.\n * @return {Projection} Projection object, or null if not in list.\n * @api\n */\nexport function get(projectionLike) {\n  return typeof projectionLike === 'string' ?\n    projections.get(/** @type {string} */ (projectionLike)) :\n    (/** @type {Projection} */ (projectionLike) || null);\n}\n\n\n/**\n * Get the resolution of the point in degrees or distance units.\n * For projections with degrees as the unit this will simply return the\n * provided resolution. For other projections the point resolution is\n * by default estimated by transforming the 'point' pixel to EPSG:4326,\n * measuring its width and height on the normal sphere,\n * and taking the average of the width and height.\n * A custom function can be provided for a specific projection, either\n * by setting the `getPointResolution` option in the\n * {@link module:ol/proj/Projection~Projection} constructor or by using\n * {@link module:ol/proj/Projection~Projection#setGetPointResolution} to change an existing\n * projection object.\n * @param {ProjectionLike} projection The projection.\n * @param {number} resolution Nominal resolution in projection units.\n * @param {import(\"./coordinate.js\").Coordinate} point Point to find adjusted resolution at.\n * @param {Units=} opt_units Units to get the point resolution in.\n * Default is the projection's units.\n * @return {number} Point resolution.\n * @api\n */\nexport function getPointResolution(projection, resolution, point, opt_units) {\n  projection = get(projection);\n  var pointResolution;\n  var getter = projection.getPointResolutionFunc();\n  if (getter) {\n    pointResolution = getter(resolution, point);\n  } else {\n    var units = projection.getUnits();\n    if (units == Units.DEGREES && !opt_units || opt_units == Units.DEGREES) {\n      pointResolution = resolution;\n    } else {\n      // Estimate point resolution by transforming the center pixel to EPSG:4326,\n      // measuring its width and height on the normal sphere, and taking the\n      // average of the width and height.\n      var toEPSG4326 = getTransformFromProjections(projection, get('EPSG:4326'));\n      var vertices = [\n        point[0] - resolution / 2, point[1],\n        point[0] + resolution / 2, point[1],\n        point[0], point[1] - resolution / 2,\n        point[0], point[1] + resolution / 2\n      ];\n      vertices = toEPSG4326(vertices, vertices, 2);\n      var width = getDistance(vertices.slice(0, 2), vertices.slice(2, 4));\n      var height = getDistance(vertices.slice(4, 6), vertices.slice(6, 8));\n      pointResolution = (width + height) / 2;\n      var metersPerUnit = opt_units ?\n        METERS_PER_UNIT[opt_units] :\n        projection.getMetersPerUnit();\n      if (metersPerUnit !== undefined) {\n        pointResolution /= metersPerUnit;\n      }\n    }\n  }\n  return pointResolution;\n}\n\n\n/**\n * Registers transformation functions that don't alter coordinates. Those allow\n * to transform between projections with equal meaning.\n *\n * @param {Array<Projection>} projections Projections.\n * @api\n */\nexport function addEquivalentProjections(projections) {\n  addProjections(projections);\n  projections.forEach(function(source) {\n    projections.forEach(function(destination) {\n      if (source !== destination) {\n        addTransformFunc(source, destination, cloneTransform);\n      }\n    });\n  });\n}\n\n\n/**\n * Registers transformation functions to convert coordinates in any projection\n * in projection1 to any projection in projection2.\n *\n * @param {Array<Projection>} projections1 Projections with equal\n *     meaning.\n * @param {Array<Projection>} projections2 Projections with equal\n *     meaning.\n * @param {TransformFunction} forwardTransform Transformation from any\n *   projection in projection1 to any projection in projection2.\n * @param {TransformFunction} inverseTransform Transform from any projection\n *   in projection2 to any projection in projection1..\n */\nexport function addEquivalentTransforms(projections1, projections2, forwardTransform, inverseTransform) {\n  projections1.forEach(function(projection1) {\n    projections2.forEach(function(projection2) {\n      addTransformFunc(projection1, projection2, forwardTransform);\n      addTransformFunc(projection2, projection1, inverseTransform);\n    });\n  });\n}\n\n\n/**\n * Clear all cached projections and transforms.\n */\nexport function clearAllProjections() {\n  projections.clear();\n  clearTransformFuncs();\n}\n\n\n/**\n * @param {Projection|string|undefined} projection Projection.\n * @param {string} defaultCode Default code.\n * @return {Projection} Projection.\n */\nexport function createProjection(projection, defaultCode) {\n  if (!projection) {\n    return get(defaultCode);\n  } else if (typeof projection === 'string') {\n    return get(projection);\n  } else {\n    return (\n      /** @type {Projection} */ (projection)\n    );\n  }\n}\n\n\n/**\n * Creates a {@link module:ol/proj~TransformFunction} from a simple 2D coordinate transform\n * function.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} coordTransform Coordinate\n *     transform.\n * @return {TransformFunction} Transform function.\n */\nexport function createTransformFromCoordinateTransform(coordTransform) {\n  return (\n    /**\n     * @param {Array<number>} input Input.\n     * @param {Array<number>=} opt_output Output.\n     * @param {number=} opt_dimension Dimension.\n     * @return {Array<number>} Output.\n     */\n    function(input, opt_output, opt_dimension) {\n      var length = input.length;\n      var dimension = opt_dimension !== undefined ? opt_dimension : 2;\n      var output = opt_output !== undefined ? opt_output : new Array(length);\n      for (var i = 0; i < length; i += dimension) {\n        var point = coordTransform([input[i], input[i + 1]]);\n        output[i] = point[0];\n        output[i + 1] = point[1];\n        for (var j = dimension - 1; j >= 2; --j) {\n          output[i + j] = input[i + j];\n        }\n      }\n      return output;\n    });\n}\n\n\n/**\n * Registers coordinate transform functions to convert coordinates between the\n * source projection and the destination projection.\n * The forward and inverse functions convert coordinate pairs; this function\n * converts these into the functions used internally which also handle\n * extents and coordinate arrays.\n *\n * @param {ProjectionLike} source Source projection.\n * @param {ProjectionLike} destination Destination projection.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} forward The forward transform\n *     function (that is, from the source projection to the destination\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} inverse The inverse transform\n *     function (that is, from the destination projection to the source\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @api\n */\nexport function addCoordinateTransforms(source, destination, forward, inverse) {\n  var sourceProj = get(source);\n  var destProj = get(destination);\n  addTransformFunc(sourceProj, destProj, createTransformFromCoordinateTransform(forward));\n  addTransformFunc(destProj, sourceProj, createTransformFromCoordinateTransform(inverse));\n}\n\n\n/**\n * Transforms a coordinate from longitude/latitude to a different projection.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate as longitude and latitude, i.e.\n *     an array with longitude as 1st and latitude as 2nd element.\n * @param {ProjectionLike=} opt_projection Target projection. The\n *     default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate projected to the target projection.\n * @api\n */\nexport function fromLonLat(coordinate, opt_projection) {\n  return transform(coordinate, 'EPSG:4326',\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857');\n}\n\n\n/**\n * Transforms a coordinate to longitude/latitude.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Projected coordinate.\n * @param {ProjectionLike=} opt_projection Projection of the coordinate.\n *     The default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate as longitude and latitude, i.e. an array\n *     with longitude as 1st and latitude as 2nd element.\n * @api\n */\nexport function toLonLat(coordinate, opt_projection) {\n  var lonLat = transform(coordinate,\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857', 'EPSG:4326');\n  var lon = lonLat[0];\n  if (lon < -180 || lon > 180) {\n    lonLat[0] = modulo(lon + 180, 360) - 180;\n  }\n  return lonLat;\n}\n\n\n/**\n * Checks if two projections are the same, that is every coordinate in one\n * projection does represent the same geographic point as the same coordinate in\n * the other projection.\n *\n * @param {Projection} projection1 Projection 1.\n * @param {Projection} projection2 Projection 2.\n * @return {boolean} Equivalent.\n * @api\n */\nexport function equivalent(projection1, projection2) {\n  if (projection1 === projection2) {\n    return true;\n  }\n  var equalUnits = projection1.getUnits() === projection2.getUnits();\n  if (projection1.getCode() === projection2.getCode()) {\n    return equalUnits;\n  } else {\n    var transformFunc = getTransformFromProjections(projection1, projection2);\n    return transformFunc === cloneTransform && equalUnits;\n  }\n}\n\n\n/**\n * Searches in the list of transform functions for the function for converting\n * coordinates from the source projection to the destination projection.\n *\n * @param {Projection} sourceProjection Source Projection object.\n * @param {Projection} destinationProjection Destination Projection\n *     object.\n * @return {TransformFunction} Transform function.\n */\nexport function getTransformFromProjections(sourceProjection, destinationProjection) {\n  var sourceCode = sourceProjection.getCode();\n  var destinationCode = destinationProjection.getCode();\n  var transformFunc = getTransformFunc(sourceCode, destinationCode);\n  if (!transformFunc) {\n    transformFunc = identityTransform;\n  }\n  return transformFunc;\n}\n\n\n/**\n * Given the projection-like objects, searches for a transformation\n * function to convert a coordinates array from the source projection to the\n * destination projection.\n *\n * @param {ProjectionLike} source Source.\n * @param {ProjectionLike} destination Destination.\n * @return {TransformFunction} Transform function.\n * @api\n */\nexport function getTransform(source, destination) {\n  var sourceProjection = get(source);\n  var destinationProjection = get(destination);\n  return getTransformFromProjections(sourceProjection, destinationProjection);\n}\n\n\n/**\n * Transforms a coordinate from source projection to destination projection.\n * This returns a new coordinate (and does not modify the original).\n *\n * See {@link module:ol/proj~transformExtent} for extent transformation.\n * See the transform method of {@link module:ol/geom/Geometry~Geometry} and its\n * subclasses for geometry transforms.\n *\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {ProjectionLike} source Source projection-like.\n * @param {ProjectionLike} destination Destination projection-like.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n * @api\n */\nexport function transform(coordinate, source, destination) {\n  var transformFunc = getTransform(source, destination);\n  return transformFunc(coordinate, undefined, coordinate.length);\n}\n\n\n/**\n * Transforms an extent from source projection to destination projection.  This\n * returns a new extent (and does not modify the original).\n *\n * @param {import(\"./extent.js\").Extent} extent The extent to transform.\n * @param {ProjectionLike} source Source projection-like.\n * @param {ProjectionLike} destination Destination projection-like.\n * @return {import(\"./extent.js\").Extent} The transformed extent.\n * @api\n */\nexport function transformExtent(extent, source, destination) {\n  var transformFunc = getTransform(source, destination);\n  return applyTransform(extent, transformFunc);\n}\n\n\n/**\n * Transforms the given point to the destination projection.\n *\n * @param {import(\"./coordinate.js\").Coordinate} point Point.\n * @param {Projection} sourceProjection Source projection.\n * @param {Projection} destinationProjection Destination projection.\n * @return {import(\"./coordinate.js\").Coordinate} Point.\n */\nexport function transformWithProjections(point, sourceProjection, destinationProjection) {\n  var transformFunc = getTransformFromProjections(sourceProjection, destinationProjection);\n  return transformFunc(point);\n}\n\n/**\n * Add transforms to and from EPSG:4326 and EPSG:3857.  This function is called\n * by when this module is executed and should only need to be called again after\n * `clearAllProjections()` is called (e.g. in tests).\n */\nexport function addCommon() {\n  // Add transformations that don't alter coordinates to convert within set of\n  // projections with equal meaning.\n  addEquivalentProjections(EPSG3857_PROJECTIONS);\n  addEquivalentProjections(EPSG4326_PROJECTIONS);\n  // Add transformations to convert EPSG:4326 like coordinates to EPSG:3857 like\n  // coordinates and back.\n  addEquivalentTransforms(EPSG4326_PROJECTIONS, EPSG3857_PROJECTIONS, fromEPSG4326, toEPSG4326);\n}\n\naddCommon();\n\n//# sourceMappingURL=proj.js.map","/**\n * @module ol/reproj\n */\nimport {createCanvasContext2D} from './dom.js';\nimport {containsCoordinate, createEmpty, extend, getHeight, getTopLeft, getWidth} from './extent.js';\nimport {solveLinearSystem} from './math.js';\nimport {getPointResolution, transform} from './proj.js';\n\n\n/**\n * Calculates ideal resolution to use from the source in order to achieve\n * pixel mapping as close as possible to 1:1 during reprojection.\n * The resolution is calculated regardless of what resolutions\n * are actually available in the dataset (TileGrid, Image, ...).\n *\n * @param {import(\"./proj/Projection.js\").default} sourceProj Source projection.\n * @param {import(\"./proj/Projection.js\").default} targetProj Target projection.\n * @param {import(\"./coordinate.js\").Coordinate} targetCenter Target center.\n * @param {number} targetResolution Target resolution.\n * @return {number} The best resolution to use. Can be +-Infinity, NaN or 0.\n */\nexport function calculateSourceResolution(sourceProj, targetProj,\n  targetCenter, targetResolution) {\n\n  var sourceCenter = transform(targetCenter, targetProj, sourceProj);\n\n  // calculate the ideal resolution of the source data\n  var sourceResolution = getPointResolution(targetProj, targetResolution, targetCenter);\n\n  var targetMetersPerUnit = targetProj.getMetersPerUnit();\n  if (targetMetersPerUnit !== undefined) {\n    sourceResolution *= targetMetersPerUnit;\n  }\n  var sourceMetersPerUnit = sourceProj.getMetersPerUnit();\n  if (sourceMetersPerUnit !== undefined) {\n    sourceResolution /= sourceMetersPerUnit;\n  }\n\n  // Based on the projection properties, the point resolution at the specified\n  // coordinates may be slightly different. We need to reverse-compensate this\n  // in order to achieve optimal results.\n\n  var sourceExtent = sourceProj.getExtent();\n  if (!sourceExtent || containsCoordinate(sourceExtent, sourceCenter)) {\n    var compensationFactor = getPointResolution(sourceProj, sourceResolution, sourceCenter) /\n        sourceResolution;\n    if (isFinite(compensationFactor) && compensationFactor > 0) {\n      sourceResolution /= compensationFactor;\n    }\n  }\n\n  return sourceResolution;\n}\n\n\n/**\n * Enlarge the clipping triangle point by 1 pixel to ensure the edges overlap\n * in order to mask gaps caused by antialiasing.\n *\n * @param {number} centroidX Centroid of the triangle (x coordinate in pixels).\n * @param {number} centroidY Centroid of the triangle (y coordinate in pixels).\n * @param {number} x X coordinate of the point (in pixels).\n * @param {number} y Y coordinate of the point (in pixels).\n * @return {import(\"./coordinate.js\").Coordinate} New point 1 px farther from the centroid.\n */\nfunction enlargeClipPoint(centroidX, centroidY, x, y) {\n  var dX = x - centroidX;\n  var dY = y - centroidY;\n  var distance = Math.sqrt(dX * dX + dY * dY);\n  return [Math.round(x + dX / distance), Math.round(y + dY / distance)];\n}\n\n\n/**\n * Renders the source data into new canvas based on the triangulation.\n *\n * @param {number} width Width of the canvas.\n * @param {number} height Height of the canvas.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} sourceResolution Source resolution.\n * @param {import(\"./extent.js\").Extent} sourceExtent Extent of the data source.\n * @param {number} targetResolution Target resolution.\n * @param {import(\"./extent.js\").Extent} targetExtent Target extent.\n * @param {import(\"./reproj/Triangulation.js\").default} triangulation\n * Calculated triangulation.\n * @param {Array<{extent: import(\"./extent.js\").Extent,\n *                 image: (HTMLCanvasElement|HTMLImageElement|HTMLVideoElement)}>} sources\n * Array of sources.\n * @param {number} gutter Gutter of the sources.\n * @param {boolean=} opt_renderEdges Render reprojection edges.\n * @return {HTMLCanvasElement} Canvas with reprojected data.\n */\nexport function render(width, height, pixelRatio,\n  sourceResolution, sourceExtent, targetResolution, targetExtent,\n  triangulation, sources, gutter, opt_renderEdges) {\n\n  var context = createCanvasContext2D(Math.round(pixelRatio * width),\n    Math.round(pixelRatio * height));\n\n  if (sources.length === 0) {\n    return context.canvas;\n  }\n\n  context.scale(pixelRatio, pixelRatio);\n\n  var sourceDataExtent = createEmpty();\n  sources.forEach(function(src, i, arr) {\n    extend(sourceDataExtent, src.extent);\n  });\n\n  var canvasWidthInUnits = getWidth(sourceDataExtent);\n  var canvasHeightInUnits = getHeight(sourceDataExtent);\n  var stitchContext = createCanvasContext2D(\n    Math.round(pixelRatio * canvasWidthInUnits / sourceResolution),\n    Math.round(pixelRatio * canvasHeightInUnits / sourceResolution));\n\n  var stitchScale = pixelRatio / sourceResolution;\n\n  sources.forEach(function(src, i, arr) {\n    var xPos = src.extent[0] - sourceDataExtent[0];\n    var yPos = -(src.extent[3] - sourceDataExtent[3]);\n    var srcWidth = getWidth(src.extent);\n    var srcHeight = getHeight(src.extent);\n\n    stitchContext.drawImage(\n      src.image,\n      gutter, gutter,\n      src.image.width - 2 * gutter, src.image.height - 2 * gutter,\n      xPos * stitchScale, yPos * stitchScale,\n      srcWidth * stitchScale, srcHeight * stitchScale);\n  });\n\n  var targetTopLeft = getTopLeft(targetExtent);\n\n  triangulation.getTriangles().forEach(function(triangle, i, arr) {\n    /* Calculate affine transform (src -> dst)\n     * Resulting matrix can be used to transform coordinate\n     * from `sourceProjection` to destination pixels.\n     *\n     * To optimize number of context calls and increase numerical stability,\n     * we also do the following operations:\n     * trans(-topLeftExtentCorner), scale(1 / targetResolution), scale(1, -1)\n     * here before solving the linear system so [ui, vi] are pixel coordinates.\n     *\n     * Src points: xi, yi\n     * Dst points: ui, vi\n     * Affine coefficients: aij\n     *\n     * | x0 y0 1  0  0 0 |   |a00|   |u0|\n     * | x1 y1 1  0  0 0 |   |a01|   |u1|\n     * | x2 y2 1  0  0 0 | x |a02| = |u2|\n     * |  0  0 0 x0 y0 1 |   |a10|   |v0|\n     * |  0  0 0 x1 y1 1 |   |a11|   |v1|\n     * |  0  0 0 x2 y2 1 |   |a12|   |v2|\n     */\n    var source = triangle.source;\n    var target = triangle.target;\n    var x0 = source[0][0], y0 = source[0][1];\n    var x1 = source[1][0], y1 = source[1][1];\n    var x2 = source[2][0], y2 = source[2][1];\n    var u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n    var v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n    var u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n    var v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n    var u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n    var v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n    // Shift all the source points to improve numerical stability\n    // of all the subsequent calculations. The [x0, y0] is used here.\n    // This is also used to simplify the linear system.\n    var sourceNumericalShiftX = x0;\n    var sourceNumericalShiftY = y0;\n    x0 = 0;\n    y0 = 0;\n    x1 -= sourceNumericalShiftX;\n    y1 -= sourceNumericalShiftY;\n    x2 -= sourceNumericalShiftX;\n    y2 -= sourceNumericalShiftY;\n\n    var augmentedMatrix = [\n      [x1, y1, 0, 0, u1 - u0],\n      [x2, y2, 0, 0, u2 - u0],\n      [0, 0, x1, y1, v1 - v0],\n      [0, 0, x2, y2, v2 - v0]\n    ];\n    var affineCoefs = solveLinearSystem(augmentedMatrix);\n    if (!affineCoefs) {\n      return;\n    }\n\n    context.save();\n    context.beginPath();\n    var centroidX = (u0 + u1 + u2) / 3;\n    var centroidY = (v0 + v1 + v2) / 3;\n    var p0 = enlargeClipPoint(centroidX, centroidY, u0, v0);\n    var p1 = enlargeClipPoint(centroidX, centroidY, u1, v1);\n    var p2 = enlargeClipPoint(centroidX, centroidY, u2, v2);\n\n    context.moveTo(p1[0], p1[1]);\n    context.lineTo(p0[0], p0[1]);\n    context.lineTo(p2[0], p2[1]);\n    context.clip();\n\n    context.transform(\n      affineCoefs[0], affineCoefs[2], affineCoefs[1], affineCoefs[3], u0, v0);\n\n    context.translate(sourceDataExtent[0] - sourceNumericalShiftX,\n      sourceDataExtent[3] - sourceNumericalShiftY);\n\n    context.scale(sourceResolution / pixelRatio,\n      -sourceResolution / pixelRatio);\n\n    context.drawImage(stitchContext.canvas, 0, 0);\n    context.restore();\n  });\n\n  if (opt_renderEdges) {\n    context.save();\n\n    context.strokeStyle = 'black';\n    context.lineWidth = 1;\n\n    triangulation.getTriangles().forEach(function(triangle, i, arr) {\n      var target = triangle.target;\n      var u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n      var v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n      var u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n      var v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n      var u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n      var v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n      context.beginPath();\n      context.moveTo(u1, v1);\n      context.lineTo(u0, v0);\n      context.lineTo(u2, v2);\n      context.closePath();\n      context.stroke();\n    });\n\n    context.restore();\n  }\n  return context.canvas;\n}\n\n//# sourceMappingURL=reproj.js.map","/**\n * @module ol/reproj/Triangulation\n */\nimport {boundingExtent, createEmpty, extendCoordinate, getBottomLeft, getBottomRight,\n  getTopLeft, getTopRight, getWidth, intersects} from '../extent.js';\nimport {modulo} from '../math.js';\nimport {getTransform} from '../proj.js';\n\n\n/**\n * Single triangle; consists of 3 source points and 3 target points.\n * @typedef {Object} Triangle\n * @property {Array<import(\"../coordinate.js\").Coordinate>} source\n * @property {Array<import(\"../coordinate.js\").Coordinate>} target\n */\n\n\n/**\n * Maximum number of subdivision steps during raster reprojection triangulation.\n * Prevents high memory usage and large number of proj4 calls (for certain\n * transformations and areas). At most `2*(2^this)` triangles are created for\n * each triangulated extent (tile/image).\n * @type {number}\n */\nvar MAX_SUBDIVISION = 10;\n\n\n/**\n * Maximum allowed size of triangle relative to world width. When transforming\n * corners of world extent between certain projections, the resulting\n * triangulation seems to have zero error and no subdivision is performed. If\n * the triangle width is more than this (relative to world width; 0-1),\n * subdivison is forced (up to `MAX_SUBDIVISION`). Default is `0.25`.\n * @type {number}\n */\nvar MAX_TRIANGLE_WIDTH = 0.25;\n\n\n/**\n * @classdesc\n * Class containing triangulation of the given target extent.\n * Used for determining source data and the reprojection itself.\n */\nvar Triangulation = function Triangulation(sourceProj, targetProj, targetExtent, maxSourceExtent, errorThreshold) {\n\n  /**\n   * @type {import(\"../proj/Projection.js\").default}\n   * @private\n   */\n  this.sourceProj_ = sourceProj;\n\n  /**\n   * @type {import(\"../proj/Projection.js\").default}\n   * @private\n   */\n  this.targetProj_ = targetProj;\n\n  /** @type {!Object<string, import(\"../coordinate.js\").Coordinate>} */\n  var transformInvCache = {};\n  var transformInv = getTransform(this.targetProj_, this.sourceProj_);\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} c A coordinate.\n   * @return {import(\"../coordinate.js\").Coordinate} Transformed coordinate.\n   * @private\n   */\n  this.transformInv_ = function(c) {\n    var key = c[0] + '/' + c[1];\n    if (!transformInvCache[key]) {\n      transformInvCache[key] = transformInv(c);\n    }\n    return transformInvCache[key];\n  };\n\n  /**\n   * @type {import(\"../extent.js\").Extent}\n   * @private\n   */\n  this.maxSourceExtent_ = maxSourceExtent;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.errorThresholdSquared_ = errorThreshold * errorThreshold;\n\n  /**\n   * @type {Array<Triangle>}\n   * @private\n   */\n  this.triangles_ = [];\n\n  /**\n   * Indicates that the triangulation crosses edge of the source projection.\n   * @type {boolean}\n   * @private\n   */\n  this.wrapsXInSource_ = false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.canWrapXInSource_ = this.sourceProj_.canWrapX() &&\n      !!maxSourceExtent &&\n      !!this.sourceProj_.getExtent() &&\n      (getWidth(maxSourceExtent) == getWidth(this.sourceProj_.getExtent()));\n\n  /**\n   * @type {?number}\n   * @private\n   */\n  this.sourceWorldWidth_ = this.sourceProj_.getExtent() ?\n    getWidth(this.sourceProj_.getExtent()) : null;\n\n  /**\n   * @type {?number}\n   * @private\n   */\n  this.targetWorldWidth_ = this.targetProj_.getExtent() ?\n    getWidth(this.targetProj_.getExtent()) : null;\n\n  var destinationTopLeft = getTopLeft(targetExtent);\n  var destinationTopRight = getTopRight(targetExtent);\n  var destinationBottomRight = getBottomRight(targetExtent);\n  var destinationBottomLeft = getBottomLeft(targetExtent);\n  var sourceTopLeft = this.transformInv_(destinationTopLeft);\n  var sourceTopRight = this.transformInv_(destinationTopRight);\n  var sourceBottomRight = this.transformInv_(destinationBottomRight);\n  var sourceBottomLeft = this.transformInv_(destinationBottomLeft);\n\n  this.addQuad_(\n    destinationTopLeft, destinationTopRight,\n    destinationBottomRight, destinationBottomLeft,\n    sourceTopLeft, sourceTopRight, sourceBottomRight, sourceBottomLeft,\n    MAX_SUBDIVISION);\n\n  if (this.wrapsXInSource_) {\n    var leftBound = Infinity;\n    this.triangles_.forEach(function(triangle, i, arr) {\n      leftBound = Math.min(leftBound,\n        triangle.source[0][0], triangle.source[1][0], triangle.source[2][0]);\n    });\n\n    // Shift triangles to be as close to `leftBound` as possible\n    // (if the distance is more than `worldWidth / 2` it can be closer.\n    this.triangles_.forEach(function(triangle) {\n      if (Math.max(triangle.source[0][0], triangle.source[1][0],\n        triangle.source[2][0]) - leftBound > this.sourceWorldWidth_ / 2) {\n        var newTriangle = [[triangle.source[0][0], triangle.source[0][1]],\n          [triangle.source[1][0], triangle.source[1][1]],\n          [triangle.source[2][0], triangle.source[2][1]]];\n        if ((newTriangle[0][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[0][0] -= this.sourceWorldWidth_;\n        }\n        if ((newTriangle[1][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[1][0] -= this.sourceWorldWidth_;\n        }\n        if ((newTriangle[2][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[2][0] -= this.sourceWorldWidth_;\n        }\n\n        // Rarely (if the extent contains both the dateline and prime meridian)\n        // the shift can in turn break some triangles.\n        // Detect this here and don't shift in such cases.\n        var minX = Math.min(\n          newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n        var maxX = Math.max(\n          newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n        if ((maxX - minX) < this.sourceWorldWidth_ / 2) {\n          triangle.source = newTriangle;\n        }\n      }\n    }.bind(this));\n  }\n\n  transformInvCache = {};\n};\n\n/**\n * Adds triangle to the triangulation.\n * @param {import(\"../coordinate.js\").Coordinate} a The target a coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} b The target b coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} c The target c coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} aSrc The source a coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} bSrc The source b coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} cSrc The source c coordinate.\n * @private\n */\nTriangulation.prototype.addTriangle_ = function addTriangle_ (a, b, c, aSrc, bSrc, cSrc) {\n  this.triangles_.push({\n    source: [aSrc, bSrc, cSrc],\n    target: [a, b, c]\n  });\n};\n\n/**\n * Adds quad (points in clock-wise order) to the triangulation\n * (and reprojects the vertices) if valid.\n * Performs quad subdivision if needed to increase precision.\n *\n * @param {import(\"../coordinate.js\").Coordinate} a The target a coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} b The target b coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} c The target c coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} d The target d coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} aSrc The source a coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} bSrc The source b coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} cSrc The source c coordinate.\n * @param {import(\"../coordinate.js\").Coordinate} dSrc The source d coordinate.\n * @param {number} maxSubdivision Maximal allowed subdivision of the quad.\n * @private\n */\nTriangulation.prototype.addQuad_ = function addQuad_ (a, b, c, d, aSrc, bSrc, cSrc, dSrc, maxSubdivision) {\n\n  var sourceQuadExtent = boundingExtent([aSrc, bSrc, cSrc, dSrc]);\n  var sourceCoverageX = this.sourceWorldWidth_ ?\n    getWidth(sourceQuadExtent) / this.sourceWorldWidth_ : null;\n  var sourceWorldWidth = /** @type {number} */ (this.sourceWorldWidth_);\n\n  // when the quad is wrapped in the source projection\n  // it covers most of the projection extent, but not fully\n  var wrapsX = this.sourceProj_.canWrapX() &&\n               sourceCoverageX > 0.5 && sourceCoverageX < 1;\n\n  var needsSubdivision = false;\n\n  if (maxSubdivision > 0) {\n    if (this.targetProj_.isGlobal() && this.targetWorldWidth_) {\n      var targetQuadExtent = boundingExtent([a, b, c, d]);\n      var targetCoverageX = getWidth(targetQuadExtent) / this.targetWorldWidth_;\n      needsSubdivision = targetCoverageX > MAX_TRIANGLE_WIDTH ||\n        needsSubdivision;\n    }\n    if (!wrapsX && this.sourceProj_.isGlobal() && sourceCoverageX) {\n      needsSubdivision = sourceCoverageX > MAX_TRIANGLE_WIDTH ||\n          needsSubdivision;\n    }\n  }\n\n  if (!needsSubdivision && this.maxSourceExtent_) {\n    if (!intersects(sourceQuadExtent, this.maxSourceExtent_)) {\n      // whole quad outside source projection extent -> ignore\n      return;\n    }\n  }\n\n  if (!needsSubdivision) {\n    if (!isFinite(aSrc[0]) || !isFinite(aSrc[1]) ||\n        !isFinite(bSrc[0]) || !isFinite(bSrc[1]) ||\n        !isFinite(cSrc[0]) || !isFinite(cSrc[1]) ||\n        !isFinite(dSrc[0]) || !isFinite(dSrc[1])) {\n      if (maxSubdivision > 0) {\n        needsSubdivision = true;\n      } else {\n        return;\n      }\n    }\n  }\n\n  if (maxSubdivision > 0) {\n    if (!needsSubdivision) {\n      var center = [(a[0] + c[0]) / 2, (a[1] + c[1]) / 2];\n      var centerSrc = this.transformInv_(center);\n\n      var dx;\n      if (wrapsX) {\n        var centerSrcEstimX =\n            (modulo(aSrc[0], sourceWorldWidth) +\n             modulo(cSrc[0], sourceWorldWidth)) / 2;\n        dx = centerSrcEstimX -\n            modulo(centerSrc[0], sourceWorldWidth);\n      } else {\n        dx = (aSrc[0] + cSrc[0]) / 2 - centerSrc[0];\n      }\n      var dy = (aSrc[1] + cSrc[1]) / 2 - centerSrc[1];\n      var centerSrcErrorSquared = dx * dx + dy * dy;\n      needsSubdivision = centerSrcErrorSquared > this.errorThresholdSquared_;\n    }\n    if (needsSubdivision) {\n      if (Math.abs(a[0] - c[0]) <= Math.abs(a[1] - c[1])) {\n        // split horizontally (top & bottom)\n        var bc = [(b[0] + c[0]) / 2, (b[1] + c[1]) / 2];\n        var bcSrc = this.transformInv_(bc);\n        var da = [(d[0] + a[0]) / 2, (d[1] + a[1]) / 2];\n        var daSrc = this.transformInv_(da);\n\n        this.addQuad_(\n          a, b, bc, da, aSrc, bSrc, bcSrc, daSrc, maxSubdivision - 1);\n        this.addQuad_(\n          da, bc, c, d, daSrc, bcSrc, cSrc, dSrc, maxSubdivision - 1);\n      } else {\n        // split vertically (left & right)\n        var ab = [(a[0] + b[0]) / 2, (a[1] + b[1]) / 2];\n        var abSrc = this.transformInv_(ab);\n        var cd = [(c[0] + d[0]) / 2, (c[1] + d[1]) / 2];\n        var cdSrc = this.transformInv_(cd);\n\n        this.addQuad_(\n          a, ab, cd, d, aSrc, abSrc, cdSrc, dSrc, maxSubdivision - 1);\n        this.addQuad_(\n          ab, b, c, cd, abSrc, bSrc, cSrc, cdSrc, maxSubdivision - 1);\n      }\n      return;\n    }\n  }\n\n  if (wrapsX) {\n    if (!this.canWrapXInSource_) {\n      return;\n    }\n    this.wrapsXInSource_ = true;\n  }\n\n  this.addTriangle_(a, c, d, aSrc, cSrc, dSrc);\n  this.addTriangle_(a, b, c, aSrc, bSrc, cSrc);\n};\n\n/**\n * Calculates extent of the 'source' coordinates from all the triangles.\n *\n * @return {import(\"../extent.js\").Extent} Calculated extent.\n */\nTriangulation.prototype.calculateSourceExtent = function calculateSourceExtent () {\n  var extent = createEmpty();\n\n  this.triangles_.forEach(function(triangle, i, arr) {\n    var src = triangle.source;\n    extendCoordinate(extent, src[0]);\n    extendCoordinate(extent, src[1]);\n    extendCoordinate(extent, src[2]);\n  });\n\n  return extent;\n};\n\n/**\n * @return {Array<Triangle>} Array of the calculated triangles.\n */\nTriangulation.prototype.getTriangles = function getTriangles () {\n  return this.triangles_;\n};\n\nexport default Triangulation;\n\n//# sourceMappingURL=Triangulation.js.map","/**\n * @module ol/reproj/Tile\n */\nimport {ERROR_THRESHOLD} from './common.js';\n\nimport Tile from '../Tile.js';\nimport TileState from '../TileState.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getArea, getCenter, getIntersection} from '../extent.js';\nimport {clamp} from '../math.js';\nimport {calculateSourceResolution, render as renderReprojected} from '../reproj.js';\nimport Triangulation from './Triangulation.js';\n\n\n/**\n * @typedef {function(number, number, number, number) : import(\"../Tile.js\").default} FunctionType\n */\n\n\n/**\n * @classdesc\n * Class encapsulating single reprojected tile.\n * See {@link module:ol/source/TileImage~TileImage}.\n *\n */\nvar ReprojTile = /*@__PURE__*/(function (Tile) {\n  function ReprojTile(\n    sourceProj,\n    sourceTileGrid,\n    targetProj,\n    targetTileGrid,\n    tileCoord,\n    wrappedTileCoord,\n    pixelRatio,\n    gutter,\n    getTileFunction,\n    opt_errorThreshold,\n    opt_renderEdges\n  ) {\n    Tile.call(this, tileCoord, TileState.IDLE);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderEdges_ = opt_renderEdges !== undefined ? opt_renderEdges : false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.gutter_ = gutter;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.sourceTileGrid_ = sourceTileGrid;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.targetTileGrid_ = targetTileGrid;\n\n    /**\n     * @private\n     * @type {import(\"../tilecoord.js\").TileCoord}\n     */\n    this.wrappedTileCoord_ = wrappedTileCoord ? wrappedTileCoord : tileCoord;\n\n    /**\n     * @private\n     * @type {!Array<import(\"../Tile.js\").default>}\n     */\n    this.sourceTiles_ = [];\n\n    /**\n     * @private\n     * @type {Array<import(\"../events.js\").EventsKey>}\n     */\n    this.sourcesListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.sourceZ_ = 0;\n\n    var targetExtent = targetTileGrid.getTileCoordExtent(this.wrappedTileCoord_);\n    var maxTargetExtent = this.targetTileGrid_.getExtent();\n    var maxSourceExtent = this.sourceTileGrid_.getExtent();\n\n    var limitedTargetExtent = maxTargetExtent ?\n      getIntersection(targetExtent, maxTargetExtent) : targetExtent;\n\n    if (getArea(limitedTargetExtent) === 0) {\n      // Tile is completely outside range -> EMPTY\n      // TODO: is it actually correct that the source even creates the tile ?\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    var sourceProjExtent = sourceProj.getExtent();\n    if (sourceProjExtent) {\n      if (!maxSourceExtent) {\n        maxSourceExtent = sourceProjExtent;\n      } else {\n        maxSourceExtent = getIntersection(maxSourceExtent, sourceProjExtent);\n      }\n    }\n\n    var targetResolution = targetTileGrid.getResolution(\n      this.wrappedTileCoord_[0]);\n\n    var targetCenter = getCenter(limitedTargetExtent);\n    var sourceResolution = calculateSourceResolution(\n      sourceProj, targetProj, targetCenter, targetResolution);\n\n    if (!isFinite(sourceResolution) || sourceResolution <= 0) {\n      // invalid sourceResolution -> EMPTY\n      // probably edges of the projections when no extent is defined\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    var errorThresholdInPixels = opt_errorThreshold !== undefined ?\n      opt_errorThreshold : ERROR_THRESHOLD;\n\n    /**\n     * @private\n     * @type {!import(\"./Triangulation.js\").default}\n     */\n    this.triangulation_ = new Triangulation(\n      sourceProj, targetProj, limitedTargetExtent, maxSourceExtent,\n      sourceResolution * errorThresholdInPixels);\n\n    if (this.triangulation_.getTriangles().length === 0) {\n      // no valid triangles -> EMPTY\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    this.sourceZ_ = sourceTileGrid.getZForResolution(sourceResolution);\n    var sourceExtent = this.triangulation_.calculateSourceExtent();\n\n    if (maxSourceExtent) {\n      if (sourceProj.canWrapX()) {\n        sourceExtent[1] = clamp(\n          sourceExtent[1], maxSourceExtent[1], maxSourceExtent[3]);\n        sourceExtent[3] = clamp(\n          sourceExtent[3], maxSourceExtent[1], maxSourceExtent[3]);\n      } else {\n        sourceExtent = getIntersection(sourceExtent, maxSourceExtent);\n      }\n    }\n\n    if (!getArea(sourceExtent)) {\n      this.state = TileState.EMPTY;\n    } else {\n      var sourceRange = sourceTileGrid.getTileRangeForExtentAndZ(\n        sourceExtent, this.sourceZ_);\n\n      for (var srcX = sourceRange.minX; srcX <= sourceRange.maxX; srcX++) {\n        for (var srcY = sourceRange.minY; srcY <= sourceRange.maxY; srcY++) {\n          var tile = getTileFunction(this.sourceZ_, srcX, srcY, pixelRatio);\n          if (tile) {\n            this.sourceTiles_.push(tile);\n          }\n        }\n      }\n\n      if (this.sourceTiles_.length === 0) {\n        this.state = TileState.EMPTY;\n      }\n    }\n  }\n\n  if ( Tile ) ReprojTile.__proto__ = Tile;\n  ReprojTile.prototype = Object.create( Tile && Tile.prototype );\n  ReprojTile.prototype.constructor = ReprojTile;\n\n  /**\n   * @inheritDoc\n   */\n  ReprojTile.prototype.disposeInternal = function disposeInternal () {\n    if (this.state == TileState.LOADING) {\n      this.unlistenSources_();\n    }\n    Tile.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * Get the HTML Canvas element for this tile.\n   * @return {HTMLCanvasElement} Canvas.\n   */\n  ReprojTile.prototype.getImage = function getImage () {\n    return this.canvas_;\n  };\n\n  /**\n   * @private\n   */\n  ReprojTile.prototype.reproject_ = function reproject_ () {\n    var sources = [];\n    this.sourceTiles_.forEach(function(tile, i, arr) {\n      if (tile && tile.getState() == TileState.LOADED) {\n        sources.push({\n          extent: this.sourceTileGrid_.getTileCoordExtent(tile.tileCoord),\n          image: tile.getImage()\n        });\n      }\n    }.bind(this));\n    this.sourceTiles_.length = 0;\n\n    if (sources.length === 0) {\n      this.state = TileState.ERROR;\n    } else {\n      var z = this.wrappedTileCoord_[0];\n      var size = this.targetTileGrid_.getTileSize(z);\n      var width = typeof size === 'number' ? size : size[0];\n      var height = typeof size === 'number' ? size : size[1];\n      var targetResolution = this.targetTileGrid_.getResolution(z);\n      var sourceResolution = this.sourceTileGrid_.getResolution(this.sourceZ_);\n\n      var targetExtent = this.targetTileGrid_.getTileCoordExtent(\n        this.wrappedTileCoord_);\n      this.canvas_ = renderReprojected(width, height, this.pixelRatio_,\n        sourceResolution, this.sourceTileGrid_.getExtent(),\n        targetResolution, targetExtent, this.triangulation_, sources,\n        this.gutter_, this.renderEdges_);\n\n      this.state = TileState.LOADED;\n    }\n    this.changed();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  ReprojTile.prototype.load = function load () {\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n\n      var leftToLoad = 0;\n\n      this.sourcesListenerKeys_ = [];\n      this.sourceTiles_.forEach(function(tile, i, arr) {\n        var state = tile.getState();\n        if (state == TileState.IDLE || state == TileState.LOADING) {\n          leftToLoad++;\n\n          var sourceListenKey = listen(tile, EventType.CHANGE,\n            function(e) {\n              var state = tile.getState();\n              if (state == TileState.LOADED ||\n                    state == TileState.ERROR ||\n                    state == TileState.EMPTY) {\n                unlistenByKey(sourceListenKey);\n                leftToLoad--;\n                if (leftToLoad === 0) {\n                  this.unlistenSources_();\n                  this.reproject_();\n                }\n              }\n            }, this);\n          this.sourcesListenerKeys_.push(sourceListenKey);\n        }\n      }.bind(this));\n\n      this.sourceTiles_.forEach(function(tile, i, arr) {\n        var state = tile.getState();\n        if (state == TileState.IDLE) {\n          tile.load();\n        }\n      });\n\n      if (leftToLoad === 0) {\n        setTimeout(this.reproject_.bind(this), 0);\n      }\n    }\n  };\n\n  /**\n   * @private\n   */\n  ReprojTile.prototype.unlistenSources_ = function unlistenSources_ () {\n    this.sourcesListenerKeys_.forEach(unlistenByKey);\n    this.sourcesListenerKeys_ = null;\n  };\n\n  return ReprojTile;\n}(Tile));\n\n\nexport default ReprojTile;\n\n//# sourceMappingURL=Tile.js.map","/**\n * @module ol/renderer/vector\n */\nimport {getUid} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nvar SIMPLIFY_TOLERANCE = 0.5;\n\n\n/**\n * @const\n * @type {Object<import(\"../geom/GeometryType.js\").default,\n *                function(import(\"../render/ReplayGroup.js\").default, import(\"../geom/Geometry.js\").default,\n *                         import(\"../style/Style.js\").default, Object)>}\n */\nvar GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry\n};\n\n\n/**\n * @param {import(\"../Feature.js\").FeatureLike} feature1 Feature 1.\n * @param {import(\"../Feature.js\").FeatureLike} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return parseInt(getUid(feature1), 10) - parseInt(getUid(feature2), 10);\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  var tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return SIMPLIFY_TOLERANCE * resolution / pixelRatio;\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Circle.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderCircleGeometry(replayGroup, geometry, style, feature) {\n  var fillStyle = style.getFill();\n  var strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    var circleReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.CIRCLE);\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(this: T, import(\"../events/Event.js\").default)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {boolean} `true` if style is loading.\n * @template T\n */\nexport function renderFeature(replayGroup, feature, style, squaredTolerance, listener, thisArg) {\n  var loading = false;\n  var imageStyle = style.getImage();\n  if (imageStyle) {\n    var imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      imageStyle.unlistenImageChange(listener, thisArg);\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n      imageState = imageStyle.getImageState();\n      imageStyle.listenImageChange(listener, thisArg);\n      loading = true;\n    }\n  }\n  renderFeatureInternal(replayGroup, feature, style, squaredTolerance);\n\n  return loading;\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n */\nfunction renderFeatureInternal(replayGroup, feature, style, squaredTolerance) {\n  var geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  var simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n  var renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature);\n  } else {\n    var geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(replayGroup, simplifiedGeometry, style, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Geometry.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature) {\n  if (geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    var geometries = /** @type {import(\"../geom/GeometryCollection.js\").default} */ (geometry).getGeometries();\n    for (var i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature);\n    }\n    return;\n  }\n  var replay = replayGroup.getReplay(style.getZIndex(), ReplayType.DEFAULT);\n  replay.drawCustom(/** @type {import(\"../geom/SimpleGeometry.js\").default} */ (geometry), feature, style.getRenderer());\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/GeometryCollection.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderGeometryCollectionGeometry(replayGroup, geometry, style, feature) {\n  var geometries = geometry.getGeometriesArray();\n  var i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    var geometryRenderer =\n        GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(replayGroup, geometries[i], style, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/LineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderLineStringGeometry(replayGroup, geometry, style, feature) {\n  var strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    var lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiLineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiLineStringGeometry(replayGroup, geometry, style, feature) {\n  var strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    var lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderMultiPolygonGeometry(replayGroup, geometry, style, feature) {\n  var fillStyle = style.getFill();\n  var strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    var polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Point.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPointGeometry(replayGroup, geometry, style, feature) {\n  var imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    var imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawPoint(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiPoint.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiPointGeometry(replayGroup, geometry, style, feature) {\n  var imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    var imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawMultiPoint(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Polygon.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPolygonGeometry(replayGroup, geometry, style, feature) {\n  var fillStyle = style.getFill();\n  var strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    var polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n//# sourceMappingURL=vector.js.map","/**\n * @module ol/render/Event\n */\n\nimport Event from '../events/Event.js';\n\nvar RenderEvent = /*@__PURE__*/(function (Event) {\n  function RenderEvent(type, opt_vectorContext, opt_frameState, opt_context, opt_glContext) {\n\n    Event.call(this, type);\n\n    /**\n     * For canvas, this is an instance of {@link module:ol/render/canvas/Immediate}.\n     * @type {import(\"./VectorContext.js\").default|undefined}\n     * @api\n     */\n    this.vectorContext = opt_vectorContext;\n\n    /**\n     * An object representing the current render frame state.\n     * @type {import(\"../PluggableMap.js\").FrameState|undefined}\n     * @api\n     */\n    this.frameState = opt_frameState;\n\n    /**\n     * Canvas context. Only available when a Canvas renderer is used, null\n     * otherwise.\n     * @type {CanvasRenderingContext2D|null|undefined}\n     * @api\n     */\n    this.context = opt_context;\n\n    /**\n     * WebGL context. Only available when a WebGL renderer is used, null\n     * otherwise.\n     * @type {import(\"../webgl/Context.js\").default|null|undefined}\n     * @api\n     */\n    this.glContext = opt_glContext;\n\n  }\n\n  if ( Event ) RenderEvent.__proto__ = Event;\n  RenderEvent.prototype = Object.create( Event && Event.prototype );\n  RenderEvent.prototype.constructor = RenderEvent;\n\n  return RenderEvent;\n}(Event));\n\nexport default RenderEvent;\n\n//# sourceMappingURL=Event.js.map","/**\n * @module ol/size\n */\n\n\n/**\n * An array of numbers representing a size: `[width, height]`.\n * @typedef {Array<number>} Size\n * @api\n */\n\n\n/**\n * Returns a buffered size.\n * @param {Size} size Size.\n * @param {number} num The amount by which to buffer.\n * @param {Size=} opt_size Optional reusable size array.\n * @return {Size} The buffered size.\n */\nexport function buffer(size, num, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = size[0] + 2 * num;\n  opt_size[1] = size[1] + 2 * num;\n  return opt_size;\n}\n\n\n/**\n * Determines if a size has a positive area.\n * @param {Size} size The size to test.\n * @return {boolean} The size has a positive area.\n */\nexport function hasArea(size) {\n  return size[0] > 0 && size[1] > 0;\n}\n\n\n/**\n * Returns a size scaled by a ratio. The result will be an array of integers.\n * @param {Size} size Size.\n * @param {number} ratio Ratio.\n * @param {Size=} opt_size Optional reusable size array.\n * @return {Size} The scaled size.\n */\nexport function scale(size, ratio, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = (size[0] * ratio + 0.5) | 0;\n  opt_size[1] = (size[1] * ratio + 0.5) | 0;\n  return opt_size;\n}\n\n\n/**\n * Returns an `Size` array for the passed in number (meaning: square) or\n * `Size` array.\n * (meaning: non-square),\n * @param {number|Size} size Width and height.\n * @param {Size=} opt_size Optional reusable size array.\n * @return {Size} Size.\n * @api\n */\nexport function toSize(size, opt_size) {\n  if (Array.isArray(size)) {\n    return size;\n  } else {\n    if (opt_size === undefined) {\n      opt_size = [size, size];\n    } else {\n      opt_size[0] = opt_size[1] = /** @type {number} */ (size);\n    }\n    return opt_size;\n  }\n}\n\n//# sourceMappingURL=size.js.map","/**\n * @module ol/renderer/canvas/ImageLayer\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../../reproj/common.js';\nimport ImageCanvas from '../../ImageCanvas.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {equals} from '../../array.js';\nimport {getHeight, getIntersection, getWidth, isEmpty} from '../../extent.js';\nimport VectorRenderType from '../../layer/VectorRenderType.js';\nimport {assign} from '../../obj.js';\nimport {layerRendererConstructors} from './Map.js';\nimport IntermediateCanvasRenderer from './IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @classdesc\n * Canvas renderer for image layers.\n * @api\n */\nvar CanvasImageLayerRenderer = /*@__PURE__*/(function (IntermediateCanvasRenderer) {\n  function CanvasImageLayerRenderer(imageLayer) {\n\n    IntermediateCanvasRenderer.call(this, imageLayer);\n\n    /**\n     * @private\n     * @type {?import(\"../../ImageBase.js\").default}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.imageTransform_ = createTransform();\n\n    /**\n     * @type {!Array<string>}\n     */\n    this.skippedFeatures_ = [];\n\n    /**\n     * @private\n     * @type {import(\"./VectorLayer.js\").default}\n     */\n    this.vectorRenderer_ = null;\n\n    if (imageLayer.getType() === LayerType.VECTOR) {\n      for (var i = 0, ii = layerRendererConstructors.length; i < ii; ++i) {\n        var ctor = layerRendererConstructors[i];\n        if (ctor !== CanvasImageLayerRenderer && ctor['handles'](imageLayer)) {\n          this.vectorRenderer_ = /** @type {import(\"./VectorLayer.js\").default} */ (new ctor(imageLayer));\n          break;\n        }\n      }\n    }\n\n  }\n\n  if ( IntermediateCanvasRenderer ) CanvasImageLayerRenderer.__proto__ = IntermediateCanvasRenderer;\n  CanvasImageLayerRenderer.prototype = Object.create( IntermediateCanvasRenderer && IntermediateCanvasRenderer.prototype );\n  CanvasImageLayerRenderer.prototype.constructor = CanvasImageLayerRenderer;\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageLayerRenderer.prototype.disposeInternal = function disposeInternal () {\n    if (this.vectorRenderer_) {\n      this.vectorRenderer_.dispose();\n    }\n    IntermediateCanvasRenderer.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageLayerRenderer.prototype.getImage = function getImage () {\n    return !this.image_ ? null : this.image_.getImage();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageLayerRenderer.prototype.getImageTransform = function getImageTransform () {\n    return this.imageTransform_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageLayerRenderer.prototype.prepareFrame = function prepareFrame (frameState, layerState) {\n\n    var pixelRatio = frameState.pixelRatio;\n    var size = frameState.size;\n    var viewState = frameState.viewState;\n    var viewCenter = viewState.center;\n    var viewResolution = viewState.resolution;\n\n    var image;\n    var imageLayer = /** @type {import(\"../../layer/Image.js\").default} */ (this.getLayer());\n    var imageSource = /** @type {import(\"../../source/Image.js\").default} */ (imageLayer.getSource());\n\n    var hints = frameState.viewHints;\n\n    var vectorRenderer = this.vectorRenderer_;\n    var renderedExtent = frameState.extent;\n    if (!vectorRenderer && layerState.extent !== undefined) {\n      renderedExtent = getIntersection(renderedExtent, layerState.extent);\n    }\n\n    if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] &&\n        !isEmpty(renderedExtent)) {\n      var projection = viewState.projection;\n      if (!ENABLE_RASTER_REPROJECTION) {\n        var sourceProjection = imageSource.getProjection();\n        if (sourceProjection) {\n          projection = sourceProjection;\n        }\n      }\n      var skippedFeatures = this.skippedFeatures_;\n      if (vectorRenderer) {\n        var context = vectorRenderer.context;\n        var imageFrameState = /** @type {import(\"../../PluggableMap.js\").FrameState} */ (assign({}, frameState, {\n          size: [\n            getWidth(renderedExtent) / viewResolution,\n            getHeight(renderedExtent) / viewResolution\n          ],\n          viewState: /** @type {import(\"../../View.js\").State} */ (assign({}, frameState.viewState, {\n            rotation: 0\n          }))\n        }));\n        var newSkippedFeatures = Object.keys(imageFrameState.skippedFeatureUids).sort();\n        image = new ImageCanvas(renderedExtent, viewResolution, pixelRatio, context.canvas, function(callback) {\n          if (vectorRenderer.prepareFrame(imageFrameState, layerState) &&\n              (vectorRenderer.replayGroupChanged ||\n              !equals(skippedFeatures, newSkippedFeatures))) {\n            context.canvas.width = imageFrameState.size[0] * pixelRatio;\n            context.canvas.height = imageFrameState.size[1] * pixelRatio;\n            vectorRenderer.compose(context, imageFrameState, layerState);\n            skippedFeatures = newSkippedFeatures;\n            callback();\n          }\n        });\n      } else {\n        image = imageSource.getImage(\n          renderedExtent, viewResolution, pixelRatio, projection);\n      }\n      if (image && this.loadImage(image)) {\n        this.image_ = image;\n        this.skippedFeatures_ = skippedFeatures;\n      }\n    }\n\n    if (this.image_) {\n      image = this.image_;\n      var imageExtent = image.getExtent();\n      var imageResolution = image.getResolution();\n      var imagePixelRatio = image.getPixelRatio();\n      var scale = pixelRatio * imageResolution /\n          (viewResolution * imagePixelRatio);\n      var transform = composeTransform(this.imageTransform_,\n        pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n        scale, scale,\n        0,\n        imagePixelRatio * (imageExtent[0] - viewCenter[0]) / imageResolution,\n        imagePixelRatio * (viewCenter[1] - imageExtent[3]) / imageResolution);\n      composeTransform(this.coordinateToCanvasPixelTransform,\n        pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n        pixelRatio / viewResolution, -pixelRatio / viewResolution,\n        0,\n        -viewCenter[0], -viewCenter[1]);\n\n      this.renderedResolution = imageResolution * pixelRatio / imagePixelRatio;\n    }\n\n    return !!this.image_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasImageLayerRenderer.prototype.forEachFeatureAtCoordinate = function forEachFeatureAtCoordinate (coordinate, frameState, hitTolerance, callback) {\n    if (this.vectorRenderer_) {\n      return this.vectorRenderer_.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback);\n    } else {\n      return IntermediateCanvasRenderer.prototype.forEachFeatureAtCoordinate.call(this, coordinate, frameState, hitTolerance, callback);\n    }\n  };\n\n  return CanvasImageLayerRenderer;\n}(IntermediateCanvasRenderer));\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {import(\"../../layer/Layer.js\").default} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasImageLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.IMAGE ||\n    layer.getType() === LayerType.VECTOR &&\n    /** @type {import(\"../../layer/Vector.js\").default} */ (layer).getRenderMode() === VectorRenderType.IMAGE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {import(\"../Map.js\").default} mapRenderer The map renderer.\n * @param {import(\"../../layer/Layer.js\").default} layer The layer to be rendererd.\n * @return {CanvasImageLayerRenderer} The layer renderer.\n */\nCanvasImageLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasImageLayerRenderer(/** @type {import(\"../../layer/Image.js\").default} */ (layer));\n};\n\n\nexport default CanvasImageLayerRenderer;\n\n//# sourceMappingURL=ImageLayer.js.map","/**\n * @module ol/pointer/MouseSource\n */\n\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport EventSource from './EventSource.js';\n\n\n/**\n * @type {number}\n */\nexport var POINTER_ID = 1;\n\n\n/**\n * @type {string}\n */\nexport var POINTER_TYPE = 'mouse';\n\n\n/**\n * Radius around touchend that swallows mouse events.\n *\n * @type {number}\n */\nvar DEDUP_DIST = 25;\n\n/**\n * Handler for `mousedown`.\n *\n * @this {MouseSource}\n * @param {MouseEvent} inEvent The in event.\n */\nfunction mousedown(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    // TODO(dfreedman) workaround for some elements not sending mouseup\n    // http://crbug/149091\n    if (POINTER_ID.toString() in this.pointerMap) {\n      this.cancel(inEvent);\n    }\n    var e = prepareEvent(inEvent, this.dispatcher);\n    this.pointerMap[POINTER_ID.toString()] = inEvent;\n    this.dispatcher.down(e, inEvent);\n  }\n}\n\n/**\n * Handler for `mousemove`.\n *\n * @this {MouseSource}\n * @param {MouseEvent} inEvent The in event.\n */\nfunction mousemove(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    var e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.move(e, inEvent);\n  }\n}\n\n/**\n * Handler for `mouseup`.\n *\n * @this {MouseSource}\n * @param {MouseEvent} inEvent The in event.\n */\nfunction mouseup(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    var p = this.pointerMap[POINTER_ID.toString()];\n\n    if (p && p.button === inEvent.button) {\n      var e = prepareEvent(inEvent, this.dispatcher);\n      this.dispatcher.up(e, inEvent);\n      this.cleanupMouse();\n    }\n  }\n}\n\n/**\n * Handler for `mouseover`.\n *\n * @this {MouseSource}\n * @param {MouseEvent} inEvent The in event.\n */\nfunction mouseover(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    var e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.enterOver(e, inEvent);\n  }\n}\n\n/**\n * Handler for `mouseout`.\n *\n * @this {MouseSource}\n * @param {MouseEvent} inEvent The in event.\n */\nfunction mouseout(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    var e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.leaveOut(e, inEvent);\n  }\n}\n\n\nvar MouseSource = /*@__PURE__*/(function (EventSource) {\n  function MouseSource(dispatcher) {\n    var mapping = {\n      'mousedown': mousedown,\n      'mousemove': mousemove,\n      'mouseup': mouseup,\n      'mouseover': mouseover,\n      'mouseout': mouseout\n    };\n    EventSource.call(this, dispatcher, mapping);\n\n    /**\n     * @const\n     * @type {!Object<string, Event|Object>}\n     */\n    this.pointerMap = dispatcher.pointerMap;\n\n    /**\n     * @const\n     * @type {Array<import(\"../pixel.js\").Pixel>}\n     */\n    this.lastTouches = [];\n  }\n\n  if ( EventSource ) MouseSource.__proto__ = EventSource;\n  MouseSource.prototype = Object.create( EventSource && EventSource.prototype );\n  MouseSource.prototype.constructor = MouseSource;\n\n  /**\n   * Detect if a mouse event was simulated from a touch by\n   * checking if previously there was a touch event at the\n   * same position.\n   *\n   * FIXME - Known problem with the native Android browser on\n   * Samsung GT-I9100 (Android 4.1.2):\n   * In case the page is scrolled, this function does not work\n   * correctly when a canvas is used (WebGL or canvas renderer).\n   * Mouse listeners on canvas elements (for this browser), create\n   * two mouse events: One 'good' and one 'bad' one (on other browsers or\n   * when a div is used, there is only one event). For the 'bad' one,\n   * clientX/clientY and also pageX/pageY are wrong when the page\n   * is scrolled. Because of that, this function can not detect if\n   * the events were simulated from a touch event. As result, a\n   * pointer event at a wrong position is dispatched, which confuses\n   * the map interactions.\n   * It is unclear, how one can get the correct position for the event\n   * or detect that the positions are invalid.\n   *\n   * @private\n   * @param {MouseEvent} inEvent The in event.\n   * @return {boolean} True, if the event was generated by a touch.\n   */\n  MouseSource.prototype.isEventSimulatedFromTouch_ = function isEventSimulatedFromTouch_ (inEvent) {\n    var lts = this.lastTouches;\n    var x = inEvent.clientX;\n    var y = inEvent.clientY;\n    for (var i = 0, l = lts.length, t = (void 0); i < l && (t = lts[i]); i++) {\n      // simulated mouse events will be swallowed near a primary touchend\n      var dx = Math.abs(x - t[0]);\n      var dy = Math.abs(y - t[1]);\n      if (dx <= DEDUP_DIST && dy <= DEDUP_DIST) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n   * Dispatches a `pointercancel` event.\n   *\n   * @param {Event} inEvent The in event.\n   */\n  MouseSource.prototype.cancel = function cancel (inEvent) {\n    var e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.cancel(e, inEvent);\n    this.cleanupMouse();\n  };\n\n  /**\n   * Remove the mouse from the list of active pointers.\n   */\n  MouseSource.prototype.cleanupMouse = function cleanupMouse () {\n    delete this.pointerMap[POINTER_ID.toString()];\n  };\n\n  return MouseSource;\n}(EventSource));\n\n\n/**\n * Creates a copy of the original event that will be used\n * for the fake pointer event.\n *\n * @param {Event} inEvent The in event.\n * @param {import(\"./PointerEventHandler.js\").default} dispatcher Event handler.\n * @return {Object} The copied event.\n */\nexport function prepareEvent(inEvent, dispatcher) {\n  var e = dispatcher.cloneEvent(inEvent, inEvent);\n\n  // forward mouse preventDefault\n  var pd = e.preventDefault;\n  e.preventDefault = function() {\n    inEvent.preventDefault();\n    pd();\n  };\n\n  e.pointerId = POINTER_ID;\n  e.isPrimary = true;\n  e.pointerType = POINTER_TYPE;\n\n  return e;\n}\n\n\nexport default MouseSource;\n\n//# sourceMappingURL=MouseSource.js.map","/**\n * @module ol/renderer/canvas/IntermediateCanvas\n */\nimport {abstract} from '../../util.js';\nimport {scale as scaleCoordinate} from '../../coordinate.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, intersects} from '../../extent.js';\nimport CanvasLayerRenderer from './Layer.js';\nimport {create as createTransform, apply as applyTransform} from '../../transform.js';\n\n/**\n * @abstract\n */\nvar IntermediateCanvasRenderer = /*@__PURE__*/(function (CanvasLayerRenderer) {\n  function IntermediateCanvasRenderer(layer) {\n\n    CanvasLayerRenderer.call(this, layer);\n\n    /**\n     * @protected\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.coordinateToCanvasPixelTransform = createTransform();\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.hitCanvasContext_ = null;\n\n  }\n\n  if ( CanvasLayerRenderer ) IntermediateCanvasRenderer.__proto__ = CanvasLayerRenderer;\n  IntermediateCanvasRenderer.prototype = Object.create( CanvasLayerRenderer && CanvasLayerRenderer.prototype );\n  IntermediateCanvasRenderer.prototype.constructor = IntermediateCanvasRenderer;\n\n  /**\n   * @inheritDoc\n   */\n  IntermediateCanvasRenderer.prototype.composeFrame = function composeFrame (frameState, layerState, context) {\n\n    this.preCompose(context, frameState);\n\n    var image = this.getImage();\n    if (image) {\n\n      // clipped rendering if layer extent is set\n      var extent = layerState.extent;\n      var clipped = extent !== undefined &&\n          !containsExtent(extent, frameState.extent) &&\n          intersects(extent, frameState.extent);\n      if (clipped) {\n        this.clip(context, frameState, /** @type {import(\"../../extent.js\").Extent} */ (extent));\n      }\n\n      var imageTransform = this.getImageTransform();\n      // for performance reasons, context.save / context.restore is not used\n      // to save and restore the transformation matrix and the opacity.\n      // see http://jsperf.com/context-save-restore-versus-variable\n      var alpha = context.globalAlpha;\n      context.globalAlpha = layerState.opacity;\n\n      // for performance reasons, context.setTransform is only used\n      // when the view is rotated. see http://jsperf.com/canvas-transform\n      var dx = imageTransform[4];\n      var dy = imageTransform[5];\n      var dw = image.width * imageTransform[0];\n      var dh = image.height * imageTransform[3];\n      if (dw >= 0.5 && dh >= 0.5) {\n        context.drawImage(image, 0, 0, +image.width, +image.height,\n          Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n      }\n      context.globalAlpha = alpha;\n\n      if (clipped) {\n        context.restore();\n      }\n    }\n\n    this.postCompose(context, frameState, layerState);\n  };\n\n  /**\n   * @abstract\n   * @return {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement} Canvas.\n   */\n  IntermediateCanvasRenderer.prototype.getImage = function getImage () {\n    return abstract();\n  };\n\n  /**\n   * @abstract\n   * @return {!import(\"../../transform.js\").Transform} Image transform.\n   */\n  IntermediateCanvasRenderer.prototype.getImageTransform = function getImageTransform () {\n    return abstract();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  IntermediateCanvasRenderer.prototype.forEachLayerAtCoordinate = function forEachLayerAtCoordinate (coordinate, frameState, hitTolerance, callback, thisArg) {\n    if (!this.getImage()) {\n      return undefined;\n    }\n\n    var pixel = applyTransform(this.coordinateToCanvasPixelTransform, coordinate.slice());\n    scaleCoordinate(pixel, frameState.viewState.resolution / this.renderedResolution);\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.getImage(), pixel[0], pixel[1], 1, 1, 0, 0, 1, 1);\n\n    var imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(), imageData);\n    } else {\n      return undefined;\n    }\n  };\n\n  return IntermediateCanvasRenderer;\n}(CanvasLayerRenderer));\n\n\nexport default IntermediateCanvasRenderer;\n\n//# sourceMappingURL=IntermediateCanvas.js.map","/**\n * @module ol/rotationconstraint\n */\nimport {toRadians} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number): (number|undefined)} Type\n */\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function disable(rotation, delta) {\n  if (rotation !== undefined) {\n    return 0;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function none(rotation, delta) {\n  if (rotation !== undefined) {\n    return rotation + delta;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number} n N.\n * @return {Type} Rotation constraint.\n */\nexport function createSnapToN(n) {\n  var theta = 2 * Math.PI / n;\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        rotation = Math.floor((rotation + delta) / theta + 0.5) * theta;\n        return rotation;\n      } else {\n        return undefined;\n      }\n    });\n}\n\n\n/**\n * @param {number=} opt_tolerance Tolerance.\n * @return {Type} Rotation constraint.\n */\nexport function createSnapToZero(opt_tolerance) {\n  var tolerance = opt_tolerance || toRadians(5);\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        if (Math.abs(rotation + delta) <= tolerance) {\n          return 0;\n        } else {\n          return rotation + delta;\n        }\n      } else {\n        return undefined;\n      }\n    });\n}\n\n//# sourceMappingURL=rotationconstraint.js.map","/**\n * @module ol/renderer/Map\n */\nimport {abstract, getUid} from '../util.js';\nimport Disposable from '../Disposable.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getWidth} from '../extent.js';\nimport {TRUE} from '../functions.js';\nimport {visibleAtResolution} from '../layer/Layer.js';\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\nimport {compose as composeTransform, invert as invertTransform, setFromArray as transformSetFromArray} from '../transform.js';\n\n/**\n * @abstract\n */\nvar MapRenderer = /*@__PURE__*/(function (Disposable) {\n  function MapRenderer(map) {\n    Disposable.call(this);\n\n    /**\n     * @private\n     * @type {import(\"../PluggableMap.js\").default}\n     */\n    this.map_ = map;\n\n    /**\n     * @private\n     * @type {!Object<string, import(\"./Layer.js\").default>}\n     */\n    this.layerRenderers_ = {};\n\n    /**\n     * @private\n     * @type {Object<string, import(\"../events.js\").EventsKey>}\n     */\n    this.layerRendererListeners_ = {};\n\n    /**\n     * @private\n     * @type {Array<typeof import(\"./Layer.js\").default>}\n     */\n    this.layerRendererConstructors_ = [];\n\n  }\n\n  if ( Disposable ) MapRenderer.__proto__ = Disposable;\n  MapRenderer.prototype = Object.create( Disposable && Disposable.prototype );\n  MapRenderer.prototype.constructor = MapRenderer;\n\n  /**\n   * @abstract\n   * @param {import(\"../render/EventType.js\").default} type Event type.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  MapRenderer.prototype.dispatchRenderEvent = function dispatchRenderEvent (type, frameState) {\n    abstract();\n  };\n\n  /**\n   * Register layer renderer constructors.\n   * @param {Array<typeof import(\"./Layer.js\").default>} constructors Layer renderers.\n   */\n  MapRenderer.prototype.registerLayerRenderers = function registerLayerRenderers (constructors) {\n    this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_, constructors);\n  };\n\n  /**\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @protected\n   */\n  MapRenderer.prototype.calculateMatrices2D = function calculateMatrices2D (frameState) {\n    var viewState = frameState.viewState;\n    var coordinateToPixelTransform = frameState.coordinateToPixelTransform;\n    var pixelToCoordinateTransform = frameState.pixelToCoordinateTransform;\n\n    composeTransform(coordinateToPixelTransform,\n      frameState.size[0] / 2, frameState.size[1] / 2,\n      1 / viewState.resolution, -1 / viewState.resolution,\n      -viewState.rotation,\n      -viewState.center[0], -viewState.center[1]);\n\n    invertTransform(\n      transformSetFromArray(pixelToCoordinateTransform, coordinateToPixelTransform));\n  };\n\n  /**\n   * Removes all layer renderers.\n   */\n  MapRenderer.prototype.removeLayerRenderers = function removeLayerRenderers () {\n    for (var key in this.layerRenderers_) {\n      this.removeLayerRendererByKey_(key).dispose();\n    }\n  };\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(this: S, import(\"../Feature.js\").FeatureLike,\n   *     import(\"../layer/Layer.js\").default): T} callback Feature callback.\n   * @param {S} thisArg Value to use as `this` when executing `callback`.\n   * @param {function(this: U, import(\"../layer/Layer.js\").default): boolean} layerFilter Layer filter\n   *     function, only layers which are visible and for which this function\n   *     returns `true` will be tested for features.  By default, all visible\n   *     layers will be tested.\n   * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n   * @return {T|undefined} Callback result.\n   * @template S,T,U\n   */\n  MapRenderer.prototype.forEachFeatureAtCoordinate = function forEachFeatureAtCoordinate (\n    coordinate,\n    frameState,\n    hitTolerance,\n    callback,\n    thisArg,\n    layerFilter,\n    thisArg2\n  ) {\n    var result;\n    var viewState = frameState.viewState;\n    var viewResolution = viewState.resolution;\n\n    /**\n     * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n     * @param {import(\"../layer/Layer.js\").default} layer Layer.\n     * @return {?} Callback result.\n     */\n    function forEachFeatureAtCoordinate(feature, layer) {\n      var managed = frameState.layerStates[getUid(layer)].managed;\n      if (!(getUid(feature) in frameState.skippedFeatureUids && !managed)) {\n        return callback.call(thisArg, feature, managed ? layer : null);\n      }\n    }\n\n    var projection = viewState.projection;\n\n    var translatedCoordinate = coordinate;\n    if (projection.canWrapX()) {\n      var projectionExtent = projection.getExtent();\n      var worldWidth = getWidth(projectionExtent);\n      var x = coordinate[0];\n      if (x < projectionExtent[0] || x > projectionExtent[2]) {\n        var worldsAway = Math.ceil((projectionExtent[0] - x) / worldWidth);\n        translatedCoordinate = [x + worldWidth * worldsAway, coordinate[1]];\n      }\n    }\n\n    var layerStates = frameState.layerStatesArray;\n    var numLayers = layerStates.length;\n    var i;\n    for (i = numLayers - 1; i >= 0; --i) {\n      var layerState = layerStates[i];\n      var layer = layerState.layer;\n      if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n        var layerRenderer = this.getLayerRenderer(layer);\n        var source = /** @type {import(\"../layer/Layer.js\").default} */ (layer).getSource();\n        if (source) {\n          result = layerRenderer.forEachFeatureAtCoordinate(\n            source.getWrapX() ? translatedCoordinate : coordinate,\n            frameState, hitTolerance, forEachFeatureAtCoordinate);\n        }\n        if (result) {\n          return result;\n        }\n      }\n    }\n    return undefined;\n  };\n\n  /**\n   * @abstract\n   * @param {import(\"../pixel.js\").Pixel} pixel Pixel.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(this: S, import(\"../layer/Layer.js\").default, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n   *     callback.\n   * @param {S} thisArg Value to use as `this` when executing `callback`.\n   * @param {function(this: U, import(\"../layer/Layer.js\").default): boolean} layerFilter Layer filter\n   *     function, only layers which are visible and for which this function\n   *     returns `true` will be tested for features.  By default, all visible\n   *     layers will be tested.\n   * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n   * @return {T|undefined} Callback result.\n   * @template S,T,U\n   */\n  MapRenderer.prototype.forEachLayerAtPixel = function forEachLayerAtPixel (pixel, frameState, hitTolerance, callback, thisArg, layerFilter, thisArg2) {\n    return abstract();\n  };\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(this: U, import(\"../layer/Layer.js\").default): boolean} layerFilter Layer filter\n   *     function, only layers which are visible and for which this function\n   *     returns `true` will be tested for features.  By default, all visible\n   *     layers will be tested.\n   * @param {U} thisArg Value to use as `this` when executing `layerFilter`.\n   * @return {boolean} Is there a feature at the given coordinate?\n   * @template U\n   */\n  MapRenderer.prototype.hasFeatureAtCoordinate = function hasFeatureAtCoordinate (coordinate, frameState, hitTolerance, layerFilter, thisArg) {\n    var hasFeature = this.forEachFeatureAtCoordinate(\n      coordinate, frameState, hitTolerance, TRUE, this, layerFilter, thisArg);\n\n    return hasFeature !== undefined;\n  };\n\n  /**\n   * @param {import(\"../layer/Base.js\").default} layer Layer.\n   * @protected\n   * @return {import(\"./Layer.js\").default} Layer renderer.\n   */\n  MapRenderer.prototype.getLayerRenderer = function getLayerRenderer (layer) {\n    var layerKey = getUid(layer);\n    if (layerKey in this.layerRenderers_) {\n      return this.layerRenderers_[layerKey];\n    } else {\n      var renderer;\n      for (var i = 0, ii = this.layerRendererConstructors_.length; i < ii; ++i) {\n        var candidate = this.layerRendererConstructors_[i];\n        if (candidate['handles'](layer)) {\n          renderer = candidate['create'](this, layer);\n          break;\n        }\n      }\n      if (renderer) {\n        this.layerRenderers_[layerKey] = renderer;\n        this.layerRendererListeners_[layerKey] = listen(renderer,\n          EventType.CHANGE, this.handleLayerRendererChange_, this);\n      } else {\n        throw new Error('Unable to create renderer for layer: ' + layer.getType());\n      }\n      return renderer;\n    }\n  };\n\n  /**\n   * @param {string} layerKey Layer key.\n   * @protected\n   * @return {import(\"./Layer.js\").default} Layer renderer.\n   */\n  MapRenderer.prototype.getLayerRendererByKey = function getLayerRendererByKey (layerKey) {\n    return this.layerRenderers_[layerKey];\n  };\n\n  /**\n   * @protected\n   * @return {Object<string, import(\"./Layer.js\").default>} Layer renderers.\n   */\n  MapRenderer.prototype.getLayerRenderers = function getLayerRenderers () {\n    return this.layerRenderers_;\n  };\n\n  /**\n   * @return {import(\"../PluggableMap.js\").default} Map.\n   */\n  MapRenderer.prototype.getMap = function getMap () {\n    return this.map_;\n  };\n\n  /**\n   * Handle changes in a layer renderer.\n   * @private\n   */\n  MapRenderer.prototype.handleLayerRendererChange_ = function handleLayerRendererChange_ () {\n    this.map_.render();\n  };\n\n  /**\n   * @param {string} layerKey Layer key.\n   * @return {import(\"./Layer.js\").default} Layer renderer.\n   * @private\n   */\n  MapRenderer.prototype.removeLayerRendererByKey_ = function removeLayerRendererByKey_ (layerKey) {\n    var layerRenderer = this.layerRenderers_[layerKey];\n    delete this.layerRenderers_[layerKey];\n\n    unlistenByKey(this.layerRendererListeners_[layerKey]);\n    delete this.layerRendererListeners_[layerKey];\n\n    return layerRenderer;\n  };\n\n  /**\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @private\n   */\n  MapRenderer.prototype.removeUnusedLayerRenderers_ = function removeUnusedLayerRenderers_ (map, frameState) {\n    for (var layerKey in this.layerRenderers_) {\n      if (!frameState || !(layerKey in frameState.layerStates)) {\n        this.removeLayerRendererByKey_(layerKey).dispose();\n      }\n    }\n  };\n\n  /**\n   * Render.\n   * @abstract\n   * @param {?import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  MapRenderer.prototype.renderFrame = function renderFrame (frameState) {\n    abstract();\n  };\n\n  /**\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @protected\n   */\n  MapRenderer.prototype.scheduleExpireIconCache = function scheduleExpireIconCache (frameState) {\n    frameState.postRenderFunctions.push(/** @type {import(\"../PluggableMap.js\").PostRenderFunction} */ (expireIconCache));\n  };\n\n  /**\n   * @param {!import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @protected\n   */\n  MapRenderer.prototype.scheduleRemoveUnusedLayerRenderers = function scheduleRemoveUnusedLayerRenderers (frameState) {\n    for (var layerKey in this.layerRenderers_) {\n      if (!(layerKey in frameState.layerStates)) {\n        frameState.postRenderFunctions.push(\n          /** @type {import(\"../PluggableMap.js\").PostRenderFunction} */ (this.removeUnusedLayerRenderers_.bind(this))\n        );\n        return;\n      }\n    }\n  };\n\n  return MapRenderer;\n}(Disposable));\n\n\n/**\n * @param {import(\"../PluggableMap.js\").default} map Map.\n * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n */\nfunction expireIconCache(map, frameState) {\n  iconImageCache.expire();\n}\n\n\n/**\n * @param {import(\"../layer/Layer.js\").State} state1 First layer state.\n * @param {import(\"../layer/Layer.js\").State} state2 Second layer state.\n * @return {number} The zIndex difference.\n */\nexport function sortByZIndex(state1, state2) {\n  return state1.zIndex - state2.zIndex;\n}\nexport default MapRenderer;\n\n//# sourceMappingURL=Map.js.map","/**\n * @module ol/renderer/canvas/Map\n */\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\nimport {includes, stableSort} from '../../array.js';\nimport {CLASS_UNSELECTABLE} from '../../css.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {visibleAtResolution} from '../../layer/Layer.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport MapRenderer, {sortByZIndex} from '../Map.js';\nimport SourceState from '../../source/State.js';\n\n\n/**\n * @type {Array<typeof import(\"../Layer.js\").default>}\n */\nexport var layerRendererConstructors = [];\n\n/**\n * @classdesc\n * Canvas map renderer.\n * @api\n */\nvar CanvasMapRenderer = /*@__PURE__*/(function (MapRenderer) {\n  function CanvasMapRenderer(map) {\n    MapRenderer.call(this, map);\n\n    var container = map.getViewport();\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context_ = createCanvasContext2D();\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = this.context_.canvas;\n\n    this.canvas_.style.width = '100%';\n    this.canvas_.style.height = '100%';\n    this.canvas_.style.display = 'block';\n    this.canvas_.className = CLASS_UNSELECTABLE;\n    container.insertBefore(this.canvas_, container.childNodes[0] || null);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderedVisible_ = true;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.transform_ = createTransform();\n\n  }\n\n  if ( MapRenderer ) CanvasMapRenderer.__proto__ = MapRenderer;\n  CanvasMapRenderer.prototype = Object.create( MapRenderer && MapRenderer.prototype );\n  CanvasMapRenderer.prototype.constructor = CanvasMapRenderer;\n\n  /**\n   * @param {import(\"../../render/EventType.js\").default} type Event type.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  CanvasMapRenderer.prototype.dispatchRenderEvent = function dispatchRenderEvent (type, frameState) {\n    var map = this.getMap();\n    var context = this.context_;\n    if (map.hasListener(type)) {\n      var extent = frameState.extent;\n      var pixelRatio = frameState.pixelRatio;\n      var viewState = frameState.viewState;\n      var rotation = viewState.rotation;\n\n      var transform = this.getTransform(frameState);\n\n      var vectorContext = new CanvasImmediateRenderer(context, pixelRatio,\n        extent, transform, rotation);\n      var composeEvent = new RenderEvent(type, vectorContext,\n        frameState, context, null);\n      map.dispatchEvent(composeEvent);\n    }\n  };\n\n  /**\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @protected\n   * @return {!import(\"../../transform.js\").Transform} Transform.\n   */\n  CanvasMapRenderer.prototype.getTransform = function getTransform (frameState) {\n    var viewState = frameState.viewState;\n    var dx1 = this.canvas_.width / 2;\n    var dy1 = this.canvas_.height / 2;\n    var sx = frameState.pixelRatio / viewState.resolution;\n    var sy = -sx;\n    var angle = -viewState.rotation;\n    var dx2 = -viewState.center[0];\n    var dy2 = -viewState.center[1];\n    return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasMapRenderer.prototype.renderFrame = function renderFrame (frameState) {\n\n    if (!frameState) {\n      if (this.renderedVisible_) {\n        this.canvas_.style.display = 'none';\n        this.renderedVisible_ = false;\n      }\n      return;\n    }\n\n    var context = this.context_;\n    var pixelRatio = frameState.pixelRatio;\n    var width = Math.round(frameState.size[0] * pixelRatio);\n    var height = Math.round(frameState.size[1] * pixelRatio);\n    if (this.canvas_.width != width || this.canvas_.height != height) {\n      this.canvas_.width = width;\n      this.canvas_.height = height;\n    } else {\n      context.clearRect(0, 0, width, height);\n    }\n\n    var rotation = frameState.viewState.rotation;\n\n    this.calculateMatrices2D(frameState);\n\n    this.dispatchRenderEvent(RenderEventType.PRECOMPOSE, frameState);\n\n    var layerStatesArray = frameState.layerStatesArray;\n    stableSort(layerStatesArray, sortByZIndex);\n\n    if (rotation) {\n      context.save();\n      rotateAtOffset(context, rotation, width / 2, height / 2);\n    }\n\n    var viewResolution = frameState.viewState.resolution;\n    var i, ii;\n    for (i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      var layerState = layerStatesArray[i];\n      var layer = layerState.layer;\n      var layerRenderer = /** @type {import(\"./Layer.js\").default} */ (this.getLayerRenderer(layer));\n      if (!visibleAtResolution(layerState, viewResolution) ||\n          layerState.sourceState != SourceState.READY) {\n        continue;\n      }\n      if (layerRenderer.prepareFrame(frameState, layerState)) {\n        layerRenderer.composeFrame(frameState, layerState, context);\n      }\n    }\n\n    if (rotation) {\n      context.restore();\n    }\n\n    this.dispatchRenderEvent(RenderEventType.POSTCOMPOSE, frameState);\n\n    if (!this.renderedVisible_) {\n      this.canvas_.style.display = '';\n      this.renderedVisible_ = true;\n    }\n\n    this.scheduleRemoveUnusedLayerRenderers(frameState);\n    this.scheduleExpireIconCache(frameState);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasMapRenderer.prototype.forEachLayerAtPixel = function forEachLayerAtPixel (pixel, frameState, hitTolerance, callback, thisArg, layerFilter, thisArg2) {\n    var result;\n    var viewState = frameState.viewState;\n    var viewResolution = viewState.resolution;\n\n    var layerStates = frameState.layerStatesArray;\n    var numLayers = layerStates.length;\n\n    var coordinate = applyTransform(\n      frameState.pixelToCoordinateTransform, pixel.slice());\n\n    var i;\n    for (i = numLayers - 1; i >= 0; --i) {\n      var layerState = layerStates[i];\n      var layer = layerState.layer;\n      if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n        var layerRenderer = /** @type {import(\"./Layer.js\").default} */ (this.getLayerRenderer(layer));\n        result = layerRenderer.forEachLayerAtCoordinate(\n          coordinate, frameState, hitTolerance, callback, thisArg);\n        if (result) {\n          return result;\n        }\n      }\n    }\n    return undefined;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasMapRenderer.prototype.registerLayerRenderers = function registerLayerRenderers (constructors) {\n    MapRenderer.prototype.registerLayerRenderers.call(this, constructors);\n    for (var i = 0, ii = constructors.length; i < ii; ++i) {\n      var ctor = constructors[i];\n      if (!includes(layerRendererConstructors, ctor)) {\n        layerRendererConstructors.push(ctor);\n      }\n    }\n  };\n\n  return CanvasMapRenderer;\n}(MapRenderer));\n\n\nexport default CanvasMapRenderer;\n\n//# sourceMappingURL=Map.js.map","/**\n * @module ol/render/replay\n */\nimport ReplayType from './ReplayType.js';\n\n\n/**\n * @const\n * @type {Array<ReplayType>}\n */\nexport var ORDER = [\n  ReplayType.POLYGON,\n  ReplayType.CIRCLE,\n  ReplayType.LINE_STRING,\n  ReplayType.IMAGE,\n  ReplayType.TEXT,\n  ReplayType.DEFAULT\n];\n\n/**\n * @const\n * @enum {number}\n */\nexport var TEXT_ALIGN = {};\nTEXT_ALIGN['left'] = 0;\nTEXT_ALIGN['end'] = 0;\nTEXT_ALIGN['center'] = 0.5;\nTEXT_ALIGN['right'] = 1;\nTEXT_ALIGN['start'] = 1;\nTEXT_ALIGN['top'] = 0;\nTEXT_ALIGN['middle'] = 0.5;\nTEXT_ALIGN['hanging'] = 0.2;\nTEXT_ALIGN['alphabetic'] = 0.8;\nTEXT_ALIGN['ideographic'] = 0.8;\nTEXT_ALIGN['bottom'] = 1;\n\n//# sourceMappingURL=replay.js.map","/**\n * @module ol/render/ReplayType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CIRCLE: 'Circle',\n  DEFAULT: 'Default',\n  IMAGE: 'Image',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  TEXT: 'Text'\n};\n\n//# sourceMappingURL=ReplayType.js.map","/**\n * @module ol/reproj/common\n */\n\n/**\n * Default maximum allowed threshold  (in pixels) for reprojection\n * triangulation.\n * @type {number}\n */\nexport var ERROR_THRESHOLD = 0.5;\n\n/**\n * Enable automatic reprojection of raster sources. Default is `true`.\n * TODO: decide if we want to expose this as a build flag or remove it\n * @type {boolean}\n */\nexport var ENABLE_RASTER_REPROJECTION = true;\n\n//# sourceMappingURL=common.js.map","/**\n * @module ol/resolutionconstraint\n */\nimport {linearFindNearest} from './array.js';\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number, number): (number|undefined)} Type\n */\n\n\n/**\n * @param {Array<number>} resolutions Resolutions.\n * @return {Type} Zoom function.\n */\nexport function createSnapToResolutions(resolutions) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        var z = linearFindNearest(resolutions, resolution, direction);\n        z = clamp(z + delta, 0, resolutions.length - 1);\n        var index = Math.floor(z);\n        if (z != index && index < resolutions.length - 1) {\n          var power = resolutions[index] / resolutions[index + 1];\n          return resolutions[index] / Math.pow(power, z - index);\n        } else {\n          return resolutions[index];\n        }\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {number} power Power.\n * @param {number} maxResolution Maximum resolution.\n * @param {number=} opt_maxLevel Maximum level.\n * @return {Type} Zoom function.\n */\nexport function createSnapToPower(power, maxResolution, opt_maxLevel) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        var offset = -direction / 2 + 0.5;\n        var oldLevel = Math.floor(\n          Math.log(maxResolution / resolution) / Math.log(power) + offset);\n        var newLevel = Math.max(oldLevel + delta, 0);\n        if (opt_maxLevel !== undefined) {\n          newLevel = Math.min(newLevel, opt_maxLevel);\n        }\n        return maxResolution / Math.pow(power, newLevel);\n      } else {\n        return undefined;\n      }\n    });\n}\n\n//# sourceMappingURL=resolutionconstraint.js.map","/**\n * @module ol/pointer/MsSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport EventSource from './EventSource.js';\n\n\n/**\n * @const\n * @type {Array<string>}\n */\nvar POINTER_TYPES = [\n  '',\n  'unavailable',\n  'touch',\n  'pen',\n  'mouse'\n];\n\n/**\n * Handler for `msPointerDown`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msPointerDown(inEvent) {\n  this.pointerMap[inEvent.pointerId.toString()] = inEvent;\n  var e = this.prepareEvent_(inEvent);\n  this.dispatcher.down(e, inEvent);\n}\n\n/**\n * Handler for `msPointerMove`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msPointerMove(inEvent) {\n  var e = this.prepareEvent_(inEvent);\n  this.dispatcher.move(e, inEvent);\n}\n\n/**\n * Handler for `msPointerUp`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msPointerUp(inEvent) {\n  var e = this.prepareEvent_(inEvent);\n  this.dispatcher.up(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n}\n\n/**\n * Handler for `msPointerOut`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msPointerOut(inEvent) {\n  var e = this.prepareEvent_(inEvent);\n  this.dispatcher.leaveOut(e, inEvent);\n}\n\n/**\n * Handler for `msPointerOver`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msPointerOver(inEvent) {\n  var e = this.prepareEvent_(inEvent);\n  this.dispatcher.enterOver(e, inEvent);\n}\n\n/**\n * Handler for `msPointerCancel`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msPointerCancel(inEvent) {\n  var e = this.prepareEvent_(inEvent);\n  this.dispatcher.cancel(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n}\n\n/**\n * Handler for `msLostPointerCapture`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msLostPointerCapture(inEvent) {\n  var e = this.dispatcher.makeEvent('lostpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n}\n\n/**\n * Handler for `msGotPointerCapture`.\n *\n * @this {MsSource}\n * @param {MSPointerEvent} inEvent The in event.\n */\nfunction msGotPointerCapture(inEvent) {\n  var e = this.dispatcher.makeEvent('gotpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n}\n\nvar MsSource = /*@__PURE__*/(function (EventSource) {\n  function MsSource(dispatcher) {\n    var mapping = {\n      'MSPointerDown': msPointerDown,\n      'MSPointerMove': msPointerMove,\n      'MSPointerUp': msPointerUp,\n      'MSPointerOut': msPointerOut,\n      'MSPointerOver': msPointerOver,\n      'MSPointerCancel': msPointerCancel,\n      'MSGotPointerCapture': msGotPointerCapture,\n      'MSLostPointerCapture': msLostPointerCapture\n    };\n    EventSource.call(this, dispatcher, mapping);\n\n    /**\n     * @const\n     * @type {!Object<string, MSPointerEvent|Object>}\n     */\n    this.pointerMap = dispatcher.pointerMap;\n  }\n\n  if ( EventSource ) MsSource.__proto__ = EventSource;\n  MsSource.prototype = Object.create( EventSource && EventSource.prototype );\n  MsSource.prototype.constructor = MsSource;\n\n  /**\n   * Creates a copy of the original event that will be used\n   * for the fake pointer event.\n   *\n   * @private\n   * @param {MSPointerEvent} inEvent The in event.\n   * @return {Object} The copied event.\n   */\n  MsSource.prototype.prepareEvent_ = function prepareEvent_ (inEvent) {\n    /** @type {MSPointerEvent|Object} */\n    var e = inEvent;\n    if (typeof inEvent.pointerType === 'number') {\n      e = this.dispatcher.cloneEvent(inEvent, inEvent);\n      e.pointerType = POINTER_TYPES[inEvent.pointerType];\n    }\n\n    return e;\n  };\n\n  /**\n   * Remove this pointer from the list of active pointers.\n   * @param {number} pointerId Pointer identifier.\n   */\n  MsSource.prototype.cleanup = function cleanup (pointerId) {\n    delete this.pointerMap[pointerId.toString()];\n  };\n\n  return MsSource;\n}(EventSource));\n\nexport default MsSource;\n\n//# sourceMappingURL=MsSource.js.map","/**\n * @module ol/pointer/NativeSource\n */\n\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport EventSource from './EventSource.js';\n\n/**\n * Handler for `pointerdown`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction pointerDown(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\n/**\n * Handler for `pointermove`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction pointerMove(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\n/**\n * Handler for `pointerup`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction pointerUp(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\n/**\n * Handler for `pointerout`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction pointerOut(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\n/**\n * Handler for `pointerover`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction pointerOver(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\n/**\n * Handler for `pointercancel`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction pointerCancel(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\n/**\n * Handler for `lostpointercapture`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction lostPointerCapture(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\n/**\n * Handler for `gotpointercapture`.\n *\n * @this {NativeSource}\n * @param {Event} inEvent The in event.\n */\nfunction gotPointerCapture(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n}\n\nvar NativeSource = /*@__PURE__*/(function (EventSource) {\n  function NativeSource(dispatcher) {\n    var mapping = {\n      'pointerdown': pointerDown,\n      'pointermove': pointerMove,\n      'pointerup': pointerUp,\n      'pointerout': pointerOut,\n      'pointerover': pointerOver,\n      'pointercancel': pointerCancel,\n      'gotpointercapture': gotPointerCapture,\n      'lostpointercapture': lostPointerCapture\n    };\n    EventSource.call(this, dispatcher, mapping);\n  }\n\n  if ( EventSource ) NativeSource.__proto__ = EventSource;\n  NativeSource.prototype = Object.create( EventSource && EventSource.prototype );\n  NativeSource.prototype.constructor = NativeSource;\n\n  return NativeSource;\n}(EventSource));\n\nexport default NativeSource;\n\n//# sourceMappingURL=NativeSource.js.map","/**\n * @module ol/pointer/PointerEvent\n */\n\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport _Event from '../events/Event.js';\n\n\n/**\n * Is the `buttons` property supported?\n * @type {boolean}\n */\nvar HAS_BUTTONS = false;\n\n\nvar PointerEvent = /*@__PURE__*/(function (_Event) {\n  function PointerEvent(type, originalEvent, opt_eventDict) {\n    _Event.call(this, type);\n\n    /**\n     * @const\n     * @type {Event}\n     */\n    this.originalEvent = originalEvent;\n\n    var eventDict = opt_eventDict ? opt_eventDict : {};\n\n    /**\n     * @type {number}\n     */\n    this.buttons = getButtons(eventDict);\n\n    /**\n     * @type {number}\n     */\n    this.pressure = getPressure(eventDict, this.buttons);\n\n    // MouseEvent related properties\n\n    /**\n     * @type {boolean}\n     */\n    this.bubbles = 'bubbles' in eventDict ? eventDict['bubbles'] : false;\n\n    /**\n     * @type {boolean}\n     */\n    this.cancelable = 'cancelable' in eventDict ? eventDict['cancelable'] : false;\n\n    /**\n     * @type {Object}\n     */\n    this.view = 'view' in eventDict ? eventDict['view'] : null;\n\n    /**\n     * @type {number}\n     */\n    this.detail = 'detail' in eventDict ? eventDict['detail'] : null;\n\n    /**\n     * @type {number}\n     */\n    this.screenX = 'screenX' in eventDict ? eventDict['screenX'] : 0;\n\n    /**\n     * @type {number}\n     */\n    this.screenY = 'screenY' in eventDict ? eventDict['screenY'] : 0;\n\n    /**\n     * @type {number}\n     */\n    this.clientX = 'clientX' in eventDict ? eventDict['clientX'] : 0;\n\n    /**\n     * @type {number}\n     */\n    this.clientY = 'clientY' in eventDict ? eventDict['clientY'] : 0;\n\n    /**\n     * @type {boolean}\n     */\n    this.ctrlKey = 'ctrlKey' in eventDict ? eventDict['ctrlKey'] : false;\n\n    /**\n     * @type {boolean}\n     */\n    this.altKey = 'altKey' in eventDict ? eventDict['altKey'] : false;\n\n    /**\n     * @type {boolean}\n     */\n    this.shiftKey = 'shiftKey' in eventDict ? eventDict['shiftKey'] : false;\n\n    /**\n     * @type {boolean}\n     */\n    this.metaKey = 'metaKey' in eventDict ? eventDict['metaKey'] : false;\n\n    /**\n     * @type {number}\n     */\n    this.button = 'button' in eventDict ? eventDict['button'] : 0;\n\n    /**\n     * @type {Node}\n     */\n    this.relatedTarget = 'relatedTarget' in eventDict ?\n      eventDict['relatedTarget'] : null;\n\n    // PointerEvent related properties\n\n    /**\n     * @const\n     * @type {number}\n     */\n    this.pointerId = 'pointerId' in eventDict ? eventDict['pointerId'] : 0;\n\n    /**\n     * @type {number}\n     */\n    this.width = 'width' in eventDict ? eventDict['width'] : 0;\n\n    /**\n     * @type {number}\n     */\n    this.height = 'height' in eventDict ? eventDict['height'] : 0;\n\n    /**\n     * @type {number}\n     */\n    this.tiltX = 'tiltX' in eventDict ? eventDict['tiltX'] : 0;\n\n    /**\n     * @type {number}\n     */\n    this.tiltY = 'tiltY' in eventDict ? eventDict['tiltY'] : 0;\n\n    /**\n     * @type {string}\n     */\n    this.pointerType = 'pointerType' in eventDict ? eventDict['pointerType'] : '';\n\n    /**\n     * @type {number}\n     */\n    this.hwTimestamp = 'hwTimestamp' in eventDict ? eventDict['hwTimestamp'] : 0;\n\n    /**\n     * @type {boolean}\n     */\n    this.isPrimary = 'isPrimary' in eventDict ? eventDict['isPrimary'] : false;\n\n    // keep the semantics of preventDefault\n    if (originalEvent.preventDefault) {\n      this.preventDefault = function() {\n        originalEvent.preventDefault();\n      };\n    }\n  }\n\n  if ( _Event ) PointerEvent.__proto__ = _Event;\n  PointerEvent.prototype = Object.create( _Event && _Event.prototype );\n  PointerEvent.prototype.constructor = PointerEvent;\n\n  return PointerEvent;\n}(_Event));\n\n\n/**\n * @param {Object<string, ?>} eventDict The event dictionary.\n * @return {number} Button indicator.\n */\nfunction getButtons(eventDict) {\n  // According to the w3c spec,\n  // http://www.w3.org/TR/DOM-Level-3-Events/#events-MouseEvent-button\n  // MouseEvent.button == 0 can mean either no mouse button depressed, or the\n  // left mouse button depressed.\n  //\n  // As of now, the only way to distinguish between the two states of\n  // MouseEvent.button is by using the deprecated MouseEvent.which property, as\n  // this maps mouse buttons to positive integers > 0, and uses 0 to mean that\n  // no mouse button is held.\n  //\n  // MouseEvent.which is derived from MouseEvent.button at MouseEvent creation,\n  // but initMouseEvent does not expose an argument with which to set\n  // MouseEvent.which. Calling initMouseEvent with a buttonArg of 0 will set\n  // MouseEvent.button == 0 and MouseEvent.which == 1, breaking the expectations\n  // of app developers.\n  //\n  // The only way to propagate the correct state of MouseEvent.which and\n  // MouseEvent.button to a new MouseEvent.button == 0 and MouseEvent.which == 0\n  // is to call initMouseEvent with a buttonArg value of -1.\n  //\n  // This is fixed with DOM Level 4's use of buttons\n  var buttons;\n  if (eventDict.buttons || HAS_BUTTONS) {\n    buttons = eventDict.buttons;\n  } else {\n    switch (eventDict.which) {\n      case 1: buttons = 1; break;\n      case 2: buttons = 4; break;\n      case 3: buttons = 2; break;\n      default: buttons = 0;\n    }\n  }\n  return buttons;\n}\n\n\n/**\n * @param {Object<string, ?>} eventDict The event dictionary.\n * @param {number} buttons Button indicator.\n * @return {number} The pressure.\n */\nfunction getPressure(eventDict, buttons) {\n  // Spec requires that pointers without pressure specified use 0.5 for down\n  // state and 0 for up state.\n  var pressure = 0;\n  if (eventDict.pressure) {\n    pressure = eventDict.pressure;\n  } else {\n    pressure = buttons ? 0.5 : 0;\n  }\n  return pressure;\n}\n\n\n/**\n * Checks if the `buttons` property is supported.\n */\n(function() {\n  try {\n    var ev = new MouseEvent('click', {buttons: 1});\n    HAS_BUTTONS = ev.buttons === 1;\n  } catch (e) {\n    // pass\n  }\n})();\n\nexport default PointerEvent;\n\n//# sourceMappingURL=PointerEvent.js.map","/**\n * @module ol/pointer/TouchSource\n */\n\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {remove} from '../array.js';\nimport EventSource from './EventSource.js';\nimport {POINTER_ID} from './MouseSource.js';\n\n\n/**\n * @type {number}\n */\nvar CLICK_COUNT_TIMEOUT = 200;\n\n/**\n * @type {string}\n */\nvar POINTER_TYPE = 'touch';\n\n/**\n * Handler for `touchstart`, triggers `pointerover`,\n * `pointerenter` and `pointerdown` events.\n *\n * @this {TouchSource}\n * @param {TouchEvent} inEvent The in event.\n */\nfunction touchstart(inEvent) {\n  this.vacuumTouches_(inEvent);\n  this.setPrimaryTouch_(inEvent.changedTouches[0]);\n  this.dedupSynthMouse_(inEvent);\n  this.clickCount_++;\n  this.processTouches_(inEvent, this.overDown_);\n}\n\n/**\n * Handler for `touchmove`.\n *\n * @this {TouchSource}\n * @param {TouchEvent} inEvent The in event.\n */\nfunction touchmove(inEvent) {\n  this.processTouches_(inEvent, this.moveOverOut_);\n}\n\n/**\n * Handler for `touchend`, triggers `pointerup`,\n * `pointerout` and `pointerleave` events.\n *\n * @this {TouchSource}\n * @param {TouchEvent} inEvent The event.\n */\nfunction touchend(inEvent) {\n  this.dedupSynthMouse_(inEvent);\n  this.processTouches_(inEvent, this.upOut_);\n}\n\n/**\n * Handler for `touchcancel`, triggers `pointercancel`,\n * `pointerout` and `pointerleave` events.\n *\n * @this {TouchSource}\n * @param {TouchEvent} inEvent The in event.\n */\nfunction touchcancel(inEvent) {\n  this.processTouches_(inEvent, this.cancelOut_);\n}\n\n\nvar TouchSource = /*@__PURE__*/(function (EventSource) {\n  function TouchSource(dispatcher, mouseSource) {\n    var mapping = {\n      'touchstart': touchstart,\n      'touchmove': touchmove,\n      'touchend': touchend,\n      'touchcancel': touchcancel\n    };\n    EventSource.call(this, dispatcher, mapping);\n\n    /**\n     * @const\n     * @type {!Object<string, Event|Object>}\n     */\n    this.pointerMap = dispatcher.pointerMap;\n\n    /**\n     * @const\n     * @type {import(\"./MouseSource.js\").default}\n     */\n    this.mouseSource = mouseSource;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.firstTouchId_ = undefined;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.clickCount_ = 0;\n\n    /**\n     * @private\n     * @type {?}\n     */\n    this.resetId_;\n\n    /**\n     * Mouse event timeout: This should be long enough to\n     * ignore compat mouse events made by touch.\n     * @private\n     * @type {number}\n     */\n    this.dedupTimeout_ = 2500;\n  }\n\n  if ( EventSource ) TouchSource.__proto__ = EventSource;\n  TouchSource.prototype = Object.create( EventSource && EventSource.prototype );\n  TouchSource.prototype.constructor = TouchSource;\n\n  /**\n   * @private\n   * @param {Touch} inTouch The in touch.\n   * @return {boolean} True, if this is the primary touch.\n   */\n  TouchSource.prototype.isPrimaryTouch_ = function isPrimaryTouch_ (inTouch) {\n    return this.firstTouchId_ === inTouch.identifier;\n  };\n\n  /**\n   * Set primary touch if there are no pointers, or the only pointer is the mouse.\n   * @param {Touch} inTouch The in touch.\n   * @private\n   */\n  TouchSource.prototype.setPrimaryTouch_ = function setPrimaryTouch_ (inTouch) {\n    var count = Object.keys(this.pointerMap).length;\n    if (count === 0 || (count === 1 && POINTER_ID.toString() in this.pointerMap)) {\n      this.firstTouchId_ = inTouch.identifier;\n      this.cancelResetClickCount_();\n    }\n  };\n\n  /**\n   * @private\n   * @param {PointerEvent} inPointer The in pointer object.\n   */\n  TouchSource.prototype.removePrimaryPointer_ = function removePrimaryPointer_ (inPointer) {\n    if (inPointer.isPrimary) {\n      this.firstTouchId_ = undefined;\n      this.resetClickCount_();\n    }\n  };\n\n  /**\n   * @private\n   */\n  TouchSource.prototype.resetClickCount_ = function resetClickCount_ () {\n    this.resetId_ = setTimeout(\n      this.resetClickCountHandler_.bind(this),\n      CLICK_COUNT_TIMEOUT);\n  };\n\n  /**\n   * @private\n   */\n  TouchSource.prototype.resetClickCountHandler_ = function resetClickCountHandler_ () {\n    this.clickCount_ = 0;\n    this.resetId_ = undefined;\n  };\n\n  /**\n   * @private\n   */\n  TouchSource.prototype.cancelResetClickCount_ = function cancelResetClickCount_ () {\n    if (this.resetId_ !== undefined) {\n      clearTimeout(this.resetId_);\n    }\n  };\n\n  /**\n   * @private\n   * @param {TouchEvent} browserEvent Browser event\n   * @param {Touch} inTouch Touch event\n   * @return {PointerEvent} A pointer object.\n   */\n  TouchSource.prototype.touchToPointer_ = function touchToPointer_ (browserEvent, inTouch) {\n    var e = this.dispatcher.cloneEvent(browserEvent, inTouch);\n    // Spec specifies that pointerId 1 is reserved for Mouse.\n    // Touch identifiers can start at 0.\n    // Add 2 to the touch identifier for compatibility.\n    e.pointerId = inTouch.identifier + 2;\n    // TODO: check if this is necessary?\n    //e.target = findTarget(e);\n    e.bubbles = true;\n    e.cancelable = true;\n    e.detail = this.clickCount_;\n    e.button = 0;\n    e.buttons = 1;\n    e.width = inTouch.radiusX || 0;\n    e.height = inTouch.radiusY || 0;\n    e.pressure = inTouch.force || 0.5;\n    e.isPrimary = this.isPrimaryTouch_(inTouch);\n    e.pointerType = POINTER_TYPE;\n\n    // make sure that the properties that are different for\n    // each `Touch` object are not copied from the BrowserEvent object\n    e.clientX = inTouch.clientX;\n    e.clientY = inTouch.clientY;\n    e.screenX = inTouch.screenX;\n    e.screenY = inTouch.screenY;\n\n    return e;\n  };\n\n  /**\n   * @private\n   * @param {TouchEvent} inEvent Touch event\n   * @param {function(TouchEvent, PointerEvent)} inFunction In function.\n   */\n  TouchSource.prototype.processTouches_ = function processTouches_ (inEvent, inFunction) {\n    var touches = Array.prototype.slice.call(inEvent.changedTouches);\n    var count = touches.length;\n    function preventDefault() {\n      inEvent.preventDefault();\n    }\n    for (var i = 0; i < count; ++i) {\n      var pointer = this.touchToPointer_(inEvent, touches[i]);\n      // forward touch preventDefaults\n      pointer.preventDefault = preventDefault;\n      inFunction.call(this, inEvent, pointer);\n    }\n  };\n\n  /**\n   * @private\n   * @param {TouchList} touchList The touch list.\n   * @param {number} searchId Search identifier.\n   * @return {boolean} True, if the `Touch` with the given id is in the list.\n   */\n  TouchSource.prototype.findTouch_ = function findTouch_ (touchList, searchId) {\n    var l = touchList.length;\n    for (var i = 0; i < l; i++) {\n      var touch = touchList[i];\n      if (touch.identifier === searchId) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n   * In some instances, a touchstart can happen without a touchend. This\n   * leaves the pointermap in a broken state.\n   * Therefore, on every touchstart, we remove the touches that did not fire a\n   * touchend event.\n   * To keep state globally consistent, we fire a pointercancel for\n   * this \"abandoned\" touch\n   *\n   * @private\n   * @param {TouchEvent} inEvent The in event.\n   */\n  TouchSource.prototype.vacuumTouches_ = function vacuumTouches_ (inEvent) {\n    var touchList = inEvent.touches;\n    // pointerMap.getCount() should be < touchList.length here,\n    // as the touchstart has not been processed yet.\n    var keys = Object.keys(this.pointerMap);\n    var count = keys.length;\n    if (count >= touchList.length) {\n      var d = [];\n      for (var i = 0; i < count; ++i) {\n        var key = Number(keys[i]);\n        var value = this.pointerMap[key];\n        // Never remove pointerId == 1, which is mouse.\n        // Touch identifiers are 2 smaller than their pointerId, which is the\n        // index in pointermap.\n        if (key != POINTER_ID && !this.findTouch_(touchList, key - 2)) {\n          d.push(value.out);\n        }\n      }\n      for (var i$1 = 0; i$1 < d.length; ++i$1) {\n        this.cancelOut_(inEvent, d[i$1]);\n      }\n    }\n  };\n\n  /**\n   * @private\n   * @param {TouchEvent} browserEvent The event.\n   * @param {PointerEvent} inPointer The in pointer object.\n   */\n  TouchSource.prototype.overDown_ = function overDown_ (browserEvent, inPointer) {\n    this.pointerMap[inPointer.pointerId] = {\n      target: inPointer.target,\n      out: inPointer,\n      outTarget: inPointer.target\n    };\n    this.dispatcher.over(inPointer, browserEvent);\n    this.dispatcher.enter(inPointer, browserEvent);\n    this.dispatcher.down(inPointer, browserEvent);\n  };\n\n  /**\n   * @private\n   * @param {TouchEvent} browserEvent The event.\n   * @param {PointerEvent} inPointer The in pointer.\n   */\n  TouchSource.prototype.moveOverOut_ = function moveOverOut_ (browserEvent, inPointer) {\n    var event = inPointer;\n    var pointer = this.pointerMap[event.pointerId];\n    // a finger drifted off the screen, ignore it\n    if (!pointer) {\n      return;\n    }\n    var outEvent = pointer.out;\n    var outTarget = pointer.outTarget;\n    this.dispatcher.move(event, browserEvent);\n    if (outEvent && outTarget !== event.target) {\n      outEvent.relatedTarget = event.target;\n      /** @type {Object} */ (event).relatedTarget = outTarget;\n      // recover from retargeting by shadow\n      outEvent.target = outTarget;\n      if (event.target) {\n        this.dispatcher.leaveOut(outEvent, browserEvent);\n        this.dispatcher.enterOver(event, browserEvent);\n      } else {\n        // clean up case when finger leaves the screen\n        /** @type {Object} */ (event).target = outTarget;\n        /** @type {Object} */ (event).relatedTarget = null;\n        this.cancelOut_(browserEvent, event);\n      }\n    }\n    pointer.out = event;\n    pointer.outTarget = event.target;\n  };\n\n  /**\n   * @private\n   * @param {TouchEvent} browserEvent An event.\n   * @param {PointerEvent} inPointer The inPointer object.\n   */\n  TouchSource.prototype.upOut_ = function upOut_ (browserEvent, inPointer) {\n    this.dispatcher.up(inPointer, browserEvent);\n    this.dispatcher.out(inPointer, browserEvent);\n    this.dispatcher.leave(inPointer, browserEvent);\n    this.cleanUpPointer_(inPointer);\n  };\n\n  /**\n   * @private\n   * @param {TouchEvent} browserEvent The event.\n   * @param {PointerEvent} inPointer The in pointer.\n   */\n  TouchSource.prototype.cancelOut_ = function cancelOut_ (browserEvent, inPointer) {\n    this.dispatcher.cancel(inPointer, browserEvent);\n    this.dispatcher.out(inPointer, browserEvent);\n    this.dispatcher.leave(inPointer, browserEvent);\n    this.cleanUpPointer_(inPointer);\n  };\n\n  /**\n   * @private\n   * @param {PointerEvent} inPointer The inPointer object.\n   */\n  TouchSource.prototype.cleanUpPointer_ = function cleanUpPointer_ (inPointer) {\n    delete this.pointerMap[inPointer.pointerId];\n    this.removePrimaryPointer_(inPointer);\n  };\n\n  /**\n   * Prevent synth mouse events from creating pointer events.\n   *\n   * @private\n   * @param {TouchEvent} inEvent The in event.\n   */\n  TouchSource.prototype.dedupSynthMouse_ = function dedupSynthMouse_ (inEvent) {\n    var lts = this.mouseSource.lastTouches;\n    var t = inEvent.changedTouches[0];\n    // only the primary finger will synth mouse events\n    if (this.isPrimaryTouch_(t)) {\n      // remember x/y of last touch\n      var lt = [t.clientX, t.clientY];\n      lts.push(lt);\n\n      setTimeout(function() {\n        // remove touch after timeout\n        remove(lts, lt);\n      }, this.dedupTimeout_);\n    }\n  };\n\n  return TouchSource;\n}(EventSource));\n\nexport default TouchSource;\n\n//# sourceMappingURL=TouchSource.js.map","/**\n * @module ol/pointer/PointerEventHandler\n */\n\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {listen, unlisten} from '../events.js';\nimport EventTarget from '../events/Target.js';\nimport {POINTER, MSPOINTER, TOUCH} from '../has.js';\nimport PointerEventType from './EventType.js';\nimport MouseSource, {prepareEvent as prepareMouseEvent} from './MouseSource.js';\nimport MsSource from './MsSource.js';\nimport NativeSource from './NativeSource.js';\nimport PointerEvent from './PointerEvent.js';\nimport TouchSource from './TouchSource.js';\n\n\n/**\n * Properties to copy when cloning an event, with default values.\n * @type {Array<Array>}\n */\nvar CLONE_PROPS = [\n  // MouseEvent\n  ['bubbles', false],\n  ['cancelable', false],\n  ['view', null],\n  ['detail', null],\n  ['screenX', 0],\n  ['screenY', 0],\n  ['clientX', 0],\n  ['clientY', 0],\n  ['ctrlKey', false],\n  ['altKey', false],\n  ['shiftKey', false],\n  ['metaKey', false],\n  ['button', 0],\n  ['relatedTarget', null],\n  // DOM Level 3\n  ['buttons', 0],\n  // PointerEvent\n  ['pointerId', 0],\n  ['width', 0],\n  ['height', 0],\n  ['pressure', 0],\n  ['tiltX', 0],\n  ['tiltY', 0],\n  ['pointerType', ''],\n  ['hwTimestamp', 0],\n  ['isPrimary', false],\n  // event instance\n  ['type', ''],\n  ['target', null],\n  ['currentTarget', null],\n  ['which', 0]\n];\n\n\nvar PointerEventHandler = /*@__PURE__*/(function (EventTarget) {\n  function PointerEventHandler(element) {\n    EventTarget.call(this);\n\n    /**\n     * @const\n     * @private\n     * @type {Element|HTMLDocument}\n     */\n    this.element_ = element;\n\n    /**\n     * @const\n     * @type {!Object<string, Event|Object>}\n     */\n    this.pointerMap = {};\n\n    /**\n     * @type {Object<string, function(Event)>}\n     * @private\n     */\n    this.eventMap_ = {};\n\n    /**\n     * @type {Array<import(\"./EventSource.js\").default>}\n     * @private\n     */\n    this.eventSourceList_ = [];\n\n    this.registerSources();\n  }\n\n  if ( EventTarget ) PointerEventHandler.__proto__ = EventTarget;\n  PointerEventHandler.prototype = Object.create( EventTarget && EventTarget.prototype );\n  PointerEventHandler.prototype.constructor = PointerEventHandler;\n\n  /**\n   * Set up the event sources (mouse, touch and native pointers)\n   * that generate pointer events.\n   */\n  PointerEventHandler.prototype.registerSources = function registerSources () {\n    if (POINTER) {\n      this.registerSource('native', new NativeSource(this));\n    } else if (MSPOINTER) {\n      this.registerSource('ms', new MsSource(this));\n    } else {\n      var mouseSource = new MouseSource(this);\n      this.registerSource('mouse', mouseSource);\n\n      if (TOUCH) {\n        this.registerSource('touch', new TouchSource(this, mouseSource));\n      }\n    }\n\n    // register events on the viewport element\n    this.register_();\n  };\n\n  /**\n   * Add a new event source that will generate pointer events.\n   *\n   * @param {string} name A name for the event source\n   * @param {import(\"./EventSource.js\").default} source The source event.\n   */\n  PointerEventHandler.prototype.registerSource = function registerSource (name, source) {\n    var s = source;\n    var newEvents = s.getEvents();\n\n    if (newEvents) {\n      newEvents.forEach(function(e) {\n        var handler = s.getHandlerForEvent(e);\n\n        if (handler) {\n          this.eventMap_[e] = handler.bind(s);\n        }\n      }.bind(this));\n      this.eventSourceList_.push(s);\n    }\n  };\n\n  /**\n   * Set up the events for all registered event sources.\n   * @private\n   */\n  PointerEventHandler.prototype.register_ = function register_ () {\n    var l = this.eventSourceList_.length;\n    for (var i = 0; i < l; i++) {\n      var eventSource = this.eventSourceList_[i];\n      this.addEvents_(eventSource.getEvents());\n    }\n  };\n\n  /**\n   * Remove all registered events.\n   * @private\n   */\n  PointerEventHandler.prototype.unregister_ = function unregister_ () {\n    var l = this.eventSourceList_.length;\n    for (var i = 0; i < l; i++) {\n      var eventSource = this.eventSourceList_[i];\n      this.removeEvents_(eventSource.getEvents());\n    }\n  };\n\n  /**\n   * Calls the right handler for a new event.\n   * @private\n   * @param {Event} inEvent Browser event.\n   */\n  PointerEventHandler.prototype.eventHandler_ = function eventHandler_ (inEvent) {\n    var type = inEvent.type;\n    var handler = this.eventMap_[type];\n    if (handler) {\n      handler(inEvent);\n    }\n  };\n\n  /**\n   * Setup listeners for the given events.\n   * @private\n   * @param {Array<string>} events List of events.\n   */\n  PointerEventHandler.prototype.addEvents_ = function addEvents_ (events) {\n    events.forEach(function(eventName) {\n      listen(this.element_, eventName, this.eventHandler_, this);\n    }.bind(this));\n  };\n\n  /**\n   * Unregister listeners for the given events.\n   * @private\n   * @param {Array<string>} events List of events.\n   */\n  PointerEventHandler.prototype.removeEvents_ = function removeEvents_ (events) {\n    events.forEach(function(e) {\n      unlisten(this.element_, e, this.eventHandler_, this);\n    }.bind(this));\n  };\n\n  /**\n   * Returns a snapshot of inEvent, with writable properties.\n   *\n   * @param {Event} event Browser event.\n   * @param {Event|Touch} inEvent An event that contains\n   *    properties to copy.\n   * @return {Object} An object containing shallow copies of\n   *    `inEvent`'s properties.\n   */\n  PointerEventHandler.prototype.cloneEvent = function cloneEvent (event, inEvent) {\n    var eventCopy = {};\n    for (var i = 0, ii = CLONE_PROPS.length; i < ii; i++) {\n      var p = CLONE_PROPS[i][0];\n      eventCopy[p] = event[p] || inEvent[p] || CLONE_PROPS[i][1];\n    }\n\n    return eventCopy;\n  };\n\n  // EVENTS\n\n\n  /**\n   * Triggers a 'pointerdown' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.down = function down (data, event) {\n    this.fireEvent(PointerEventType.POINTERDOWN, data, event);\n  };\n\n  /**\n   * Triggers a 'pointermove' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.move = function move (data, event) {\n    this.fireEvent(PointerEventType.POINTERMOVE, data, event);\n  };\n\n  /**\n   * Triggers a 'pointerup' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.up = function up (data, event) {\n    this.fireEvent(PointerEventType.POINTERUP, data, event);\n  };\n\n  /**\n   * Triggers a 'pointerenter' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.enter = function enter (data, event) {\n    data.bubbles = false;\n    this.fireEvent(PointerEventType.POINTERENTER, data, event);\n  };\n\n  /**\n   * Triggers a 'pointerleave' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.leave = function leave (data, event) {\n    data.bubbles = false;\n    this.fireEvent(PointerEventType.POINTERLEAVE, data, event);\n  };\n\n  /**\n   * Triggers a 'pointerover' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.over = function over (data, event) {\n    data.bubbles = true;\n    this.fireEvent(PointerEventType.POINTEROVER, data, event);\n  };\n\n  /**\n   * Triggers a 'pointerout' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.out = function out (data, event) {\n    data.bubbles = true;\n    this.fireEvent(PointerEventType.POINTEROUT, data, event);\n  };\n\n  /**\n   * Triggers a 'pointercancel' event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.cancel = function cancel (data, event) {\n    this.fireEvent(PointerEventType.POINTERCANCEL, data, event);\n  };\n\n  /**\n   * Triggers a combination of 'pointerout' and 'pointerleave' events.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.leaveOut = function leaveOut (data, event) {\n    this.out(data, event);\n    if (!this.contains_(data.target, data.relatedTarget)) {\n      this.leave(data, event);\n    }\n  };\n\n  /**\n   * Triggers a combination of 'pointerover' and 'pointerevents' events.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.enterOver = function enterOver (data, event) {\n    this.over(data, event);\n    if (!this.contains_(data.target, data.relatedTarget)) {\n      this.enter(data, event);\n    }\n  };\n\n  /**\n   * @private\n   * @param {Element} container The container element.\n   * @param {Element} contained The contained element.\n   * @return {boolean} Returns true if the container element\n   *   contains the other element.\n   */\n  PointerEventHandler.prototype.contains_ = function contains_ (container, contained) {\n    if (!container || !contained) {\n      return false;\n    }\n    return container.contains(contained);\n  };\n\n  // EVENT CREATION AND TRACKING\n  /**\n   * Creates a new Event of type `inType`, based on the information in\n   * `data`.\n   *\n   * @param {string} inType A string representing the type of event to create.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   * @return {PointerEvent} A PointerEvent of type `inType`.\n   */\n  PointerEventHandler.prototype.makeEvent = function makeEvent (inType, data, event) {\n    return new PointerEvent(inType, event, data);\n  };\n\n  /**\n   * Make and dispatch an event in one call.\n   * @param {string} inType A string representing the type of event.\n   * @param {Object} data Pointer event data.\n   * @param {Event} event The event.\n   */\n  PointerEventHandler.prototype.fireEvent = function fireEvent (inType, data, event) {\n    var e = this.makeEvent(inType, data, event);\n    this.dispatchEvent(e);\n  };\n\n  /**\n   * Creates a pointer event from a native pointer event\n   * and dispatches this event.\n   * @param {Event} event A platform event with a target.\n   */\n  PointerEventHandler.prototype.fireNativeEvent = function fireNativeEvent (event) {\n    var e = this.makeEvent(event.type, event, event);\n    this.dispatchEvent(e);\n  };\n\n  /**\n   * Wrap a native mouse event into a pointer event.\n   * This proxy method is required for the legacy IE support.\n   * @param {string} eventType The pointer event type.\n   * @param {Event} event The event.\n   * @return {PointerEvent} The wrapped event.\n   */\n  PointerEventHandler.prototype.wrapMouseEvent = function wrapMouseEvent (eventType, event) {\n    var pointerEvent = this.makeEvent(\n      eventType, prepareMouseEvent(event, this), event);\n    return pointerEvent;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  PointerEventHandler.prototype.disposeInternal = function disposeInternal () {\n    this.unregister_();\n    EventTarget.prototype.disposeInternal.call(this);\n  };\n\n  return PointerEventHandler;\n}(EventTarget));\n\nexport default PointerEventHandler;\n\n//# sourceMappingURL=PointerEventHandler.js.map","/**\n * @module ol/renderer/canvas/VectorTileLayer\n */\nimport {getUid} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport TileState from '../../TileState.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, containsCoordinate, equals, getIntersection, getTopLeft, intersects} from '../../extent.js';\nimport VectorTileRenderType from '../../layer/VectorTileRenderType.js';\nimport {equivalent as equivalentProjection} from '../../proj.js';\nimport Units from '../../proj/Units.js';\nimport ReplayType from '../../render/ReplayType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup, {replayDeclutter} from '../../render/canvas/ReplayGroup.js';\nimport {ORDER} from '../../render/replay.js';\nimport CanvasTileLayerRenderer from './TileLayer.js';\nimport {getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  reset as resetTransform,\n  scale as scaleTransform,\n  translate as translateTransform\n} from '../../transform.js';\n\n\n/**\n * @type {!Object<string, Array<import(\"../../render/ReplayType.js\").default>>}\n */\nvar IMAGE_REPLAYS = {\n  'image': [ReplayType.POLYGON, ReplayType.CIRCLE,\n    ReplayType.LINE_STRING, ReplayType.IMAGE, ReplayType.TEXT],\n  'hybrid': [ReplayType.POLYGON, ReplayType.LINE_STRING]\n};\n\n\n/**\n * @type {!Object<string, Array<import(\"../../render/ReplayType.js\").default>>}\n */\nvar VECTOR_REPLAYS = {\n  'image': [ReplayType.DEFAULT],\n  'hybrid': [ReplayType.IMAGE, ReplayType.TEXT, ReplayType.DEFAULT],\n  'vector': ORDER\n};\n\n\n/**\n * @classdesc\n * Canvas renderer for vector tile layers.\n * @api\n */\nvar CanvasVectorTileLayerRenderer = /*@__PURE__*/(function (CanvasTileLayerRenderer) {\n  function CanvasVectorTileLayerRenderer(layer) {\n\n    CanvasTileLayerRenderer.call(this, layer, true);\n\n    /**\n     * Declutter tree.\n     * @private\n     */\n    this.declutterTree_ = layer.getDeclutter() ? rbush(9, undefined) : null;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.dirty_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedLayerRevision_;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.tmpTransform_ = createTransform();\n\n    var renderMode = layer.getRenderMode();\n\n    // Use lower resolution for pure vector rendering. Closest resolution otherwise.\n    this.zDirection = renderMode === VectorTileRenderType.VECTOR ? 1 : 0;\n\n    if (renderMode !== VectorTileRenderType.VECTOR) {\n      this.context = createCanvasContext2D();\n    }\n\n\n    listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n  }\n\n  if ( CanvasTileLayerRenderer ) CanvasVectorTileLayerRenderer.__proto__ = CanvasTileLayerRenderer;\n  CanvasVectorTileLayerRenderer.prototype = Object.create( CanvasTileLayerRenderer && CanvasTileLayerRenderer.prototype );\n  CanvasVectorTileLayerRenderer.prototype.constructor = CanvasVectorTileLayerRenderer;\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorTileLayerRenderer.prototype.disposeInternal = function disposeInternal () {\n    unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n    CanvasTileLayerRenderer.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorTileLayerRenderer.prototype.getTile = function getTile (z, x, y, pixelRatio, projection) {\n    var tile = CanvasTileLayerRenderer.prototype.getTile.call(this, z, x, y, pixelRatio, projection);\n    if (tile.getState() === TileState.LOADED) {\n      this.createReplayGroup_(/** @type {import(\"../../VectorImageTile.js\").default} */ (tile), pixelRatio, projection);\n      if (this.context) {\n        this.renderTileImage_(/** @type {import(\"../../VectorImageTile.js\").default} */ (tile), pixelRatio, projection);\n      }\n    }\n    return tile;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorTileLayerRenderer.prototype.getTileImage = function getTileImage (tile) {\n    var tileLayer = /** @type {import(\"../../layer/Tile.js\").default} */ (this.getLayer());\n    return /** @type {import(\"../../VectorImageTile.js\").default} */ (tile).getImage(tileLayer);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorTileLayerRenderer.prototype.prepareFrame = function prepareFrame (frameState, layerState) {\n    var layer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n    var layerRevision = layer.getRevision();\n    if (this.renderedLayerRevision_ != layerRevision) {\n      this.renderedTiles.length = 0;\n    }\n    this.renderedLayerRevision_ = layerRevision;\n    return CanvasTileLayerRenderer.prototype.prepareFrame.call(this, frameState, layerState);\n  };\n\n  /**\n   * @param {import(\"../../VectorImageTile.js\").default} tile Tile.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.createReplayGroup_ = function createReplayGroup_ (tile, pixelRatio, projection) {\n    var this$1 = this;\n\n    var layer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n    var revision = layer.getRevision();\n    var renderOrder = /** @type {import(\"../../render.js\").OrderFunction} */ (layer.getRenderOrder()) || null;\n\n    var replayState = tile.getReplayState(layer);\n    if (!replayState.dirty && replayState.renderedRevision == revision &&\n        replayState.renderedRenderOrder == renderOrder) {\n      return;\n    }\n\n    var source = /** @type {import(\"../../source/VectorTile.js\").default} */ (layer.getSource());\n    var sourceTileGrid = source.getTileGrid();\n    var tileGrid = source.getTileGridForProjection(projection);\n    var resolution = tileGrid.getResolution(tile.tileCoord[0]);\n    var tileExtent = tile.extent;\n\n    var loop = function ( t, tt ) {\n      var sourceTile = tile.getTile(tile.tileKeys[t]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        return;\n      }\n\n      var sourceTileCoord = sourceTile.tileCoord;\n      var sourceTileExtent = sourceTileGrid.getTileCoordExtent(sourceTileCoord);\n      var sharedExtent = getIntersection(tileExtent, sourceTileExtent);\n      var bufferedExtent = equals(sourceTileExtent, sharedExtent) ? null :\n        buffer(sharedExtent, layer.getRenderBuffer() * resolution, this$1.tmpExtent);\n      var tileProjection = sourceTile.getProjection();\n      var reproject = false;\n      if (!equivalentProjection(projection, tileProjection)) {\n        reproject = true;\n        sourceTile.setProjection(projection);\n      }\n      replayState.dirty = false;\n      var replayGroup = new CanvasReplayGroup(0, sharedExtent, resolution,\n        pixelRatio, source.getOverlaps(), this$1.declutterTree_, layer.getRenderBuffer());\n      var squaredTolerance = getSquaredRenderTolerance(resolution, pixelRatio);\n\n      /**\n       * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n       * @this {CanvasVectorTileLayerRenderer}\n       */\n      var render = function(feature) {\n        var styles;\n        var styleFunction = feature.getStyleFunction() || layer.getStyleFunction();\n        if (styleFunction) {\n          styles = styleFunction(feature, resolution);\n        }\n        if (styles) {\n          var dirty = this.renderFeature(feature, squaredTolerance, styles, replayGroup);\n          this.dirty_ = this.dirty_ || dirty;\n          replayState.dirty = replayState.dirty || dirty;\n        }\n      };\n\n      var features = sourceTile.getFeatures();\n      if (renderOrder && renderOrder !== replayState.renderedRenderOrder) {\n        features.sort(renderOrder);\n      }\n      for (var i = 0, ii = features.length; i < ii; ++i) {\n        var feature = features[i];\n        if (reproject) {\n          if (tileProjection.getUnits() == Units.TILE_PIXELS) {\n            // projected tile extent\n            tileProjection.setWorldExtent(sourceTileExtent);\n            // tile extent in tile pixel space\n            tileProjection.setExtent(sourceTile.getExtent());\n          }\n          feature.getGeometry().transform(tileProjection, projection);\n        }\n        if (!bufferedExtent || intersects(bufferedExtent, feature.getGeometry().getExtent())) {\n          render.call(this$1, feature);\n        }\n      }\n      replayGroup.finish();\n      sourceTile.setReplayGroup(layer, tile.tileCoord.toString(), replayGroup);\n    };\n\n    for (var t = 0, tt = tile.tileKeys.length; t < tt; ++t) loop( t, tt );\n    replayState.renderedRevision = revision;\n    replayState.renderedRenderOrder = renderOrder;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorTileLayerRenderer.prototype.forEachFeatureAtCoordinate = function forEachFeatureAtCoordinate (coordinate, frameState, hitTolerance, callback, thisArg) {\n    var resolution = frameState.viewState.resolution;\n    var rotation = frameState.viewState.rotation;\n    hitTolerance = hitTolerance == undefined ? 0 : hitTolerance;\n    var layer = this.getLayer();\n    /** @type {!Object<string, boolean>} */\n    var features = {};\n\n    var renderedTiles = /** @type {Array<import(\"../../VectorImageTile.js\").default>} */ (this.renderedTiles);\n\n    var bufferedExtent, found;\n    var i, ii;\n    for (i = 0, ii = renderedTiles.length; i < ii; ++i) {\n      var tile = renderedTiles[i];\n      bufferedExtent = buffer(tile.extent, hitTolerance * resolution, bufferedExtent);\n      if (!containsCoordinate(bufferedExtent, coordinate)) {\n        continue;\n      }\n      for (var t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n        var sourceTile = tile.getTile(tile.tileKeys[t]);\n        if (sourceTile.getState() != TileState.LOADED) {\n          continue;\n        }\n        var replayGroup = /** @type {CanvasReplayGroup} */ (sourceTile.getReplayGroup(layer,\n          tile.tileCoord.toString()));\n        found = found || replayGroup.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n          /**\n           * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n           * @return {?} Callback result.\n           */\n          function(feature) {\n            var key = getUid(feature);\n            if (!(key in features)) {\n              features[key] = true;\n              return callback.call(thisArg, feature, layer);\n            }\n          }, null);\n      }\n    }\n    return found;\n  };\n\n  /**\n   * @param {import(\"../../VectorTile.js\").default} tile Tile.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {import(\"../../transform.js\").Transform} transform Transform.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.getReplayTransform_ = function getReplayTransform_ (tile, frameState) {\n    var layer = this.getLayer();\n    var source = /** @type {import(\"../../source/VectorTile.js\").default} */ (layer.getSource());\n    var tileGrid = source.getTileGrid();\n    var tileCoord = tile.tileCoord;\n    var tileResolution = tileGrid.getResolution(tileCoord[0]);\n    var viewState = frameState.viewState;\n    var pixelRatio = frameState.pixelRatio;\n    var renderResolution = viewState.resolution / pixelRatio;\n    var tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n    var center = viewState.center;\n    var origin = getTopLeft(tileExtent);\n    var size = frameState.size;\n    var offsetX = Math.round(pixelRatio * size[0] / 2);\n    var offsetY = Math.round(pixelRatio * size[1] / 2);\n    return composeTransform(this.tmpTransform_,\n      offsetX, offsetY,\n      tileResolution / renderResolution, tileResolution / renderResolution,\n      viewState.rotation,\n      (origin[0] - center[0]) / tileResolution,\n      (center[1] - origin[1]) / tileResolution);\n  };\n\n  /**\n   * @param {import(\"../../events/Event.js\").default} event Event.\n   */\n  CanvasVectorTileLayerRenderer.prototype.handleFontsChanged_ = function handleFontsChanged_ (event) {\n    var layer = this.getLayer();\n    if (layer.getVisible() && this.renderedLayerRevision_ !== undefined) {\n      layer.changed();\n    }\n  };\n\n  /**\n   * Handle changes in image style state.\n   * @param {import(\"../../events/Event.js\").default} event Image style change event.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.handleStyleImageChange_ = function handleStyleImageChange_ (event) {\n    this.renderIfReadyAndVisible();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorTileLayerRenderer.prototype.postCompose = function postCompose (context, frameState, layerState) {\n    var layer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n    var renderMode = layer.getRenderMode();\n    if (renderMode != VectorTileRenderType.IMAGE) {\n      var declutterReplays = layer.getDeclutter() ? {} : null;\n      var source = /** @type {import(\"../../source/VectorTile.js\").default} */ (layer.getSource());\n      var replayTypes = VECTOR_REPLAYS[renderMode];\n      var pixelRatio = frameState.pixelRatio;\n      var rotation = frameState.viewState.rotation;\n      var size = frameState.size;\n      var offsetX, offsetY;\n      if (rotation) {\n        offsetX = Math.round(pixelRatio * size[0] / 2);\n        offsetY = Math.round(pixelRatio * size[1] / 2);\n        rotateAtOffset(context, -rotation, offsetX, offsetY);\n      }\n      if (declutterReplays) {\n        this.declutterTree_.clear();\n      }\n      var viewHints = frameState.viewHints;\n      var snapToPixel = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n      var tiles = this.renderedTiles;\n      var tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n      var clips = [];\n      var zs = [];\n      for (var i = tiles.length - 1; i >= 0; --i) {\n        var tile = /** @type {import(\"../../VectorImageTile.js\").default} */ (tiles[i]);\n        if (tile.getState() == TileState.ABORT) {\n          continue;\n        }\n        var tileCoord = tile.tileCoord;\n        var worldOffset = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent)[0] - tile.extent[0];\n        var transform = undefined;\n        for (var t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n          var sourceTile = tile.getTile(tile.tileKeys[t]);\n          if (sourceTile.getState() != TileState.LOADED) {\n            continue;\n          }\n          var replayGroup = /** @type {CanvasReplayGroup} */ (sourceTile.getReplayGroup(layer, tileCoord.toString()));\n          if (!replayGroup || !replayGroup.hasReplays(replayTypes)) {\n            // sourceTile was not yet loaded when this.createReplayGroup_() was\n            // called, or it has no replays of the types we want to render\n            continue;\n          }\n          if (!transform) {\n            transform = this.getTransform(frameState, worldOffset);\n          }\n          var currentZ = sourceTile.tileCoord[0];\n          var currentClip = replayGroup.getClipCoords(transform);\n          context.save();\n          context.globalAlpha = layerState.opacity;\n          // Create a clip mask for regions in this low resolution tile that are\n          // already filled by a higher resolution tile\n          for (var j = 0, jj = clips.length; j < jj; ++j) {\n            var clip = clips[j];\n            if (currentZ < zs[j]) {\n              context.beginPath();\n              // counter-clockwise (outer ring) for current tile\n              context.moveTo(currentClip[0], currentClip[1]);\n              context.lineTo(currentClip[2], currentClip[3]);\n              context.lineTo(currentClip[4], currentClip[5]);\n              context.lineTo(currentClip[6], currentClip[7]);\n              // clockwise (inner ring) for higher resolution tile\n              context.moveTo(clip[6], clip[7]);\n              context.lineTo(clip[4], clip[5]);\n              context.lineTo(clip[2], clip[3]);\n              context.lineTo(clip[0], clip[1]);\n              context.clip();\n            }\n          }\n          replayGroup.replay(context, transform, rotation, {}, snapToPixel, replayTypes, declutterReplays);\n          context.restore();\n          clips.push(currentClip);\n          zs.push(currentZ);\n        }\n      }\n      if (declutterReplays) {\n        replayDeclutter(declutterReplays, context, rotation, snapToPixel);\n      }\n      if (rotation) {\n        rotateAtOffset(context, rotation,\n          /** @type {number} */ (offsetX), /** @type {number} */ (offsetY));\n      }\n    }\n    CanvasTileLayerRenderer.prototype.postCompose.call(this, context, frameState, layerState);\n  };\n\n  /**\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../../style/Style.js\").default|Array<import(\"../../style/Style.js\").default>} styles The style or array of styles.\n   * @param {import(\"../../render/canvas/ReplayGroup.js\").default} replayGroup Replay group.\n   * @return {boolean} `true` if an image is loading.\n   */\n  CanvasVectorTileLayerRenderer.prototype.renderFeature = function renderFeature$1 (feature, squaredTolerance, styles, replayGroup) {\n    if (!styles) {\n      return false;\n    }\n    var loading = false;\n    if (Array.isArray(styles)) {\n      for (var i = 0, ii = styles.length; i < ii; ++i) {\n        loading = renderFeature(\n          replayGroup, feature, styles[i], squaredTolerance,\n          this.handleStyleImageChange_, this) || loading;\n      }\n    } else {\n      loading = renderFeature(\n        replayGroup, feature, styles, squaredTolerance,\n        this.handleStyleImageChange_, this);\n    }\n    return loading;\n  };\n\n  /**\n   * @param {import(\"../../VectorImageTile.js\").default} tile Tile.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @private\n   */\n  CanvasVectorTileLayerRenderer.prototype.renderTileImage_ = function renderTileImage_ (tile, pixelRatio, projection) {\n    var layer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n    var replayState = tile.getReplayState(layer);\n    var revision = layer.getRevision();\n    var replays = IMAGE_REPLAYS[layer.getRenderMode()];\n    if (replays && replayState.renderedTileRevision !== revision) {\n      replayState.renderedTileRevision = revision;\n      var tileCoord = tile.wrappedTileCoord;\n      var z = tileCoord[0];\n      var source = /** @type {import(\"../../source/VectorTile.js\").default} */ (layer.getSource());\n      var tileGrid = source.getTileGridForProjection(projection);\n      var resolution = tileGrid.getResolution(z);\n      var context = tile.getContext(layer);\n      var size = source.getTilePixelSize(z, pixelRatio, projection);\n      context.canvas.width = size[0];\n      context.canvas.height = size[1];\n      var tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n      for (var i = 0, ii = tile.tileKeys.length; i < ii; ++i) {\n        var sourceTile = tile.getTile(tile.tileKeys[i]);\n        if (sourceTile.getState() != TileState.LOADED) {\n          continue;\n        }\n        var pixelScale = pixelRatio / resolution;\n        var transform = resetTransform(this.tmpTransform_);\n        scaleTransform(transform, pixelScale, -pixelScale);\n        translateTransform(transform, -tileExtent[0], -tileExtent[3]);\n        var replayGroup = /** @type {CanvasReplayGroup} */ (sourceTile.getReplayGroup(layer,\n          tile.tileCoord.toString()));\n        replayGroup.replay(context, transform, 0, {}, true, replays);\n      }\n    }\n  };\n\n  return CanvasVectorTileLayerRenderer;\n}(CanvasTileLayerRenderer));\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {import(\"../../layer/Layer.js\").default} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR_TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {import(\"../Map.js\").default} mapRenderer The map renderer.\n * @param {import(\"../../layer/Layer.js\").default} layer The layer to be rendererd.\n * @return {CanvasVectorTileLayerRenderer} The layer renderer.\n */\nCanvasVectorTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorTileLayerRenderer(/** @type {import(\"../../layer/VectorTile.js\").default} */ (layer));\n};\n\n\nexport default CanvasVectorTileLayerRenderer;\n\n//# sourceMappingURL=VectorTileLayer.js.map","/**\n * @module ol/renderer/canvas/TileLayer\n */\nimport {getUid} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, createEmpty, equals, getIntersection, isEmpty} from '../../extent.js';\nimport IntermediateCanvasRenderer from './IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @classdesc\n * Canvas renderer for tile layers.\n * @api\n */\nvar CanvasTileLayerRenderer = /*@__PURE__*/(function (IntermediateCanvasRenderer) {\n  function CanvasTileLayerRenderer(tileLayer, opt_noContext) {\n\n    IntermediateCanvasRenderer.call(this, tileLayer);\n\n    /**\n     * @protected\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context = opt_noContext ? null : createCanvasContext2D();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.oversampling_;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.renderedExtent_ = null;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.renderedRevision;\n\n    /**\n     * @protected\n     * @type {!Array<import(\"../../Tile.js\").default>}\n     */\n    this.renderedTiles = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.newTiles_ = false;\n\n    /**\n     * @protected\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.tmpExtent = createEmpty();\n\n    /**\n     * @private\n     * @type {import(\"../../TileRange.js\").default}\n     */\n    this.tmpTileRange_ = new TileRange(0, 0, 0, 0);\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.imageTransform_ = createTransform();\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.zDirection = 0;\n\n  }\n\n  if ( IntermediateCanvasRenderer ) CanvasTileLayerRenderer.__proto__ = IntermediateCanvasRenderer;\n  CanvasTileLayerRenderer.prototype = Object.create( IntermediateCanvasRenderer && IntermediateCanvasRenderer.prototype );\n  CanvasTileLayerRenderer.prototype.constructor = CanvasTileLayerRenderer;\n\n  /**\n   * @private\n   * @param {import(\"../../Tile.js\").default} tile Tile.\n   * @return {boolean} Tile is drawable.\n   */\n  CanvasTileLayerRenderer.prototype.isDrawableTile_ = function isDrawableTile_ (tile) {\n    var tileLayer = /** @type {import(\"../../layer/Tile.js\").default} */ (this.getLayer());\n    var tileState = tile.getState();\n    var useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();\n    return tileState == TileState.LOADED ||\n        tileState == TileState.EMPTY ||\n        tileState == TileState.ERROR && !useInterimTilesOnError;\n  };\n\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @return {!import(\"../../Tile.js\").default} Tile.\n   */\n  CanvasTileLayerRenderer.prototype.getTile = function getTile (z, x, y, pixelRatio, projection) {\n    var tileLayer = /** @type {import(\"../../layer/Tile.js\").default} */ (this.getLayer());\n    var tileSource = /** @type {import(\"../../source/Tile.js\").default} */ (tileLayer.getSource());\n    var tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n    if (tile.getState() == TileState.ERROR) {\n      if (!tileLayer.getUseInterimTilesOnError()) {\n        // When useInterimTilesOnError is false, we consider the error tile as loaded.\n        tile.setState(TileState.LOADED);\n      } else if (tileLayer.getPreload() > 0) {\n        // Preloaded tiles for lower resolutions might have finished loading.\n        this.newTiles_ = true;\n      }\n    }\n    if (!this.isDrawableTile_(tile)) {\n      tile = tile.getInterimTile();\n    }\n    return tile;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasTileLayerRenderer.prototype.prepareFrame = function prepareFrame (frameState, layerState) {\n\n    var pixelRatio = frameState.pixelRatio;\n    var size = frameState.size;\n    var viewState = frameState.viewState;\n    var projection = viewState.projection;\n    var viewResolution = viewState.resolution;\n    var viewCenter = viewState.center;\n\n    var tileLayer = /** @type {import(\"../../layer/Tile.js\").default} */ (this.getLayer());\n    var tileSource = /** @type {import(\"../../source/Tile.js\").default} */ (tileLayer.getSource());\n    var sourceRevision = tileSource.getRevision();\n    var tileGrid = tileSource.getTileGridForProjection(projection);\n    var z = tileGrid.getZForResolution(viewResolution, this.zDirection);\n    var tileResolution = tileGrid.getResolution(z);\n    var oversampling = Math.round(viewResolution / tileResolution) || 1;\n    var extent = frameState.extent;\n\n    if (layerState.extent !== undefined) {\n      extent = getIntersection(extent, layerState.extent);\n    }\n    if (isEmpty(extent)) {\n      // Return false to prevent the rendering of the layer.\n      return false;\n    }\n\n    var tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n    var imageExtent = tileGrid.getTileRangeExtent(z, tileRange);\n\n    var tilePixelRatio = tileSource.getTilePixelRatio(pixelRatio);\n\n    /**\n     * @type {Object<number, Object<string, import(\"../../Tile.js\").default>>}\n     */\n    var tilesToDrawByZ = {};\n    tilesToDrawByZ[z] = {};\n\n    var findLoadedTiles = this.createLoadedTileFinder(\n      tileSource, projection, tilesToDrawByZ);\n\n    var hints = frameState.viewHints;\n    var animatingOrInteracting = hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING];\n\n    var tmpExtent = this.tmpExtent;\n    var tmpTileRange = this.tmpTileRange_;\n    this.newTiles_ = false;\n    var tile, x, y;\n    for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        if (Date.now() - frameState.time > 16 && animatingOrInteracting) {\n          continue;\n        }\n        tile = this.getTile(z, x, y, pixelRatio, projection);\n        if (this.isDrawableTile_(tile)) {\n          var uid = getUid(this);\n          if (tile.getState() == TileState.LOADED) {\n            tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n            var inTransition = tile.inTransition(uid);\n            if (!this.newTiles_ && (inTransition || this.renderedTiles.indexOf(tile) === -1)) {\n              this.newTiles_ = true;\n            }\n          }\n          if (tile.getAlpha(uid, frameState.time) === 1) {\n            // don't look for alt tiles if alpha is 1\n            continue;\n          }\n        }\n\n        var childTileRange = tileGrid.getTileCoordChildTileRange(\n          tile.tileCoord, tmpTileRange, tmpExtent);\n        var covered = false;\n        if (childTileRange) {\n          covered = findLoadedTiles(z + 1, childTileRange);\n        }\n        if (!covered) {\n          tileGrid.forEachTileCoordParentTileRange(\n            tile.tileCoord, findLoadedTiles, null, tmpTileRange, tmpExtent);\n        }\n\n      }\n    }\n\n    var renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n    if (!(this.renderedResolution && Date.now() - frameState.time > 16 && animatingOrInteracting) && (\n      this.newTiles_ ||\n          !(this.renderedExtent_ && containsExtent(this.renderedExtent_, extent)) ||\n          this.renderedRevision != sourceRevision ||\n          oversampling != this.oversampling_ ||\n          !animatingOrInteracting && renderedResolution != this.renderedResolution\n    )) {\n\n      var context = this.context;\n      if (context) {\n        var tilePixelSize = tileSource.getTilePixelSize(z, pixelRatio, projection);\n        var width = Math.round(tileRange.getWidth() * tilePixelSize[0] / oversampling);\n        var height = Math.round(tileRange.getHeight() * tilePixelSize[1] / oversampling);\n        var canvas = context.canvas;\n        if (canvas.width != width || canvas.height != height) {\n          this.oversampling_ = oversampling;\n          canvas.width = width;\n          canvas.height = height;\n        } else {\n          if ((this.renderedExtent_ && !equals(imageExtent, this.renderedExtent_)) ||\n              this.renderedRevision != sourceRevision) {\n            context.clearRect(0, 0, width, height);\n          }\n          oversampling = this.oversampling_;\n        }\n      }\n\n      this.renderedTiles.length = 0;\n      /** @type {Array<number>} */\n      var zs = Object.keys(tilesToDrawByZ).map(Number);\n      zs.sort(function(a, b) {\n        if (a === z) {\n          return 1;\n        } else if (b === z) {\n          return -1;\n        } else {\n          return a > b ? 1 : a < b ? -1 : 0;\n        }\n      });\n      var currentResolution, currentScale, currentTilePixelSize, currentZ, i, ii;\n      var tileExtent, tileGutter, tilesToDraw, w, h;\n      for (i = 0, ii = zs.length; i < ii; ++i) {\n        currentZ = zs[i];\n        currentTilePixelSize = tileSource.getTilePixelSize(currentZ, pixelRatio, projection);\n        currentResolution = tileGrid.getResolution(currentZ);\n        currentScale = currentResolution / tileResolution;\n        tileGutter = tilePixelRatio * tileSource.getGutterForProjection(projection);\n        tilesToDraw = tilesToDrawByZ[currentZ];\n        for (var tileCoordKey in tilesToDraw) {\n          tile = tilesToDraw[tileCoordKey];\n          tileExtent = tileGrid.getTileCoordExtent(tile.getTileCoord(), tmpExtent);\n          x = (tileExtent[0] - imageExtent[0]) / tileResolution * tilePixelRatio / oversampling;\n          y = (imageExtent[3] - tileExtent[3]) / tileResolution * tilePixelRatio / oversampling;\n          w = currentTilePixelSize[0] * currentScale / oversampling;\n          h = currentTilePixelSize[1] * currentScale / oversampling;\n          this.drawTileImage(tile, frameState, layerState, x, y, w, h, tileGutter, z === currentZ);\n          this.renderedTiles.push(tile);\n        }\n      }\n\n      this.renderedRevision = sourceRevision;\n      this.renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n      this.renderedExtent_ = imageExtent;\n    }\n\n    var scale = this.renderedResolution / viewResolution;\n    var transform = composeTransform(this.imageTransform_,\n      pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n      scale, scale,\n      0,\n      (this.renderedExtent_[0] - viewCenter[0]) / this.renderedResolution * pixelRatio,\n      (viewCenter[1] - this.renderedExtent_[3]) / this.renderedResolution * pixelRatio);\n    composeTransform(this.coordinateToCanvasPixelTransform,\n      pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n      pixelRatio / viewResolution, -pixelRatio / viewResolution,\n      0,\n      -viewCenter[0], -viewCenter[1]);\n\n\n    this.updateUsedTiles(frameState.usedTiles, tileSource, z, tileRange);\n    this.manageTilePyramid(frameState, tileSource, tileGrid, pixelRatio,\n      projection, extent, z, tileLayer.getPreload());\n    this.scheduleExpireCache(frameState, tileSource);\n\n    return this.renderedTiles.length > 0;\n  };\n\n  /**\n   * @param {import(\"../../Tile.js\").default} tile Tile.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../layer/Layer.js\").State} layerState Layer state.\n   * @param {number} x Left of the tile.\n   * @param {number} y Top of the tile.\n   * @param {number} w Width of the tile.\n   * @param {number} h Height of the tile.\n   * @param {number} gutter Tile gutter.\n   * @param {boolean} transition Apply an alpha transition.\n   */\n  CanvasTileLayerRenderer.prototype.drawTileImage = function drawTileImage (tile, frameState, layerState, x, y, w, h, gutter, transition) {\n    var image = this.getTileImage(tile);\n    if (!image) {\n      return;\n    }\n    var uid = getUid(this);\n    var alpha = transition ? tile.getAlpha(uid, frameState.time) : 1;\n    var tileLayer = /** @type {import(\"../../layer/Tile.js\").default} */ (this.getLayer());\n    var tileSource = /** @type {import(\"../../source/Tile.js\").default} */ (tileLayer.getSource());\n    if (alpha === 1 && !tileSource.getOpaque(frameState.viewState.projection)) {\n      this.context.clearRect(x, y, w, h);\n    }\n    var alphaChanged = alpha !== this.context.globalAlpha;\n    if (alphaChanged) {\n      this.context.save();\n      this.context.globalAlpha = alpha;\n    }\n    this.context.drawImage(image, gutter, gutter,\n      image.width - 2 * gutter, image.height - 2 * gutter, x, y, w, h);\n\n    if (alphaChanged) {\n      this.context.restore();\n    }\n    if (alpha !== 1) {\n      frameState.animate = true;\n    } else if (transition) {\n      tile.endTransition(uid);\n    }\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasTileLayerRenderer.prototype.getImage = function getImage () {\n    var context = this.context;\n    return context ? context.canvas : null;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasTileLayerRenderer.prototype.getImageTransform = function getImageTransform () {\n    return this.imageTransform_;\n  };\n\n  /**\n   * Get the image from a tile.\n   * @param {import(\"../../Tile.js\").default} tile Tile.\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @protected\n   */\n  CanvasTileLayerRenderer.prototype.getTileImage = function getTileImage (tile) {\n    return /** @type {import(\"../../ImageTile.js\").default} */ (tile).getImage();\n  };\n\n  return CanvasTileLayerRenderer;\n}(IntermediateCanvasRenderer));\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {import(\"../../layer/Layer.js\").default} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {import(\"../Map.js\").default} mapRenderer The map renderer.\n * @param {import(\"../../layer/Layer.js\").default} layer The layer to be rendererd.\n * @return {CanvasTileLayerRenderer} The layer renderer.\n */\nCanvasTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasTileLayerRenderer(/** @type {import(\"../../layer/Tile.js\").default} */ (layer));\n};\n\n\n/**\n * @function\n * @return {import(\"../../layer/Tile.js\").default|import(\"../../layer/VectorTile.js\").default}\n */\nCanvasTileLayerRenderer.prototype.getLayer;\n\n\nexport default CanvasTileLayerRenderer;\n\n//# sourceMappingURL=TileLayer.js.map","/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\n\nimport {equals} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {intersects} from '../../extent.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {transformGeom2D} from '../../geom/SimpleGeometry.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport VectorContext from '../VectorContext.js';\nimport {defaultTextAlign, defaultFillStyle, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline, defaultFont} from '../canvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\nvar CanvasImmediateRenderer = /*@__PURE__*/(function (VectorContext) {\n  function CanvasImmediateRenderer(context, pixelRatio, extent, transform, viewRotation) {\n    VectorContext.call(this);\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context_ = context;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.extent_ = extent;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.transform_ = transform;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.viewRotation_ = viewRotation;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.contextFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.contextStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.contextTextState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.fillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.strokeState_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorY_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageHeight_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOpacity_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.imageRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageRotation_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageScale_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageWidth_ = 0;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.text_ = '';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.textRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textRotation_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textScale_ = 0;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.textFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.textStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.textState_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.pixelCoordinates_ = [];\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.tmpLocalTransform_ = createTransform();\n\n  }\n\n  if ( VectorContext ) CanvasImmediateRenderer.__proto__ = VectorContext;\n  CanvasImmediateRenderer.prototype = Object.create( VectorContext && VectorContext.prototype );\n  CanvasImmediateRenderer.prototype.constructor = CanvasImmediateRenderer;\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.drawImages_ = function drawImages_ (flatCoordinates, offset, end, stride) {\n    if (!this.image_) {\n      return;\n    }\n    var pixelCoordinates = transform2D(\n      flatCoordinates, offset, end, 2, this.transform_,\n      this.pixelCoordinates_);\n    var context = this.context_;\n    var localTransform = this.tmpLocalTransform_;\n    var alpha = context.globalAlpha;\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha * this.imageOpacity_;\n    }\n    var rotation = this.imageRotation_;\n    if (this.imageRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (var i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n      var x = pixelCoordinates[i] - this.imageAnchorX_;\n      var y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n      if (rotation !== 0 || this.imageScale_ != 1) {\n        var centerX = x + this.imageAnchorX_;\n        var centerY = y + this.imageAnchorY_;\n        composeTransform(localTransform,\n          centerX, centerY,\n          this.imageScale_, this.imageScale_,\n          rotation,\n          -centerX, -centerY);\n        context.setTransform.apply(context, localTransform);\n      }\n      context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_,\n        this.imageWidth_, this.imageHeight_, x, y,\n        this.imageWidth_, this.imageHeight_);\n    }\n    if (rotation !== 0 || this.imageScale_ != 1) {\n      context.setTransform(1, 0, 0, 1, 0, 0);\n    }\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha;\n    }\n  };\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.drawText_ = function drawText_ (flatCoordinates, offset, end, stride) {\n    if (!this.textState_ || this.text_ === '') {\n      return;\n    }\n    if (this.textFillState_) {\n      this.setContextFillState_(this.textFillState_);\n    }\n    if (this.textStrokeState_) {\n      this.setContextStrokeState_(this.textStrokeState_);\n    }\n    this.setContextTextState_(this.textState_);\n    var pixelCoordinates = transform2D(\n      flatCoordinates, offset, end, stride, this.transform_,\n      this.pixelCoordinates_);\n    var context = this.context_;\n    var rotation = this.textRotation_;\n    if (this.textRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (; offset < end; offset += stride) {\n      var x = pixelCoordinates[offset] + this.textOffsetX_;\n      var y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n      if (rotation !== 0 || this.textScale_ != 1) {\n        var localTransform = composeTransform(this.tmpLocalTransform_,\n          x, y,\n          this.textScale_, this.textScale_,\n          rotation,\n          -x, -y);\n        context.setTransform.apply(context, localTransform);\n      }\n      if (this.textStrokeState_) {\n        context.strokeText(this.text_, x, y);\n      }\n      if (this.textFillState_) {\n        context.fillText(this.text_, x, y);\n      }\n    }\n    if (rotation !== 0 || this.textScale_ != 1) {\n      context.setTransform(1, 0, 0, 1, 0, 0);\n    }\n  };\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} close Close.\n   * @private\n   * @return {number} end End.\n   */\n  CanvasImmediateRenderer.prototype.moveToLineTo_ = function moveToLineTo_ (flatCoordinates, offset, end, stride, close) {\n    var context = this.context_;\n    var pixelCoordinates = transform2D(\n      flatCoordinates, offset, end, stride, this.transform_,\n      this.pixelCoordinates_);\n    context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n    var length = pixelCoordinates.length;\n    if (close) {\n      length -= 2;\n    }\n    for (var i = 2; i < length; i += 2) {\n      context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n    }\n    if (close) {\n      context.closePath();\n    }\n    return end;\n  };\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n  CanvasImmediateRenderer.prototype.drawRings_ = function drawRings_ (flatCoordinates, offset, ends, stride) {\n    for (var i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n    }\n    return offset;\n  };\n\n  /**\n   * Render a circle geometry into the canvas.  Rendering is immediate and uses\n   * the current fill and stroke styles.\n   *\n   * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n   * @override\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.drawCircle = function drawCircle (geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.fillState_ || this.strokeState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      var pixelCoordinates = transformGeom2D(\n        geometry, this.transform_, this.pixelCoordinates_);\n      var dx = pixelCoordinates[2] - pixelCoordinates[0];\n      var dy = pixelCoordinates[3] - pixelCoordinates[1];\n      var radius = Math.sqrt(dx * dx + dy * dy);\n      var context = this.context_;\n      context.beginPath();\n      context.arc(\n        pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      this.drawText_(geometry.getCenter(), 0, 2, 2);\n    }\n  };\n\n  /**\n   * Set the rendering style.  Note that since this is an immediate rendering API,\n   * any `zIndex` on the provided style will be ignored.\n   *\n   * @param {import(\"../../style/Style.js\").default} style The rendering style.\n   * @override\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.setStyle = function setStyle (style) {\n    this.setFillStrokeStyle(style.getFill(), style.getStroke());\n    this.setImageStyle(style.getImage());\n    this.setTextStyle(style.getText());\n  };\n\n  /**\n   * Render a geometry into the canvas.  Call\n   * {@link module:ol/render/canvas/Immediate#setStyle} first to set the rendering style.\n   *\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n   * @override\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.drawGeometry = function drawGeometry (geometry) {\n    var type = geometry.getType();\n    switch (type) {\n      case GeometryType.POINT:\n        this.drawPoint(/** @type {import(\"../../geom/Point.js\").default} */ (geometry));\n        break;\n      case GeometryType.LINE_STRING:\n        this.drawLineString(/** @type {import(\"../../geom/LineString.js\").default} */ (geometry));\n        break;\n      case GeometryType.POLYGON:\n        this.drawPolygon(/** @type {import(\"../../geom/Polygon.js\").default} */ (geometry));\n        break;\n      case GeometryType.MULTI_POINT:\n        this.drawMultiPoint(/** @type {import(\"../../geom/MultiPoint.js\").default} */ (geometry));\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        this.drawMultiLineString(/** @type {import(\"../../geom/MultiLineString.js\").default} */ (geometry));\n        break;\n      case GeometryType.MULTI_POLYGON:\n        this.drawMultiPolygon(/** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry));\n        break;\n      case GeometryType.GEOMETRY_COLLECTION:\n        this.drawGeometryCollection(/** @type {import(\"../../geom/GeometryCollection.js\").default} */ (geometry));\n        break;\n      case GeometryType.CIRCLE:\n        this.drawCircle(/** @type {import(\"../../geom/Circle.js\").default} */ (geometry));\n        break;\n      default:\n    }\n  };\n\n  /**\n   * Render a feature into the canvas.  Note that any `zIndex` on the provided\n   * style will be ignored - features are rendered immediately in the order that\n   * this method is called.  If you need `zIndex` support, you should be using an\n   * {@link module:ol/layer/Vector~VectorLayer} instead.\n   *\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {import(\"../../style/Style.js\").default} style Style.\n   * @override\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.drawFeature = function drawFeature (feature, style) {\n    var geometry = style.getGeometryFunction()(feature);\n    if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    this.setStyle(style);\n    this.drawGeometry(geometry);\n  };\n\n  /**\n   * Render a GeometryCollection to the canvas.  Rendering is immediate and\n   * uses the current styles appropriate for each geometry in the collection.\n   *\n   * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.drawGeometryCollection = function drawGeometryCollection (geometry) {\n    var geometries = geometry.getGeometriesArray();\n    for (var i = 0, ii = geometries.length; i < ii; ++i) {\n      this.drawGeometry(geometries[i]);\n    }\n  };\n\n  /**\n   * Render a Point geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.drawPoint = function drawPoint (geometry) {\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n\n  /**\n   * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n   * uses the current style.\n   *\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.drawMultiPoint = function drawMultiPoint (geometry) {\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n\n  /**\n   * Render a LineString into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.drawLineString = function drawLineString (geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      context.beginPath();\n      this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length,\n        geometry.getStride(), false);\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      var flatMidpoint = geometry.getFlatMidpoint();\n      this.drawText_(flatMidpoint, 0, 2, 2);\n    }\n  };\n\n  /**\n   * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n   * and uses the current style.\n   *\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.drawMultiLineString = function drawMultiLineString (geometry) {\n    var geometryExtent = geometry.getExtent();\n    if (!intersects(this.extent_, geometryExtent)) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      var offset = 0;\n      var ends = /** @type {Array<number>} */ (geometry.getEnds());\n      var stride = geometry.getStride();\n      context.beginPath();\n      for (var i = 0, ii = ends.length; i < ii; ++i) {\n        offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n      }\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      var flatMidpoints = geometry.getFlatMidpoints();\n      this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n    }\n  };\n\n  /**\n   * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.drawPolygon = function drawPolygon (geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      var context = this.context_;\n      context.beginPath();\n      this.drawRings_(geometry.getOrientedFlatCoordinates(),\n        0, /** @type {Array<number>} */ (geometry.getEnds()), geometry.getStride());\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      var flatInteriorPoint = geometry.getFlatInteriorPoint();\n      this.drawText_(flatInteriorPoint, 0, 2, 2);\n    }\n  };\n\n  /**\n   * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n   * uses the current style.\n   * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.drawMultiPolygon = function drawMultiPolygon (geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      var context = this.context_;\n      var flatCoordinates = geometry.getOrientedFlatCoordinates();\n      var offset = 0;\n      var endss = geometry.getEndss();\n      var stride = geometry.getStride();\n      context.beginPath();\n      for (var i = 0, ii = endss.length; i < ii; ++i) {\n        var ends = endss[i];\n        offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n      }\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      var flatInteriorPoints = geometry.getFlatInteriorPoints();\n      this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n    }\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.setContextFillState_ = function setContextFillState_ (fillState) {\n    var context = this.context_;\n    var contextFillState = this.contextFillState_;\n    if (!contextFillState) {\n      context.fillStyle = fillState.fillStyle;\n      this.contextFillState_ = {\n        fillStyle: fillState.fillStyle\n      };\n    } else {\n      if (contextFillState.fillStyle != fillState.fillStyle) {\n        contextFillState.fillStyle = context.fillStyle = fillState.fillStyle;\n      }\n    }\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.setContextStrokeState_ = function setContextStrokeState_ (strokeState) {\n    var context = this.context_;\n    var contextStrokeState = this.contextStrokeState_;\n    if (!contextStrokeState) {\n      context.lineCap = /** @type {CanvasLineCap} */ (strokeState.lineCap);\n      if (CANVAS_LINE_DASH) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n      context.lineJoin = /** @type {CanvasLineJoin} */ (strokeState.lineJoin);\n      context.lineWidth = strokeState.lineWidth;\n      context.miterLimit = strokeState.miterLimit;\n      context.strokeStyle = strokeState.strokeStyle;\n      this.contextStrokeState_ = {\n        lineCap: strokeState.lineCap,\n        lineDash: strokeState.lineDash,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineJoin: strokeState.lineJoin,\n        lineWidth: strokeState.lineWidth,\n        miterLimit: strokeState.miterLimit,\n        strokeStyle: strokeState.strokeStyle\n      };\n    } else {\n      if (contextStrokeState.lineCap != strokeState.lineCap) {\n        contextStrokeState.lineCap = context.lineCap = /** @type {CanvasLineCap} */ (strokeState.lineCap);\n      }\n      if (CANVAS_LINE_DASH) {\n        if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n          context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n        }\n        if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n          contextStrokeState.lineDashOffset = context.lineDashOffset =\n              strokeState.lineDashOffset;\n        }\n      }\n      if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n        contextStrokeState.lineJoin = context.lineJoin = /** @type {CanvasLineJoin} */ (strokeState.lineJoin);\n      }\n      if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n        contextStrokeState.lineWidth = context.lineWidth = strokeState.lineWidth;\n      }\n      if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n        contextStrokeState.miterLimit = context.miterLimit =\n            strokeState.miterLimit;\n      }\n      if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n        contextStrokeState.strokeStyle = context.strokeStyle =\n            strokeState.strokeStyle;\n      }\n    }\n  };\n\n  /**\n   * @param {import(\"../canvas.js\").TextState} textState Text state.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.setContextTextState_ = function setContextTextState_ (textState) {\n    var context = this.context_;\n    var contextTextState = this.contextTextState_;\n    var textAlign = textState.textAlign ?\n      textState.textAlign : defaultTextAlign;\n    if (!contextTextState) {\n      context.font = textState.font;\n      context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n      context.textBaseline = /** @type {CanvasTextBaseline} */ (textState.textBaseline);\n      this.contextTextState_ = {\n        font: textState.font,\n        textAlign: textAlign,\n        textBaseline: textState.textBaseline\n      };\n    } else {\n      if (contextTextState.font != textState.font) {\n        contextTextState.font = context.font = textState.font;\n      }\n      if (contextTextState.textAlign != textAlign) {\n        contextTextState.textAlign = context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n      }\n      if (contextTextState.textBaseline != textState.textBaseline) {\n        contextTextState.textBaseline = context.textBaseline =\n          /** @type {CanvasTextBaseline} */ (textState.textBaseline);\n      }\n    }\n  };\n\n  /**\n   * Set the fill and stroke style for subsequent draw operations.  To clear\n   * either fill or stroke styles, pass null for the appropriate parameter.\n   *\n   * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.setFillStrokeStyle = function setFillStrokeStyle (fillStyle, strokeStyle) {\n    if (!fillStyle) {\n      this.fillState_ = null;\n    } else {\n      var fillStyleColor = fillStyle.getColor();\n      this.fillState_ = {\n        fillStyle: asColorLike(fillStyleColor ?\n          fillStyleColor : defaultFillStyle)\n      };\n    }\n    if (!strokeStyle) {\n      this.strokeState_ = null;\n    } else {\n      var strokeStyleColor = strokeStyle.getColor();\n      var strokeStyleLineCap = strokeStyle.getLineCap();\n      var strokeStyleLineDash = strokeStyle.getLineDash();\n      var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      var strokeStyleLineJoin = strokeStyle.getLineJoin();\n      var strokeStyleWidth = strokeStyle.getWidth();\n      var strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      this.strokeState_ = {\n        lineCap: strokeStyleLineCap !== undefined ?\n          strokeStyleLineCap : defaultLineCap,\n        lineDash: strokeStyleLineDash ?\n          strokeStyleLineDash : defaultLineDash,\n        lineDashOffset: strokeStyleLineDashOffset ?\n          strokeStyleLineDashOffset : defaultLineDashOffset,\n        lineJoin: strokeStyleLineJoin !== undefined ?\n          strokeStyleLineJoin : defaultLineJoin,\n        lineWidth: this.pixelRatio_ * (strokeStyleWidth !== undefined ?\n          strokeStyleWidth : defaultLineWidth),\n        miterLimit: strokeStyleMiterLimit !== undefined ?\n          strokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(strokeStyleColor ?\n          strokeStyleColor : defaultStrokeStyle)\n      };\n    }\n  };\n\n  /**\n   * Set the image style for subsequent draw operations.  Pass null to remove\n   * the image style.\n   *\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.setImageStyle = function setImageStyle (imageStyle) {\n    if (!imageStyle) {\n      this.image_ = null;\n    } else {\n      var imageAnchor = imageStyle.getAnchor();\n      // FIXME pixel ratio\n      var imageImage = imageStyle.getImage(1);\n      var imageOrigin = imageStyle.getOrigin();\n      var imageSize = imageStyle.getSize();\n      this.imageAnchorX_ = imageAnchor[0];\n      this.imageAnchorY_ = imageAnchor[1];\n      this.imageHeight_ = imageSize[1];\n      this.image_ = imageImage;\n      this.imageOpacity_ = imageStyle.getOpacity();\n      this.imageOriginX_ = imageOrigin[0];\n      this.imageOriginY_ = imageOrigin[1];\n      this.imageRotateWithView_ = imageStyle.getRotateWithView();\n      this.imageRotation_ = imageStyle.getRotation();\n      this.imageScale_ = imageStyle.getScale() * this.pixelRatio_;\n      this.imageWidth_ = imageSize[0];\n    }\n  };\n\n  /**\n   * Set the text style for subsequent draw operations.  Pass null to\n   * remove the text style.\n   *\n   * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n   * @override\n   */\n  CanvasImmediateRenderer.prototype.setTextStyle = function setTextStyle (textStyle) {\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      var textFillStyle = textStyle.getFill();\n      if (!textFillStyle) {\n        this.textFillState_ = null;\n      } else {\n        var textFillStyleColor = textFillStyle.getColor();\n        this.textFillState_ = {\n          fillStyle: asColorLike(textFillStyleColor ?\n            textFillStyleColor : defaultFillStyle)\n        };\n      }\n      var textStrokeStyle = textStyle.getStroke();\n      if (!textStrokeStyle) {\n        this.textStrokeState_ = null;\n      } else {\n        var textStrokeStyleColor = textStrokeStyle.getColor();\n        var textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n        var textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n        var textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n        var textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n        var textStrokeStyleWidth = textStrokeStyle.getWidth();\n        var textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n        this.textStrokeState_ = {\n          lineCap: textStrokeStyleLineCap !== undefined ?\n            textStrokeStyleLineCap : defaultLineCap,\n          lineDash: textStrokeStyleLineDash ?\n            textStrokeStyleLineDash : defaultLineDash,\n          lineDashOffset: textStrokeStyleLineDashOffset ?\n            textStrokeStyleLineDashOffset : defaultLineDashOffset,\n          lineJoin: textStrokeStyleLineJoin !== undefined ?\n            textStrokeStyleLineJoin : defaultLineJoin,\n          lineWidth: textStrokeStyleWidth !== undefined ?\n            textStrokeStyleWidth : defaultLineWidth,\n          miterLimit: textStrokeStyleMiterLimit !== undefined ?\n            textStrokeStyleMiterLimit : defaultMiterLimit,\n          strokeStyle: asColorLike(textStrokeStyleColor ?\n            textStrokeStyleColor : defaultStrokeStyle)\n        };\n      }\n      var textFont = textStyle.getFont();\n      var textOffsetX = textStyle.getOffsetX();\n      var textOffsetY = textStyle.getOffsetY();\n      var textRotateWithView = textStyle.getRotateWithView();\n      var textRotation = textStyle.getRotation();\n      var textScale = textStyle.getScale();\n      var textText = textStyle.getText();\n      var textTextAlign = textStyle.getTextAlign();\n      var textTextBaseline = textStyle.getTextBaseline();\n      this.textState_ = {\n        font: textFont !== undefined ?\n          textFont : defaultFont,\n        textAlign: textTextAlign !== undefined ?\n          textTextAlign : defaultTextAlign,\n        textBaseline: textTextBaseline !== undefined ?\n          textTextBaseline : defaultTextBaseline\n      };\n      this.text_ = textText !== undefined ? textText : '';\n      this.textOffsetX_ =\n          textOffsetX !== undefined ? (this.pixelRatio_ * textOffsetX) : 0;\n      this.textOffsetY_ =\n          textOffsetY !== undefined ? (this.pixelRatio_ * textOffsetY) : 0;\n      this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n      this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n      this.textScale_ = this.pixelRatio_ * (textScale !== undefined ?\n        textScale : 1);\n    }\n  };\n\n  return CanvasImmediateRenderer;\n}(VectorContext));\n\n\nexport default CanvasImmediateRenderer;\n\n//# sourceMappingURL=Immediate.js.map","/**\n * @module ol/render/Box\n */\n\nimport Disposable from '../Disposable.js';\nimport Polygon from '../geom/Polygon.js';\n\nvar RenderBox = /*@__PURE__*/(function (Disposable) {\n  function RenderBox(className) {\n    Disposable.call(this);\n\n    /**\n     * @type {import(\"../geom/Polygon.js\").default}\n     * @private\n     */\n    this.geometry_ = null;\n\n    /**\n     * @type {HTMLDivElement}\n     * @private\n     */\n    this.element_ = /** @type {HTMLDivElement} */ (document.createElement('div'));\n    this.element_.style.position = 'absolute';\n    this.element_.className = 'ol-box ' + className;\n\n    /**\n     * @private\n     * @type {import(\"../PluggableMap.js\").default}\n     */\n    this.map_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../pixel.js\").Pixel}\n     */\n    this.startPixel_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../pixel.js\").Pixel}\n     */\n    this.endPixel_ = null;\n\n  }\n\n  if ( Disposable ) RenderBox.__proto__ = Disposable;\n  RenderBox.prototype = Object.create( Disposable && Disposable.prototype );\n  RenderBox.prototype.constructor = RenderBox;\n\n  /**\n   * @inheritDoc\n   */\n  RenderBox.prototype.disposeInternal = function disposeInternal () {\n    this.setMap(null);\n  };\n\n  /**\n   * @private\n   */\n  RenderBox.prototype.render_ = function render_ () {\n    var startPixel = this.startPixel_;\n    var endPixel = this.endPixel_;\n    var px = 'px';\n    var style = this.element_.style;\n    style.left = Math.min(startPixel[0], endPixel[0]) + px;\n    style.top = Math.min(startPixel[1], endPixel[1]) + px;\n    style.width = Math.abs(endPixel[0] - startPixel[0]) + px;\n    style.height = Math.abs(endPixel[1] - startPixel[1]) + px;\n  };\n\n  /**\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   */\n  RenderBox.prototype.setMap = function setMap (map) {\n    if (this.map_) {\n      this.map_.getOverlayContainer().removeChild(this.element_);\n      var style = this.element_.style;\n      style.left = style.top = style.width = style.height = 'inherit';\n    }\n    this.map_ = map;\n    if (this.map_) {\n      this.map_.getOverlayContainer().appendChild(this.element_);\n    }\n  };\n\n  /**\n   * @param {import(\"../pixel.js\").Pixel} startPixel Start pixel.\n   * @param {import(\"../pixel.js\").Pixel} endPixel End pixel.\n   */\n  RenderBox.prototype.setPixels = function setPixels (startPixel, endPixel) {\n    this.startPixel_ = startPixel;\n    this.endPixel_ = endPixel;\n    this.createOrUpdateGeometry();\n    this.render_();\n  };\n\n  /**\n   * Creates or updates the cached geometry.\n   */\n  RenderBox.prototype.createOrUpdateGeometry = function createOrUpdateGeometry () {\n    var startPixel = this.startPixel_;\n    var endPixel = this.endPixel_;\n    var pixels = [\n      startPixel,\n      [startPixel[0], endPixel[1]],\n      endPixel,\n      [endPixel[0], startPixel[1]]\n    ];\n    var coordinates = pixels.map(this.map_.getCoordinateFromPixel, this.map_);\n    // close the polygon\n    coordinates[4] = coordinates[0].slice();\n    if (!this.geometry_) {\n      this.geometry_ = new Polygon([coordinates]);\n    } else {\n      this.geometry_.setCoordinates([coordinates]);\n    }\n  };\n\n  /**\n   * @return {import(\"../geom/Polygon.js\").default} Geometry.\n   */\n  RenderBox.prototype.getGeometry = function getGeometry () {\n    return this.geometry_;\n  };\n\n  return RenderBox;\n}(Disposable));\n\n\nexport default RenderBox;\n\n//# sourceMappingURL=Box.js.map","/**\n * @module ol/pointer/EventType\n */\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n  POINTERMOVE: 'pointermove',\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n\n//# sourceMappingURL=EventType.js.map","/**\n * @module ol/renderer/canvas/VectorLayer\n */\nimport {getUid} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, createEmpty, containsExtent, getWidth} from '../../extent.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup from '../../render/canvas/ReplayGroup.js';\nimport CanvasLayerRenderer from './Layer.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\n\n/**\n * @classdesc\n * Canvas renderer for vector layers.\n * @api\n */\nvar CanvasVectorLayerRenderer = /*@__PURE__*/(function (CanvasLayerRenderer) {\n  function CanvasVectorLayerRenderer(vectorLayer) {\n\n    CanvasLayerRenderer.call(this, vectorLayer);\n\n    /**\n     * Declutter tree.\n     * @private\n     */\n    this.declutterTree_ = vectorLayer.getDeclutter() ? rbush(9, undefined) : null;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.dirty_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedRevision_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedResolution_ = NaN;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.renderedExtent_ = createEmpty();\n\n    /**\n     * @private\n     * @type {function(import(\"../../Feature.js\").default, import(\"../../Feature.js\").default): number|null}\n     */\n    this.renderedRenderOrder_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../render/canvas/ReplayGroup.js\").default}\n     */\n    this.replayGroup_ = null;\n\n    /**\n     * A new replay group had to be created by `prepareFrame()`\n     * @type {boolean}\n     */\n    this.replayGroupChanged = true;\n\n    /**\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context = createCanvasContext2D();\n\n    listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n  }\n\n  if ( CanvasLayerRenderer ) CanvasVectorLayerRenderer.__proto__ = CanvasLayerRenderer;\n  CanvasVectorLayerRenderer.prototype = Object.create( CanvasLayerRenderer && CanvasLayerRenderer.prototype );\n  CanvasVectorLayerRenderer.prototype.constructor = CanvasVectorLayerRenderer;\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorLayerRenderer.prototype.disposeInternal = function disposeInternal () {\n    unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n    CanvasLayerRenderer.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../layer/Layer.js\").State} layerState Layer state.\n   */\n  CanvasVectorLayerRenderer.prototype.compose = function compose (context, frameState, layerState) {\n    var extent = frameState.extent;\n    var pixelRatio = frameState.pixelRatio;\n    var skippedFeatureUids = layerState.managed ?\n      frameState.skippedFeatureUids : {};\n    var viewState = frameState.viewState;\n    var projection = viewState.projection;\n    var rotation = viewState.rotation;\n    var projectionExtent = projection.getExtent();\n    var vectorSource = /** @type {import(\"../../source/Vector.js\").default} */ (this.getLayer().getSource());\n\n    var transform = this.getTransform(frameState, 0);\n\n    // clipped rendering if layer extent is set\n    var clipExtent = layerState.extent;\n    var clipped = clipExtent !== undefined;\n    if (clipped) {\n      this.clip(context, frameState, /** @type {import(\"../../extent.js\").Extent} */ (clipExtent));\n    }\n    var replayGroup = this.replayGroup_;\n    if (replayGroup && !replayGroup.isEmpty()) {\n      if (this.declutterTree_) {\n        this.declutterTree_.clear();\n      }\n      var layer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n      var drawOffsetX = 0;\n      var drawOffsetY = 0;\n      var replayContext;\n      var transparentLayer = layerState.opacity !== 1;\n      var hasRenderListeners = layer.hasListener(RenderEventType.RENDER);\n      if (transparentLayer || hasRenderListeners) {\n        var drawWidth = context.canvas.width;\n        var drawHeight = context.canvas.height;\n        if (rotation) {\n          var drawSize = Math.round(Math.sqrt(drawWidth * drawWidth + drawHeight * drawHeight));\n          drawOffsetX = (drawSize - drawWidth) / 2;\n          drawOffsetY = (drawSize - drawHeight) / 2;\n          drawWidth = drawHeight = drawSize;\n        }\n        // resize and clear\n        this.context.canvas.width = drawWidth;\n        this.context.canvas.height = drawHeight;\n        replayContext = this.context;\n      } else {\n        replayContext = context;\n      }\n\n      var alpha = replayContext.globalAlpha;\n      if (!transparentLayer) {\n        // for performance reasons, context.save / context.restore is not used\n        // to save and restore the transformation matrix and the opacity.\n        // see http://jsperf.com/context-save-restore-versus-variable\n        replayContext.globalAlpha = layerState.opacity;\n      }\n\n      if (replayContext != context) {\n        replayContext.translate(drawOffsetX, drawOffsetY);\n      }\n\n      var viewHints = frameState.viewHints;\n      var snapToPixel = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n      var width = frameState.size[0] * pixelRatio;\n      var height = frameState.size[1] * pixelRatio;\n      rotateAtOffset(replayContext, -rotation,\n        width / 2, height / 2);\n      replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids, snapToPixel);\n      if (vectorSource.getWrapX() && projection.canWrapX() &&\n          !containsExtent(projectionExtent, extent)) {\n        var startX = extent[0];\n        var worldWidth = getWidth(projectionExtent);\n        var world = 0;\n        var offsetX;\n        while (startX < projectionExtent[0]) {\n          --world;\n          offsetX = worldWidth * world;\n          transform = this.getTransform(frameState, offsetX);\n          replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids, snapToPixel);\n          startX += worldWidth;\n        }\n        world = 0;\n        startX = extent[2];\n        while (startX > projectionExtent[2]) {\n          ++world;\n          offsetX = worldWidth * world;\n          transform = this.getTransform(frameState, offsetX);\n          replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids, snapToPixel);\n          startX -= worldWidth;\n        }\n      }\n      rotateAtOffset(replayContext, rotation,\n        width / 2, height / 2);\n\n      if (hasRenderListeners) {\n        this.dispatchRenderEvent(replayContext, frameState, transform);\n      }\n      if (replayContext != context) {\n        if (transparentLayer) {\n          var mainContextAlpha = context.globalAlpha;\n          context.globalAlpha = layerState.opacity;\n          context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n          context.globalAlpha = mainContextAlpha;\n        } else {\n          context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n        }\n        replayContext.translate(-drawOffsetX, -drawOffsetY);\n      }\n\n      if (!transparentLayer) {\n        replayContext.globalAlpha = alpha;\n      }\n    }\n\n    if (clipped) {\n      context.restore();\n    }\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorLayerRenderer.prototype.composeFrame = function composeFrame (frameState, layerState, context) {\n    var transform = this.getTransform(frameState, 0);\n    this.preCompose(context, frameState, transform);\n    this.compose(context, frameState, layerState);\n    this.postCompose(context, frameState, layerState, transform);\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorLayerRenderer.prototype.forEachFeatureAtCoordinate = function forEachFeatureAtCoordinate (coordinate, frameState, hitTolerance, callback, thisArg) {\n    if (!this.replayGroup_) {\n      return undefined;\n    } else {\n      var resolution = frameState.viewState.resolution;\n      var rotation = frameState.viewState.rotation;\n      var layer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n      /** @type {!Object<string, boolean>} */\n      var features = {};\n      var result = this.replayGroup_.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n        /**\n         * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n         * @return {?} Callback result.\n         */\n        function(feature) {\n          var key = getUid(feature);\n          if (!(key in features)) {\n            features[key] = true;\n            return callback.call(thisArg, feature, layer);\n          }\n        }, null);\n      return result;\n    }\n  };\n\n  /**\n   * @param {import(\"../../events/Event.js\").default} event Event.\n   */\n  CanvasVectorLayerRenderer.prototype.handleFontsChanged_ = function handleFontsChanged_ (event) {\n    var layer = this.getLayer();\n    if (layer.getVisible() && this.replayGroup_) {\n      layer.changed();\n    }\n  };\n\n  /**\n   * Handle changes in image style state.\n   * @param {import(\"../../events/Event.js\").default} event Image style change event.\n   * @private\n   */\n  CanvasVectorLayerRenderer.prototype.handleStyleImageChange_ = function handleStyleImageChange_ (event) {\n    this.renderIfReadyAndVisible();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  CanvasVectorLayerRenderer.prototype.prepareFrame = function prepareFrame (frameState, layerState) {\n    var vectorLayer = /** @type {import(\"../../layer/Vector.js\").default} */ (this.getLayer());\n    var vectorSource = /** @type {import(\"../../source/Vector.js\").default} */ (vectorLayer.getSource());\n\n    var animating = frameState.viewHints[ViewHint.ANIMATING];\n    var interacting = frameState.viewHints[ViewHint.INTERACTING];\n    var updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n    var updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n    if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n        (!updateWhileInteracting && interacting)) {\n      return true;\n    }\n\n    var frameStateExtent = frameState.extent;\n    var viewState = frameState.viewState;\n    var projection = viewState.projection;\n    var resolution = viewState.resolution;\n    var pixelRatio = frameState.pixelRatio;\n    var vectorLayerRevision = vectorLayer.getRevision();\n    var vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n    var vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n    if (vectorLayerRenderOrder === undefined) {\n      vectorLayerRenderOrder = defaultRenderOrder;\n    }\n\n    var extent = buffer(frameStateExtent,\n      vectorLayerRenderBuffer * resolution);\n    var projectionExtent = viewState.projection.getExtent();\n\n    if (vectorSource.getWrapX() && viewState.projection.canWrapX() &&\n        !containsExtent(projectionExtent, frameState.extent)) {\n      // For the replay group, we need an extent that intersects the real world\n      // (-180° to +180°). To support geometries in a coordinate range from -540°\n      // to +540°, we add at least 1 world width on each side of the projection\n      // extent. If the viewport is wider than the world, we need to add half of\n      // the viewport width to make sure we cover the whole viewport.\n      var worldWidth = getWidth(projectionExtent);\n      var gutter = Math.max(getWidth(extent) / 2, worldWidth);\n      extent[0] = projectionExtent[0] - gutter;\n      extent[2] = projectionExtent[2] + gutter;\n    }\n\n    if (!this.dirty_ &&\n        this.renderedResolution_ == resolution &&\n        this.renderedRevision_ == vectorLayerRevision &&\n        this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n        containsExtent(this.renderedExtent_, extent)) {\n      this.replayGroupChanged = false;\n      return true;\n    }\n\n    this.replayGroup_ = null;\n\n    this.dirty_ = false;\n\n    var replayGroup = new CanvasReplayGroup(\n      getRenderTolerance(resolution, pixelRatio), extent, resolution,\n      pixelRatio, vectorSource.getOverlaps(), this.declutterTree_, vectorLayer.getRenderBuffer());\n    vectorSource.loadFeatures(extent, resolution, projection);\n    /**\n     * @param {import(\"../../Feature.js\").default} feature Feature.\n     * @this {CanvasVectorLayerRenderer}\n     */\n    var render = function(feature) {\n      var styles;\n      var styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n      if (styleFunction) {\n        styles = styleFunction(feature, resolution);\n      }\n      if (styles) {\n        var dirty = this.renderFeature(\n          feature, resolution, pixelRatio, styles, replayGroup);\n        this.dirty_ = this.dirty_ || dirty;\n      }\n    }.bind(this);\n    if (vectorLayerRenderOrder) {\n      /** @type {Array<import(\"../../Feature.js\").default>} */\n      var features = [];\n      vectorSource.forEachFeatureInExtent(extent,\n        /**\n         * @param {import(\"../../Feature.js\").default} feature Feature.\n         */\n        function(feature) {\n          features.push(feature);\n        });\n      features.sort(vectorLayerRenderOrder);\n      for (var i = 0, ii = features.length; i < ii; ++i) {\n        render(features[i]);\n      }\n    } else {\n      vectorSource.forEachFeatureInExtent(extent, render);\n    }\n    replayGroup.finish();\n\n    this.renderedResolution_ = resolution;\n    this.renderedRevision_ = vectorLayerRevision;\n    this.renderedRenderOrder_ = vectorLayerRenderOrder;\n    this.renderedExtent_ = extent;\n    this.replayGroup_ = replayGroup;\n\n    this.replayGroupChanged = true;\n    return true;\n  };\n\n  /**\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../style/Style.js\").default|Array<import(\"../../style/Style.js\").default>} styles The style or array of styles.\n   * @param {import(\"../../render/canvas/ReplayGroup.js\").default} replayGroup Replay group.\n   * @return {boolean} `true` if an image is loading.\n   */\n  CanvasVectorLayerRenderer.prototype.renderFeature = function renderFeature$1 (feature, resolution, pixelRatio, styles, replayGroup) {\n    if (!styles) {\n      return false;\n    }\n    var loading = false;\n    if (Array.isArray(styles)) {\n      for (var i = 0, ii = styles.length; i < ii; ++i) {\n        loading = renderFeature(\n          replayGroup, feature, styles[i],\n          getSquaredRenderTolerance(resolution, pixelRatio),\n          this.handleStyleImageChange_, this) || loading;\n      }\n    } else {\n      loading = renderFeature(\n        replayGroup, feature, styles,\n        getSquaredRenderTolerance(resolution, pixelRatio),\n        this.handleStyleImageChange_, this);\n    }\n    return loading;\n  };\n\n  return CanvasVectorLayerRenderer;\n}(CanvasLayerRenderer));\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {import(\"../../layer/Layer.js\").default} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {import(\"../Map.js\").default} mapRenderer The map renderer.\n * @param {import(\"../../layer/Layer.js\").default} layer The layer to be rendererd.\n * @return {CanvasVectorLayerRenderer} The layer renderer.\n */\nCanvasVectorLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorLayerRenderer(/** @type {import(\"../../layer/Vector.js\").default} */ (layer));\n};\n\n\nexport default CanvasVectorLayerRenderer;\n\n//# sourceMappingURL=VectorLayer.js.map","/**\n * @module ol/render/canvas\n */\nimport {getFontFamilies} from '../css.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {clear} from '../obj.js';\nimport LRUCache from '../structs/LRUCache.js';\nimport {create as createTransform} from '../transform.js';\n\n\n/**\n * @typedef {Object} FillState\n * @property {import(\"../colorlike.js\").ColorLike} fillStyle\n */\n\n\n/**\n * @typedef {Object} FillStrokeState\n * @property {import(\"../colorlike.js\").ColorLike} [currentFillStyle]\n * @property {import(\"../colorlike.js\").ColorLike} [currentStrokeStyle]\n * @property {string} [currentLineCap]\n * @property {Array<number>} currentLineDash\n * @property {number} [currentLineDashOffset]\n * @property {string} [currentLineJoin]\n * @property {number} [currentLineWidth]\n * @property {number} [currentMiterLimit]\n * @property {number} [lastStroke]\n * @property {import(\"../colorlike.js\").ColorLike} [fillStyle]\n * @property {import(\"../colorlike.js\").ColorLike} [strokeStyle]\n * @property {string} [lineCap]\n * @property {Array<number>} lineDash\n * @property {number} [lineDashOffset]\n * @property {string} [lineJoin]\n * @property {number} [lineWidth]\n * @property {number} [miterLimit]\n */\n\n\n/**\n * @typedef {Object} StrokeState\n * @property {string} lineCap\n * @property {Array<number>} lineDash\n * @property {number} lineDashOffset\n * @property {string} lineJoin\n * @property {number} lineWidth\n * @property {number} miterLimit\n * @property {import(\"../colorlike.js\").ColorLike} strokeStyle\n */\n\n\n/**\n * @typedef {Object} TextState\n * @property {string} font\n * @property {string} [textAlign]\n * @property {string} textBaseline\n * @property {string} [placement]\n * @property {number} [maxAngle]\n * @property {boolean} [overflow]\n * @property {import(\"../style/Fill.js\").default} [backgroundFill]\n * @property {import(\"../style/Stroke.js\").default} [backgroundStroke]\n * @property {number} [scale]\n * @property {Array<number>} [padding]\n */\n\n\n/**\n * Container for decluttered replay instructions that need to be rendered or\n * omitted together, i.e. when styles render both an image and text, or for the\n * characters that form text along lines. The basic elements of this array are\n * `[minX, minY, maxX, maxY, count]`, where the first four entries are the\n * rendered extent of the group in pixel space. `count` is the number of styles\n * in the group, i.e. 2 when an image and a text are grouped, or 1 otherwise.\n * In addition to these four elements, declutter instruction arrays (i.e. the\n * arguments to {@link module:ol/render/canvas~drawImage} are appended to the array.\n * @typedef {Array<*>} DeclutterGroup\n */\n\n\n/**\n * @const\n * @type {string}\n */\nexport var defaultFont = '10px sans-serif';\n\n\n/**\n * @const\n * @type {import(\"../color.js\").Color}\n */\nexport var defaultFillStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport var defaultLineCap = 'round';\n\n\n/**\n * @const\n * @type {Array<number>}\n */\nexport var defaultLineDash = [];\n\n\n/**\n * @const\n * @type {number}\n */\nexport var defaultLineDashOffset = 0;\n\n\n/**\n * @const\n * @type {string}\n */\nexport var defaultLineJoin = 'round';\n\n\n/**\n * @const\n * @type {number}\n */\nexport var defaultMiterLimit = 10;\n\n\n/**\n * @const\n * @type {import(\"../color.js\").Color}\n */\nexport var defaultStrokeStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport var defaultTextAlign = 'center';\n\n\n/**\n * @const\n * @type {string}\n */\nexport var defaultTextBaseline = 'middle';\n\n\n/**\n * @const\n * @type {Array<number>}\n */\nexport var defaultPadding = [0, 0, 0, 0];\n\n\n/**\n * @const\n * @type {number}\n */\nexport var defaultLineWidth = 1;\n\n\n/**\n * The label cache for text rendering. To change the default cache size of 2048\n * entries, use {@link module:ol/structs/LRUCache#setSize}.\n * @type {LRUCache<HTMLCanvasElement>}\n * @api\n */\nexport var labelCache = new LRUCache();\n\n\n/**\n * @type {!Object<string, number>}\n */\nexport var checkedFonts = {};\n\n\n/**\n * @type {CanvasRenderingContext2D}\n */\nvar measureContext = null;\n\n\n/**\n * @type {!Object<string, number>}\n */\nexport var textHeights = {};\n\n\n/**\n * Clears the label cache when a font becomes available.\n * @param {string} fontSpec CSS font spec.\n */\nexport var checkFont = (function() {\n  var retries = 60;\n  var checked = checkedFonts;\n  var size = '32px ';\n  var referenceFonts = ['monospace', 'serif'];\n  var len = referenceFonts.length;\n  var text = 'wmytzilWMYTZIL@#/&?$%10\\uF013';\n  var interval, referenceWidth;\n\n  function isAvailable(font) {\n    var context = getMeasureContext();\n    // Check weight ranges according to\n    // https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight#Fallback_weights\n    for (var weight = 100; weight <= 700; weight += 300) {\n      var fontWeight = weight + ' ';\n      var available = true;\n      for (var i = 0; i < len; ++i) {\n        var referenceFont = referenceFonts[i];\n        context.font = fontWeight + size + referenceFont;\n        referenceWidth = context.measureText(text).width;\n        if (font != referenceFont) {\n          context.font = fontWeight + size + font + ',' + referenceFont;\n          var width = context.measureText(text).width;\n          // If width and referenceWidth are the same, then the fallback was used\n          // instead of the font we wanted, so the font is not available.\n          available = available && width != referenceWidth;\n        }\n      }\n      if (available) {\n        // Consider font available when it is available in one weight range.\n        //FIXME With this we miss rare corner cases, so we should consider\n        //FIXME checking availability for each requested weight range.\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function check() {\n    var done = true;\n    for (var font in checked) {\n      if (checked[font] < retries) {\n        if (isAvailable(font)) {\n          checked[font] = retries;\n          clear(textHeights);\n          // Make sure that loaded fonts are picked up by Safari\n          measureContext = null;\n          labelCache.clear();\n        } else {\n          ++checked[font];\n          done = false;\n        }\n      }\n    }\n    if (done) {\n      clearInterval(interval);\n      interval = undefined;\n    }\n  }\n\n  return function(fontSpec) {\n    var fontFamilies = getFontFamilies(fontSpec);\n    if (!fontFamilies) {\n      return;\n    }\n    for (var i = 0, ii = fontFamilies.length; i < ii; ++i) {\n      var fontFamily = fontFamilies[i];\n      if (!(fontFamily in checked)) {\n        checked[fontFamily] = retries;\n        if (!isAvailable(fontFamily)) {\n          checked[fontFamily] = 0;\n          if (interval === undefined) {\n            interval = setInterval(check, 32);\n          }\n        }\n      }\n    }\n  };\n})();\n\n\n/**\n * @return {CanvasRenderingContext2D} Measure context.\n */\nfunction getMeasureContext() {\n  if (!measureContext) {\n    measureContext = createCanvasContext2D(1, 1);\n  }\n  return measureContext;\n}\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @return {import(\"../size.js\").Size} Measurement.\n */\nexport var measureTextHeight = (function() {\n  var span;\n  var heights = textHeights;\n  return function(font) {\n    var height = heights[font];\n    if (height == undefined) {\n      if (!span) {\n        span = document.createElement('span');\n        span.textContent = 'M';\n        span.style.margin = span.style.padding = '0 !important';\n        span.style.position = 'absolute !important';\n        span.style.left = '-99999px !important';\n      }\n      span.style.font = font;\n      document.body.appendChild(span);\n      height = heights[font] = span.offsetHeight;\n      document.body.removeChild(span);\n    }\n    return height;\n  };\n})();\n\n\n/**\n * @param {string} font Font.\n * @param {string} text Text.\n * @return {number} Width.\n */\nexport function measureTextWidth(font, text) {\n  var measureContext = getMeasureContext();\n  if (font != measureContext.font) {\n    measureContext.font = font;\n  }\n  return measureContext.measureText(text).width;\n}\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n * @param {number} offsetX X offset.\n * @param {number} offsetY Y offset.\n */\nexport function rotateAtOffset(context, rotation, offsetX, offsetY) {\n  if (rotation !== 0) {\n    context.translate(offsetX, offsetY);\n    context.rotate(rotation);\n    context.translate(-offsetX, -offsetY);\n  }\n}\n\n\nexport var resetTransform = createTransform();\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {import(\"../transform.js\").Transform|null} transform Transform.\n * @param {number} opacity Opacity.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} w Width.\n * @param {number} h Height.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} scale Scale.\n */\nexport function drawImage(context,\n  transform, opacity, image, originX, originY, w, h, x, y, scale) {\n  var alpha;\n  if (opacity != 1) {\n    alpha = context.globalAlpha;\n    context.globalAlpha = alpha * opacity;\n  }\n  if (transform) {\n    context.setTransform.apply(context, transform);\n  }\n\n  context.drawImage(image, originX, originY, w, h, x, y, w * scale, h * scale);\n\n  if (alpha) {\n    context.globalAlpha = alpha;\n  }\n  if (transform) {\n    context.setTransform.apply(context, resetTransform);\n  }\n}\n\n//# sourceMappingURL=canvas.js.map","/**\n * @module ol/render/VectorContext\n */\n\n/**\n * @classdesc\n * Context for drawing geometries.  A vector context is available on render\n * events and does not need to be constructed directly.\n * @api\n */\nvar VectorContext = function VectorContext () {};\n\nVectorContext.prototype.drawCustom = function drawCustom (geometry, feature, renderer) {};\n\n/**\n * Render a geometry.\n *\n * @param {import(\"../geom/Geometry.js\").default} geometry The geometry to render.\n */\nVectorContext.prototype.drawGeometry = function drawGeometry (geometry) {};\n\n/**\n * Set the rendering style.\n *\n * @param {import(\"../style/Style.js\").default} style The rendering style.\n */\nVectorContext.prototype.setStyle = function setStyle (style) {};\n\n/**\n * @param {import(\"../geom/Circle.js\").default} circleGeometry Circle geometry.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawCircle = function drawCircle (circleGeometry, feature) {};\n\n/**\n * @param {import(\"../Feature.js\").default} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n */\nVectorContext.prototype.drawFeature = function drawFeature (feature, style) {};\n\n/**\n * @param {import(\"../geom/GeometryCollection.js\").default} geometryCollectionGeometry Geometry collection.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawGeometryCollection = function drawGeometryCollection (geometryCollectionGeometry, feature) {};\n\n/**\n * @param {import(\"../geom/LineString.js\").default|import(\"./Feature.js\").default} lineStringGeometry Line string geometry.\n * @param {import(\"../Feature.js\").default|import(\"./Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawLineString = function drawLineString (lineStringGeometry, feature) {};\n\n/**\n * @param {import(\"../geom/MultiLineString.js\").default|import(\"./Feature.js\").default} multiLineStringGeometry MultiLineString geometry.\n * @param {import(\"../Feature.js\").default|import(\"./Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawMultiLineString = function drawMultiLineString (multiLineStringGeometry, feature) {};\n\n/**\n * @param {import(\"../geom/MultiPoint.js\").default|import(\"./Feature.js\").default} multiPointGeometry MultiPoint geometry.\n * @param {import(\"../Feature.js\").default|import(\"./Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawMultiPoint = function drawMultiPoint (multiPointGeometry, feature) {};\n\n/**\n * @param {import(\"../geom/MultiPolygon.js\").default} multiPolygonGeometry MultiPolygon geometry.\n * @param {import(\"../Feature.js\").default|import(\"./Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawMultiPolygon = function drawMultiPolygon (multiPolygonGeometry, feature) {};\n\n/**\n * @param {import(\"../geom/Point.js\").default|import(\"./Feature.js\").default} pointGeometry Point geometry.\n * @param {import(\"../Feature.js\").default|import(\"./Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawPoint = function drawPoint (pointGeometry, feature) {};\n\n/**\n * @param {import(\"../geom/Polygon.js\").default|import(\"./Feature.js\").default} polygonGeometry Polygon geometry.\n * @param {import(\"../Feature.js\").default|import(\"./Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawPolygon = function drawPolygon (polygonGeometry, feature) {};\n\n/**\n * @param {import(\"../geom/Geometry.js\").default|import(\"./Feature.js\").default} geometry Geometry.\n * @param {import(\"../Feature.js\").default|import(\"./Feature.js\").default} feature Feature.\n */\nVectorContext.prototype.drawText = function drawText (geometry, feature) {};\n\n/**\n * @param {import(\"../style/Fill.js\").default} fillStyle Fill style.\n * @param {import(\"../style/Stroke.js\").default} strokeStyle Stroke style.\n */\nVectorContext.prototype.setFillStrokeStyle = function setFillStrokeStyle (fillStyle, strokeStyle) {};\n\n/**\n * @param {import(\"../style/Image.js\").default} imageStyle Image style.\n * @param {import(\"./canvas.js\").DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setImageStyle = function setImageStyle (imageStyle, opt_declutterGroup) {};\n\n/**\n * @param {import(\"../style/Text.js\").default} textStyle Text style.\n * @param {import(\"./canvas.js\").DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setTextStyle = function setTextStyle (textStyle, opt_declutterGroup) {};\n\nexport default VectorContext;\n\n//# sourceMappingURL=VectorContext.js.map","/**\n * @module ol/proj/Units\n */\n\n/**\n * Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or\n * `'us-ft'`.\n * @enum {string}\n */\nvar Units = {\n  DEGREES: 'degrees',\n  FEET: 'ft',\n  METERS: 'm',\n  PIXELS: 'pixels',\n  TILE_PIXELS: 'tile-pixels',\n  USFEET: 'us-ft'\n};\n\n\n/**\n * Meters per unit lookup table.\n * @const\n * @type {Object<Units, number>}\n * @api\n */\nexport var METERS_PER_UNIT = {};\n// use the radius of the Normal sphere\nMETERS_PER_UNIT[Units.DEGREES] = 2 * Math.PI * 6370997 / 360;\nMETERS_PER_UNIT[Units.FEET] = 0.3048;\nMETERS_PER_UNIT[Units.METERS] = 1;\nMETERS_PER_UNIT[Units.USFEET] = 1200 / 3937;\n\nexport default Units;\n\n//# sourceMappingURL=Units.js.map"],"sourceRoot":""}